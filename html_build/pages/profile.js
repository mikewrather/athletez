/**
 * @license RequireJS text 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/* jQuery Resize And Crop (jrac)
 * A jQuery 1.4+ and jQueryUi 1.8+ plugin under GNU GENERAL PUBLIC LICENSE version 2 lisense.
 * Copyright (c) 2011 Cedric Gampert - cgampert@gmail.com
 */

/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.1
 *
 */

/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.6.5
 *
 */

/*!
 * jQuery Browser Plugin v0.0.3
 * https://github.com/gabceb/jquery-browser-plugin
 *
 * Original jquery-browser code Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * http://jquery.org/license
 *
 * Modifications Copyright 2013 Gabriel Cebrian
 * https://github.com/gabceb
 *
 * Released under the MIT license
 *
 * Date: 2013-07-29T17:23:27-07:00
 */

define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.4",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!profile/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header" class="profile-header"></div>\r\n	<div class="green-left-heading">MESSAGE BOARD</div>\r\n	<div id="commenton-wrap" class="clearfix clear profile-comment-list-box"></div>\r\n	<div id="comment_div" class="clearfix"></div>\r\n	\r\n	<div class="green-left-heading">PHOTO/VIDEO</div>\r\n	<div class="row-fluid" id="main-content">\r\n	<!-- <div id="video-wrap" class="clearfix"></div> -->\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<div id="add-media" class="clearfix">add media</div>\r\n	</div>\r\n	\r\n	<div class="row-fluid">\r\n		<div class="span4" id="main-sidebar">\r\n			<div id="org-wrap" class="clearfix hide"></div>\r\n			<div id="related-wrap" class="clearfix"></div>\r\n			<div  class="clearfix"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="green-left-heading">GAMES</div>\r\n	<div id="games_div" class="clearfix">\r\n		<!--div class="game-box-outer">\r\n			<ul>\r\n				<li><a href="javascript: void(0);" class="background-blue">a</a></li>\r\n				<li><a href="javascript: void(0);" class="background-orange">b</a></li>\r\n				<li><a href="javascript: void(0);" class="background-orange">c</a></li>\r\n				<li><a href="javascript: void(0);" class="background-orange">d</a></li>\r\n			</ul>\r\n		</div-->\r\n		\r\n	</div>\r\n	<div class="green-left-heading">FANS</div>\r\n	<div id="fans-div" class="clearfix clear">&nbsp;</div>\r\n	\r\n	<div id="main-footer">\r\n	</div>\r\n</div>\r\n'}),define("text!chrome/templates/header.html",[],function(){return'\r\n<div class="row-fluid">\r\n    <div class="logo">\r\n    {{#branding}}\r\n    <a class="brand" title="home" href="#home">\r\n        <img src="{{base_url}}{{src}}" id="header_logo" alt="{{alt}}" />\r\n    </a>\r\n    {{/branding}}\r\n    </div>\r\n\r\n    <div class="searchform"><!--\r\n    {{#search}}\r\n    <form action="/" method="post" class="form-inline">\r\n        <input class="input-search" name="s" placeholder="{{placeholder}}"/>    \r\n    </form>\r\n    {{/search}}-->\r\n    </div>\r\n\r\n    <div class="account clearfix">\r\n        {{#authorized}}\r\n            <div class="photo"><img src="" alt="{{user_name}}"/></div>\r\n            <div class="userlinks dropdown">\r\n                <a class="dropdown-toggle" data-toggle="dropdown">{{user_name}} <b class="caret"></b></a>\r\n                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\r\n                    {{#nav}}\r\n                        <li><a href="{{link}}" {{#id}} id="{{id}}" {{/id}} >{{page}}</a></li>\r\n                    {{/nav}}\r\n\r\n                </ul>\r\n            </div>\r\n        {{/authorized}}    \r\n        {{^authorized}}\r\n            <a href="{{login_url}}" id="userlogin">{{login_label}}</a>\r\n        {{/authorized}}    \r\n    </div>\r\n</div>\r\n\r\n<!--\r\n{{^authorized}}\r\n<div class="row-fluid textright">\r\n    {{signup_social_label}} <a href="{{signup_facebook_link}}" class="signup-facebook">{{signup_facebook_label}}</a>\r\n	<a href="{{signup_email_link}}" class="signup-email">{{signup_email_label}}</a>\r\n</div>\r\n{{/authorized}} -->\r\n<!--\r\n <div class="alert global-alert"></div>\r\n<div class="alert alert-info global-messages"></div>\r\n<div class="alert alert-error global-errors"></div>\r\n-->\r\n'}),define("chrome/models/header",["models/base","utils/storage"],function(e,t){var n;return n=e.extend({defaults:{branding:{alt:"Athletez Logo",src:"http://cdn.athletez.com/resources/img/athletez_logo_small.png"},search:{placeholder:"Search"},login_url:"#user/login",login_label:"SIGN IN",logout_url:"#logout",logout_label:"Log Out",signup_social_label:"Sign up for Free",signup_facebook_label:"Facebook",signup_email_label:"Email",signup_facebook_link:"/",signup_email_link:"/"},url:function(){return testpath?testpath+"/authcheck?time="+(new Date).getTime():"/authcheck?time="+(new Date).getTime()},saveCookie:function(){var e=new t("user","localStorage");e.create(this)}}),n}),define("text!signup/templates/layout.html",[],function(){return'<!--<div id="main-header">\r\n</div>\r\n\r\n<div id="main-content">\r\n</div>\r\n\r\n<div id="main-footer">\r\n</div>-->\r\n\r\n<div id="RegModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n	</div>\r\n	<div id="main-contentreg"></div>\r\n	<div class="modal-body">\r\n		<div class="inner-content-h"></div>\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n</div>\r\n'}),define("text!registration/templates/layout.html",[],function(){return'\r\n<div id="main-header">\r\n\r\n</div>\r\n\r\n<div id="main-content">\r\n    \r\n    \r\n    \r\n</div>\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n'}),define("controller",["facade","collections","models","utils"],function(e,t,n,r){var i,s=t.ApplicationStates,o=n.EventModel,u=e._,a=e.$,f=r.lib.Channel,l=e.Backbone.Model.extend;return i=function(e){e=e||{},e.title?document.title=e.title:document.title="Athletez",this.route=e.route,i.prototype.appStates?e.appStates&&(i.prototype.appStates=e.appStates):i.prototype.appStates=new s,this.route&&i.prototype.appStates&&this.getStoredState(),this.initialize(e)},i.extend=l,i.prototype={initialize:function(e){return this.triggerPublishers(),u.bindAll(this),this.handleOptions(e),this.addSubscribers(),this.handleDeferreds(),this},generateRandomNumber:function(){var e=(new Date).getTime();return e+=Math.floor(Math.random()*200+1),e},setupSections:function(){},setupScheme:function(){},setupLayout:function(){var e;return this.layout=e,this.layout},handleDeferreds:function(){var e=this;a.when(null).then(function(){})},addSubscribers:function(){},removeSubscribers:function(){},triggerPublishers:function(){},meta:{activeViews:[],viewNames:[]},handleOptions:function(e){i.prototype.handleOptions(e)},routeChange:function(e){i.prototype.routeChange(options)},addStateChangeSubscriber:null},i.prototype.data=null,i.prototype.layout=null,i.prototype.scheme=[],i.prototype.sections={},i.prototype.route=null,i.prototype.handleOptions=function(e){e&&e.useFixtures&&this.useFixturesForWebServices()},i.prototype.transitionActiveViews=function(e){var t,n=this.layout,r=this.meta.sectionName,i=this.meta.activeViews=[];e=e||this.meta.presentation,t=function(t,s){s===e&&(t.state()==="not-rendered"&&t.render(),n.transition(r,t),i.push(s))},this.iterateOverLayoutViews(t)},i.prototype.renderInActiveViews=function(){var e;e=function(e){e.state()==="not-rendered"&&(e.callbacks.add(function(){e.state("not-displayed")}),e.render())},this.iterateOverLayoutViews(e)},i.prototype.iterateOverLayoutViews=function(e){var t=this.meta.activeViews,n=this.sections,r=this.meta.viewNames,i,s,o;for(o=0;o<r.length;o++)i=r[o],u.contains(t,i)||(s=n[i],e&&u.isFunction(e)&&e(s,i))},i.prototype.routeChange=function(e,t,n){var r={data:{}},s;if(e&&!u.isString(e))throw s="Controller routeChange expects string as 1st argument.",new Error(s);this.route=e,this.layout&&(this.layout.state({route:e}),r.data=this.layout.state(),u.extend(r,t||{}),i.prototype.appStates.add(r),this.data=r.data,debug.log(r),i.prototype.appStates.save(e)),n&&u.isFunction(n)&&n(this.data),debug.log("Controller routeChange method called with: "+e)},i.prototype.getStoredState=function(){var e;if(!this.route)throw new Error("Controller does not have route property.");return e=i.prototype.appStates.findInCollectionOrStorage(this.route),this.data=e&&e.data?e.data:e,this.data},i.prototype.addStateChangeSubscriber=function(e,t){function s(r,s){var o=e,a=t,f=n,l;f.layout&&(l=f.layout.state(),l&&i.prototype.appStates.add({name:f.route,data:l,expires:new Date(Date.now()+4032e4),storage:"localStorage"})),a&&u.isFunction(a)&&a(r,s)}var n=this,r;if(!e||!u.isString(e))throw r="controller method addStateChangeSubscriber expected string as 1st argument.",new Error(r);f(e+":stateChanged").subscribe(s)},i.prototype.remove=function(){var e;this.layout&&this.layout.remove();for(e in this)delete this[e]},i.prototype.webServices={},i.prototype.useFixturesForWebServices=function(){},i}),define("user/models/basics",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"undefined"==typeof this.id?testpath?testpath+"/user/basics/":"/api/user/basics/":testpath?testpath+"/user/basics/"+this.id:"/api/user/basics/"+this.id},initialize:function(){n.__super__.initialize.apply(this,arguments)},user_pic_small:function(){return this.payload.user_picture.types.small_thumb.url}}),n}),define("registration/models/select_type",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return"/api/user/basics/"+this.id},fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n)}}),t}),define("user/models/fbreg",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,birth_day:null,high_school:null,email:null,user_picture:null},desc:"Facebook Registration Information",exec_data:{exec_time:0,exec_error:!1},id:1})}),n}),define("registration/models/register_facebook",["facade","user/models/fbreg","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbreg":"/api/user/fbreg"}}),r}),define("registration/models/register_email",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+this.id}}),t}),define("registration/models/upload_image",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/uploadimage":"/api/user/uploadimage"}}),t}),define("registration/models/select_org",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!registration/templates/select_type.html",[],function(){return'\r\n<h1>Register with AthletesUp</h1>\r\n<a href="#" class="register_facebook">Sign up through Facebook</a>\r\n<br/><br/> OR <br/><br/>\r\n<a href="#" class="register_email">Register With Email Address</a>\r\n\r\n<a href="#" class="go_club">go club directly</a>\r\n<div id="fb-root"></div>'}),define("registration/views/select_type",["require","registration/models/select_type","text!registration/templates/select_type.html","facade","views","utils"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView;return r=a.extend({id:"main-content",events:{"click .register_facebook":"registerWithFacebook","click .register_email":"registerWithEmail","click .go_club":"selectOrg"},template:n,initialize:function(e){a.prototype.initialize.call(this,e),this.initModel()},registerWithFacebook:function(e){function t(){FB.login(function(e){e.authResponse?u("registration-with-facebook").publish():alert("Cancelled")},{scope:"email, user_birthday, user_photos"})}function n(){var e,n="facebook-jssdk",r=document.getElementsByTagName("script")[0];if(document.getElementById(n)){t();return}e=document.createElement("script"),e.id=n,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(e,r)}e.preventDefault(),window.fbAsyncInit=function(){FB.init({appId:"219148511595084",status:!0,cookie:!0,xfbml:!0,oauth:!0}),FB.getLoginStatus(function(e){e.status==="connected"?FB.api("/me",function(e){u("registration-with-facebook").publish()}):e.status==="not_authorized"?t():t()},{scope:"email, user_birthday, user_photos"})},n()},registerWithEmail:function(e){e.preventDefault(),u("registration-with-email").publish()},initModel:function(){function n(n){e.select_type=new t,e.select_type.id=n,e.select_type.fetch(),$.when(e.select_type.request).done(function(){e.model=e.select_type})}var e=this;u("app-inited").subscribe(n)},selectOrg:function(e){e.preventDefault();var t=this,n=t.model.get("payload");u("registration-select-org").publish(n)}}),r}),define("text!registration/templates/register_facebook.html",[],function(){return'{{#errorDisplay}}\r\n<div class="span8" style="color:red;"> Error:  {{errorValue}} </div>\r\n{{/errorDisplay}}\r\n\r\n{{^errorDisplay}}\r\n \r\n\r\n\r\n{{#payload}}\r\n\r\n\r\n<h1>Register with Facebook</h1>\r\n<div class="row-fluid">\r\n	<div class="span4">\r\n		<img class="picture" src="{{profile_picture}}" alt="{{name}}"/><br/>\r\n	</div>\r\n	<div class="span8">\r\n		<h3>{{name}}</h3>\r\n\r\n		<div class="field">\r\n			DOB:\r\n			<span class="value" data-name="birthday" data-value="{{birthday}}">\r\n				<input type="hidden" name="birthday" value="{{birthday}}"/>\r\n				{{birthday}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n\r\n		<div class="field">\r\n			Email:\r\n			<span class="value" data-name="email" data-value="{{email}}">\r\n				<input type="hidden" name="email" value="{{email}}"/>\r\n				{{email}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			Password: <input type="password" class="password" name="password"/>\r\n		</div>\r\n		<div class="field">\r\n			Again: <input type="password" name="password-again"/>\r\n		</div>\r\n		<div class="password-error"></div>\r\n	</div>\r\n</div>\r\n<div class="row-fluid">\r\n	<label for="agree"><input type="checkbox" id="agree" name="agree"/>I have read and agree to the <a href="#">Terms of Service</a></label>\r\n	<a href="javascript:void(0);" class="next btn-common btn-green">What\'s Next</a>\r\n</div>\r\n{{/payload}}\r\n\r\n{{/errorDisplay}}'}),function(e){e.extend(e.fn,{pstrength:function(t){var t=e.extend({verdects:["Very weak","Weak","Medium","Strong","Very strong"],colors:["#f00","#c06","#f60","#3c0","#3f0"],scores:[10,15,30,40],common:["password","sex","god","123456","123","liverpool","letmein","qwerty","monkey"],minchar:6},t);return this.each(function(){var n=e(this).attr("id");e(this).after('<div class="pstrength-minchar" id="'+n+'_minchar">Minimum number of characters is '+t.minchar+"</div>"),e(this).after('<div class="pstrength-info" id="'+n+'_text"></div>'),e(this).after('<div class="pstrength-bar" id="'+n+'_bar" style="border: 1px solid white; font-size: 1px; height: 5px; width: 0px;"></div>'),e(this).keyup(function(){e.fn.runPassword(e(this).val(),n,t)})})},runPassword:function(t,n,r){nPerc=e.fn.checkPassword(t,r);var i="#"+n+"_bar",s="#"+n+"_text";nPerc==-200?(strColor="#f00",strText="Unsafe password word!",e(i).css({width:"0%"})):nPerc<0&&nPerc>-199?(strColor="#ccc",strText="Too short",e(i).css({width:"5%"})):nPerc<=r.scores[0]?(strColor=r.colors[0],strText=r.verdects[0],e(i).css({width:"10%"})):nPerc>r.scores[0]&&nPerc<=r.scores[1]?(strColor=r.colors[1],strText=r.verdects[1],e(i).css({width:"25%"})):nPerc>r.scores[1]&&nPerc<=r.scores[2]?(strColor=r.colors[2],strText=r.verdects[2],e(i).css({width:"50%"})):nPerc>r.scores[2]&&nPerc<=r.scores[3]?(strColor=r.colors[3],strText=r.verdects[3],e(i).css({width:"75%"})):(strColor=r.colors[4],strText=r.verdects[4],e(i).css({width:"92%"})),e(i).css({backgroundColor:strColor}),e(s).html("<span style='color: "+strColor+";'>"+strText+"</span>")},checkPassword:function(e,t){var n=0,r=t.verdects[0];e.length<t.minchar?n-=100:e.length>=t.minchar&&e.length<=t.minchar+2?n+=6:e.length>=t.minchar+3&&e.length<=t.minchar+4?n+=12:e.length>=t.minchar+5&&(n+=18),e.match(/[a-z]/)&&(n+=1),e.match(/[A-Z]/)&&(n+=5),e.match(/\d+/)&&(n+=5),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(n+=7),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(n+=5),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(n+=7),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(n+=2),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(n+=3),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(n+=3);for(var i=0;i<t.common.length;i++)e.toLowerCase()==t.common[i]&&(n=-200);return n}})}(jQuery),define("jquery.pstrength",function(){}),define("media/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),t!=undefined?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this},selectImageType:function(e){return r.each(this.get("payload").types,function(t,n){n==e&&(this.get("payload").image_path=t.url)},this),this}}),n}),define("media/collections/images",["facade","collections","media/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.processItemFromPayload(t,i),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("registration/collections/fbimages",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbpics":"/api/user/fbpics"}}),r}),define("text!registration/templates/fbimage-item.html",[],function(){return'\r\n{{#payload}}\r\n<img src="{{thumbnail}}" alt="Thumb"/>\r\n{{#num_votes}}{{num_votes}} Votes{{/num_votes}}\r\n{{/payload}}\r\n\r\n'}),define("registration/views/fbimage-item",["vendor","views","utils","text!registration/templates/fbimage-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"image",events:{click:"changeImage"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeImage:function(){Channel("changeimage"+this.model.collection.id).publish(this.model)}}),i}),define("text!registration/templates/fbimage-board.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter fbimagecontainer pane">\r\n        <img id="image-select" src="{{original}}" alt="{{image_title}}"/>\r\n        <div class="coords" style="display:none;">\r\n            <div>crop x <input name="crop-x" type="hidden" /></div>\r\n            <div>crop y <input name="crop-y" type="hidden" /></div>\r\n            <div>crop width <input name="crop-width" type="hidden" /></div>\r\n            <div>crop height <input name="crop-height" type="hidden" /></div>\r\n            <div>image width <input name="image-width" type="hidden" /></div>\r\n            <div>image height <input name="image-height" type="hidden" /></div>            \r\n        </div>\r\n    </div>\r\n{{/payload}}\r\n'}),function(e){e.fn.jrac=function(t){var n={crop_width:200,crop_height:100,crop_x:0,crop_y:0,crop_resize:!0,crop_aspect_ratio:null,image_width:null,image_height:null,zoom_min:100,zoom_max:3e3,viewport_image_surrounding:!1,viewport_width:null,viewport_height:null,viewport_resize:!0,viewport_content_left:0,viewport_content_top:0,viewport_onload:null};return this.each(function(){if(!e(this).is("img"))return;var r=!1;typeof t=="object"?e.extend(n,t):t=="destroy"&&(r=!0);var i=e(this),s=!1;i.parent().hasClass("jrac_viewport")&&(s=!0),s&&r?(i.draggable("destroy"),i.parent().find(".jrac_crop").remove(),i.parent().parent().find(".jrac_zoom_slider").remove(),i.parent().append(i.data("original")),i.parent().unwrap(),i.unwrap(),i.remove()):i.data("original",i.clone());if(r)return;s||i.hide().css("position","absolute").wrap('<div class="jrac_container"><div class="jrac_viewport"></div></div>');var o=i.parent(),u=o.parent(),a=e('<div class="jrac_loading" />');o.append(a);var f=function(){e.extend(i,{scale_proportion_locked:!0,originalWidth:i.width(),originalHeight:i.height()}),i.width(n.image_width).height(n.image_height),n.viewport_image_surrounding?o.width(i.width()).height(i.height()):o.width(n.viewport_width).height(n.viewport_height),i.css({left:n.viewport_content_left,top:n.viewport_content_top});if(!s){var t=e('<div class="jrac_zoom_slider"><div class="ui-slider-handle"></div></div>').width(o.width()).slider({value:i.width(),min:n.zoom_min,max:n.zoom_max,start:function(n,r){e.extend(t,{on_start_width_value:r.value,on_start_height_value:i.height()})},slide:function(e,n){var r=Math.round(t.on_start_height_value*n.value/t.on_start_width_value);i.height(r),i.width(n.value),o.observator.notify("jrac_image_height",r),o.observator.notify("jrac_image_width",n.value)}});u.append(t),n.viewport_resize&&o.resizable({resize:function(e,n){t.width(n.size.width)}}),i.draggable({drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});var r=e('<div class="jrac_crop"><div class="jrac_crop_drag_handler"></div></div>').css({width:n.crop_width,height:n.crop_height,left:n.crop_x+n.viewport_content_left,top:n.crop_y+n.viewport_content_top}).draggable({containment:o,handle:"div.jrac_crop_drag_handler",drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});n.crop_resize&&r.resizable({containment:o,aspectRatio:n.crop_aspect_ratio,resize:function(e,t){t.size.width!=t.originalSize.width&&o.observator.notify("jrac_crop_width",r.width()),t.size.height!=t.originalSize.height&&o.observator.notify("jrac_crop_height",r.height())}}),o.append(r)}e.extend(o,{$container:u,$image:i,$crop:r,$zoom_widget:t,observator:{items:{},register:function(e,t,n){e&&t&&(this.items[e]={element:t,callback:n})},unregister:function(e){delete this.items[e]},notify:function(t,n){if(this.items[t]){var r=this.items[t].element,s=this.items[t].callback;r.trigger(t,[o,n]),e.isFunction(s)&&s.call(o,t,r,n)}i.trigger("jrac_events",[o])},notify_all:function(){this.notify("jrac_crop_x",this.crop_position_x()),this.notify("jrac_crop_y",this.crop_position_y()),this.notify("jrac_crop_width",r.width()),this.notify("jrac_crop_height",r.height()),this.notify("jrac_image_width",i.width()),this.notify("jrac_image_height",i.height())},crop_position_x:function(){return r.position().left-i.position().left},crop_position_y:function(){return r.position().top-i.position().top},crop_consistent:function(){return this.crop_position_x()>=0&&this.crop_position_y()>=0&&this.crop_position_x()+r.width()<=i.width()&&this.crop_position_y()+r.height()<=i.height()},set_property:function(e,n){n=parseInt(n);if(isNaN(n))return;switch(e){case"jrac_crop_x":r.css("left",n+i.position().left);break;case"jrac_crop_y":r.css("top",n+i.position().top);break;case"jrac_crop_width":r.width(n);break;case"jrac_crop_height":r.height(n);break;case"jrac_image_width":if(i.scale_proportion_locked){var s=Math.round(i.height()*n/i.width());i.height(s),this.notify("jrac_image_height",s)}i.width(n),t.slider("value",n);break;case"jrac_image_height":if(i.scale_proportion_locked){var o=Math.round(i.width()*n/i.height());i.width(o),this.notify("jrac_image_width",o),t.slider("value",o)}i.height(n)}this.notify(e,n)}}}),a.hide(),a.remove(),i.show(),e.isFunction(n.viewport_onload)&&(n.viewport_onload.call(o),o.observator.notify_all())},l=i.attr("src");/^data:image/.test(l)?f():(l=l+(l.search(/\?/)<0?"?":"&")+"jracrandom="+(new Date).getTime(),e("<img>").attr("src",l).load(f()))})}}(jQuery),define("jquery.jrac",function(){}),define("registration/views/fbimage-board",["require","text!registration/templates/fbimage-board.html","facade","views","utils","jquery.jrac"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=r._,a=r.$,f=s.lib.Channel;return n=o.extend({tagName:"div",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){console.log("fb image board render"),console.log("fb image board collection"),console.log(this.collection);var e=this;o.prototype.render.call(this)},selectArea:function(e,t){a("#x1").val(t.x1),a("#y1").val(t.y1),a("#x2").val(t.x2),a("#y2").val(t.y2),a("#w").val(t.width),a("#h").val(t.height)},initCropView:function(){a("#image-select").jrac({crop_width:150,crop_height:150,crop_aspect_ratio:"1:1",crop_x:100,crop_y:100,image_width:400,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){a(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,a(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=a(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},removeCropView:function(){a("#image-select").jrac("destroy"),a("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=this.$(".coords :input").serializeArray(),t=this.model.get("payload");a.each(e,function(e,n){t[n.name]=n.value}),this.model.set("payload",t)}}),n}),define("text!registration/templates/picture_buttons.html",[],function(){return'\r\n<div id="picture-buttons">\r\n    <a href="#" class="use_image">Use This Image</a>\r\n    <a href="#" class="upload_image">Upload a New Image</a>\r\n</div>\r\n'}),define("registration/views/picture_buttons",["require","text!registration/templates/picture_buttons.html","vendor","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=s.lib.Channel,a=e("vendor"),f=a.Mustache;return n=o.extend({tagName:"div",className:"picture-buttons clearfix",template:t,events:{"click .use_image":"clickUseImage","click .upload_image":"clickUploadImage"},render:function(){var e=f.to_html(this.template);return this.$el.html(e),this},clickUseImage:function(e){e.preventDefault(),u("registration-use-image").publish()},clickUploadImage:function(e){e.preventDefault(),u("registration-upload-image").publish()}}),n}),define("registration/views/fbimage-list",["facade","utils","views","registration/views/fbimage-item","registration/views/fbimage-board","registration/views/picture_buttons","models/base"],function(e,t,n,r,i,s,o){var u,a=n.BaseView;return _=e._,u=a.extend({initialize:function(e){console.log(this.options,"options.collection"),_.map(this.collection,function(e,t){console.log(e.payload,"value.attributes")})},createElement:function(){}}),u}),define("registration/views/register_facebook",["require","text!registration/templates/register_facebook.html","backbone","facade","views","utils","jquery.pstrength","registration/collections/fbimages","registration/views/fbimage-list"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView,f=e("registration/collections/fbimages"),l=e("registration/views/fbimage-list");return r=a.extend({id:"main-content",events:{keypress:"stopSubmit","click .change-field":"changeField","click .diff_fb_pic":"diffFBPicture","click .upload_new_image":"uploadNewImage","click .next":"nextStep"},template:t,initialize:function(e){function s(e){i.$(".picture").attr("src",e)}function o(){i.initFBPictures()}function f(){i.initUploadImage()}var t=jQuery.parseJSON(this.model.request.responseText);if(t.exec_data.exec_error){var n=!0,r=t.exec_data.error_array[0].error;this.model.set("errorDisplay",!0),this.model.set("errorValue",r)}var i=this;if(!this.model)throw new Error("RegistrationFacebookView expected options.model.");i.parseFBData(this.model.get("payload")),a.prototype.initialize.call(this,e),u("registration-change-picture").subscribe(s),u("registration-diff-fbpicture").subscribe(o),u("registration-upload-image").subscribe(f)},childViews:{},render:function(e,t,n){a.prototype.render.call(this,e,t,n),this.$(".password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},diffFBPicture:function(e){e.preventDefault(),this.initFBPictures()},uploadNewImage:function(e){e.preventDefault(),this.initUploadImage()},parseFBData:function(e){e.hs_exists=e.high_school?!0:!1,e.dob_exists=e.birthday?!0:!1,e.email_exists=e.email?!0:!1,this.model.set("payload",e)},initFBPictures:function(){var e=this;this.fbimages?(debug.log(e.fbimages.toJSON(),"else"),this.fbImageListView=new l({collection:e.fbimages.toJSON()})):(this.fbimages=new f,this.fbimages.fetch(),$.when(this.fbimages.request).done(function(){debug.log("this.fbimages are as follows"),debug.log(e.fbimages.toJSON()),this.fbImageListView=new l({collection:e.fbimages.toJSON()})}))},setupFBPictures:function(){var e=this;this.fbImageListView=new l({collection:this.fbimages});var t=this.addChildView(this.fbImageListView);this.childViews.fbImageListView=this.fbImageListView,this.callbacks.add(function(){t()}),this.fbImageListView.render(),this.$el.append(e.fbImageListView.el),$("#"+this.fbImageListView.id).dialog({width:"80%",close:e.removeListView})},removeListView:function(){this.childViews.fbImageListView.removeCropView()},initUploadImage:function(){alert("Upload Image")},changeField:function(e){e.preventDefault(),$parent=this.$(e.target).parent(),id=$parent.attr("data-name"),value=$parent.attr("data-value"),$parent.html('<input type="text" id="'+id+'" name="'+id+'" value="'+value+'"/>')},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=this.model.get("payload");$.each(t,function(e,t){n[t.name]=t.value});if(n["password"]==""||n["password-again"]==""){alert("Please input a password");return}if(n["password"]!=n["password-again"]){alert("Please input a password correctly");return}if(n["agree"]==null){alert("Please agree to the Terms of Service");return}this.model.attributes.id=!1,this.model.set({payload:n,id:1}),this.model.url=function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+n.users_id},this.model.save({callback:"true"},{success:function(e){location.href="#usersettings",$("#RegModal").modal("hide")}})}}),r}),define("text!registration/templates/register_email.html",[],function(){return'\r\n<h1>The Basics</h1>\r\n<div class="row-fluid">\r\n    <form class="form-horizontal">\r\n        <div class="control-group">\r\n            <label class="control-label" for="first_name">First Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="firstname" id="first_name" placeholder="First Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="last_name">Last Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="lastname" id="last_name" placeholder="Last Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="dob">DOB: </label>\r\n            <div class="controls">\r\n                <input type="text" name="dob" id="dob" placeholder="Birthday">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="email">Email: </label>\r\n            <div class="controls">\r\n                <input type="text" name="email" id="email" placeholder="Email">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label">Gender: </label>\r\n            <div class="controls" id="gender">\r\n                <label for="male"><input type="radio" id="male" name="gender" value="M"> Male</label>\r\n                <label for="female"><input type="radio" id="female" name="gender" value="F"> Female</label>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="password">Password: </label>\r\n            <div class="controls">\r\n                <input type="password" id="password" name="password" placeholder="Password"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="re_password">Again: </label>\r\n            <div class="controls">\r\n                <input type="password" id="re_password" name="re_password" placeholder="Password Again"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <p class="agree-error text-error"></p>\r\n            <label for="accept_terms">\r\n                <input type="checkbox" id="accept_terms" name="accept_terms"/>I have read and agree to the <a href="#">Terms of Service</a>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </label>            \r\n            <a href="#" class="next">What\'s Next</a>\r\n        </div>\r\n    </form>\r\n</div>'}),define("registration/views/register_email",["require","text!registration/templates/register_email.html","facade","views","utils","jquery.pstrength","models/base"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView,a=e("models/base");return n=u.extend({id:"main-content",events:{keypress:"stopSubmit","click .next":"nextStep"},template:t,initialize:function(e){if(!this.model)throw new Error("RegistrationEmailView expected options.model.");u.prototype.initialize.call(this,e)},render:function(e,t,n){u.prototype.render.call(this,e,t,n),this.$("#password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n={};$.each(t,function(e,t){n[t.name]=t.value});var r=new a(n);r.url=function(){return"/api/user/register"},r.saveSuccess=function(e,t){a.prototype.saveSuccess.call(this,e,t);var n=t.exec_data,r=t.payload;n.exec_error||o("registration-select-org").publish(r)},r.save()}}),n}),define("text!registration/templates/upload_image.html",[],function(){return'\r\nUpload Image\r\n\r\n<a href="#" class="next">What\'s Next</a>'}),define("registration/views/upload_image",["require","text!registration/templates/upload_image.html","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView;return n=u.extend({id:"main-content",events:{"click .next":"nextStep"},template:t,initialize:function(e){u.prototype.initialize.call(this,e)},nextStep:function(e){e.preventDefault(),o("registration-select-org").publish()}}),n}),define("text!registration/templates/select_org.html",[],function(){return'\r\n<h1>Athletic Organizations</h1>\r\n<div class="step-club">\r\n<div>Link Up With Your Teams</div>\r\n<a href="#" class="find_club">\r\n    <h3>Find My Club</h3>\r\n    <p>Use our club locator to find your sports club and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{#show_highschool}}\r\n<div class="step-highschool" style="display:none;">\r\n<div class="text-error">Only display high school chooser if age <= 18</div>\r\n<a href="#" class="high_school">\r\n    <h3>High School Locator</h3>\r\n    <p>If you play for your high school, click here to find your school and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{/show_highschool}}\r\n<div class="step-sport" style="display:none;">\r\n<a href="#" class="indiv_sports">\r\n    <h3>Individual Sports</h3>\r\n    <p>If you are an athlete who competes without a team, this is where you\'ll find your sport.</p>\r\n</a>\r\n</div>\r\n<div class="step-next" style="display:none;">\r\n<a href="#" class="next">What\'s Next</a>\r\n</div>\r\n'}),define("registration/models/my_club",["models/base"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/myclub":"/api/user/basics/"+this.id}}),t}),define("text!registration/templates/find_my_club.html",[],function(){return'\r\n<h2>Find My Sports Club</h2>\r\n<form id="findClubFrm" class="form-horizontal">\r\n    <div class="control-group">\r\n        <label class="control-label" for="states_id">What State?</label>\r\n        <div class="controls">\r\n            <input id="states_id" name="state_name" placeholder="Just Start Typing" value="{{state}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="sports_id">What Sport?</label>\r\n        <div class="controls">\r\n            <input id="sports_id" name="sport_name" placeholder="Just Start Typing" value="{{sport}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="orgs_id">Club Name</label>\r\n        <div class="controls">\r\n            <input id="orgs_id" name="org_name" placeholder="Just Start Typing" value="{{club}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="complevels"></div>\r\n    <div class="seasons"></div>\r\n    <a href="#" class="back">Go Back</a>    \r\n    <a href="#" class="not_find">Can\'t Find Your Club?</a>\r\n    <a href="#" class="continue">Continue</a>\r\n</form>\r\n'}),define("location/models/state",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{location_id:0,location_name:null,location_country:null},desc:"State Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("location/collections/states",["facade","collections","location/models/state","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){return testpath?testpath+"/state_search":this.state_name==undefined?"/api/state/search":"/api/state/search/?state_name="+this.state_name},fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("registration/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports",["facade","collections","sportorg/models/sport","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){return testpath?testpath+"/sport_search":(this.state_name==undefined,"/api/sport/search/?sport_name="+this.sport_name+"&gender="+this.gender)},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){}}),i}),define("registration/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/club",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/clubs",["facade","collections","sportorg/models/club","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){var e=this;return testpath?testpath+"/club_search":(e.states_id==undefined||e.sports_id==undefined||e.club_name==undefined,"/api/org/search/?sports_club=1&states_id="+e.states_id+"&sports_id="+e.sports_id+"&org_name="+e.club_name)},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var r in n){var i=new SportorgSportModel;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t)}}),i}),define("registration/collections/clubs",["facade","collections","sportorg/collections/clubs","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("registration/views/find_my_club",["require","text!registration/templates/find_my_club.html","facade","views","utils","models/base","jqueryui","registration/collections/states","registration/collections/sports","registration/collections/clubs"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=e("models/base");return BaseView=i.BaseView,_=r._,$=r.$,Channel=s.lib.Channel,RegistrationStatesCollection=e("registration/collections/states"),RegistrationSportsCollection=e("registration/collections/sports"),RegistrationClubsCollection=e("registration/collections/clubs"),n=BaseView.extend({id:"find-my-club",tagName:"div",className:"find-my-club",template:t,events:{"click .back":"closeView","click .not-find":"notFind","click .continue":"highSchoolView","keyup #states_id":"keyupState","keyup #sports_id":"keyupSport","keyup #orgs_id":"keyupClub","blur #states_id":"changeState","blur #sports_id":"changeSport","change #orgs_id":"changeClub"},states:[],states_id:"",sports:[],sports_id:"",clubs:[],clubs_id:"",setOptions:function(e){if(!this.model)throw new Error("RegistrationFindMyClubView expected options.model.")},initialize:function(e){BaseView.prototype.initialize.call(this,e)},render:function(){var e=this;BaseView.prototype.render.call(this)},closeView:function(e){e.preventDefault(),Channel("registration-close-clubview").publish()},notFind:function(e){e.preventDefault()},highSchoolView:function(e){e.preventDefault()},keyUp:function(e){switch(this.$(e.target).attr("id")){case"state":this.keyupState(e);break;case"sport":this.keyupSport(e);break;case"club":this.keyupClub(e)}},keyupState:function(e){var t=this,n=this.$("#states_id").val(),r=[];if(n!=""){var i=new RegistrationStatesCollection;i.state_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();(e==null||e.length<1)&&t.$("#states_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.states=[];for(var n in e)t.states.push(e[n].payload);debug.log("self.states",t.states),t.states.forEach(function(e,t){r.push(e.name)}),debug.log("stateArr",r),t.$("#states_id").autocomplete({source:r})})}},changeState:function(e){var t=this.$("#states_id").val(),n=this;n.states_id="",n.states.forEach(function(e,r){e["name"]==t&&(n.states_id=e.id)}),this.keyupClub()},keyupSport:function(e){var t=this,n=t.model,r="all";n.get("payload").gender&&(r=n.get("payload").gender);var i=this.$("#sports_id").val(),s=[];if(i!=""){var o=new RegistrationSportsCollection;o.sport_name=i,o.gender=r,$(e.target).addClass("ui-autocomplete-loading"),o.fetch(),$.when(o.request).done(function(){if(o.isError())return;var e=o.toJSON();console.log("Sports Model",e),(e==null||e.length<1)&&t.$("#sports_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.sports=[];for(var n in e)t.sports.push(e[n].payload);console.log("sports",t.sports),t.sports.forEach(function(e,t){s.push(e.sport_name)}),console.log("sportArr",s),t.$("#sports_id").autocomplete({source:s})})}},changeSport:function(e){var t=this.$("#sports_id").val(),n=this;n.sports_id="",n.sports.forEach(function(e,r){e["sport_name"]==t&&(n.sports_id=e.sport_id)}),this.keyupClub()},keyupClub:function(e){var t=this,n=this.$("#orgs_id").val(),r=[];if(n!=""){var i=new RegistrationClubsCollection;console.log(t.states_id,t.sports_id,n),i.states_id=t.states_id,i.sports_id=t.sports_id,i.club_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();console.log("models",e),(e==null||e.length<1)&&t.$("#orgs_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.clubs=[];for(var n in e)t.clubs.push(e[n].payload);t.clubs.forEach(function(e,t){r.push(e.org_name)}),console.log("clubArr",r),t.$("#orgs_id").autocomplete({source:r})})}},changeClub:function(e){var t=this.$("#orgs_id").val(),n=this;n.clubs_id=0,n.clubs.forEach(function(e,r){e["name"]==t&&(n.clubs_id=e.id)})}}),n}),define("registration/views/select_org",["require","text!registration/templates/select_org.html","facade","views","utils","registration/models/my_club","registration/views/find_my_club"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=r.$,u=s.lib.Channel,a=i.SectionView,f=e("registration/models/my_club"),l=e("registration/views/find_my_club");return n=a.extend({id:"main-content",step:1,events:{"click .find_club":"findMyClub","click .high_school":"highSchoolLocator","click .indiv_sports":"individualSports","click .next":"nextStep"},template:t,initialize:function(e){a.prototype.initialize.call(this,e)},childViews:[],findMyClub:function(e){e.preventDefault();if(this.step!=1)return;var t=this;this.myclub?(this.myclub.fetch(),this.findMyClubView.render(),o("#"+this.findMyClubView.id).dialog({width:"80%",close:t.removeMyClubView})):(this.myclub=new f,this.myclub.id=t.model.get("payload").id,this.myclub.fetch(),o.when(this.myclub.request).done(function(){t.setupFindMyClub()}))},setupFindMyClub:function(){function n(){o("#"+e.findMyClubView.id).dialog("close")}var e=this;this.findMyClubView=new l({model:this.myclub});var t=this.addChildView(this.findMyClubView);this.childViews.findMyClubView=this.findMyClubView,this.callbacks.add(function(){t()}),this.findMyClubView.render(),this.$el.append(e.findMyClubView.el),o("#"+e.findMyClubView.id).dialog({width:"80%",close:e.removeMyClubView}),u("registration-close-clubview").subscribe(n)},removeMyClubView:function(){},highSchoolLocator:function(e){e.preventDefault();if(this.step!=2)return},individualSports:function(e){e.preventDefault();if(this.step!=3)return},nextStep:function(e){e.preventDefault();if(this.step!=4)return}}),n}),define("signup/views/shopopup",["require","backbone","underscore","registration","views","facade","utils"],function(e,t,n,r){var i,s=t.View;return i=s.extend({initialize:function(e){$("#errormsg, #preview").html(""),$("#RegModal").modal("show"),console.log($("#RegModal .modal-body")),$("#RegModal").on("hide",function(){$("div#modalPopup").remove()})}}),i}),define("registration",["require","text!signup/templates/layout.html","text!registration/templates/layout.html","facade","controller","models","views","utils","registration/models/select_type","registration/models/register_facebook","registration/models/register_email","registration/models/upload_image","registration/models/select_org","registration/views/select_type","registration/views/register_facebook","registration/views/register_email","registration/views/upload_image","registration/views/select_org","signup/views/shopopup"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("registration/models/select_type"),f=e("registration/models/register_facebook"),l=e("registration/models/register_email"),c=e("registration/models/upload_image"),h=e("registration/models/select_org"),p=e("registration/views/select_type"),d=e("registration/views/register_facebook"),v=e("registration/views/register_email"),m=e("registration/views/upload_image"),g=e("registration/views/select_org"),y=e("signup/views/shopopup"),b=o.LayoutView,w=r.$,E=r._,S=u.debug,x=u.lib.Channel,T=["/pages/registration/registration.css","/pages/signup/css/signupstyle.css","/css/style.jrac.css"];return n=i.extend({initialize:function(e){return x("load:css").publish(T),E.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){ga("send","event","Signup","Header","Loading reg header"),this.setupLayout().render(),this.refreshPage(),this.createData(),this.handleDeferreds()},createData:function(){this.select_type=new a},handleDeferreds:function(){function t(){e.initRegisterFacebook()}function n(){e.initRegisterEmail()}function r(){e.uploadImage()}function i(t){e.selectOrg(t)}var e=this;routing.off("registration-with-facebook"),routing.on("registration-with-facebook",function(){e.initRegisterFacebook()}),x("registration-select-org").subscribe(i)},refreshPage:function(){var e;this.selectTypeView&&(w(this.selectTypeView.destination).html(""),e=w.inArray(this.selectTypeView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerFacebookView&&(w(this.registerFacebookView.destination).html(""),e=w.inArray(this.registerFacebookView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerEmailView&&(w(this.registerEmailView.destination).html(""),e=w.inArray(this.registerEmailView,this.scheme),~e&&this.scheme.splice(e,1)),this.selectOrgView&&(w(this.selectOrgView.destination).html(""),e=w.inArray(this.selectOrgView,this.scheme),~e&&this.scheme.splice(e,1))},setupSelectTypeView:function(){this.selectTypeView=new p({model:this.select_type,name:"Select Registration Type",destination:"#main-content"}),this.scheme.push(this.selectTypeView),this.layout.render()},initRegisterFacebook:function(){var e=this;this.refreshPage(),this.register_facebook=new f,this.register_facebook.bind("request",e.handleProgress,this),this.register_facebook.fetch(),w.when(this.register_facebook.request).done(function(t){console.log(t.payload.identity_exists,"payload"),t.payload.identity_exists==1?routing.trigger("reload-home"):(this.pop=new y,e.setupRegisterFacebookView())}).fail(function(t){this.pop=new y,e.setupRegisterFacebookView()})},handleProgress:function(e){},setupRegisterFacebookView:function(){this.registerFacebookView=new d({model:this.register_facebook,name:"Registration with Facebook",destination:"#main-contentreg"}),this.scheme.push(this.registerFacebookView),this.layout.render()},initRegisterEmail:function(){var e=this;this.refreshPage(),this.register_email=new l,e.setupRegisterEmailView()},setupRegisterEmailView:function(){this.registerEmailView=new v({model:this.register_email,name:"Registration with Email Address",destination:"#main-content"}),this.scheme.push(this.registerEmailView),this.layout.render()},uploadImage:function(){var e=this;this.refreshPage(),this.upload_image=new c,this.setupUploadImageView()},setupUploadImageView:function(){this.uploadImageView=new m({model:this.upload_image,name:"Registration Upload Image",destination:"#main-content"}),this.scheme.push(this.uploadImageView),this.layout.render()},selectOrg:function(e){var t=this;this.refreshPage(),this.select_org=new h,this.select_org.id=e.id,this.select_org.fetch(),w.when(this.select_org.request).done(function(){t.setupSelectOrgView()})},setupSelectOrgView:function(){this.selectOrgView=new g({model:this.select_org,name:"Registration Select Org",destination:"#main-content"}),this.scheme.push(this.selectOrgView),this.layout.render()},setupLayout:function(){return this.scheme=[],w("#regModelPopup").length||w("body").append('<div id="regModelPopup"></div>'),pageLayout=new b({scheme:this.scheme,destination:"#setupLayout",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout}}),n}),define("text!login/templates/layout.html",[],function(){return'<style type="text/css">\r\n	#logincontainer{\r\n		padding-left: 15px;\r\n		font-weight: bold;\r\n	}\r\n</style>\r\n<!--div id="Loginview" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n	<div id="">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n			<h3 id="label">Login</h3>\r\n		</div>\r\n		<div id="main-content-reg"></div>\r\n	</div>	\r\n</div-->\r\n'}),define("login/models/Loginmodel",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"api/user/login?time="+(new Date).getTime(),payload:{}}),t}),define("text!login/templates/logintemplate.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n<div id="regcontainer">\r\n	<div id="loginmain">\r\n		<div id="mainreg">\r\n			<div id="fbpane">\r\n				<div id="label">\r\n					Login with facebook\r\n				</div>\r\n				<div id="fblogo"><span></span></div>\r\n			</div>\r\n			<div class ="regor">\r\n				or\r\n			</div>\r\n			<div id="regpanemain">	\r\n				<form action="/user/login" method="post" accept-charset="utf-8">\r\n					<div id="firstregbase">\r\n						<!--<div class="loginbase">\r\n							<!--<label for="username">Email</label>-->\r\n							<input type="text" name="username" placeholder="Email Address" />\r\n							<!--<label for="password">Password</label>-->\r\n							<input type="password" name="password" placeholder="Password" />\r\n							<div class="loguser">\r\n								<input type="checkbox" name="remember" />\r\n								<label for="remember">Remember Me</label>\r\n								\r\n								<p>(Remember Me keeps you logged in for 2 weeks)</p>\r\n							</div>	\r\n						<!--</div>-->	\r\n						<div class="errormsg"></div>\r\n						\r\n						<button type="button" class=" loginUser btn btn-primary">Login</button>\r\n						<div class="addsub">\r\n							<button type="button"  class="forgot-password-h btn btn-info btn-sm btn-custom" >Forgot My Password</button>\r\n							\r\n							<button type="button"  id= "signup" class=" btn btn-info btn-sm btn-custom" >create a new account</button>\r\n							\r\n						</div>				\r\n					</div>\r\n					\r\n					\r\n				</form>\r\n				\r\n			</div>\r\n			\r\n	\r\n		</div>\r\n\r\n	</div>\r\n	\r\n</div>\r\n\r\n<div class="forgot-password-container hide">\r\n	<div class="success-message hide">Password Reset link has been sent to your email address. Please check.</div>\r\n	<div class="error-message hide">Sorry we couldn\'t find the match record. Please try again with valid Email.</div>	\r\n	<form action="" method="POST" class="forgot-password-form-h">\r\n		<!--<label for="">Email</label>-->\r\n		<div id="firstregbase">\r\n			<input type="email" name="forgot_password_email" class="forgot-password-email-h" placeholder="Email Address" />\r\n			<button type="submit" name="forgot-password-btn" class="forgot-pasword-btn-h btn btn-default addsub" > Request Password </button>\r\n			<button type="button" class="log-in-link-h btn btn-default btn-sm addsub" >&nbsp;Log In &nbsp;</button>\r\n		</div>\r\n		<!--<br/>\r\n		<input type="submit" name="forgot-password-btn" class="forgot-pasword-btn-h btn btn-default" value="Request Password" />\r\n		<br/><br/>!-->\r\n		<!--<p><a class="log-in-link-h" href="javascript: void(0);"> Log In</a></p>-->\r\n	</form>\r\n</div>'}),define("signup/models/registerbasic",["models/base"],function(e){var t;return t=e.extend({defaults:{},validate:function(e,t){if(e.priority<0)return"Priority cannot be negative."},validation:{email:{required:!0,pattern:"email",msg:"Please enter a valid email"}}}),t}),define("signup/models/registration-basics-final",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"api/user/register"}),t}),define("text!signup/templates/registration.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n<style>\r\n\r\n</style>\r\n<div id="regcontainer">\r\n	<div id="mainreg">\r\n		<div id="header">\r\n			<span class="regheader"> Show us what you got</span>\r\n		</div>\r\n\r\n		<div id="fbpane">\r\n			<div id="label">\r\n				Register with facebook\r\n			</div>\r\n			<div id="fblogo"><span></span></div>\r\n		</div>\r\n		<div class ="regor">\r\n			or\r\n		</div>\r\n		<div id="regpanemain">\r\n			<form action="#/user/create" method="post" class="signupform" accept-charset="utf-8">\r\n				<div id="firstregbase">\r\n					<input type="text" name="firstname" placeholder="First name" />\r\n					<div class="error">\r\n					</div>\r\n					<input type="text" name="lastname" placeholder="Last name" />\r\n					<input type="text" name="email" placeholder="Email" />\r\n					<div class="error">\r\n					</div>\r\n				</div>\r\n				<div class = "signupsubmit">\r\n					<input type="submit" name="create" value="Sign Up" class="regsubmit" />\r\n				</div>\r\n			</form>\r\n			<%  if(!onlyRegister) { %>\r\n\r\n				<div id="reglogin">\r\n				<span>Been here before <a href="javascript:void(0);">sign in</a></span>\r\n				</div>\r\n\r\n			<% } %>\r\n			\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("signup/views/facebooksignup",["vendor","views","registration","signup","signup/views/shopopup","utils/storage"],function(e,t,n,r,i,s){var o,u=t.BaseView,a=e.$,f=e._,l=e.Mustache;return o=u.extend({signupFacebook:function(){var e=this;this.registrationController||(this.registrationController=new n);var t=f.bind(e.getFBlogin,this);this.Fbinit(t),this.loadFBLogin()},Fbinit:function(e){var t=this;window.fbAsyncInit=function(){console.log("facebook"),FB.init({appId:"219148511595084",status:!0,cookie:!0,xfbml:!0,oauth:!0}),e()}},loadFBLogin:function(){this.registrationController.refreshPage();var e,t="facebook-jssdk",n=document.getElementsByTagName("script")[0];document.getElementById(t)&&(this.loginInfo=this.loginfb(),this.return),e=document.createElement("script"),e.id=t,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(e,n)},getFBlogin:function(){var e=this;FB.getLoginStatus(function(t){t.status==="connected"?FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")}):t.status==="not_authorized"?(console.log("not_authorized"),e.loginInfo||(e.loginInfo=e.loginfb())):e.loginInfo||(e.loginInfo=e.loginfb())},{scope:"email, user_birthday, user_photos"})},loginfb:function(){FB.login(function(e){e.authResponse?routing.trigger("registration-with-facebook"):alert("Cancelled ")},{scope:"email, user_birthday, user_photos"})},checkFBlogin:function(){FB.getLoginStatus(function(e){e.status==="connected"&&FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")})},{scope:"email, user_birthday, user_photos"})}}),o}),define("text!signup/templates/basciFinal.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n\r\n\r\n<div id="regcontainer">\r\n	<div id="mainregfinal">\r\n		<div id="regpanefinal">\r\n			<form action="#/user/create" method="post" accept-charset="utf-8">\r\n				<div id="finalreg">\r\n					<div class="firstdiv" id="firstname">\r\n						<div class="label">\r\n							<label for="Name">Name</label>\r\n						</div>\r\n						<input type="text" id="first_name" name="Name" placeholder="Name" />\r\n						<a id="editname" class="hide">edit</a>\r\n					</div>\r\n					<div class="seconddiv" id="dob">\r\n						<div class="label">\r\n							<label for="born">Born</label>\r\n						</div>	\r\n						\r\n					</div>\r\n					<div class="thirddiv" id="email">\r\n						<div class="label">\r\n							<label for="Email">Email</label>\r\n						</div>	\r\n						<input type="text" name="email" id="emailInput" placeholder="Email" />\r\n					</div>\r\n					<div class="fourthdiv">\r\n\r\n						<div class="label">\r\n							<label for="Gender">Gender</label>\r\n						</div>\r\n						<div class="Gender" id="Gender">\r\n\r\n							<div class="radioinput" id="radioinput1"><input type="radio" id="male" name="gender" value="M"></div>\r\n							<div class="radio"><label for="male">Male</label></div>\r\n							<div class="radioinput" id="radioinput2"><input type="radio" id="Female" name="gender" value="F"></div>\r\n							<div class="radio"><label for="Female">Female</label></div>\r\n						</div>\r\n						\r\n					</div>\r\n					<div class="fifthdiv">\r\n						<div class="label">\r\n							<label>I am</label>\r\n						</div>\r\n						<div class="Role" id="Role">\r\n							<div class="radioinput"><input type="radio" id="athlete" name="role" value="A" /></div>\r\n							<div class="radio"><label for="athlete">An Athlete</label></div>\r\n							<div class="radioinput"><input type="radio" id="Fan" name="role" value="F"></div>\r\n							<div class="radio"><label for="Fan">A Fan</label></div>\r\n						</div>\r\n					\r\n					</div>\r\n					<div class="sixthdiv">\r\n						<div class="label">\r\n							<label for="Password">Password</label>\r\n						</div>	\r\n						<input type="password" name="password" id="password" placeholder="Password" />\r\n					</div>\r\n					<div class="seventhdiv">\r\n						<div class="label">\r\n							<label for="CPassword">Confirm</label>\r\n						</div>	\r\n						<input type="password" name="re_password" id="re_password" placeholder="Password" />\r\n					</div>\r\n					\r\n					<div>\r\n						<input type="checkbox" name="re_terms_conditions" class="terms-condition terms-condition-h" />\r\n						I Accept<a href="tos.html" target="_blank">Terms and Conditions</a>\r\n					</div>\r\n					\r\n					</div>\r\n					<div id="submitbutton">\r\n						<input type="submit" name="create" value="Sign Up" class="regsubmitfinal" />\r\n					</div>	\r\n				</form>\r\n				\r\n			<%  if(!page) { %>	<br /><br/>\r\n				<div id="reglogin">\r\n					<span>Been here before <a href="#">sign in</a></span>\r\n				</div>\r\n			<% } %>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("signup/views/registration-basics-final",["require","text!signup/templates/basciFinal.html","backbone","underscore","views","facade","utils"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.template=r.template(t,{page:e.openAsPopUp?!0:!1}),e.destination&&(this.$el=$(e.destination)),e.openAsPopUp&&(this.openAsPopUp=e.openAsPopUp),this.render()},render:function(){this.$el.html(this.template),this.registrationElements(),this.payload=this.finalRegistrationPayload(this.options.attr),this.fetchpayload(this.payload)},events:{"click .regsubmitfinal":"next","click #editname":"editName"},editName:function(e){e.preventDefault(),$(".firstdiv").empty();var t=this.getnameElement("first_name","First Name","firstname"),n=this.getnameElement("last_name","Last Name","lastname"),r=this.getLabel("First Name"),i=this.getLabel("Second Name");$(".firstdiv").append(r),$(".firstdiv").append(t),$(".firstdiv").append(i),$(".firstdiv").append(n)},getLabel:function(e){var t=$("<div/>").attr({"class":"label"}),n=$("<lable/>").attr({For:e}).html(e);return t.append(n),t},getnameElement:function(e,t,n){var r=$("<input/>").attr({name:n,type:"text",id:e,placeholder:t});return r},finalRegistrationPayload:function(e){payload={};var t=e.attr;return $.each(t,function(e,t){payload[t.name]=t.value}),payload},registrationElements:function(){var e={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31"},n={1945:"1945",1946:"1946",1947:"1947",1948:"1948",1949:"1949",1950:"1950",1951:"1951",1952:"1952",1953:"1953",1954:"1954",1955:"1955",1956:"1956",1957:"1957",1958:"1958",1959:"1959",1960:"1960",1961:"1961",1962:"1962",1963:"1963",1964:"1964",1965:"1965",1966:"1966",1967:"1967",1968:"1968",1969:"1969",1970:"1970",1971:"1971",1972:"1972",1973:"1973",1974:"1974",1975:"1975",1976:"1976",1977:"1977",1978:"1978",1979:"1979",1980:"1980",1981:"1981",1982:"1982",1983:"1983",1984:"1984",1985:"1985",1986:"1986",1987:"1987",1988:"1988",1989:"1989",1990:"1990",1991:"1991",1992:"1992",1993:"1993",1994:"1994",1995:"1995",1996:"1996",1997:"1997",1998:"1998",1999:"1999",2e3:"2000",2001:"2001",2002:"2002",2003:"2003",2004:"2004",2005:"2005",2006:"2006",2007:"2007",2008:"2008",2009:"2009",2010:"2010",2011:"2011",2012:"2012",2013:"2013",2014:"2014",2015:"2015",2016:"2016",2017:"2017",2018:"2018"},r=this.option(e,"born","06");this.$el.find(".seconddiv").append(r);var i=this.option(t,"borndate","15");this.$el.find(".seconddiv").append(i);var s=this.option(n,"borndyear","1985");this.$el.find(".seconddiv").append(s)},option:function(e,t,n){var r='<select class="'+t+'">';return $.each(e,function(e,t){var i="";if(e==n)var i="selected='selected'";r+='<option value="'+e+'" '+i+">"+t+"</option>"}),r+="</select>",r},fetchpayload:function(e){this.$el.find("#first_name").val(e.firstname+" "+e.lastname),this.$el.find("#emailInput").val(e.email)},next:function(e){e.preventDefault();var t=$(".terms-condition-h").is(":checked");if(!t){alert("Please select terms and condition.");return}var n=this;console.log(this.payload);var r=this.$(":input").serializeArray();$.each(r,function(e,t){payload[t.name]=t.value}),console.log(payload,"new payload"),this.payload.gender=$("input:radio[name=gender]").val(),this.payload.password=$("#password").val(),this.payload.re_password=$("#re_password").val(),this.payload.dob=$(".borndate").val()+"-"+$(".born").val()+"-"+$(".borndyear").val(),this.payload.accept_terms=t,this.model.save(this.payload,{success:function(e){location.href="#usersettings",$("#RegModal").modal("hide")},error:function(e){$(".errormsg").remove();var t=jQuery.parseJSON(e.request.responseText);errorArray=t.exec_data.error_array,$.each(errorArray,function(e,t){n.displayErrors(t)})}})},displayErrors:function(e){var t=$("#"+e.field),n=t.width();if(n){console.log(t.position(),"fieldName",n,"elemet width");var r=this.displayMesage(t.position(),e.error,n);$("#finalreg").append(r)}},displayMesage:function(e,t,n){console.log(n,"widthele");var r=e.left+15;r+=n,console.log(r,"posleft");var i=$("<div/>").attr({name:"error message","class":"errormsg"}).css({width:"100%","margin-top":"10px",color:"#CE0009"}).html(t);return i}}),i}),define("signup/views/registerbasic",["require","text!signup/templates/registration.html","backbone","underscore","registration","login","views","signup/views/facebooksignup","facade","utils","signup/views/registration-basics-final","signup/models/registration-basics-final"],function(e,t,n,r,i,s){var o,u=e("facade"),a=e("views"),f=e("signup/views/facebooksignup"),l=e("utils"),c=l.lib.Channel,h=e("signup/views/registration-basics-final"),p=e("signup/models/registration-basics-final"),d=n.View;return o=d.extend({initialize:function(e){e.openAsaPage&&(this.openAsaPage=e.openAsaPage),this.registrationController=new i({route:""}),this.template=r.template(t,{onlyRegister:this.openAsaPage?!0:!1}),this.$el=$(e.destination),console.log("REG BLOCK:",this.$el),$("#errormsg, #preview").html(""),d.prototype.initialize.call(this,e),debug.log("Image upload basic view"),!this.openAsaPage,this.render()},render:function(){this.$el.html(this.template)},events:{"click .regsubmit":"next","click #fbpane":"signupFacebook","click #reglogin a":"showLogin"},next:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=!0;$.each(t,function(e,t){if(!t.value)return alert(t.name+" is blank"),n=!1,!1});try{if(this.openAsaPage&&n){this.basic_type=new p;var r={model:this.basic_type,name:"Final registration",attr:{attr:t},openAsPopUp:!0};this.selectRegisterBasicFinalView=new h(r);var r={};r.height="500px",r.width="500px",r.title="The Basics",r.html=this.selectRegisterBasicFinalView.$el,routing.trigger("common-popup-open",r)}else n&&routing.trigger("register-basic-final",t)}catch(i){}},signupFacebook:function(e){e.preventDefault(),$("#RegModal").modal("hide"),headView=new f,headView.signupFacebook()},showLogin:function(e){e.preventDefault(),$("#RegModal").modal("hide"),this.logincontroller=new LoginController,routing.trigger("Login")}}),o}),define("signup/models/image-upload",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"/api/user/savecrop/425983",payload:{}}),t}),define("text!signup/templates/imageupload.html",[],function(){return' <style type="text/css">\r\n\r\n </style>\r\n <div id="regcontainer">\r\n    <div id="mainregimg">\r\n      <div id="header">\r\n      <span class="regheader"> Upload a user pic</span>\r\n    </div>\r\n      <div id="imgcontainer" class="imgcontainer">\r\n       \r\n        <div class="textcenter pane" id="imgpreview" >\r\n          <img id="image-select" style="max-height: 245px; max-width: 320px;" />\r\n            <div class="coords" style="display:none;">\r\n                <div>crop x <input name="crop-x" type="hidden" /></div>\r\n                <div>crop y <input name="crop-y" type="hidden" /></div>\r\n                <div>crop width <input name="crop-width" type="hidden" /></div>\r\n                <div>crop height <input name="crop-height" type="hidden" /></div>\r\n                <div>image width <input name="image-width" type="hidden" /></div>\r\n                <div>image height <input name="image-height" type="hidden" /></div>            \r\n            </div>\r\n        </div>\r\n        <div id="imguploader" class="imguploader">\r\n          <input type="file" name= "preview" id="preview">\r\n        </div>\r\n        <div class="inputmask">\r\n          <div class="selectlabel">Select File</div>\r\n          <div class="showselected"></div>\r\n        </div>  \r\n         \r\n        <div id="imgupload"  class="imgupload">\r\n          <input type="submit" name="imgup" id="crpimgup" value="Crop and save" class="imgup" /> \r\n           <input type="submit" name="skip" id="skip" value="Skip" class="imgup" />   \r\n        </div>\r\n        \r\n      </div>\r\n    </div>  \r\n  </div>   '}),define("signup/views/image-upload",["require","text!signup/templates/imageupload.html","backbone","underscore","views","facade","utils","jquery.jrac"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),this.userinfo(this.options.attr)},events:{"change input":"preview","click #crpimgup":"imageupload","click #skip":"skip"},skip:function(e){e.preventDefault(),window.location.href="#usersettings"},userinfo:function(e){},preview:function(e){this.removeCropView();var t=window.URL||window.webkitURL;window.fileURL=t.createObjectURL(e.target.files[0]),this.srcimg=window.fileURL,$("#image-select").attr({src:window.fileURL}),this.initCropView()},initCropView:function(){$("#image-select").jrac({crop_width:200,crop_height:240,crop_aspect_ratio:"1:1",crop_x:0,crop_y:0,crop_resize:!1,viewport_resize:!1,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){$(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,$(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=$(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},imageupload:function(e){e.preventDefault(),this.getImageInfo()},removeCropView:function(){$("#image-select").jrac("destroy"),$("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=[],t=this.$(".coords :input").serializeArray();e.image_url=this.srcimg,$.each(t,function(t,n){e[n.name]=n.value}),console.log(e,"finalRegistrationPayload"),this.model.save(e,{success:function(e){a("upload-user-image").publish(e)},error:function(){}})}}),i}),define("signup",["require","text!signup/templates/layout.html","facade","controller","models","views","utils","signup/models/registerbasic","signup/models/registration-basics-final","signup/views/registerbasic","signup/views/registration-basics-final","signup/models/image-upload","signup/views/image-upload"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("signup/models/registerbasic"),f=e("signup/models/registration-basics-final"),l=e("signup/models/image-upload"),c=e("signup/views/registerbasic"),h=e("signup/views/registration-basics-final"),p=e("signup/views/image-upload"),d=o.LayoutView,v=r.$,m=r._,g=u.debug,y=u.lib.Channel,b=["/pages/signup/css/signupstyle.css","/css/style.jrac.css","/pages/imageup/imageup.css"];return n=i.extend({initialize:function(e){return y("load:css").publish(b),m.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){ga("send","event","Signup","Open","User opened registration box"),this.refreshPage(),this.setupLayout(),this.createData(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],pageLayout=new d({scheme:this.scheme,destination:"#modalBody",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.select_type=new a},refreshPage:function(){this.selectTypeView&&(v(this.selectTypeView.destination).html(""),position=v.inArray(this.selectTypeView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){v("#imgUploadModal").modal("show"),v("#imgUploadModal").on("hidden",function(){}),v("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){function t(t){e.initRegisterFinal({attr:t})}function n(t){e.uploadUserImage({attr:t})}var e=this;routing.off("register-basic"),routing.on("register-basic",function(){e.setupSelectTypeView()}),routing.off("register-basic-final"),routing.on("register-basic-final",function(e){t(e)}),routing.off("upload-user-image"),routing.on("upload-user-image",function(e){n(e)})},initRegisterFinal:function(e){this.basic_type=new f,this.selectRegisterBasicFinalView=new h({model:this.basic_type,name:"Final registration",destination:"#modalBody",attr:e}),this.layout.render()},uploadUserImage:function(e){this.basic_type=new l,this.selectRegisterBasicFinalView=new p({model:this.basic_type,name:"Final registration",destination:"#modalBody",attr:e}),this.layout.render();var t={};t.height="500px",t.width="90%",t.title="Register",routing.trigger("common-popup-open",t)},setupSelectTypeView:function(){this.selectTypeView=new c({model:this.select_type,name:"Select Registration Type",destination:"#modalBody"}),console.log(this.selectTypeView),this.scheme.push(this.selectTypeView),this.layout.render();var e={};e.height="500px",e.width="90%",e.title="Register",routing.trigger("common-popup-open",e)}}),n}),define("login/models/Forgotmodel",["models/base"],function(e){return e.extend({defaults:{},email:undefined,url:function(){return"api/user/pw_reset?email="+encodeURIComponent(this.email)},payload:{}})}),define("login/views/Loginview",["require","text!login/templates/logintemplate.html","backbone","underscore","signup","views","facade","utils","login/models/Forgotmodel","signup/views/facebooksignup"],function(e,t,n,r,i){var s,o=e("facade"),u=e("views"),a=e("utils"),f=a.lib.Channel,l=e("login/models/Forgotmodel"),c=e("signup/views/facebooksignup"),h=n.View;return SigninBasicView=h.extend({initialize:function(e){this.signcontroller=new i,this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),$("#errormsg, #preview").html(""),debug.log("Image upload basic view"),$("#Loginview").modal("show"),$("#Loginview").on("hide",function(){$("div#LoginPopup").empty()})},events:{"click button#signup":"signupUser","click .loginUser":"userLogin","click .forgot-password-h":"forgotPassword","submit .forgot-password-form-h":"forgotPasswordForm","click .log-in-link-h":"loginPageView","click #fbpane":"signupFacebook"},forgotPasswordForm:function(e){e.preventDefault();var t=this,n=new l;n.email=$(e.target).find(".forgot-password-email-h").val(),n.save({email:n.email}),$.when(n.request).done(function(){t.$el.find(".success-message").removeClass("hide"),setTimeout(function(){t.loginPageView()},3e3)}),$.when(n.request).fail(function(){t.$el.find(".error-message").removeClass("hide")})},signupFacebook:function(e){e.preventDefault(),$("#RegModal").modal("hide"),headView=new c,headView.signupFacebook()},userLogin:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=[];$.each(t,function(e,t){n[t.name]=t.value});var r=$.extend({},n);try{console.log(r,"new")}catch(i){console={},console.log=function(e){}}this.model.save(r,{success:function(e){location.href="#profile",$("#Loginview").modal("hide")},error:function(e){$(".errormsg").empty();var t=jQuery.parseJSON(e.request.responseText);$(".errormsg").html(t.exec_data.error_array[0].error)}})},forgotPassword:function(e){e.preventDefault(),this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Forgot Password"),$("#loginmain").addClass("hide"),$(".forgot-password-container").removeClass("hide")},loginPageView:function(){this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Login"),$("#loginmain").removeClass("hide"),$(".forgot-password-container").addClass("hide")},signupUser:function(e){e.preventDefault(),routing.trigger("register-basic")}}),SigninBasicView}),define("login/models/Logoutmodel",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"/api/user/logout?time="+(new Date).getTime(),payload:{}}),t}),define("login",["require","text!login/templates/layout.html","application","facade","controller","models","views","utils","login/models/Loginmodel","login/views/Loginview","login/models/Logoutmodel"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("login/models/Loginmodel"),l=e("login/views/Loginview"),c=e("login/models/Logoutmodel"),h=u.LayoutView,p=i.$,d=i._,v=a.debug,m=a.lib.Channel,g=["/pages/imageup/imageup.css"];return LoginController=s.extend({initialize:function(e){return m("load:css").publish(g),d.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.refreshPage(),this.setupLayout(),this.createData(),this.refreshPage(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],pageLayout=new h({scheme:this.scheme,destination:"#LoginPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.login_type=new f},refreshPage:function(){this.loginView&&(p(this.loginView.destination).html(""),position=p.inArray(this.loginView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){p("#imgUploadModal").modal("show"),p("#imgUploadModal").on("hidden",function(){}),p("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){var e=this;routing.off("Login"),routing.on("Login",function(){e.setupLoginView()}),routing.off("Logout"),routing.on("Logout",function(t){e.setupLogout(t)})},setupLogout:function(e){var t=this;this.logoutcheck=new c,this.logoutcheck.fetch(),p.when(this.logoutcheck.request).done(function(){e!=undefined&&e.clear(),window.localStorage.clear(),location.href="/"})},setupLoginView:function(){var e="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50),t="#"+e+" #modalBody",n={};n.height="500px",n.width="90%",n.title="Login",n.id=e,routing.trigger("common-popup-open",n),this.loginView=new l({model:this.login_type,name:"Login View",destination:t}),this.scheme.push(this.selectTypeView),this.layout.render()}}),LoginController}),define("chrome/views/header",["vendor","views","text!chrome/templates/header.html","chrome/models/header","registration","login","signup","signup/views/shopopup","utils/storage","signup/views/facebooksignup"],function(e,t,n,r,i,s,o,u,a){var f,l=require("signup/views/facebooksignup"),c=t.BaseView,h=e.$,p=e._,d=e.Mustache;return f=c.extend({tagName:"header",className:"container-fluid clearfix",initialize:function(e){this.template=n},model:new r,events:{"click .signup-facebook":"signupFacebook","click .signup-email":"signupUser","click .account clearfix a":"login","click #userlogin":"userLogin","click #logoutId":"LogoutUser"},render:function(){var e=this;return this.model.fetchSuccess=this.model.fetchError=function(t,n){var r=d.to_html(e.template,t.toJSON());e.$el.html(r);if(typeof t.get("user_photo")=="object"&&typeof t.get("user_photo").types=="object")if(typeof t.get("user_photo").types.small_thumb=="object")var i=t.get("user_photo").types.small_thumb.url;else if(typeof t.get("user_photo").types.large_thumb=="object")var i=t.get("user_photo").types.large_thumb.url;else if(typeof t.get("user_photo").types.original=="object")var i=t.get("user_photo").types.original.url;else var i="";e.$(".photo img").attr("src",i);var s=t.get("authorized");if(s){var o=t.get("id");e.model.saveCookie(),routing.userLoggedIn=!0,routing.loggedInUserId=o,routing.trigger("app-inited",o)}else routing.userLoggedIn=!1,routing.trigger("app-inited");h("#main").removeClass("region-loader")},this.model.fetch(),this},userLogin:function(e){e.preventDefault(),this.logincontroller=new LoginController,routing.trigger("Login")},signupFBTest:function(e){},signupFacebook:function(e){e.preventDefault(),headView=new l,headView.signupFacebook()},signupUser:function(){this.signupc=new o({route:""}),routing.trigger("register-basic"),this.pop=new u},LogoutUser:function(e){e.preventDefault(),this.logincontroller||(this.logincontroller=new LoginController),routing.trigger("Logout",this.model)}}),f}),define("text!chrome/templates/main.html",[],function(){return"\r\n\r\n"}),define("chrome/models/main",["models/base"],function(e){var t;return t=e.extend({defaults:{}}),t}),define("chrome/views/main",["vendor","views","text!chrome/templates/main.html","chrome/models/main"],function(e,t,n,r){var i,s=t.BaseView,o=e.$,u=e._,a=e.Mustache;return i=s.extend({id:"main",className:"clear clearfix",initialize:function(e){this.template=n},model:new r,render:function(){var e=a.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("text!chrome/templates/footer.html",[],function(){return"\r\n\r\n"}),define("chrome/models/footer",["models/base"],function(e){var t;return t=e.extend({defaults:{}}),t}),define("chrome/views/footer",["vendor","views","text!chrome/templates/footer.html","chrome/models/footer"],function(e,t,n,r){var i,s=t.BaseView,o=e.$,u=e._,a=e.Mustache;return i=s.extend({tagName:"footer",className:"container-fluid clearfix",initialize:function(e){this.template=n},model:new r,render:function(){var e=a.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("chrome",["chrome/views/header","chrome/views/main","chrome/views/footer"],function(e,t,n){var r;return r=function(){$("#main").unbind().empty().addClass("region-loader"),App.header?App.header.render():(App.header=new e,App.header.render().$el.prependTo("body"));if(!$("#main").length){var r=new t;r.render().$el.appendTo("body")}if(!$("footer.container-fluid").length){var i=new n;i.render().$el.appendTo("body")}!$(".common-modal").length},r}),define("text!imageup/templates/basic.html",[],function(){return'<!--<div id="url" class="url">URL\r\n	<select id="url_tag">\r\n		<option value="user">Users</option>\r\n		<option value="game">Games</option>\r\n		<option value="team">Teams</option>\r\n	</select>\r\n	<input type="text" name="id_tag" id="id_tag" placeholder="ID"/>\r\n</div>\r\n<a href="#imgUploadModal" role="button" class="btn" data-toggle="modal">Upload Image</a>\r\n--><div id="imgUploadModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n		<h3 id="label">Image Uploader</h3>\r\n	</div>\r\n\r\n	<div class="side-panel" id="left_upload">\r\n		\r\n	</div>\r\n\r\n	<div class="main-body">\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n<div class="clear"></div>\r\n</div>'}),define("text!imageup/templates/uploader.html",[],function(){return'<div id="main-content-img" class="imageholder">\r\n	<div id="imageholder" class="textcenter m_top_50 bigger">Drag & Drop Here</div>\r\n	<div class="textcenter m_top_50 bigger">OR</div>\r\n	<div align="center" class="m_top_50"><input type="file" id="image_file" class="files" name="image_file[]" multiple="">\r\n		<div class="clear"></div>\r\n		<div class="textcenter m_top_50 bigger">\r\n			<button class="btn fileuploader btn-primary" id="imageup" type="button">Upload and Finish</button>\r\n		</div>\r\n	</div>\r\n</div>\r\n<div id="main-content-tag-section" class="imageholder floatLeft m_top_2 displayNone">\r\n		<div id="image-tagging" class="displayNone">\r\n			\r\n		</div>\r\n		<div id="select-allup" class="tag_select_all">\r\n			\r\n		</div>	\r\n</div>'}),define("imageup/models/basic",["facade","media/models/image"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("imageup/models/imageupload",["facade","media/models/image"],function(e,t){var n,r=e._;return ImageUploadModel=t.extend({initialize:function(e,n){t.prototype.initialize.call(e,n)}}),n}),define("imageup/models/errorshow",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{msg:null,color:null}),initialize:function(e,t){}}),n}),define("imageup/collections/basics",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/"+this.id+"/images/":"/api/user/images/"}}),r}),define("imageup/models/preview",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({initialize:function(e,t){}}),n}),define("text!imageup/templates/select_all.html",[],function(){return'<div class="well-large div_select_all">\r\n	<div class="text-center m_top_20 bigger">SELECT IMAGES TO TAG A TEAM, PLAYER OR GAME</div>\r\n	<div class="clear"></div>\r\n	<div class="text-center m_top_20 bigger" >OR</div>\r\n	<div class="clear"></div>\r\n	<div class="text-center m_top_20 bigger"><a href="javascript:void(0)" id="btn_select_all_h">SELECT ALL</a></div>\r\n	<div class="clear"></div>\r\n</div>'}),define("text!usercontrols/tag/templates/layout.html",[],function(){return'<div class="well-large container_batch_tag">\r\n	<h4>Tagging</h4>\r\n	<div class="section-Add-Sports_h well-large">\r\n	<div class="m_bottom_10">\r\n		Select Sport:\r\n	</div>\r\n	<div class="row-fluid section_inner">\r\n		<span class="span-ddl-sports-tag_h dropdown"></span>\r\n		<div class="clear"></div>\r\n		<!-- <select class="ddl-tag-sports_h" style=></select> -->\r\n		<span class="displayNone field-message"></span> \r\n	<br/>\r\n	<button class="btn btn-primary btn-tag-sport_h displayNone">Done</button>\r\n	</div>\r\n	\r\n	</div>\r\n	<div class="div-tag-list_h section_outer">		\r\n	<div class="section-sports_h displayNone">\r\n		<label class="lbl-tag-sport-name_h bigger"></label>\r\n		<!-- <div class="clear"></div> -->\r\n		<span>\r\n			<a href="javascript:void(0)" class="btn-tag-edit-sport_h">Edit</a></span>\r\n	</div>\r\n	\r\n	<div class="section-team_h displayNone section_inner">\r\n		<strong>Teams :</strong> <br/>\r\n		<label class="lbl-tag-team-name_h"></label><span><button class="btn btn-tag-edit-team_h displayNone">Edit</button></span>\r\n	</div>\r\n\r\n	<div class="section-events_h displayNone section_inner">\r\n		<strong>Event:</strong> <br/>\r\n		<label class="lbl-tag-event-name_h"></label><span><button class="btn btn-tag-edit-event_h displayNone">Edit</button></span>\r\n	</div>\r\n	\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-team_h displayNone section_outer">\r\n		Tag a Team : \r\n		<br/>\r\n		<input type="text" class="txt-tag-team-state_h" placeholder="Enter State" />\r\n		<div class="clear"></div>\r\n		<input type="text" class="txt-tag-team-city_h displayNone" placeholder="Enter City" />\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-tag-team-school_h displayNone" placeholder="Enter Team" />\r\n	<!--	<select class="ddl-tag-team-level_h displayNone"></select>\r\n		<select class="ddl-tag-team-season_h displayNone"></select> -->\r\n	 	<div class="clear"></div>\r\n	 	<span class="displayNone field-message"></span> \r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-team-Done_h displayNone">Done</button>\r\n		\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-event_h displayNone section_outer">\r\n		Tag an Event:\r\n		<br/>\r\n		<input type="text" class="txt-tag-event-state_h" placeholder="Enter State" />\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-tag-event_h" disabled="disabled" placeholder="Enter The Event\'s Title" />\r\n		<div class="clear"></div>\r\n		<span class="displayNone field-message"></span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-event-Done_h displayNone">Done</button>\r\n\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-player_h displayNone section_outer">\r\n		Tag a Player : \r\n		<br/>\r\n		<div class="section-tag-player-input_h">\r\n		<input type="text" class="txt-tag-player-name_h" placeholder="Enter Name" />\r\n		</div>\r\n		<div class="clear"></div>\r\n		<span class="btn-tag-add-player_h strong">\r\n			+\r\n		</span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-player-Done_h">Done</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-team-players_h displayNone section_inner">\r\n		<strong>Players :</strong> \r\n<div class="clear"></div>\r\n		<label class="lbl-tag-players-name_h"></label>\r\n		<span class="displayNone"><button class="btn btn-tag-edit-players-team_h displayNone">Edit</button></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-game_h displayNone section_outer">\r\n		<strong>Tag a Game : </strong>\r\n		<div class="clear"></div>\r\n		<span class="span-ddl-games-tag_h  dropdown"></span>\r\n		<!-- <select class="ddl-tag-game_h"></select> -->\r\n		<div class="clear"></div>\r\n		<span class="displayNone field-message"></span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-game-Done_h displayNone">Done</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-team-games_h displayNone section_outer">\r\n		<strong>Games :</strong>\r\n		<div class="clear"></div>\r\n		<label class="lbl-tag-games-name_h"></label><span class="displayNone"><button class="btn btn-tag-edit-games-team_h displayNone">Edit</button></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-link_h displayNone section_outer">\r\n		Tag:\r\n		<a href="javascript:void(0)" class="link-tag-team_h">Team&nbsp;</a>\r\n		<a href="javascript:void(0)" class="link-tag-player_h displayNone">Player&nbsp;</a>\r\n		<a href="javascript:void(0)" class="link-tag-Game_h displayNone">Game&nbsp;</a>\r\n		<a href="javascript:void(0)" class="link-tag-event_h displayNone">Event&nbsp;</a>\r\n		<div class="clear"></div>\r\n		<span class="displayNone field-message"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<!-- <div class="section_outer">\r\n		<button class="btn btn-primary btn-tag-Finish_h displayNone">Finish</button>\r\n	</div> -->\r\n</div>'}),define("text!imageup/templates/error_template.html",[],function(){return'<div class="alert {{color}}" align="center">\r\n	<button type="button" class="close" data-dismiss="alert">&times;</button>\r\n	{{msg}}\r\n</div>'}),define("imageup/views/errors",["require","text!imageup/templates/error_template.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=e("vendor"),a=i.SectionView,f=r.$,l=r._,c=s.debug;return n=a.extend({id:"main-content",template:t,initialize:function(e){a.prototype.initialize.call(this,e),c.log("error view")}}),n}),define("usercontrols/tag/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports_listall",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return"/api/sport/listall/"},ParseForDropdown:function(){var e=this,t=e.toJSON();return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var n=t.payload,r="";n.male=="1"&&n.female=="1"?r="":n.male=="1"?r="Men's ":n.female=="1"&&(r="Women's "),t.payload.custom_name=r+n.sport_name,t.payload.team_type=n.sport_type?n.sport_type.name||"":""}}),t}}),i}),define("sportorg/models/org",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/orgs",["facade","collections","sportorg/models/org","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5);var o=r[i],u=o.teams,a=[];for(var f in u){var l=u[f];a.push(l)}o.teams=a,s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),i}),define("usercontrols/tag/collections/schools",["facade","utils","sportorg/collections/orgs","sportorg/models/org"],function(e,t,n,r){var i;return i=n.extend({url:function(){var e=this;return testpath?testpath+"/api/org/search/"+this.sport_id:"/api/org/search?states_id="+e.states_id+"&org_name="+e.org_name},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("sportorg/models/team",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,location:null,picture:null,sport:null,complevel:null,season:null,year:null,mascot:null,unique_ident:null,statvals:[{statval:null,statdate:null,statteam:null,stat_context:null}]},desc:"Team information",exec_data:{exec_time:0,exec_error:!1}}),url:function(){return"/api/team/basics/"+this.id},parseAsRequired:function(e){return e}}),n}),define("sportorg/collections/teams",["facade","collections","sportorg/models/team","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}console.log("Updtaed Collection",e),e.deferred.resolve(t)}}),i}),define("usercontrols/tag/collections/teams",["facade","collections","sportorg/collections/teams","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.team_name&&(e+="team_name="+this.team_name),this.team_name&&(e+="&searchtext="+this.team_name),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.sports_id&&(e+="&sports_id="+this.sports_id),"/api/team/search?"+e}}),i}),define("models/common",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("location/collections/cities",["facade","collections","models/common","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){if(this.city_name==undefined)return"/api/city/search";var e="?city_name="+this.city_name;return this.states_id&&(e+="&states_id="+this.states_id),"/api/city/search/"+e},fetchSuccess:function(e,t){e.reset();var n=t.payload;if(n!=null)for(i=0;i<(n.length>10?10:n.length);i++){var r={};r.city=n[i].name,r.county=n[i].county.name,r.state=n[i].county.state.name,r.id=n[i].id,e.push(r)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("user/models/common",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("user/collections/users",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,url:function(){var e="";return this.user_name&&(e+="searchtext="+this.user_name),this.sports_id&&(e+="&sports_id="+this.sports_id),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.team_id&&(e+="&team_id="+this.cities_id),"/api/user/search?"+e},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("sportorg/models/game",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,game_name:null,game_day:null,game_time:null,game_picture:null,teams:[{team_name:null,team_location:null,points_scored:0,points_against:0,is_winner:null}],game_location:null},desc:"Game information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/games",["facade","collections","sportorg/models/game","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},ParseForDropdown:function(){var e=this,t=e.toJSON();return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var n=t.payload;t.payload.custom_name=n.game_name}}),t}}),s}),define("usercontrols/tag/collections/games",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.sports_id&&(e+="sports_id="+this.sports_id+"&"),this.teams_id&&(e+="teams_id="+this.teams_id+"&"),this.states_id&&(e+="states_id="+this.states_id+"&"),this.cities_id&&(e+="cities_id="+this.cities_id+"&"),"/api/game/search/0?"+e}}),i}),define("sportorg/models/complevel",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,min_age:0,max_age:0},desc:"Complevel information",exec_data:{exec_time:0,exec_error:!1}}),fetchSuccess:function(e,t){}}),n}),define("usercontrols/tag/models/complevel",["facade","sportorg/models/complevel"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/org/basics/"+this.orgs_id+"?id1="+this.orgs_id)},fetchSuccess:function(e,t){}}),n}),define("text!usercontrol/dropdown/template/layout.html",[],function(){return'<div class="dropdown-container">\r\n	<input type="hidden" class="hidden-input-dropdown-h" value="" />\r\n	<div class="drop-down-outer">\r\n		<div class="region-dark dropdown-header-box">\r\n			{{dropView.title}}\r\n		</div>\r\n		<div class="down-arrow-outer">\r\n			<a href="javascript: void(0);" class="down-arrow up-down-arrow-h">\r\n				<span class="icon-white icon-chevron-down"></span>\r\n			</a>\r\n		</div>\r\n	</div>\r\n	<div class="common-container">\r\n		<ul class="common-dropdown">\r\n			{{#records}}\r\n			<li class="{{#dropView.defaultSelected}}{{dropView.defaultSelected}}{{/dropView.defaultSelected}}">\r\n				<a data-id="{{#dropView.getRecordId}}{{dropView.getRecordId}}{{/dropView.getRecordId}}" href="javascript: void(0);">{{#dropView.getRecordValue}}{{dropView.getRecordValue}}{{/dropView.getRecordValue}}</a>\r\n			</li>\r\n			{{/records}}\r\n		</ul>\r\n	</div>\r\n</div>\r\n'}),define("usercontrol/dropdown/view/dropdown",["require","text!usercontrol/dropdown/template/layout.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=i.BaseView,h=r.Backbone,p,d;return p=h.View.extend({template:t,multiple:!1,selectedOptions:[],className:"dropdown-wrapper",events:{"click .up-down-arrow-h":"showDropdown","click li a":"selectOptions"},selectOptions:function(e){var t=l(e.target).data("id");this.multiple?this.setMultipleOptions(t,e):this.setSingleOption(t,e),this.showSelectedValue(),this.callback&&this.callback(this.selectedOptions)},showSelectedValue:function(){var e=this.$el.find(".common-dropdown li.selected").text()||this.title;this.$el.find(".dropdown-header-box").html(e)},setMultipleOptions:function(e,t){var n=this.checkifExists(e);n==-1?(l(t.target).parent().addClass("selected"),this.selectedOptions.push(e)):(l(t.target).parent().removeClass("selected"),this.selectedOptions.splice(n,1))},setSingleOption:function(e,t){var n=this.checkifExists(e);n==-1&&(this.selectedOptions=[],console.log(this.$el.find(".common-dropdown li")),this.$el.find(".common-dropdown li").removeClass("selected"),l(t.target).parent().addClass("selected"),this.selectedOptions.push(e),this.$el.find(".hidden-input-dropdown-h").val(e),this.hideDropdown())},checkifExists:function(e){var t=-1;for(var n in this.selectedOptions)if(this.selectedOptions[n]==e){t=n;break}return t},initialize:function(e){d=this,n=this,this.selectedOptions=[],n.setOptions(e),this.render(),this.$el.find(".hidden-input-dropdown-h").attr("id",this.elementId)},hideDropdown:function(e){if(!e||!this.$el.find(l(e.target)).parents(".dropdown-container").length)this.$el.find(".dropdown-container").removeClass("increase-dropown-zindex"),this.$el.find(".up-down-arrow-h span").removeClass("icon-chevron-up").addClass("icon-chevron-down"),this.$el.find(".common-dropdown").slideUp()},showDropdown:function(e){e.preventDefault();var t=this;l(e.currentTarget).find("span").hasClass("icon-chevron-down")?(l(e.currentTarget).find("span").removeClass("icon-chevron-down").addClass("icon-chevron-up"),l(".dropdown-container").removeClass("increase-dropown-zindex"),t.$el.find(".dropdown-container").addClass("increase-dropown-zindex"),l("html").bind("click",function(e){t.hideDropdown(e)})):(t.$el.find(".dropdown-container").removeClass("increase-dropown-zindex"),l(e.currentTarget).find("span").removeClass("icon-chevron-up").addClass("icon-chevron-down")),l(e.currentTarget).parents(".dropdown-container").find(".common-dropdown").slideToggle()},getRecordId:function(){return this.payload[d.data.recordId]},defaultSelected:function(e){if(d.multiple){if(_.isArray(d.selectedValue))for(var t in d.selectedValue)if(d.selectedValue[t]==this.payload[d.data.recordId])return"selected"}else if(d.selectedValue&&d.selectedValue==this.payload[d.data.recordId])return"selected"},getRecordValue:function(){return this.payload[d.data.recordValue]},render:function(){this.data.dropView=this;if(!this.selectedValue){if(this.data.records.length)var e=this.data.records[0].payload[this.data.recordId];this.multiple?(this.selectedValue=[],this.selectedValue.push(e)):this.selectedValue=e}var t=this,n=f.to_html(t.template,this.data);return l(t.el).html(n),this.targetView.$el.find(this.destination).html(this.el),this.$el.find(".hidden-input-dropdown-h").val(this.selectedValue),this.selectedOptions.push(this.selectedValue),this.showSelectedValue(),l("#"+this.elementId).length?t.callback&&t.callback(this.selectedOptions):setTimeout(function(){if(!t.$el.find("li.selected").length){var e=t.$el.find(".common-dropdown li:first-child");e.addClass("selected"),t.$el.find("#"+t.elementId).val(e.find("a").data("id")),t.showSelectedValue()}t.callback&&t.callback(t.selectedOptions)},200),!0},setOptions:function(e){for(var t in e)this[t]=e[t]}}),p}),define("usercontrols/tag/models/sport",["facade","sportorg/models/sport"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/sport/basics/"+this.id}}),n}),define("usercontrols/tag/collections/events",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.sports_id&&(e+="sports_id="+this.sports_id+"&"),this.states_id&&(e+="states_id="+this.states_id+"&"),this.event_name&&(e+="searchtext="+encodeURI(this.event_name)),"/api/game/search?"+e}}),i}),define("usercontrols/tag/views/main",["require","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","usercontrols/tag/models/basic_info","sportorg/collections/sports_listall","location/collections/states","usercontrols/tag/collections/schools","usercontrols/tag/collections/teams","location/collections/cities","user/collections/users","usercontrols/tag/collections/games","usercontrols/tag/models/complevel","usercontrol/dropdown/view/dropdown","usercontrols/tag/models/sport","usercontrols/tag/collections/events"],function(e){var t=e("text!usercontrols/tag/templates/layout.html"),n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/tag/collections/schools"),m=e("user/collections/users"),g=e("usercontrols/tag/collections/games"),y=e("usercontrols/tag/collections/teams"),b=e("usercontrols/tag/models/complevel"),w=e("usercontrol/dropdown/view/dropdown"),E=e("usercontrols/tag/models/sport"),S=e("usercontrols/tag/collections/events");return TagView=s.extend({template:t,tagData:{Game:{},Player:{},Team:{}},events:{"change .ddl-tag-sports_h":"changeSport","click .btn-tag-sport_h":"sportsDone","click .btn-tag-edit-sport_h":"editSport","click .link-tag-team_h":"showTeamSection","keyup .txt-tag-team-state_h":"keyupState","blur .txt-tag-team-state_h":"changeState","keyup .txt-tag-team-city_h":"keyupCity","blur .txt-tag-team-city_h":"changeCity","keyup .txt-tag-team-school_h":"keyupSchool","blur .txt-tag-team-school_h":"changeSchool","change .ddl-tag-team-level_h":"changeCompLevel","change .ddl-tag-team-season_h":"changeSeason","click .btn-tag-team-Done_h":"doneTagTeamTagging","keyup .txt-tag-event-state_h":"keyupState","blur .txt-tag-event-state_h":"changeState","keyup .txt-tag-event_h":"keyupEvent","blur .txt-tag-event_h":"changeEvent","click .btn-tag-event-Done_h":"doneTagTeamTagging","click .link-tag-event_h":"showEventSection","click .btn-tag-event-Done_h":"doneEventTagging","change .ddl-tag-event_h":"changeEvent","click .link-tag-player_h":"showPlayer","click .btn-tag-add-player_h":"addPlayer","keyup .txt-tag-player-name_h":"keyUpPlayer","change .txt-tag-player-name_h":"setPlayerId","click .btn-tag-player-Done_h":"donePlayerTagging","click .link-tag-Game_h":"showGameSection","click .btn-tag-game-Done_h":"doneGameTagging","change .ddl-tag-game_h":"changeGame","click .btn-tag-Finish_h":"finishTagging"},controls:{secAddSports:".section-Add-Sports_h",divTagList:".div-tag-list_h",secSports:".section-sports_h",lblSportName:".lbl-tag-sport-name_h",btnEditSport:".btn-tag-edit-sport_h",btnSportsDone:".btn-tag-sport_h",ddlSports:".ddl-tag-sports_h",spnSports:".span-ddl-sports-tag_h",dropdownHeader:".dropdown-header-box",secTeam:".section-team_h",lblTeamName:".lbl-tag-team-name_h",secTagTeam:".section-tag-team_h",txtTeamState:".txt-tag-team-state_h",txtTeamCity:".txt-tag-team-city_h",txtTeamSchool:".txt-tag-team-school_h",btnTeamDone:".btn-tag-team-Done_h",secEvent:".section-events_h",lblEventName:".lbl-tag-event-name_h",secTagEvent:".section-tag-event_h",txtEventState:".txt-tag-event-state_h",txtEvent:".txt-tag-event_h",btnEventDone:".btn-tag-event-Done_h",secPlayer:".section-tag-player_h",secPlayerInput:".section-tag-player-input_h",txtPlayerName:".txt-tag-player-name_h",additionalPlayer:".additional_h",btnAddPlayer:".btn-tag-add-player_h",btnPlayerDone:".btn-tag-player-Done_h",sectionSelectedPlayers:".section-team-players_h",lblPlayerNames:".lbl-tag-players-name_h",secGame:".section-tag-game_h",ddlGame:".ddl-tag-game_h",btnGameDone:".btn-tag-game-Done_h",secFooterLinks:".section-link_h",lnkTeam:".link-tag-team_h",lnkPlayer:".link-tag-player_h",lnkGame:".link-tag-Game_h",lnkEvent:".link-tag-event_h",sectionSelectedGames:".section-team-games_h",lblGameNames:".lbl-tag-games-name_h",spnGames:".span-ddl-games-tag_h",btnTeamFinish:".btn-tag-Finish_h",fieldMessage:".field-message",fieldError:".field-error",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnGamesIdData:"hdn_game_id",hdnGamesId:"#hdn_game_id"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",eventId:"eventid"},inlineTemplates:{sportOption:'{{#sports}}<option value="{{sport_id}}">{{sport_name}}</option>{{/sports}}',compLevelOption:'{{#levels}}<option value="{{complevel_id}}">{{complevel_name}}</option>{{/levels}}',seasonOption:'{{#seasons}}<option value="{{season_id}}">{{season_name}}</option>{{/seasons}}',addPlayerText:'</br><input type="text" class="txt-tag-player-name_h additional_h" placeholder="Enter Name" value="" />'},messages:{dataNotExist:"Not finding anything... ",dataNotExistAwards:"Not finding any awards. ",MandatoryFields:"Sport, Name and Year are mandatory.",selectOrganization:"Please Select High School Or Club & Season. ",selectEvent:"Please select an event. ",selectTeamAndSports:"Please Select Both Sports And A Team. "},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id,e.is_owner==undefined||e.is_owner==null?this.is_owner=null:this.is_owner=e.is_owner;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null},init:function(){n.setupView()},setupView:function(){n.setUpMainView(),n.fillSports()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e),console.log("isowner",n.is_owner)},fillSports:function(){if(!(n.sports&&n.sports.length>0)){var e=new h;e.processResult=function(t){var r=e.ParseForDropdown();n.SetupSportsView(r)},e.fetch()}},SetupSportsView:function(e){n.sports=e;var t={};t.records=n.sports,t.recordId="id",t.recordValue="custom_name";var r=new w({data:t,title:"Select Sport",elementId:n.controls.hdnSportsIdData,destination:n.controls.spnSports,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeSport(e)}});n.sports_id&&(n.sportsDone(),n.is_owner==0&&(console.log("insideoop"),l(n.destination).find(n.controls.btnEditSport).addClass("display_none_important")))},changeSport:function(e){e&&e!=0?l(n.destination).find(n.controls.btnSportsDone).fadeIn():l(n.destination).find(n.controls.btnSportsDone).fadeOut()},setSport:function(){return n.sportsId?(n.sport=new E({id:n.sportsId}),n.sport.fetch(),l.when(n.sport.request).done(function(){var e=n.sport.get("payload");e.sport_type_id==1?(l(n.destination).find(n.controls.lnkTeam).fadeIn(),l(n.destination).find(n.controls.lnkEvent).fadeOut()):e.sport_type_id==2&&(l(n.destination).find(n.controls.lnkEvent).fadeIn(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.lnkTeam).fadeOut()),l(n.destination).find(n.controls.lblSportName).html(l(n.destination).find(n.controls.spnSports).find(n.controls.dropdownHeader).text()),l(n.destination).find(n.controls.secAddSports).fadeOut(),l(n.destination).find(n.controls.secSports).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}),n.sport):!1},sportsDone:function(e){n.sportsId=l(n.destination).find(n.controls.hdnSportsId).val(),n.setSport()},editSport:function(){this.tagData={Game:{},Player:{},Team:{}},l(n.destination).find(n.controls.secSports).fadeOut(),l(n.destination).find(n.controls.secAddSports).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeOut(),l(n.destination).find("*").show(),l(n.destination).find(".displayNone").hide(),l(n.destination).find("input").val(""),l(n.destination).find(n.controls.additionalPlayer).remove()},showTeamSection:function(e){l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.secGame).fadeOut(),l(n.destination).find(n.controls.secTagTeam).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeOut(),l(n.destination).find(n.controls.btnTeamFinish).fadeOut(),l(e.target).hide()},showEventSection:function(e){l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.secGame).fadeOut(),l(n.destination).find(n.controls.secTagEvent).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeOut(),l(n.destination).find(n.controls.btnEventDone).fadeOut(),l(e.target).hide()},keyupState:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.stateId),n.CheckTeamControlsVisibility();var i=new p;i.state_name=l(e.target).val(),n.stateFetchRequest=n.stateFetchRequest||[],n.stateFetchRequest.push(n.cityFetchRequest||[]),n.stateFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.stateFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.stateFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.states=[];for(var s in t)n.states.push(t[s].payload);n.states.forEach(function(e,t){r.push(e.name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeState(e)},changeState:function(e){console.log(l(e.target),l(e.target).hasClass("txt-tag-event-state_h"));var t=l(e.target).val();l(e.target).removeAttr(n.attributes.stateId);var r=!1;n.states_id="",n.states&&n.states.forEach(function(i,s){i["name"]==t&&(r=!0,n.states_id=i.id,l(e.target).attr(n.attributes.stateId,n.states_id),l(e.target).hasClass("txt-tag-event-state_h")?l(e.target).parent().find(n.controls.txtEvent).removeAttr("disabled").attr(n.attributes.stateId,n.states_id):l(e.target).parent().find(n.controls.txtTeamSchool).removeAttr("disabled").attr(n.attributes.stateId,n.states_id))}),r||(n.states_id=0,l(n.destination).find(n.controls.txtTeamSchool).attr("disabled","disabled").removeAttr(n.attributes.stateId).fadeOut()),n.CheckTeamControlsVisibility()},keyupCity:function(e){var t=l(e.target).val(),r=[];if(t.length>2)if(n.isValidAutoCompleteKey(e)==1){try{n.$(e.target).autocomplete("destroy")}catch(i){}l(e.target).removeAttr(n.attributes.cityId),n.CheckTeamControlsVisibility();var s=new d;s.states_id=n.states_id,s.city_name=l(e.target).val(),console.log("City Request Abort Request Function AddGame/Main.js"),n.cityFetchRequest=n.cityFetchRequest||[],n.cityFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.cityFetchRequest=n.abortRequest(n.cityFetchRequest);var o=s.fetch();n.cityFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.cities=[];for(var i in t)n.cities.push(t[i]);n.cities.forEach(function(e,t){r.push(e.city)}),n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeCity(e)},changeCity:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.cityId);var r=!1;n.city_id="",n.cities&&n.cities.forEach(function(i,s){i["city"]==t&&(r=!0,n.city_id=i.id,l(e.target).attr(n.attributes.cityId,n.city_id))}),r?l(n.destination).find(n.controls.txtTeamSchool).removeAttr("disabled"):(n.city_id=0,l(n.destination).find(n.controls.txtTeamSchool).attr("disabled","disabled").removeAttr(n.attributes.cityId).fadeOut()),n.CheckTeamControlsVisibility()},keyupSchool:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility();var s=new y;s.states_id=l(e.target).attr(n.attributes.stateId),s.sports_id=l(n.destination).find(n.controls.hdnSportsId).val(),s.team_name=t,l(e.target).addClass("ui-autocomplete-loading"),console.log("Team Request Abort Request Function"),n.TeamFetchRequest=n.abortRequest(n.TeamFetchRequest);var o=s.fetch();n.TeamFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.teams=[];for(var i in t)n.teams.push(t[i].payload);n.teams.forEach(function(e,t){r.push(e.team_name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeSchool(e)},changeSchool:function(e){var t=l(e.target).val(),r=!1;n.team_id=0,n.teams&&n.teams.forEach(function(i,s){var o=i.team_name;o==t&&(r=!0,n.team_id=i.id,l(e.target).attr(n.attributes.teamId,n.team_id))}),r||l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility()},keyupEvent:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility();var s=new S;s.states_id=l(e.target).attr(n.attributes.stateId),s.sports_id=n.sport.id,s.event_name=t,l(e.target).addClass("ui-autocomplete-loading"),console.log("Event Request Abort Request Function"),n.EventFetchRequest=n.abortRequest(n.EventFetchRequest);var o=s.fetch();n.EventFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.events=[];for(var i in t)n.events.push(t[i].payload);n.events.forEach(function(e,t){r.push(e.event_name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility(),n.isEnterKey(e)&&n.changeEvent(e)},changeEvent:function(e){var t=l(e.target).val(),r=!1;n.event_id=0,n.events&&n.events.forEach(function(i,s){var o=i.event_name;o==t&&(r=!0,n.event_id=i.id,l(e.target).attr(n.attributes.eventId,n.event_id))}),r||l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility()},CheckEventControlsVisibility:function(){var e=l(n.destination).find(n.controls.txtEventState).attr(n.attributes.stateId);e&&e!=""&&e!=0?l(n.destination).find(n.controls.txtEvent).show():l(n.destination).find(n.controls.txtEvent).val("").removeAttr(n.attributes.eventId).hide(),e=l(n.destination).find(n.controls.txtEvent).attr(n.attributes.eventId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnEventDone).show():l(n.destination).find(n.controls.btnEventDone).hide()},doneEventTagging:function(e){var t=l(n.destination).find(n.controls.txtEvent).attr(n.attributes.eventId);n.event_id=t;var r=[];if(t&&t!=""&&t!=0&&t&&t!=""&&t!=0){var i=l(n.destination).find(n.controls.txtEvent).val();r.push(t),l(n.destination).find(n.controls.lblEventName).html(i),l(n.destination).find(n.controls.secTagEvent).fadeOut(),l(n.destination).find(n.controls.secEvent).fadeIn(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}else n.$(e.target).parents(n.controls.secTagEvent).find(n.controls.fieldMessage).html(n.messages.selectOrganization).stop().fadeIn();var s={8:r};u(n.channel).publish(s)},CheckTeamControlsVisibility:function(){var e=l(n.destination).find(n.controls.txtTeamState).attr(n.attributes.stateId);e&&e!=""&&e!=0?l(n.destination).find(n.controls.txtTeamSchool).show():l(n.destination).find(n.controls.txtTeamSchool).val("").removeAttr(n.attributes.teamId).hide(),e=l(n.destination).find(n.controls.txtTeamSchool).attr(n.attributes.teamId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnTeamDone).show():l(n.destination).find(n.controls.btnTeamDone).hide()},doneTagTeamTagging:function(e){var t=l(n.destination).find(n.controls.txtTeamSchool).attr(n.attributes.teamId);n.team_id=t;var r=l(n.destination).find(n.controls.ddlTeamSeason).val(),i=[];if(t&&t!=""&&t!=0&&t&&t!=""&&t!=0){var s=l(n.destination).find(n.controls.txtTeamSchool).val();i.push(t),l(n.destination).find(n.controls.lblTeamName).html(s),l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secTeam).fadeIn(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.lnkGame).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}else n.$(e.target).parents(n.controls.secTagTeam).find(n.controls.fieldMessage).html(n.messages.selectOrganization).stop().fadeIn();var o={5:i};u(n.channel).publish(o)},showPlayer:function(e){l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secGame).fadeOut(),l(n.destination).find(n.controls.secPlayer).fadeIn(),l(n.destination).find(n.controls.btnTeamFinish).fadeOut()},addPlayer:function(e){l(n.destination).find(n.controls.secPlayerInput).append(n.inlineTemplates.addPlayerText)},keyUpPlayer:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.playersId);var i=new m;i.user_name=t,i.states_id=n.states_id,i.sports_id=l(n.destination).find(n.controls.hdnSportsId).val(),l(e.target).addClass("ui-autocomplete-loading"),console.log("Player Request Abort Request Function"),n.PlayerFetchRequest=n.abortRequest(n.PlayerFetchRequest);var s=i.fetch();n.PlayerFetchRequest.push(s),l.when(i.request).done(function(){var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.users=[];for(var s in t)n.users.push(t[s].payload);n.users.forEach(function(e,t){r.push(e.name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.setPlayerId(e),n.isEnterKey(e)&&n.addPlayer(e);else l(e.target).removeAttr(n.attributes.playersId)},setPlayerId:function(e){if(n.users){var t=l(e.target).val().toLowerCase();for(var r in n.users)if(n.users[r].name.toLowerCase()==t){l(e.target).attr(n.attributes.playersId,n.users[r].id);return}}},donePlayerTagging:function(e){var t=[],r="",i=[];l(n.destination).find(n.controls.txtPlayerName).each(function(){var e=l(this).attr(n.attributes.playersId);e>0&&(t.push({name:l(this).val(),id:e}),r+=","+l(this).val(),i.push(e))});if(t.length>0){var s={players:t},o=l(n.destination).find(n.controls.sectionSelectedPlayers);l(o).find(n.controls.lblPlayerNames).html(r),l(o).fadeIn(),l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.btnTeamFinish).fadeIn();var a={1:i};u(n.channel).publish(a)}else{l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.selectPlayer).fadeIn();var o=l(n.destination).find(n.controls.sectionSelectedPlayers);l(o).find(n.controls.lblPlayerNames).html(""),l(o).fadeOut()}},showGameSection:function(e){n.bindGamesData(e),l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.secGame).fadeIn(),l(n.destination).find(n.controls.btnTeamFinish).fadeOut()},bindGamesData:function(e){var t=l(n.destination).find(n.controls.hdnSportsId).val();if(n.sportsId){var r=new g;r.states_id=n.states_id,r.sports_id=n.sportsId,r.teams_id=n.team_id,l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html("").fadeOut(),r.processResult=function(e){n.SetupGamesView(e)},console.log("Team Request Abort Request Function"),n.GameFetchRequest=n.abortRequest(n.GameFetchRequest);var i=r.fetch();n.GameFetchRequest.push(i)}else l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.selectTeamAndSports).fadeIn()},SetupGamesView:function(e){var t=e.toJSON();if(t==null||t.length<1){l(n.destination).find(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn();return}n.games=t;var r={};r.records=n.games,r.recordId="id",r.recordValue="game_name";var i=new w({data:r,title:"Select Game",elementId:n.controls.hdnGamesIdData,destination:n.controls.spnGames,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeGame(e)}})},changeGame:function(e){var t=e;t&&t!=""&&t!=0?l(n.destination).find(n.controls.secGame).find(n.controls.btnGameDone).fadeIn():l(n.destination).find(n.controls.secGame).find(n.controls.btnGameDone).fadeOut()},doneGameTagging:function(e){var t=this,n=l(e.target).parents(t.controls.secGame).find(t.controls.hdnGamesId).val(),r="";if(n&&n!=""&&n!=0){r=l(e.target).parents(t.controls.secGame).find(t.controls.spnGames).find(t.controls.dropdownHeader).text();var i={game:{id:n,game_name:r}},s=[];s.push(n),t.tagData.Game=i;var o=l(t.destination).find(t.controls.sectionSelectedGames);l(o).find(t.controls.lblGameNames).html(r),l(o).fadeIn(),l(t.destination).find(t.controls.secGame).fadeOut(),l(t.destination).find(t.controls.btnTeamFinish).fadeIn();var a={8:s};u(t.channel).publish(a)}else{var o=l(t.destination).find(t.controls.sectionSelectedGames);l(o).find(t.controls.lblGameNames).html(""),l(o).fadeIn()}},finishTagging:function(){}}),TagView}),define("imageup/views/basic",["require","text!imageup/templates/uploader.html","text!imageup/templates/select_all.html","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","imageup/models/basic","imageup/views/errors","usercontrols/tag/views/main"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=o.SectionView,c=e("imageup/models/basic"),h=e("imageup/views/errors"),p=s.$,d=s._,v=u.debug,m=e("usercontrols/tag/views/main");return v.log("SectionView: ",l),i=l.extend({id:"imageuploadForm",events:{"click #imageup":"imageUploadClick","change #image_file":"imagePreview","dragover #imageholder":"drag","drop #imageholder":"drop","click #btn_select_all_h":"selectAllImages"},template:t,data:t,tagCollection:[],tagData:{1:[],5:[],8:[]},"const":{User:1,Team:5,Game:8},files_byUploader:[],files_drag:[],initialize:function(e,t){p("#errormsg, #preview").html(""),l.prototype.initialize.call(this,e),console.log("Image upload basic view"),this.attr=t,this.files_drag=[],this.scheme=e.scheme,this.layout=e.layout,this.dropedImage=e.dropedImage,this.attr?this.sports_id=this.attr.sports_id||null:this.sports_id=null,a("tag-team-image-success").empty(),a("tag-team-image-success").subscribe(this.tagFunction),p("#imgUploadModal").modal("show"),p("#imgUploadModal").on("hidden",function(){routing.trigger("refresh-onImageUpload")}),p("#imgUploadModal").on("hide",function(){routing.trigger("refresh-onImageUpload")})},drag:function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},drop:function(e){var t=this;e.stopPropagation(),e.preventDefault(),p("#errormsg").hide(),this.files_drag=this.files_drag||[];var n=e.originalEvent.dataTransfer.files;n.length>0&&t.showLoader(t);var r=[];t.dataum=t.dataum||[];var i=t.dataum.length;for(var s=0,o;o=n[s];s++){if(!o.type.match("image.*"))continue;this.files_drag.push(o);var u=new FileReader;u.onload=function(e){return function(n){var r="preview_"+i;i++,t.dataum.push({preview_id:r,width:"250px",height:"250px",filesrc:n.target.result,title:escape(e.name)}),data={data:t.dataum},p("#image_file").attr("disabled","disabled"),routing.trigger("imageup-preview",data),t.hideLoader()}}(o),t.setUpBottomView(),u.readAsDataURL(o)}},imagePreview:function(e){var t=this;v.log("Image preview view"),p("#preview").hide(),p("#errormsg").hide(),this.files_byUploader=this.files_byUploader||[];var n=p("#image_file")[0].files;n.length>0&&t.showLoader(t),t.dataum=[];var r,i=t.dataum.length,s=0;for(;r=n[s];s++){if(!r.type.match("image.*"))continue;t.files_byUploader.push(r);var o=new FileReader;o.onload=function(e){return function(r){var s="preview_"+i;i++,t.dataum.push({preview_id:s,width:"250px",height:"250px",filesrc:r.target.result,title:escape(e.name)}),i==n.length&&(console.log("data**************************"),data={data:t.dataum},console.log(data),routing.trigger("imageup-preview",data),t.hideLoader())}}(r),o.readAsDataURL(r)}t.setUpBottomView()},imageUploadClick:function(e){e.preventDefault();var t=this;p("#errormsg").hide(),p("#imageup").attr("disabled","disabled"),p(".closepreview").attr("disabled","disabled"),p(".rotate").attr("disabled","disabled");if(p(".previewimg").length==0){var n={msg:"Image Field Empty",color:"alert-error"};routing.trigger("imageup-msg",n),p("#imageup").removeAttr("disabled")}else if(this.dropedImage){var r=this.files_drag.length;jQuery.each(this.dropedImage.data[0].drag_info,function(e,n){var i=new FormData;if(p("#preview_"+e+"group").length>0){i.append("image_file",n),p("#preview_"+e+"rotang").val()>0?i.append("rotate",p("#preview_"+e+"rotang").val()):i.append("rotate","false");for(var s in t.attr)console.error(s,t.attr[s]),i.append(s,t.attr[s]);var o={dataum:i,id:e,len:r};console.log(o),routing.trigger("imageup-add-image",o)}}),this.files_drag=[],p("#imageup").removeAttr("disabled")}else if(this.files_drag.length>=1){var r=this.files_drag.length;jQuery.each(this.files_drag,function(e,n){var i=new FormData;if(p("#preview_"+e+"group").length>0){i.append("image_file",n),p("#preview_"+e+"rotang").val()>0?i.append("rotate",p("#preview_"+e+"rotang").val()):i.append("rotate","false");for(var s in t.attr)console.error(s,t.attr[s]),i.append(s,t.attr[s]);var o=t.getTagData(p("#preview_"+e+"group"));i.append("tag",JSON.stringify(o));var u={dataum:i,id:e,len:r};console.log(u),routing.trigger("imageup-add-image",u)}}),this.files_drag=[],p("#imageup").removeAttr("disabled")}else console.log("file_byUploader"),console.log(this.files_byUploader),jQuery.each(t.files_byUploader,function(e,n){var r=new FormData;if(p("#preview_"+e+"group").length>0){r.append("image_file",n),p("#preview_"+e+"rotang").val()>0?r.append("rotate",p("#preview_"+e+"rotang").val()):r.append("rotate","false");for(var i in t.attr)r.append(i,t.attr[i]);var s=t.getTagData(p("#preview_"+e+"group"));r.append("tag",JSON.stringify(s));var o={dataum:r,id:e,len:t.files_byUploader.length};routing.trigger("imageup-add-image",o)}}),t.files_byUploader=[],p("#imageup").removeAttr("disabled");this.dataum=[]},getTagData:function(e){var t=p(e).attr("gameIndex"),n=p(e).attr("teamIndex"),r=p(e).attr("userIndex"),i={1:[],5:[],8:[]};if(t>-1){var s=this.tagData[this.const.Game][t];s&&(i[this.const.Game]=s)}if(n>-1){var s=this.tagData[this.const.Team][n];s&&(i[this.const.Team]=s)}if(r>-1){var s=this.tagData[this.const.User][r];s&&(i[this.const.User]=s)}return i},setUpBottomView:function(){p("#main-content-tag-section").fadeIn(),this.setUpSelectAllView(),this.setUpTagView()},setUpSelectAllView:function(){var e=this;p("#select-allup").html(n),e.showSelectAllImages()},setUpTagView:function(){var e=this;this.tagView=new m({model:this.model,template:r,name:"tag-image "+(new Date).toString(),destination:"#image-tagging",user_id:e.user_id||null,sports_id:e.sports_id,channel:"tag-team-image-success"}),this.scheme.push(this.tagView),this.layout.render()},tagFunction:function(e){var t=this;this.tagCollection.push(e);var n=0,r=p(".previewimg.selected");console.log("selected",r);for(var i in e)t.tagData[i]=t.tagData[i]||[],t.tagData[i].push(e[i]),n=t.tagData[i].length-1,i==t.const.Game?r.attr("gameIndex",n):i==t.const.Team?r.attr("teamIndex",n):i==t.const.User&&r.attr("userIndex",n)},selectAllImages:function(e){p(".previewimg").addClass("selected"),p("#select-allup").hide(),p("#image-tagging").show()},showSelectAllImages:function(){p("#select-allup").show(),p("#image-tagging").hide()}}),i}),define("text!imageup/templates/preview_template.html",[],function(){return'{{#data}} \r\n	<div class="previewimg" id="{{preview_id}}group"align="center">\r\n		\r\n		<div class="previewimgsrc" id="{{preview_id}}pre" align="center">\r\n			<img src="{{filesrc}}" class="img-polaroid" width="{{width}}" height="{{height}}" title="{{title}}" draggable="false">\r\n			<!-- <button type="button" class="close closepreview" value ="{{preview_id}}"data-dismiss="{{preview_id}}">&times;</button> -->\r\n			<input type="hidden" id="{{preview_id}}rotang" value="0">\r\n		\r\n		</div>\r\n		\r\n		<div class="clear"></div>\r\n		<div id="{{preview_id}}rot" class="previewrotate lnkFooter">\r\n			<button id="{{preview_id}}pre img" value="{{preview_id}}" class="btn rotate">rotate 90&deg;</button>\r\n			<button type="button" class="btn close closepreview" value ="{{preview_id}}"data-dismiss="{{preview_id}}">delete</button>\r\n		</div>\r\n		<div class="clear"></div>\r\n		<div id="{{preview_id}}" class="previewprogress"></div>\r\n		<div class="clear"></div>\r\n	</div>\r\n{{/data}} '}),define("imageup/views/preview",["require","text!imageup/templates/preview_template.html","text!usercontrols/tag/templates/layout.html","text!imageup/templates/select_all.html","facade","views","utils","vendor","usercontrols/tag/views/main"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=o.SectionView,c=s.$,h=s._,p=e("usercontrols/tag/views/main"),d=u.debug;return i=l.extend({id:"imgpreview",template:t,events:{"click .rotate":"imageRotate","click .close":"closePreview","click .previewimgsrc":"selectImage","mouseover .previewimg":"showFooter","mouseout .previewimg":"hideFooter"},initialize:function(e){l.prototype.initialize.call(this,e),console.log("preview view",e),this.degree=0,this.scheme=e.scheme,this.layout=e.layout},imageRotate:function(e){id=e.currentTarget.id,val=e.currentTarget.value,this.degree=c("#"+val+"rotang").val(),this.degree=parseInt(this.degree)+90,this.degree>=360&&(this.degree=0),c("#"+id).css({"-webkit-transform":"rotate("+this.degree+"deg)","-moz-transform":"rotate("+this.degree+"deg)","-ms-transform":"rotate("+this.degree+"deg)","-o-transform":"rotate("+this.degree+"deg)",transform:"rotate("+this.degree+"deg)",zoom:1}),c("#"+val+"rotang").val(this.degree)},closePreview:function(e){var t=[];h.each(this.model.get("data"),function(n,r,i){console.log(n.preview_id,e.currentTarget.value),n.preview_id!=e.currentTarget.value&&t.push(n)}),this.model.set("data",t),id=e.currentTarget.value+"group";var n=document.getElementById(id);n.parentNode.removeChild(n)},selectImage:function(e){var t=c(e.target).hasClass("previewimg"),n=t?c(e.target):c(e.target).parents(".previewimg");n.toggleClass("selected");var r=c(this.destination).find(".previewimg.selected");r.length<1?this.setUpSelectAllView():this.setUpTagView()},setUpSelectAllView:function(){c("#image-tagging").hide(),c("#select-allup").show()},setUpTagView:function(){c("#select-allup").hide(),c("#image-tagging").show()},showFooter:function(e){c(e.target).parents(".previewimg").find(".lnkFooter").show()},hideFooter:function(e){c(e.target).parents(".previewimg").find(".lnkFooter").hide()}}),i}),define("imageup",["require","text!imageup/templates/basic.html","text!imageup/templates/uploader.html","facade","controller","models","views","utils","imageup/models/basic","imageup/models/imageupload","imageup/models/errorshow","imageup/collections/basics","imageup/models/preview","imageup/views/basic","imageup/views/errors","imageup/views/preview"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("imageup/models/basic"),f=e("imageup/models/imageupload"),l=e("imageup/models/errorshow"),c=e("imageup/collections/basics"),h=e("imageup/models/preview"),p=e("imageup/views/basic"),d=e("imageup/views/errors"),v=e("imageup/views/preview"),m=o.LayoutView,g=r.$,y=r._,b=u.debug,w=u.lib.Channel,E=["/pages/imageup/imageup.css"];return n=i.extend({initialize:function(e){return w("load:css").publish(E),y.bindAll(this),this.scheme=[],this.handleOptions(e),this.init(e),this},init:function(e){this.url=e.url,this.attr=e.attr,this.data=e.data,this.count=0,this.setupLayout(),this.handleDeferreds(),this.showuploader(),this.data&&this.showPreviewDropImage()},handleDeferreds:function(){function t(t){e.imageUpload(t)}function n(t){e.msgShowup(t)}function r(t){e.previewShowup(t)}function i(){e.rerender()}var e=this;routing.off("imageup-add-image"),routing.on("imageup-add-image",function(e){t(e)}),routing.off("imageup-msg"),routing.on("imageup-msg",function(e){n(e)}),routing.off("imageup-preview"),routing.on("imageup-preview",function(e){console.log("this is"),r(e)}),routing.off("imageup-rerender"),routing.on("imageup-rerender",function(e){i(e)})},showuploader:function(){var e=new p({scheme:this.scheme,layout:this.layout,name:"Add Media",dropedImage:this.data,model:new a,destination:"#left_upload"},this.attr);b.log("Imagecontroller Show"),console.log(this.scheme),this.scheme.push(e),this.layout.render()},setupLayout:function(){var e;return b.log("Imagecontroller Layout"),this.scheme=[],g(".model-popup-h").remove(),g("body").append('<div id="modalPopup" class="model-popup-h"></div>'),e=new m({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=e,this.layout},previewShowup:function(e){var t=new h(e);for(var n in this.scheme)this.scheme[n].id=="imgpreview"&&delete this.scheme[n];previewShowView=new v({scheme:this.scheme,layout:this.layout,name:"Preview Show View",model:t,destination:"#preview",displayWhen:"ready"}),b.log("Preview View Show"),this.scheme.push(previewShowView),g("#preview").show(),routing.trigger("imageup-rerender")},rerender:function(){this.showuploader()},showPreviewDropImage:function(){var e=this;e.data&&routing.trigger("imageup-preview",e.data)},imageUpload:function(e){console.log(e),b.log("image uploading starts");var t=e.id,n=e.len,r=[],i="",s=this,r=e.dataum;g("#preview_"+t).addClass("image_upload_loader_new"),g(".previewimgsrc").addClass("fade-out"),g.ajax({url:this.url,data:r,cache:!1,processData:!1,contentType:!1,type:"POST",success:function(e){g("#preview_"+t).fadeOut("slow"),g("#preview_"+t+"rot").fadeOut("slow"),routing.trigger("image-upload-success",e),g("imageup").attr("disabled","disabled"),s.count++,s.count==n&&(i={msg:" File Uploaded Succesfully",color:"alert-success"},routing.trigger("imageup-msg",i),g("#imageup").removeAttr("disabled"),g("#image_file").removeAttr("disabled"),g(".closepreview").removeAttr("disabled")),g("#preview_"+t).unbind().removeClass("image_upload_loader_new").html("").attr("disabled","disabled")},error:function(e){g("#preview_"+t).fadeOut("slow"),g(".previewimgsrc").removeClass("fade-out"),g("#preview_"+t).fadeIn("slow").html("<b>Upload Error!</b>"),b.log(e),i={msg:e.statusText,color:"alert-error"},routing.trigger("imageup-msg",i),g("#imageup").removeAttr("disabled"),g("#image_file").removeAttr("disabled"),g(".closepreview").removeAttr("disabled");return}})},msgShowup:function(e){for(var t in this.scheme)this.scheme[t].destination=="#errormsg"&&delete this.scheme[t];errorShowModel=new l(e),addErrorView=new d({name:"File Upload Msg",model:errorShowModel,destination:"#errormsg",displayWhen:"ready"}),b.log("Error View Show"),this.scheme.push(addErrorView),g("#errormsg").show(),routing.trigger("imageup-rerender")}}),n}),define("text!pages/home/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header"></div>\r\n	<div id="main-content" class="row-fluid">\r\n		<div class="green-left-heading">\r\n			Top Rated\r\n		</div>\r\n		<div id="top-rated" class="p-l-20 clearfix clear"></div>\r\n\r\n		<div id="menu" class="p-l-20 clear"></div>\r\n		<div class="search-result-outer">\r\n			<div id="search-result" class="p-l-20 clear"></div>\r\n			<a href="javascript: void(0);" class="left-arrow-page home-page-arrow left-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/left_arrow.png">\r\n			</a>\r\n			<a href="javascript: void(0);" class="right-arrow-page home-page-arrow right-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/right_arrow.png">\r\n			</a>\r\n		</div>\r\n	</div>\r\n	<div id="main-footer"></div>\r\n</div>'}),define("pages/home/models/menu",["models"],function(e){var t,n=e.BaseModel;return t=n.extend({defaults:{name:null,views:{browse:[{name:"VOTES",value:"votes"},{name:"RECENT",value:"newest"},{name:"FANS",value:"followers"}],time:[{name:"TODAY",value:"DAY"},{name:"THIS WEEK",value:"WEEK"},{name:"THIS MONTH",value:"MONTH"},{name:"ALL TIME",value:"YEAR"}]}}}),t}),define("packages/location/models/city",["models","facade"],function(e,t){var n,r=e.BaseModel,s=t.$,o=t._;return n=r.extend({defaults:{name:null},initialize:function(e,t){this.id=this.id||o.uniqueId("m"),this.addSubscribers(),o.bindAll(this)},search:function(e){this.request&&this.request.abort(),this.request=s.ajax({url:"/api/location/search/?search_text="+e}).done(function(t,n,r){var s=[],u=t.payload;if(u!=null)for(i=0;i<(u.length>10?10:u.length);i++){var a={};a.label=u[i].str,a.id=u[i].id;var f=o.isUndefined(u[i].obj.states_obj)?!o.isUndefined(u[i].obj.city)&&!o.isUndefined(u[i].obj.city.states_obj)?u[i].obj.city.states_obj:{}:u[i].obj.states_obj;a.state_id=f.id,a.country_id=o.isUndefined(f.country)?"":f.country.id,s.push(a)}Channel("response :"+e).publish(s)})},addSubscribers:function(){var e=this;Channel("changeInput"+this.id).subscribe(e.search)}}),n}),define("sport/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{sport_id:0,sport_name:null,sport_type:null},desc:"Sport Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("packages/sport/collections/sports",["require","sport/models/sport","facade","collections","utils"],function(e,t){var n,r=e("utils"),s=e("facade"),o=e("collections"),u=r.debug,a=o.BaseCollection,f=s._;return n=a.extend({model:t,url:function(){var e="/api/sport/listall?",t=this.name||"boys",n="";switch(t){case"boys":n="male=1";break;case"both":n="male=1&";case"girls":n+="female=1"}return e+n},initialize:function(e,t){this.url=t.url||this.url,this.name=t.name,a.prototype.initialize.call(this,e,t)},fetchSuccess:function(e,n){e.reset();var r=n.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new t;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",n.desc),s.set("exec_data",n.exec_data),e.push(s)}e.deferred.resolve(n)}}),n}),define("pages/home/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("pages/home/collections/image",["facade","collections","pages/home/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,initialize:function(e,t){debug.log("HomeImageList initialize..."),this.cid=this.cid||o.uniqueId("c"),this.deferred=new $.Deferred,this.num=t.num,o.bindAll(this)},fetchSuccess:function(e,t){var r=o.first(t.payload,e.num);e.reset();for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("text!pages/home/templates/menu.html",[],function(){return'<div class="demo-select">\r\n\r\n</div>\r\n<div class="menu-outer-h">\r\n\r\n	<div id="resulttype" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h restype-link-h"><span class="option-heading-h">Athletes</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h restype-options-h">\r\n\r\n			<div class="clearfix"></div>\r\n			<ul class="dropdown-menu" style="display: block; position: relative;">\r\n				<li><a id="user" class="restype" data-number="2" href="javascript:void(0)">Athletes</a></li>\r\n				<li><a id="image" class="restype" data-number="1" href="javascript:void(0)">Images</a></li>\r\n				<li><a id="video" class="restype"  data-number="0" href="javascript:void(0)">Videos</a></li>\r\n				<li><a id="game" class="restype" data-number="3" href="javascript:void(0)">Games &amp; Events</a></li>\r\n			</ul>\r\n		</div>\r\n	</div>\r\n	<div id="sport" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h sport-link-h">\r\n			<span class="option-heading-h">ALL SPORTS</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-sport-area-h sports-option-h">\r\n			<!--<a href="javascript: void(0);" class="btn sport-reset-btn-h">Reset</a>-->\r\n\r\n			<div class="left text-center">\r\n				<strong>Guys</strong>\r\n\r\n				<div id=\'boys\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Girls</strong>\r\n\r\n				<div id=\'girls\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Both</strong>\r\n\r\n				<div id=\'both\' class="text-left sport-list"></div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div id="location" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h location-link-h"> <span class="option-heading-h">ANYWHERE</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-location-area-h no-padding">\r\n			<!--<a href="javascript: void(0);" class="btn location-reset-btn-h">Reset</a>-->\r\n			<!--div class="state"></div-->\r\n			<div class="city"></div>\r\n		</div>\r\n	</div>\r\n\r\n	<div id="views" class="menu span2">\r\n		<a href="javascript:void(0)" class="menu-link-h view-link-h"><span class="option-heading-h">ORDER</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h view-options-h">\r\n			\r\n\r\n			<div class="dropdown">\r\n				<span> SORT BY</span>\r\n\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative; margin-bottom:15px;">\r\n					{{#views.browse}}\r\n					<li><a class="browse" data-id="{{value}}" href="javascript:void(0);">{{name}}</a></li>\r\n					{{/views.browse}}\r\n				</ul>\r\n			</div>\r\n\r\n			<br/>\r\n\r\n			<div class="dropdown">\r\n				<span>TIME FRAME</span>\r\n\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative;">\r\n					{{#views.time}}\r\n					<li><a class="time" data-id="{{value}}" href="javascript: void(0)">{{name}}</a></li>\r\n					{{/views.time}}\r\n				</ul>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div id="reset" class="menu span2" >\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link"><span class="option-heading-h reset-all-btn-h" style="text-decoration: underline;">RESET</span></a>\r\n	</div>\r\n\r\n	<div class="pull-right search-box">\r\n		<input type="text" id="search" placeholder="SEARCH" style="height: 28px; margin:0px 5px;;"/><a href="javascript:void(0);" class="common-btn common-default-sky-dark common-btn-small">SEARCH</a>\r\n	</div>\r\n</div>'}),function(e){jQuery.fn.extend({slimScroll:function(n){var r=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function i(t){if(p){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3),e(t.target||t.srcTarget||t.srcElement).closest("."+r.wrapperClass).is(x.parent())&&s(n,!0),t.preventDefault&&!S&&t.preventDefault(),S||(t.returnValue=!1)}}function s(e,t,n){S=!1;var i=e,s=x.outerHeight()-N.outerHeight();t&&(i=parseInt(N.css("top"))+e*parseInt(r.wheelStep)/100*N.outerHeight(),i=Math.min(Math.max(i,0),s),i=0<e?Math.ceil(i):Math.floor(i),N.css({top:i+"px"})),b=parseInt(N.css("top"))/(x.outerHeight()-N.outerHeight()),i=b*(x[0].scrollHeight-x.outerHeight()),n&&(i=e,e=i/x[0].scrollHeight*x.outerHeight(),e=Math.min(Math.max(e,0),s),N.css({top:e+"px"})),x.scrollTop(i),x.trigger("slimscrolling",~~i),l(),c()}function o(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1),this.addEventListener("MozMousePixelScroll",i,!1)):document.attachEvent("onmousewheel",i)}function u(){y=Math.max(x.outerHeight()/x[0].scrollHeight*x.outerHeight(),E),N.css({height:y+"px"});var e=y==x.outerHeight()?"none":"block";N.css({display:e})}function l(){u(),clearTimeout(m),b==~~b?(S=r.allowPageScroll,w!=b&&x.trigger("slimscroll",0==~~b?"top":"bottom")):S=!1,w=b,y>=x.outerHeight()?S=!0:(N.stop(!0,!0).fadeIn("fast"),r.railVisible&&C.stop(!0,!0).fadeIn("fast"))}function c(){r.alwaysVisible||(m=setTimeout(function(){r.disableFadeOut&&p||d||v||(N.fadeOut("slow"),C.fadeOut("slow"))},1e3))}var p,d,v,m,g,y,b,w,E=30,S=!1,x=e(this);if(x.parent().hasClass(r.wrapperClass)){var T=x.scrollTop(),N=x.parent().find("."+r.barClass),C=x.parent().find("."+r.railClass);u();if(e.isPlainObject(n)){if("height"in n&&"auto"==n.height){x.parent().css("height","auto"),x.css("height","auto");var k=x.parent().parent().height();x.parent().css("height",k),x.css("height",k)}if("scrollTo"in n)T=parseInt(r.scrollTo);else if("scrollBy"in n)T+=parseInt(r.scrollBy);else if("destroy"in n){N.remove(),C.remove(),x.unwrap();return}s(T,!1,!0)}}else{r.height="auto"==r.height?x.parent().height():r.height,T=e("<div></div>").addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height}),x.css({overflow:"hidden",width:r.width,height:r.height});var C=e("<div></div>").addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),N=e("<div></div>").addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),k="right"==r.position?{right:r.distance}:{left:r.distance};C.css(k),N.css(k),x.wrap(T),x.parent().append(N),x.parent().append(C),r.railDraggable&&N.bind("mousedown",function(n){var r=e(document);return v=!0,t=parseFloat(N.css("top")),pageY=n.pageY,r.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,N.css("top",currTop),s(0,N.position().top,!1)}),r.bind("mouseup.slimscroll",function(e){v=!1,c(),r.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),C.hover(function(){l()},function(){c()}),N.hover(function(){d=!0},function(){d=!1}),x.hover(function(){p=!0,l(),c()},function(){p=!1,c()}),x.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(g=e.originalEvent.touches[0].pageY)}),x.bind("touchmove",function(e){S||e.originalEvent.preventDefault(),e.originalEvent.touches.length&&(s((g-e.originalEvent.touches[0].pageY)/r.touchScrollStep,!0),g=e.originalEvent.touches[0].pageY)}),u(),"bottom"===r.start?(N.css({top:x.outerHeight()-N.outerHeight()}),s(0,!0)):"top"!==r.start&&(s(e(r.start).position().top,null,!0),r.alwaysVisible||N.hide()),o()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery),define("jquery.slimscroll",function(){}),define("pages/home/views/menu",["require","text!pages/home/templates/menu.html","facade","views","jquery.slimscroll"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView;return n=s.extend({id:"menu",events:{"blur #search":"updateSearch","focus #search":"hideDropdown","click .restype":"changeBaseUrl","click .dropdown-menu-alias > li > a":"select","click .dd":"doNothing","click .menu-link-h":"showMenuDropdown","click .views-reset-btn-h":"resetView","click .sport-reset-btn-h":"resetSport","click .location-reset-btn-h":"resetLocation","click .reset-all-btn-h":"resetAll"},demoSelect:function(){},resetAll:function(){this.resetView(),this.resetLocation(),this.resetSport()},resetView:function(){var e="view";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-view-area-h ul li a.select, .reset-view-area-h ul li.select").removeClass("select")},resetSport:function(){var e="sports";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-sport-area-h ul li a.select, .reset-sport-area-h ul li.select").removeClass("select")},resetLocation:function(){var e="location";Channel("resetFilter").publish(e),this.$el.find("#city").val(""),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-location-area-h ul li a.select, .reset-location-area-h ul li.select").removeClass("select")},template:t,intialize:function(e){s.prototype.initialize.call(this,e),console.log("intializwe menu view ----------->>>")},updateSearch:function(e){Channel("textChanged").publish($(e.target).val())},changeBaseUrl:function(e){var t=$(e.currentTarget);t.parents("ul").find(".restype").removeClass("select"),t.addClass("select");var n=t.data("number");Channel("baseUrlChanged").publish(n)},stateListChange:function(e){var t=$(e.currentTarget).val();console.log(t);var n=t.data("id");routing.trigger("stateChanged",n)},doNothing:function(e){e.preventDefault(),e.stopPropagation()},hideDropdown:function(){this.$el.find(".menu-detail-h").hide()},hideAllDropdowns:function(){var e=this;$("html, #search").click(function(t){try{console.log($(t.target).parents("#views").length)}catch(t){console={},console.log=function(e){}}$(t.target).parents(".menu").length||e.hideDropdown()})},showMenuDropdown:function(e){var t=$(e.currentTarget).next();t.css("display")=="none"?(this.$el.find(".menu-detail-h").hide(),t.show()):t.hide()},select:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),n=t.attr("class");$(".dropdown-menu > li > a."+n).removeClass("select"),n=t.attr("class").split(" ")[0],$(t).addClass("select");var r={submenu:n,value:$(t).data("id")||$(t).text()};Channel("viewFilterChanged").publish(r),debug.log(r)},toggle:function(e){e.preventDefault();var t=$(e.currentTarget),n=$(t).offset(),r=n.top+40,i=n.left+10,s=t.attr("id");s="#"+s+" .dd",$(s).attr("class")==="dd open"?$(s).hide().removeClass("open"):($(".open").hide().removeClass("open"),$(s).css("top",r).css("left",i),$(s).show(),$(s).addClass("open"))},afterRender:function(){this.hideAllDropdowns();var e=this,t=setInterval(function(){try{$(e.el).find(".sport-list").slimScroll(),clearInterval(t)}catch(n){}},1e3),n=this.model.toJSON();try{console.error(n.views)}catch(r){console={},console.log=function(e){}}}}),n}),define("text!media/templates/image-item.html",[],function(){return'<a href="{{_link}}" data-index="{{index}}" class="image-outer-h {{^_has_link}}open-photo-player-h{{/_has_link}}">\r\n	<div class="image-item-container">\r\n		{{#_thumbnail}}<img class="list-thumbnail" src="{{_thumbnail}}" alt=""/>{{/_thumbnail}}\r\n		{{^_thumbnail}}\r\n			<div class="game-tile">{{_noicon_text}}</div>\r\n		{{/_thumbnail}}\r\n		<div class="action-section">\r\n			{{#show_edit}}\r\n				<!--<div class="action-block left-block edit edit-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>edit</span></div>-->\r\n				<div class="action-block right-block delete delete-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>delete</span></div>\r\n			{{/show_edit}}\r\n			{{^show_edit}}\r\n				<div class="action-block left-block vote vote-h {{#_has_voted}} link-disabled {{/_has_voted}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}">\r\n					<span>vote</span>\r\n				</div>\r\n				{{#_can_follow}}\r\n				<div class="action-block right-block follow follow-h {{#_is_following}} link-disabled {{/_is_following}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>follow</span></div>\r\n				{{/_can_follow}}\r\n			{{/show_edit}}\r\n		</div>\r\n		<div class="detail-view {{#_detailclass}}{{_detailclass}}{{/_detailclass}}">\r\n			<h6>{{_label}}</h6>\r\n			<span>{{& _sublabel}}</span>\r\n		</div>\r\n	</div>\r\n</a>'}),define("votes/models/vote",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/vote/add?subject_type_id="+this.entity_id+"&subject_id="+this.subject_id},setData:function(){this.set({subject_type_id:this.entity_id,subject_id:this.subject_id})}}),n}),define("votes/models/follow",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/ent/follow/"+this.entity_id+"/"+this.subject_id}}),n}),define("common/models/delete",["models","facade"],function(e,t){var n=e.BaseModel,r=t.Backbone,i=t.$,s=t._;return n.extend({subject_id:undefined,enttypes_id:undefined,removeNode:undefined,id:1,url:function(){return"/api/ent/delete/"+this.enttypes_id+"/"+this.subject_id},destroyAndRemove:function(){if(confirm("Are you sure you want to delete this?")){var e=this;this.destroy({success:function(t,n){e.removeNode.remove()}})}}})}),define("media/views/image-item",["vendor","views","utils","text!media/templates/image-item.html","votes/models/vote","votes/models/follow","utils/storage","chrome/views/header","common/models/delete"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=require("votes/models/vote"),f=require("utils/storage"),l=require("votes/models/follow"),c=require("common/models/delete"),h=require("chrome/views/header");return i=o.extend({tagName:"li",className:"image",events:{"click .vote-h":"vote","click .follow-h":"follow","click .edit-h":"edit","click .delete-h":"delete"},initialize:function(e){this.template=r;if(e.length)for(var t in e)this[t]=e[t]},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},render:function(){function b(e){console.log(s(this),e)}console.log("in render");var e=this,t=this.model.attributes.payload,n={_enttypes_id:t.enttypes_id,_id:t.id,_has_voted:t.has_voted,_is_following:t.is_following,_can_follow:t.can_follow},r=!1,i=null,o=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},a=!1;switch(t.enttypes_id){case"23":typeof t.standard_thumb=="object"?(i=t.standard_thumb,n._thumbnail=i.url):n._thumbnail=t.thumbs,a=!0,n._enttypes_id=typeof (t.media=="object")?t.media.enttypes_id:0,n._id=typeof (t.media=="object")?t.media.id:0,n._label=t.media.name,n._link="javascript: void(0);",n._has_link=!1,t.media.hasOwnProperty("is_owner")&&(r=t.media.is_owner),n._noicon_text="play";break;case"21":n._enttypes_id=typeof (t.media_obj=="object")?t.media_obj.enttypes_id:0,n._id=typeof (t.media_obj=="object")?t.media_obj.id:0,typeof t.types=="object"&&(typeof t.types.standard_thumb=="object"?(i=t.types.standard_thumb,n._thumbnail=i.url):typeof t.types.large_thumb=="object"?(i=t.types.large_thumb,n._thumbnail=i.url):typeof t.types.original=="object"&&(i=t.types.original,n._thumbnail=i.url)),n._label=_.isUndefined(t.media_obj.users_obj.label)?"":t.media_obj.users_obj.label,typeof t.media_obj.sports_obj=="object"&&(n._sublabel=o(t.media_obj.sports_obj.sport_name)),n._link="javascript: void(0);",n._has_link=!1,t.media_obj.hasOwnProperty("is_owner")&&(r=t.media_obj.is_owner),n._noicon_text="view";break;case"1":typeof t.user_picture_obj=="object"&&typeof t.user_picture_obj.types=="object"&&(typeof t.user_picture_obj.types.standard_thumb=="object"?(i=t.user_picture_obj.types.standard_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.large_thumb=="object"?(i=t.user_picture_obj.types.large_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.original=="object"&&(i=t.user_picture_obj.types.original,n._thumbnail=i.url)),n._noicon_text="hi",n._label=t.label,n._sublabel="Votes: "+t.num_votes+", Followers: "+t.num_followers,n._link="/#profile/"+t.id,n._has_link=!0,t.hasOwnProperty("is_owner")&&(r=t.is_owner);break;case"8":n._detailclass="game",i=t.game_picture!==null?t.game_picture.types.standard_thumb:!1,n._thumbnail=i.url,n._label=t.game_day,n._link="/#game/"+t.id,n._has_link=!0;var f="",l=t.teams;if(l!=null)var c=l.length;console.log(t);for(var h=0;h<c;h++)f+="<span>",f+=o(t.teams[h].team_name),f+="</span>";t.hasOwnProperty("is_owner")&&(r=t.is_owner),f!=""?n._sublabel=f:n._sublabel=t.event_name,n._noicon_text="vs",console.log(n)}n.show_edit=r==1?!0:undefined;var p=u.to_html(this.template,n);this.$el.html(p);var d="120px",v="92px";this.$el.find(".image-item-container").mouseout(function(){s(this).find(".action-block").css({opacity:0}),s(this).find(".detail-view").css({bottom:"-"+v}),s(this).find(".detail-view.game").css({bottom:"-"+d})});if(i!="undefined"&&i!=null){var m=i.width/220,g=i.height/220;i.width=parseInt(i.width),i.height=parseInt(i.height);var y=i.width>i.height?-(i.width/g-220)/2:-(i.height/m-220)/2;y>0&&(y=0),i.width>i.height?this.$el.find("img.list-thumbnail").css({"max-width":i.width/g,left:y}):this.$el.find("img.list-thumbnail").css({"max-height":i.height/m,top:y})}return a&&this.$el.append('<div class="circle open-photo-player-h"><div class="play"></div></div>'),this.$el.find(".image-item-container").mouseover(function(){s(this).find(".detail-view").css({bottom:"0px"}),s(this).find(".action-block").css({opacity:90})}),this.$el.find(".circle").mouseover(function(){s(this).parent().find(".detail-view").css({bottom:"0px"}),s(this).parent().find(".action-block").css({opacity:90})}),this.$el.find(".vote-h").click(function(t){e.vote(t)}),this.$el.find(".follow-h").click(function(t){e.follow(t)}),this.$el.find(".edit-h").click(function(t){e.edit(t)}),this.$el.find(".delete-h").click(function(t){e["delete"](t)}),this},vote:function(e){e.preventDefault(),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}var t=new a;t.subject_id=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,t.setData(),t.save(),s.when(t.request).done(function(){s(e.currentTarget).addClass("link-disabled")})},follow:function(e){e.preventDefault(),console.log(e.target),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}var t=new l;t.subject_id=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,console.log(t),t.save(),s.when(t.request).done(function(){typeof t.get("payload").follower=="object"&&typeof t.get("payload").subject=="object"&&t.get("payload").id>0?s(e.currentTarget).addClass("link-disabled"):console.log("FAIL")})},edit:function(e){e.stopPropagation(),e.preventDefault();var t=this,n=this.model.get("payload");switch(n.enttypes_id){case"23":break;case"21":break;case"1":window.location.hash="profile/"+n.id;break;case"8":window.location.hash="game/"+n.id}console.log(this.model)},"delete":function(e){e.stopPropagation(),e.preventDefault(),console.log(this.model);var t=this,n=new c;n.subject_id=s(e.currentTarget).attr("subject-id"),n.enttypes_id=s(e.currentTarget).attr("subject-type-id"),n.removeNode=s(e.currentTarget).parents("li.image"),n.destroyAndRemove()}}),i}),define("pages/home/views/image-list",["facade","views","utils","media/views/image-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"image-list",name:"Image List",tagName:"ul",_tagName:"li",_className:"image",events:{"click .open-photo-player-h":"initPhotoPlayer"},_view:r,initialize:function(e){var t=this;this.name=e.name||this.name,f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");u.bindAll(this),this.addSubscribers()},initPhotoPlayer:function(e){e.preventDefault(),console.log(this.collection);var t=o(e.target).parents("li").index();routing.trigger("photo-player-init",t,this.collection,this.collection.id)},childViews:{}}),i}),define("text!packages/location/templates/state-item.html",[],function(){return'{{#payload}}\r\n<div data-id="{{id}}" class="state-{{id}}">{{name}}</div>\r\n{{/payload}}\r\n\r\n'}),define("packages/location/views/state-item",["vendor","views","utils","text!packages/location/templates/state-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"state",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeState:function(){console.log(this.model),Channel("stateChanged:"+this.model.collection.cid).publish(this.model)}}),i}),define("packages/location/views/state-list",["facade","views","utils","packages/location/views/state-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"state-list",name:"State List",tagName:"ul",_tagName:"li",_className:"state",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("StateListView expected options.collection.");u.bindAll(this),this.addSubscribers()},childViews:{}}),i}),define("pages/home/views/state-list",["facade","views","utils","packages/location/views/state-list"],function(e,t,n,r){var i,s=e.$,o=e._,u=n.lib.Channel,a=t.SectionView;return i=r.extend({tagName:"select",_tagName:"option",events:{change:"changeState"},initialize:function(e){r.prototype.initialize.call(this,e),this.id=e.id||this.id||o.uniqueId("v")},changeState:function(e){console.log(this.collection);var t=s(e.target).val(),n="";this.collection.each(function(e){e.get("payload").name==t&&(n=e.get("payload").id)}),n!=""&&(console.log("sdsd"),routing.trigger("stateChanged",n))}}),i}),define("text!sport/templates/sport-item.html",[],function(){return'{{#payload}}\r\n<a href="javascript: void(0);">\r\n<img src="{{small_icon}}" class="tiny-sport-icon"/>{{sport_name}}</a>\r\n{{/payload}}'}),define("sport/views/sport-item",["vendor","views","utils","text!sport/templates/sport-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"sport",events:{},initialize:function(e){this.template=r},render:function(){var e=this,t=u.to_html(this.template,this.model.toJSON());return this.$el.html(t),this.$el.find("a").click(function(){e.selectSport()}),this},selectSport:function(){debug.log(this.model),s("li.sport").removeClass("select"),this.$el.addClass("select"),Channel("sportChanged:"+this.model.collection.cid).publish(this.model)}}),i}),define("packages/sport/views/sport-list",["facade","views","utils","sport/views/sport-item","jqueryui","jquery.slimscroll"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=n.debug;return CollectionView=t.CollectionView,SectionView=t.SectionView,s=CollectionView.extend(SectionView.prototype),i=s.extend({__super__:CollectionView.prototype,className:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){s.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");u.bindAll(this),this.name=e.name||this.name,this._tagName=e._tagName||this._tagName,this.tagName=e.tagName||this.tagName,this._className=e._className||this._className,this._view=e._view||this._view,this.addSubscribers()},initScroll:function(){o("."+this.className).slimScroll({height:"200px"})},addSubscribers:function(){var e=this;a("layout:ready").subscribe(e.initScroll)},childViews:{}}),i}),define("text!location/templates/city.html",[],function(){return'<input id="city" type="text" placeholder="Enter a City"/>'}),define("packages/location/views/city",["require","text!location/templates/city.html","views","facade","utils","jqueryui","controller"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("controller");return n=o.extend({template:t,className:"ui-front",initialize:function(e){o.prototype.initialize.call(this,e),this.id=e.id||this.id||a.unique("v"),this.addSubscribers()},initPlugin:function(){var e=this,t=this.model.id;u("#city").autocomplete({minLength:2,source:function(e,n){var r=e.term,i=l.prototype.appStates;if(i){var s=i.findByNameInStorage(r);if(s){n(s.data);return}}var o=function(e){var t=l.prototype.appStates;t&&(t.add({name:r,data:e,storage:"localStorage",expires:new Date(Date.now()+3154e5)}),t.save(r)),n(e)};Channel("response :"+r).subscribe(o),Channel("changeInput"+t).publish(r)},select:function(t,n){Channel("cityChanged:"+e.id).publish(n.item),f.log(n.item)}})},addSubscribers:function(){var e=this;Channel("layout:ready").subscribe(e.initPlugin)}}),n}),define("home",["require","text!pages/home/templates/layout.html","facade","controller","models","views","utils","pages/home/models/menu","packages/location/models/city","signup/models/registerbasic","packages/sport/collections/sports","pages/home/collections/image","location/collections/states","pages/home/views/menu","pages/home/views/image-list","pages/home/views/state-list","packages/sport/views/sport-list","signup/views/registerbasic","packages/location/views/city"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("packages/sport/collections/sports"),f=e("location/collections/states"),l=e("pages/home/collections/image"),c=e("pages/home/models/menu"),h=e("packages/location/models/city"),p=e("signup/models/registerbasic"),d=e("pages/home/views/menu"),v=e("signup/views/registerbasic"),m=e("pages/home/views/image-list"),g=e("pages/home/views/state-list"),y=e("packages/sport/views/sport-list"),b=e("packages/location/views/city"),w=o.LayoutView,E=r.$,S=r._,x=u.lib.Channel,T=[base_url+"pages/home/home.css"];return n=i.extend({searchPage:0,initialize:function(e){return x("load:css").publish(T),S.bindAll(this),this.handleOptions(e),e.userId&&(this.userId=e.userId),this.scheme=[],this.genderTypes=["boys","girls","both"],this.init(),this},init:function(){this.initUrlOptions(),this.createData(),this.handleDeferreds()},initUrlOptions:function(){this.searchUrls=["/api/video/search","/api/image/search","/api/user/search","/api/game/search"],this.baseUrl=this.searchUrls[2],this.urlOptions={sports_id:"0",cities_id:"0",orderby:"random",time:"DAY",states_id:"0",searchtext:"",country_id:"0"},this.menuValues=[{src:".view-options-h .browse.select",target:".view-link-h .option-heading-h",input:!1,defaultValue:"ORDER"},{src:".sports-option-h .sport.select",target:".sport-link-h .option-heading-h",input:!1,defaultValue:"ALL SPORTS"},{src:"#city",target:".location-link-h .option-heading-h",input:!0,defaultValue:"ANYWHERE"},{src:"#resulttype a.restype.select",target:".restype-link-h .option-heading-h",input:!1,defaultValue:"ATHLETES"}],this.viewOptions=["orderby","time"],this.sportsOptions=["sports_id"],this.locationOptions=["cities_id","states_id","country_id"]},addSubscribers:function(){var e=this;S.each(this.genderTypes,function(e){x("sportChanged:"+this.collections[e].cid).subscribe(this.changeSportFilter)},this),x("cityChanged:"+this.sections.city.id).subscribe(this.changeCityFilter),routing.on("stateChanged",function(t){e.changeStateFilter(t)}),x("textChanged").subscribe(this.updateText),x("viewFilterChanged").subscribe(this.changeViewFilter),x("baseUrlChanged").subscribe(this.updateBaseUrl),x("resetFilter").subscribe(this.resetFilter)},setupScheme:function(){var e,t=this.params;for(e=0;e<this.meta.activeViews.length;e++)this.scheme.push(this.sections[this.meta.activeViews[e]])},initSections:function(){this.setupMenuView(),S.each(this.genderTypes,this.setupSportListView),S.each(["top-rated","search-result"],this.setupImageListView),this.setupLocationDDView(),this.setupScheme(),this.setupLayout().render(),this.setUpRegistrationView(),this.cityView&&this.cityView.initPlugin(),this.userId&&E(".register-wrapper, .register-wrapper-h").hide().html("")},updateBaseUrl:function(e){this.baseUrl=this.searchUrls[e],this.transitionView()},updateText:function(e){this.urlOptions.searchtext=e,this.transitionView()},changeViewFilter:function(e){e.submenu==="browse"?options={orderby:e.value}:options={time:e.value},options.orderby=="random"?E(".left-arrow-page").fadeOut():E(".left-arrow-page").fadeIn(),this.transitionView(options)},changeSportFilter:function(e){console.log(e);var t={sports_id:e.attributes.payload.sport_id};this.transitionView(t)},changeStateFilter:function(e){var t={states_id:e};this.transitionView(t)},changeCityFilter:function(e){e.label&&E("#city").val(e.label);var t={cities_id:e.id,states_id:e.state_id,country_id:e.country_id};this.transitionView(t)},resetFilter:function(e){for(var t in this.menuValues)this.menuValues[t].input?E(this.menuValues[t].src).val(""):E(this.menuValues[t].src).removeClass("select");switch(e){case"view":for(var t in this.viewOptions)this.viewOptions[t]=="orderby"?(E(".dropdown-menu .browse").removeClass("select"),this.urlOptions[this.viewOptions[t]]="random"):t=="time"&&(this.urlOptions[this.viewOptions[t]]="today");break;case"sports":for(var t in this.sportsOptions)this.urlOptions[this.sportsOptions[t]]="0";break;case"location":for(var t in this.locationOptions)this.urlOptions[this.locationOptions[t]]="0"}this.transitionView()},transitionView:function(e){this.searchPage=0,this.searchView(e)},searchView:function(e){var t=this,n="search-result",r=this.collections[n];controller=this,r.url=this.url(e),r.targetElement="#search-result",r.fetch(),E.when(r.request).done(function(){r.length<12?E(".right-arrow-page-h").addClass("disable-arrow-link"):E(".right-arrow-page-h").removeClass("disable-arrow-link"),t.searchPage==0||controller.urlOptions.orderby=="random"?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link");var e=new m({collection:r,name:n,destination:"#"+n,user_id:this.userId});controller.layout.transition(n,e)});for(var i in this.menuValues){if(this.menuValues[i].input)var s=E(this.menuValues[i].src).val();else var s=E(this.menuValues[i].src).text();s!=""?E(this.menuValues[i].target).html(s):E(this.menuValues[i].target).html(this.menuValues[i].defaultValue)}},bindCickEvents:function(){var e=this;E(document).on("click",".left-arrow-page-h",function(){e.searchPage-=12,e.searchView()}),E(document).on("click",".right-arrow-page-h",function(){e.searchPage+=12,e.searchView()}),e.searchPage==0?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link")},url:function(e){var t=this.baseUrl+"?offset="+this.searchPage+"&";S.extend(this.urlOptions,e);var n=[];return E.each(this.urlOptions,function(e,t){n.push(e+"="+encodeURIComponent(t))}),t+n.join("&")},createData:function(){var e=this;e.collections={},e.collections["search-result"]=new l([],{url:e.url(),num:"12",targetElement:"#search-result"}),e.collections.state=new f,e.collections["top-rated"]=new l([],{url:"/api/user/search",num:"4",targetElement:"#top-rated"}),S.each(e.genderTypes,function(t){e.collections[t]=new a([],{name:t})})},handleDeferreds:function(){var e=this,t=[];S.each(this.collections,function(e,n,r){t.push(e.fetch())}),E.when.apply(E,t).done(e.initSections,e.addSubscribers)},setupImageListView:function(e){var t;t=new m({collection:this.collections[e],name:e,destination:"#"+e,user_id:this.userId}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setupSportListView:function(e){var t;t=new y({collection:this.collections[e],name:e,id:e,destination:"#sport #"+e}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setUpRegistrationView:function(){var e;this.select_type=new p,this.selectTypeView=new v({model:this.select_type,name:"Select Registration Type",destination:".register-wrapper-h",openAsaPage:!0})},setupMenuView:function(){var e=new c,t,n="menu";t=new d({model:e,name:n,destination:"#"+n}),t.render(),this.sections[n]=t,this.meta.activeViews.push(n)},setupLocationDDView:function(){var e,t="state",n=new h,r="city";this.cityView=new b({model:n,name:r,destination:"#location .city"}),this.cityView.render(),this.sections[r]=this.cityView,this.meta.activeViews.push(r)},setupLayout:function(){var e;return e=new w({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.bindCickEvents(),this.layout}}),n}),define("text!videopreview/templates/basic.html",[],function(){return'<div id="imgUploadModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n		<h3 id="label">Video Uploader</h3>\r\n	</div>\r\n\r\n	<div class="modal-body">\r\n		<div id="main-content-img" class="video"></div>\r\n\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n\r\n</div>'}),define("videopreview/models/base",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{URL:window.URL||window.webkitURL}),files:[],initialize:function(){!this.URL},playSelectedFile:function(e){var t=this.files[0],n=t.type,r=document.querySelector("video"),i=r.canPlayType(n);i=i===""?"no":i;var s='Can play type "'+n+'": '+i,o=i==="no";this.displayMessage(s,o);if(o)return;var u=this.URL.createObjectURL(t);r.src=u}}),n}),define("videopreview/models/videoup",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({initialize:function(e){},doUpload:function(e){return new plupload.Uploader({runtimes:"html5,gears,flash,silverlight,browserplus",browse_button:"pickfiles",container:"container_plupload",max_file_size:"500mb",max_file_count:1,chunk_size:"5mb",url:e,unique_names:!0,flash_swf_url:"/plupload/js/plupload.flash.swf",silverlight_xap_url:"/plupload/js/plupload.silverlight.xap",filters:[{title:"Video files",extensions:"mov,mp4,mpeg4,avi,mkv,webm,ogg"}],multipart_params:{title:""},init:{ChunkUploaded:function(e,t,n){console.log(t,n)},FileUploaded:function(e,t,n){$("#"+t.id+" b").html("100%"),$("#uploadfiles").removeClass("isUploading"),e.refresh(),$("form.form input").val("");var r=$.parseJSON(n.response);console.log(r),r.result=="success"&&$("#resultdiv").html("SUCCESS! Your video has been uploaded and is now being encoded.  This may take a few minutes.  You will receive an email when the video is ready to view.  If anything goes wrong you can refer to the encode job ID: "+r.jobID).show(),console.log(t,n)}}})}}),n}),define("text!videopreview/templates/upload.html",[],function(){return'<!--<input type="file" id="chooseVideoFile" accept="video/*"/>\r\n<form>\r\n	<div id="container">\r\n		<div id="pickfiles">Find a Video</div>\r\n		<div class="modal-footer">\r\n			<button class="btn fileuploader btn-primary" id="videoup" type="button">Upload</button>\r\n			<button class="btn" data-dismiss="modal"  aria-hidden="true">Close</button>\r\n		</div>\r\n	</div>\r\n</form>-->\r\n\r\n<div id="file_upload"></div>\r\n<form class="form" id="upload_form" method="post">\r\n	<div id="container_plupload">\r\n\r\n	<div style="padding:5px 0 20px 10px;">The video uploader will let you upload large videos to our servers.  Once the upload is finished, it takes a couple minutes for everything to process.\r\n	So nothing will happen right away, but it will be on your profile within a couple minutes of when you hit upload.</div>\r\n	<span class="file-wrapper">\r\n				<div class="qq-upload-button" id="pickfiles" style="float:left; width:95%;">\r\n					<a class="btn-common common-default-sky-dark">Select a Video File</a>\r\n					<span style="font-size:11px; display:block; color:#880000;" id="fileVal"></span>\r\n				</div></span><br/>\r\n		<input type="text" id="title" name="title" style="width:95%" placeholder="Enter a Title"/>\r\n		<label style="margin-bottom: 2px;">Sport</label>\r\n		<select name="sports_id" id="sports_id" style="width:95%;" class="">\r\n			<option value="1">Baseball (Men\'s)</option>\r\n			<option value="2">Basketball (Men\'s)</option>\r\n			<option value="20">Basketball (Women\'s)</option>\r\n			<option value="52">Beach Volleyball (Individual)</option>\r\n			<option value="53">Boxing (Men\'s)</option>\r\n			<option value="54">Boxing (Women\'s)</option>\r\n			<option value="55">Brazilian Jujitsu (Men\'s)</option>\r\n			<option value="56">Brazilian Jujitsu (Women\'s)</option>\r\n			<option value="22">Cheerleading (Women\'s)</option>\r\n			<option value="19">Crew (Men\'s)</option>\r\n			<option value="35">Crew (Women\'s)</option>\r\n			<option value="3">Cross Country (Men\'s)</option>\r\n			<option value="21">Cross Country (Women\'s)</option>\r\n			<option value="74">Crossfit (Individual)</option>\r\n			<option value="72">Cycling (Individual)</option>\r\n			<option value="39">Diving (Men\'s)</option>\r\n			<option value="47">Diving (Women\'s)</option>\r\n			<option value="41">Fencing (Men\'s)</option>\r\n			<option value="42">Fencing (Women\'s)</option>\r\n			<option value="34">Field Hockey (Women\'s)</option>\r\n			<option value="6">Football (Men\'s)</option>\r\n			<option value="82">Golf (Individual)</option>\r\n			<option value="8">Golf (Team) (Men\'s)</option>\r\n			<option value="23">Golf (Team) (Women\'s)</option>\r\n			<option value="36">Gymnastics (Men\'s)</option>\r\n			<option value="43">Gymnastics (Women\'s)</option>\r\n			<option value="9">Hockey (Men\'s)</option>\r\n			<option value="24">Hockey (Women\'s)</option>\r\n			<option value="40">Indoor Track (Men\'s)</option>\r\n			<option value="46">Indoor Track (Women\'s)</option>\r\n			<option value="62">Karate (Men\'s)</option>\r\n			<option value="63">Karate (Women\'s)</option>\r\n			<option value="64">Kickboxing (Men\'s)</option>\r\n			<option value="65">Kickboxing (Women\'s)</option>\r\n			<option value="10">Lacrosse (Men\'s)</option>\r\n			<option value="25">Lacrosse (Women\'s)</option>\r\n			<option value="50">Long Distance Running (Individual)</option>\r\n			<option value="57">MMA (Men\'s)</option>\r\n			<option value="58">MMA (Women\'s)</option>\r\n			<option value="78">Mountain Climbing (Individual)</option>\r\n			<option value="37">Rifle (Men\'s)</option>\r\n			<option value="44">Rifle (Women\'s)</option>\r\n			<option value="7">Rugby (Men\'s)</option>\r\n			<option value="38">Skiing (Men\'s)</option>\r\n			<option value="45">Skiing (Women\'s)</option>\r\n			<option value="11">Soccer (Men\'s)</option>\r\n			<option value="27">Soccer (Women\'s)</option>\r\n			<option value="26">Softball (Women\'s)</option>\r\n			<option value="70">Spartan Race (Individual)</option>\r\n			<option value="48">Squash (Men\'s)</option>\r\n			<option value="49">Squash (Women\'s)</option>\r\n			<option value="76">Surfing (Individual)</option>\r\n			<option value="68">Swimming (Individual)</option>\r\n			<option value="12">Swimming (Team) (Men\'s)</option>\r\n			<option value="28">Swimming (Team) (Women\'s)</option>\r\n			<option value="66">Tennis (Individual)</option>\r\n			<option value="14">Tennis (Team) (Men\'s)</option>\r\n			<option value="30">Tennis (Team) (Women\'s)</option>\r\n			<option value="15">Track and Field (Men\'s)</option>\r\n			<option value="31">Track and Field (Women\'s)</option>\r\n			<option value="51">Triathalon (Individual)</option>\r\n			<option value="16">Volleyball (Men\'s)</option>\r\n			<option value="32">Volleyball (Women\'s)</option>\r\n			<option value="17">Water Polo (Men\'s)</option>\r\n			<option value="33">Water Polo (Women\'s)</option>\r\n			<option value="18">Wrestling (Men\'s)</option>\r\n		</select>\r\n\r\n		<div id="uploadfiles" class="common-default-sky-dark btn-common" style="width:70px;">Upload</div>\r\n		<div id="filelist"></div>\r\n	</div>\r\n</form>\r\n\r\n<div id="resultdiv" style="display: none; padding-left: 10px;"></div></div>'}),function(){function l(){this.returnValue=!1}function c(){this.cancelBubble=!0}var e=0,t=[],n={},r={},i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},s=/[<>&\"\']/g,o,u=window.setTimeout,a={},f;(function(e){var t=e.split(/,/),n,i,s;for(n=0;n<t.length;n+=2){s=t[n+1].split(/ /);for(i=0;i<s.length;i++)r[s[i]]=t[n]}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var h={VERSION:"1.5.4",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:r,ua:function(){var e=navigator,t=e.userAgent,n=e.vendor,r,i,s;return r=/WebKit/.test(t),s=r&&n.indexOf("Apple")!==-1,i=window.opera&&window.opera.buildNumber,{windows:navigator.platform.indexOf("Win")!==-1,ie:!r&&!i&&/MSIE/gi.test(t)&&/Explorer/gi.test(e.appName),webkit:r,gecko:!r&&/Gecko/.test(t),safari:s,opera:!!i}}(),typeOf:function(e){return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(e){return h.each(arguments,function(t,n){n>0&&h.each(t,function(t,n){e[n]=t})}),e},cleanName:function(e){var t,n;n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,""),e},addRuntime:function(e,n){return n.name=e,t[e]=n,t.push(n),n},guid:function(){var t=(new Date).getTime().toString(32),n;for(n=0;n<5;n++)t+=Math.floor(Math.random()*65535).toString(32);return(h.guidPrefix||"p")+t+(e++).toString(32)},buildUrl:function(e,t){var n="";return h.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},each:function(e,t){var n,r,i;if(e){n=e.length;if(n===o){for(r in e)if(e.hasOwnProperty(r)&&t(e[r],r)===!1)return}else for(i=0;i<n;i++)if(t(e[i],i)===!1)return}},formatSize:function(e){return e===o||/\D/.test(e)?h.translate("N/A"):e>1073741824?Math.round(e/1073741824,1)+" GB":e>1048576?Math.round(e/1048576,1)+" MB":e>1024?Math.round(e/1024,1)+" KB":e+" b"},getPos:function(e,t){function a(e){var t,n,r=0,i=0;return e&&(n=e.getBoundingClientRect(),t=s.compatMode==="CSS1Compat"?s.documentElement:s.body,r=n.left+t.scrollLeft,i=n.top+t.scrollTop),{x:r,y:i}}var n=0,r=0,i,s=document,o,u;e=e,t=t||s.body;if(e&&e.getBoundingClientRect&&navigator.userAgent.indexOf("MSIE")>0&&s.documentMode<8)return o=a(e),u=a(t),{x:o.x-u.x,y:o.y-u.y};i=e;while(i&&i!=t&&i.nodeType)n+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;i=e.parentNode;while(i&&i!=t&&i.nodeType)n-=i.scrollLeft||0,r-=i.scrollTop||0,i=i.parentNode;return{x:n,y:r}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSize:function(e){var t;return typeof e=="string"&&(e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],t=="g"&&(e*=1073741824),t=="m"&&(e*=1048576),t=="k"&&(e*=1024)),e},xmlEncode:function(e){return e?(""+e).replace(s,function(e){return i[e]?"&"+i[e]+";":e}):e},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},inArray:function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1},addI18n:function(e){return h.extend(n,e)},translate:function(e){return n[e]||e},isEmptyObj:function(e){if(e===o)return!0;for(var t in e)return!1;return!0},hasClass:function(e,t){var n;return e.className==""?!1:(n=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),n.test(e.className))},addClass:function(e,t){h.hasClass(e,t)||(e.className=e.className==""?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return t===" "&&n===" "?" ":""})},getStyle:function(e,t){if(e.currentStyle)return e.currentStyle[t];if(window.getComputedStyle)return window.getComputedStyle(e,null)[t]},addEvent:function(e,t,n){var r,i,s,u;u=arguments[3],t=t.toLowerCase(),f===o&&(f="Plupload_"+h.guid()),e.addEventListener?(r=n,e.addEventListener(t,r,!1)):e.attachEvent&&(r=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=l,e.stopPropagation=c,n(e)},e.attachEvent("on"+t,r)),e[f]===o&&(e[f]=h.guid()),a.hasOwnProperty(e[f])||(a[e[f]]={}),i=a[e[f]],i.hasOwnProperty(t)||(i[t]=[]),i[t].push({func:r,orig:n,key:u})},removeEvent:function(e,t){var n,r,i;typeof arguments[2]=="function"?r=arguments[2]:i=arguments[2],t=t.toLowerCase();if(!(e[f]&&a[e[f]]&&a[e[f]][t]))return;n=a[e[f]][t];for(var s=n.length-1;s>=0;s--)if(n[s].key===i||n[s].orig===r){e.removeEventListener?e.removeEventListener(t,n[s].func,!1):e.detachEvent&&e.detachEvent("on"+t,n[s].func),n[s].orig=null,n[s].func=null,n.splice(s,1);if(r!==o)break}n.length||delete a[e[f]][t];if(h.isEmptyObj(a[e[f]])){delete a[e[f]];try{delete e[f]}catch(u){e[f]=o}}},removeAllEvents:function(e){var t=arguments[1];if(e[f]===o||!e[f])return;h.each(a[e[f]],function(n,r){h.removeEvent(e,r,t)})}};h.Uploader=function(e){function f(){var e,t=0,n;if(this.state==h.STARTED){for(n=0;n<i.length;n++)!e&&i[n].status==h.QUEUED?(e=i[n],e.status=h.UPLOADING,this.trigger("BeforeUpload",e)&&this.trigger("UploadFile",e)):t++;t==i.length&&(this.stop(),this.trigger("UploadComplete",i))}}function l(){var e,t;r.reset();for(e=0;e<i.length;e++)t=i[e],t.size!==o?(r.size+=t.size,r.loaded+=t.loaded):r.size=o,t.status==h.DONE?r.uploaded++:t.status==h.FAILED?r.failed++:r.queued++;r.size===o?r.percent=i.length>0?Math.ceil(r.uploaded/i.length*100):0:(r.bytesPerSec=Math.ceil(r.loaded/((+(new Date)-s||1)/1e3)),r.percent=r.size>0?Math.ceil(r.loaded/r.size*100):0)}var n={},r,i=[],s,a=!1;r=new h.QueueProgress,e=h.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},e),h.extend(this,{state:h.STOPPED,runtime:"",features:{},files:i,settings:e,total:r,id:h.guid(),init:function(){function v(){var e=a[p++],t,r,i;if(e){t=e.getFeatures(),r=n.settings.required_features;if(r){r=r.split(",");for(i=0;i<r.length;i++)if(!t[r[i]]){v();return}}e.init(n,function(r){r&&r.success?(n.features=t,n.runtime=e.name,n.trigger("Init",{runtime:e.name}),n.trigger("PostInit"),n.refresh()):v()})}else n.trigger("Error",{code:h.INIT_ERROR,message:h.translate("Init error.")})}var n=this,r,a,c,p=0,d;typeof e.preinit=="function"?e.preinit(n):h.each(e.preinit,function(e,t){n.bind(t,e)}),e.page_url=e.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(e.url)||(e.url=e.page_url+e.url),e.chunk_size=h.parseSize(e.chunk_size),e.max_file_size=h.parseSize(e.max_file_size),n.bind("FilesAdded",function(t,r){var s,a,f=0,l,c=e.filters;c&&c.length&&(l=[],h.each(c,function(e){h.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?l.push("\\.*"):l.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),l=new RegExp(l.join("|")+"$","i"));for(s=0;s<r.length;s++){a=r[s],a.loaded=0,a.percent=0,a.status=h.QUEUED;if(l&&!l.test(a.name)){t.trigger("Error",{code:h.FILE_EXTENSION_ERROR,message:h.translate("File extension error."),file:a});continue}if(a.size!==o&&a.size>e.max_file_size){t.trigger("Error",{code:h.FILE_SIZE_ERROR,message:h.translate("File size error."),file:a});continue}i.push(a),f++}if(!f)return!1;u(function(){n.trigger("QueueChanged"),n.refresh()},1)}),e.unique_names&&n.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),r="tmp";n&&(r=n[1]),t.target_name=t.id+"."+r}),n.bind("UploadProgress",function(e,t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,l()}),n.bind("StateChanged",function(e){if(e.state==h.STARTED)s=+(new Date);else if(e.state==h.STOPPED)for(r=e.files.length-1;r>=0;r--)e.files[r].status==h.UPLOADING&&(e.files[r].status=h.QUEUED,l())}),n.bind("QueueChanged",l),n.bind("Error",function(e,t){t.file&&(t.file.status=h.FAILED,l(),e.state==h.STARTED&&u(function(){f.call(n)},1))}),n.bind("FileUploaded",function(e,t){t.status=h.DONE,t.loaded=t.size,e.trigger("UploadProgress",t),u(function(){f.call(n)},1)});if(e.runtimes){a=[],d=e.runtimes.split(/\s?,\s?/);for(r=0;r<d.length;r++)t[d[r]]&&a.push(t[d[r]])}else a=t;v(),typeof e.init=="function"?e.init(n):h.each(e.init,function(e,t){n.bind(t,e)})},refresh:function(){this.trigger("Refresh")},start:function(){i.length&&this.state!=h.STARTED&&(this.state=h.STARTED,this.trigger("StateChanged"),f.call(this))},stop:function(){this.state!=h.STOPPED&&(this.state=h.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(){a=arguments[0]!==o?arguments[0]:!0,this.trigger("DisableBrowse",a)},getFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e)return i[t]},removeFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){var n;return n=i.splice(e===o?0:e,t===o?i.length:t),this.trigger("FilesRemoved",n),this.trigger("QueueChanged"),n},trigger:function(e){var t=n[e.toLowerCase()],r,i;if(t){i=Array.prototype.slice.call(arguments),i[0]=this;for(r=0;r<t.length;r++)if(t[r].func.apply(t[r].scope,i)===!1)return!1}return!0},hasEventListener:function(e){return!!n[e.toLowerCase()]},bind:function(e,t,r){var i;e=e.toLowerCase(),i=n[e]||[],i.push({func:t,scope:r||this}),n[e]=i},unbind:function(e){e=e.toLowerCase();var t=n[e],r,i=arguments[1];if(t){if(i!==o){for(r=t.length-1;r>=0;r--)if(t[r].func===i){t.splice(r,1);break}}else t=[];t.length||delete n[e]}},unbindAll:function(){var e=this;h.each(n,function(t,n){e.unbind(n)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},h.File=function(e,t,n){var r=this;r.id=e,r.name=t,r.size=n,r.loaded=0,r.percent=0,r.status=0},h.Runtime=function(){this.getFeatures=function(){},this.init=function(e,t){}},h.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},h.runtimes={},window.plupload=h}(),function(){if(window.google&&google.gears)return;var e=null;if(typeof GearsFactory!="undefined")e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory"),e.getBuildInfo().indexOf("ie_mobile")!=-1&&e.privateSetGlobalObject(this)}catch(t){typeof navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-googlegears"]&&(e=document.createElement("object"),e.style.display="none",e.width=0,e.height=0,e.type="application/x-googlegears",document.documentElement.appendChild(e))}if(!e)return;window.google||(window.google={}),google.gears||(google.gears={factory:e})}(),function(e,t,n,r){function s(e,t,n){var r,i,s,o;i=google.gears.factory.create("beta.canvas");try{i.decode(e),t.width||(t.width=i.width),t.height||(t.height=i.height),o=Math.min(width/i.width,height/i.height);if(o<1||o===1&&n==="image/jpeg")return i.resize(Math.round(i.width*o),Math.round(i.height*o)),t.quality?i.encode(n,{quality:t.quality/100}):i.encode(n)}catch(u){}return e}var i={};n.runtimes.Gears=n.addRuntime("gears",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(r,o){function d(e){var t,s,o=[],u;for(s=0;s<e.length;s++)t=e[s],u=n.guid(),i[u]=t.blob,o.push(new n.File(u,t.name,t.blob.length));r.trigger("FilesAdded",o)}var u,l,h=!1;if(!e.google||!google.gears)return o({success:!1});try{u=google.gears.factory.create("beta.desktop")}catch(p){return o({success:!1})}r.bind("PostInit",function(){var e=r.settings,i=t.getElementById(e.drop_element);i&&(n.addEvent(i,"dragover",function(e){u.setDropEffect(e,"copy"),e.preventDefault()},r.id),n.addEvent(i,"drop",function(e){var t=u.getDragData(e,"application/x-gears-files");t&&d(t.files),e.preventDefault()},r.id),i=0),n.addEvent(t.getElementById(e.browse_button),"click",function(t){var n=[],r,i,s;t.preventDefault();if(h)return;e:for(r=0;r<e.filters.length;r++){s=e.filters[r].extensions.split(",");for(i=0;i<s.length;i++){if(s[i]==="*"){n=[];break e}n.push("."+s[i])}}u.openFiles(d,{singleFile:!e.multi_selection,filter:n})},r.id)}),r.bind("CancelUpload",function(){l.abort&&l.abort()}),r.bind("UploadFile",function(e,t){function v(){function y(r){var i,s="----pluploadboundary"+n.guid(),o="--",u="\r\n",f,h;a&&(l.setRequestHeader("Content-Type","multipart/form-data; boundary="+s),i=google.gears.factory.create("beta.blobbuilder"),n.each(n.extend(m,e.settings.multipart_params),function(e,t){i.append(o+s+u+'Content-Disposition: form-data; name="'+t+'"'+u+u),i.append(e+u)}),h=n.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",i.append(o+s+u+'Content-Disposition: form-data; name="'+e.settings.file_data_name+'"; filename="'+t.name+'"'+u+"Content-Type: "+h+u+u),i.append(r),i.append(u+o+s+o+u),f=i.getAsBlob(),p=f.length-r.length,r=f),l.send(r)}var s,a=e.settings.multipart,p=0,m={name:t.target_name||t.name},g=e.settings.url;if(t.status==n.DONE||t.status==n.FAILED||e.state==n.STOPPED)return;d&&(m.chunk=r,m.chunks=o),s=Math.min(u,t.size-r*u),a||(g=n.buildUrl(e.settings.url,m)),l=google.gears.factory.create("beta.httprequest"),l.open("POST",g),a||(l.setRequestHeader("Content-Disposition",'attachment; filename="'+t.name+'"'),l.setRequestHeader("Content-Type","application/octet-stream")),n.each(e.settings.headers,function(e,t){l.setRequestHeader(t,e)}),l.upload.onprogress=function(n){t.loaded=h+n.loaded-p,e.trigger("UploadProgress",t)},l.onreadystatechange=function(){var i;if(l.readyState==4&&e.state!==n.STOPPED)if(l.status==200){i={chunk:r,chunks:o,response:l.responseText,status:l.status},e.trigger("ChunkUploaded",t,i);if(i.cancelled){t.status=n.FAILED;return}h+=s,++r>=o?(t.status=n.DONE,e.trigger("FileUploaded",t,{response:l.responseText,status:l.status})):v()}else e.trigger("Error",{code:n.HTTP_ERROR,message:n.translate("HTTP Error."),file:t,chunk:r,chunks:o,status:l.status})},r<o&&y(i[t.id].slice(r*u,s))}var r=0,o,u,h=0,p=e.settings.resize,d;p&&/\.(png|jpg|jpeg)$/i.test(t.name)&&(i[t.id]=s(i[t.id],p,/\.png$/i.test(t.name)?"image/png":"image/jpeg")),t.size=i[t.id].length,u=e.settings.chunk_size,d=u>0,o=Math.ceil(t.size/u),d||(u=t.size,o=1),v()}),r.bind("DisableBrowse",function(e,t){h=t}),r.bind("Destroy",function(e){var r,i,s={browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(r in s)i=t.getElementById(s[r]),i&&n.removeAllEvents(i,e.id)}),o({success:!0})}})}(window,document,plupload),function(e,t,n,r){function o(e){var t,n=typeof e,i,s,u;if(e===r||e===null)return"null";if(n==="string")return t="\bb	t\nn\ff\rr\"\"''\\\\",'"'+e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(e,n){var r=t.indexOf(n);return r+1?"\\"+t.charAt(r+1):(e=n.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e)})+'"';if(n=="object"){i=e.length!==r,t="";if(i){for(s=0;s<e.length;s++)t&&(t+=","),t+=o(e[s]);t="["+t+"]"}else{for(u in e)e.hasOwnProperty(u)&&(t&&(t+=","),t+=o(u)+":"+o(e[u]));t="{"+t+"}"}return t}return""+e}function u(e){var t=!1,n=null,r=null,i,s,o,u,a,f=0;try{try{r=new ActiveXObject("AgControl.AgControl"),r.IsVersionSupported(e)&&(t=!0),r=null}catch(l){var c=navigator.plugins["Silverlight Plug-In"];if(c){i=c.description,i==="1.0.30226.2"&&(i="2.0.30226.2"),s=i.split(".");while(s.length>3)s.pop();while(s.length<4)s.push(0);o=e.split(".");while(o.length>4)o.pop();do u=parseInt(o[f],10),a=parseInt(s[f],10),f++;while(f<o.length&&u===a);u<=a&&!isNaN(u)&&(t=!0)}}}catch(h){t=!1}return t}var i={},s={};n.silverlight={trigger:function(e,t){var r=i[e],s,o;r&&(o=n.toArray(arguments).slice(1),o[0]="Silverlight:"+t,setTimeout(function(){r.trigger.apply(r,o)},0))}},n.runtimes.Silverlight=n.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(r,l){function E(){return t.getElementById(r.id+"_silverlight").content.Upload}var p,v="",m=r.settings.filters,y,w=t.body;if(!u("2.0.31005.0")||e.opera&&e.opera.buildNumber){l({success:!1});return}s[r.id]=!1,i[r.id]=r,p=t.createElement("div"),p.id=r.id+"_silverlight_container",n.extend(p.style,{position:"absolute",top:"80px",background:r.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:r.settings.shim_bgcolor||t.documentMode>8?"":.01}),p.className="plupload silverlight",r.settings.container&&(w=t.getElementById(r.settings.container),n.getStyle(w,"position")==="static"&&(w.style.position="relative")),w.appendChild(p);for(y=0;y<m.length;y++)v+=(v!=""?"|":"")+m[y].title+" | *."+m[y].extensions.replace(/,/g,";*.");p.innerHTML='<object id="'+r.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+r.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+r.id+",filter="+v+",multiselect="+r.settings.multi_selection+'"/></object>',r.bind("Silverlight:Init",function(){var e,u={};if(s[r.id])return;s[r.id]=!0,r.bind("Silverlight:StartSelectFiles",function(t){e=[]}),r.bind("Silverlight:SelectFile",function(t,r,i,s){var o;o=n.guid(),u[o]=r,u[r]=o,e.push(new n.File(o,i,s))}),r.bind("Silverlight:SelectSuccessful",function(){e.length&&r.trigger("FilesAdded",e)}),r.bind("Silverlight:UploadChunkError",function(e,t,i,s,o){r.trigger("Error",{code:n.IO_ERROR,message:"IO Error.",details:o,file:e.getFile(u[t])})}),r.bind("Silverlight:UploadFileProgress",function(e,t,r,i){var s=e.getFile(u[t]);s.status!=n.FAILED&&(s.size=i,s.loaded=r,e.trigger("UploadProgress",s))}),r.bind("Refresh",function(e){var r,i,s;r=t.getElementById(e.settings.browse_button),r&&(i=n.getPos(r,t.getElementById(e.settings.container)),s=n.getSize(r),n.extend(t.getElementById(e.id+"_silverlight_container").style,{top:i.y+"px",left:i.x+"px",width:s.w+"px",height:s.h+"px"}))}),r.bind("Silverlight:UploadChunkSuccessful",function(e,t,r,i,s){var o,a=e.getFile(u[t]);o={chunk:r,chunks:i,response:s},e.trigger("ChunkUploaded",a,o),a.status!=n.FAILED&&e.state!==n.STOPPED&&E().UploadNextChunk(),r==i-1&&(a.status=n.DONE,e.trigger("FileUploaded",a,{response:s}))}),r.bind("Silverlight:UploadSuccessful",function(e,t,r){var i=e.getFile(u[t]);i.status=n.DONE,e.trigger("FileUploaded",i,{response:r})}),r.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)E().RemoveFile(u[t[n].id])}),r.bind("UploadFile",function(e,t){var r=e.settings,i=r.resize||{};E().UploadFile(u[t.id],e.settings.url,o({name:t.target_name||t.name,mime:n.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,image_width:i.width,image_height:i.height,image_quality:i.quality||90,multipart:!!r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,headers:r.headers}))}),r.bind("CancelUpload",function(){E().CancelUpload()}),r.bind("Silverlight:MouseEnter",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_hover,i&&s&&n.addClass(i,s)}),r.bind("Silverlight:MouseLeave",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_hover,i&&s&&n.removeClass(i,s)}),r.bind("Silverlight:MouseLeftButtonDown",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_active,i&&s&&(n.addClass(i,s),n.addEvent(t.body,"mouseup",function(){n.removeClass(i,s)}))}),r.bind("Sliverlight:StartSelectFiles",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_active,i&&s&&n.removeClass(i,s)}),r.bind("DisableBrowse",function(e,t){E().DisableBrowse(t)}),r.bind("Destroy",function(e){var r;n.removeAllEvents(t.body,e.id),delete s[e.id],delete i[e.id],r=t.getElementById(e.id+"_silverlight_container"),r&&w.removeChild(r)}),l({success:!0})})}})}(window,document,plupload),function(e,t,n,r){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}var i={},s={};n.flash={trigger:function(e,t,n){setTimeout(function(){var r=i[e],s,o;r&&r.trigger("Flash:"+t,n)},0)}},n.runtimes.Flash=n.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(e,r){function p(){return t.getElementById(e.id+"_flash")}function v(){if(l++>5e3){r({success:!1});return}s[e.id]===!1&&setTimeout(v,1)}var u,f,l=0,h=t.body;if(o()<10){r({success:!1});return}s[e.id]=!1,i[e.id]=e,u=t.getElementById(e.settings.browse_button),f=t.createElement("div"),f.id=e.id+"_flash_container",n.extend(f.style,{position:"absolute",top:"0px",background:e.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),f.className="plupload flash",e.settings.container&&(h=t.getElementById(e.settings.container),n.getStyle(h,"position")==="static"&&(h.style.position="relative")),h.appendChild(f),function(){var r,i;r='<object id="'+e.id+'_flash" type="application/x-shockwave-flash" data="'+e.settings.flash_swf_url+'" ',n.ua.ie&&(r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+e.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(e.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',n.ua.ie?(i=t.createElement("div"),f.appendChild(i),i.outerHTML=r,i=null):f.innerHTML=r}(),v(),u=f=null,e.bind("Destroy",function(e){var r;n.removeAllEvents(t.body,e.id),delete s[e.id],delete i[e.id],r=t.getElementById(e.id+"_flash_container"),r&&h.removeChild(r)}),e.bind("Flash:Init",function(){var i={},o;try{p().setFileFilters(e.settings.filters,e.settings.multi_selection)}catch(u){r({success:!1});return}if(s[e.id])return;s[e.id]=!0,e.bind("UploadFile",function(t,r){var s=t.settings,o=e.settings.resize||{};p().uploadFile(i[r.id],s.url,{name:r.target_name||r.name,mime:n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:s.chunk_size,width:o.width,height:o.height,quality:o.quality,multipart:s.multipart,multipart_params:s.multipart_params||{},file_data_name:s.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:s.headers,urlstream_upload:s.urlstream_upload})}),e.bind("CancelUpload",function(){p().cancelUpload()}),e.bind("Flash:UploadProcess",function(e,t){var r=e.getFile(i[t.id]);r.status!=n.FAILED&&(r.loaded=t.loaded,r.size=t.size,e.trigger("UploadProgress",r))}),e.bind("Flash:UploadChunkComplete",function(e,t){var r,s=e.getFile(i[t.id]);r={chunk:t.chunk,chunks:t.chunks,response:t.text},e.trigger("ChunkUploaded",s,r),s.status!==n.FAILED&&e.state!==n.STOPPED&&p().uploadNextChunk(),t.chunk==t.chunks-1&&(s.status=n.DONE,e.trigger("FileUploaded",s,{response:t.text}))}),e.bind("Flash:SelectFiles",function(t,r){var s,o,u=[],a;for(o=0;o<r.length;o++)s=r[o],a=n.guid(),i[a]=s.id,i[s.id]=a,u.push(new n.File(a,s.name,s.size));u.length&&e.trigger("FilesAdded",u)}),e.bind("Flash:SecurityError",function(t,r){e.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:GenericError",function(t,r){e.trigger("Error",{code:n.GENERIC_ERROR,message:n.translate("Generic error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:IOError",function(t,r){e.trigger("Error",{code:n.IO_ERROR,message:n.translate("IO error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:ImageError",function(t,r){e.trigger("Error",{code:parseInt(r.code,10),message:n.translate("Image error."),file:e.getFile(i[r.id])})}),e.bind("Flash:StageEvent:rollOver",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.addClass(i,s)}),e.bind("Flash:StageEvent:rollOut",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.removeClass(i,s)}),e.bind("Flash:StageEvent:mouseDown",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&(n.addClass(i,s),n.addEvent(t.body,"mouseup",function(){n.removeClass(i,s)},r.id))}),e.bind("Flash:StageEvent:mouseUp",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&n.removeClass(i,s)}),e.bind("Flash:ExifData",function(t,n){e.trigger("ExifData",e.getFile(i[n.id]),n.data)}),e.bind("Flash:GpsData",function(t,n){e.trigger("GpsData",e.getFile(i[n.id]),n.data)}),e.bind("QueueChanged",function(t){e.refresh()}),e.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)p().removeFile(i[t[n].id])}),e.bind("StateChanged",function(t){e.refresh()}),e.bind("Refresh",function(r){var i,s,o;p().setFileFilters(e.settings.filters,e.settings.multi_selection),i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(r.settings.container)),o=n.getSize(i),n.extend(t.getElementById(r.id+"_flash_container").style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}))}),e.bind("DisableBrowse",function(e,t){p().disableBrowse(t)}),r({success:!0})})}})}(window,document,plupload),function(e){e.runtimes.BrowserPlus=e.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(t,n){function u(n){var r,s,o=[],u,f;for(s=0;s<n.length;s++)u=n[s],f=e.guid(),i[f]=u,o.push(new e.File(f,u.name,u.size));s&&t.trigger("FilesAdded",o)}function f(){var f=!1;t.bind("PostInit",function(){function h(e,t){r.DragAndDrop.AddDropTarget({id:e},function(n){r.DragAndDrop.AttachCallbacks({id:e,hover:function(e){!e&&t&&t()},drop:function(e){t&&t(),u(e)}},function(){})})}function p(){document.getElementById(o).style.top="-1000px"}var n,i=s.drop_element,o=t.id+"_droptarget",l=document.getElementById(i),c;l&&(document.attachEvent&&/MSIE/gi.test(navigator.userAgent)?(n=document.createElement("div"),n.setAttribute("id",o),e.extend(n.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0}),document.body.appendChild(n),e.addEvent(l,"dragenter",function(t){var n,r;n=document.getElementById(i),r=e.getPos(n),e.extend(document.getElementById(o).style,{top:r.y+"px",left:r.x+"px",width:n.offsetWidth+"px",height:n.offsetHeight+"px"})}),h(o,p)):h(i)),e.addEvent(document.getElementById(s.browse_button),"click",function(t){var n=[],i,o,l=s.filters,c,h;t.preventDefault();if(f)return;e:for(i=0;i<l.length;i++){c=l[i].extensions.split(",");for(o=0;o<c.length;o++){if(c[o]==="*"){n=[];break e}h=e.mimeTypes[c[o]],h&&e.inArray(h,n)===-1&&n.push(e.mimeTypes[c[o]])}}r.FileBrowse.OpenBrowseDialog({mimeTypes:n},function(e){e.success&&u(e.value)})}),l=n=null}),t.bind("CancelUpload",function(){r.Uploader.cancel({},function(){})}),t.bind("DisableBrowse",function(e,t){f=t}),t.bind("UploadFile",function(t,n){function d(i,s){var o;if(n.status==e.FAILED)return;u.name=n.target_name||n.name,f&&(u.chunk=""+i,u.chunks=""+s),o=p.shift(),r.Uploader.upload({url:t.settings.url,files:{file:o},cookies:document.cookies,postvars:e.extend(u,t.settings.multipart_params),progressCallback:function(e){var r,s=0;l[i]=parseInt(e.filePercent*o.size/100,10);for(r=0;r<l.length;r++)s+=l[r];n.loaded=s,t.trigger("UploadProgress",n)}},function(r){var o,u;r.success?(o=r.value.statusCode,f&&t.trigger("ChunkUploaded",n,{chunk:i,chunks:s,response:r.value.body,status:o}),p.length>0?d(++i,s):(n.status=e.DONE,t.trigger("FileUploaded",n,{response:r.value.body,status:o}),o>=400&&t.trigger("Error",{code:e.HTTP_ERROR,message:e.translate("HTTP Error."),file:n,status:o}))):t.trigger("Error",{code:e.GENERIC_ERROR,message:e.translate("Generic Error."),file:n,details:r.error})})}function v(e){n.size=e.size,f?r.FileAccess.chunk({file:e,chunkSize:f},function(e){if(e.success){var t=e.value,n=t.length;l=Array(n);for(var r=0;r<n;r++)l[r]=0,p.push(t[r]);d(0,n)}}):(l=Array(1),p.push(e),d(0,1))}var s=i[n.id],u={},f=t.settings.chunk_size,l,p=[];o&&/\.(png|jpg|jpeg)$/i.test(n.name)?BrowserPlus.ImageAlter.transform({file:s,quality:o.quality||90,actions:[{scale:{maxwidth:o.width,maxheight:o.height}}]},function(e){e.success&&v(e.value.file)}):v(s)}),n({success:!0})}var r=window.BrowserPlus,i={},s=t.settings,o=s.resize;r?r.init(function(e){var t=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];o&&t.push({service:"ImageAlter",version:"4"}),e.success?r.require({services:t},function(e){e.success?f():n()}):n()}):n()}})}(plupload),function(e,t,n,r){function u(t,n){var r;if(!("FileReader"in e))return n(t.getAsDataURL());r=new FileReader,r.readAsDataURL(t),r.onload=function(){n(r.result)}}function a(t,n){var r;if(!("FileReader"in e))return n(t.getAsBinary());r=new FileReader,r.readAsBinaryString(t),r.onload=function(){n(r.result)}}function f(e,n,r,i){var o,a,f,l,p=this;u(s[e.id],function(s){o=t.createElement("canvas"),o.style.display="none",t.body.appendChild(o),a=o.getContext("2d"),f=new Image,f.onerror=f.onabort=function(){i({success:!1})},f.onload=function(){var t,u,d,m,g;n.width||(n.width=f.width),n.height||(n.height=f.height),l=Math.min(n.width/f.width,n.height/f.height);if(l<1||l===1&&r==="image/jpeg"){t=Math.round(f.width*l),u=Math.round(f.height*l),o.width=t,o.height=u,a.drawImage(f,0,0,t,u);if(r==="image/jpeg"){m=new c(atob(s.substring(s.indexOf("base64,")+7))),m.headers&&m.headers.length&&(g=new h,g.init(m.get("exif")[0])&&(g.setExif("PixelXDimension",t),g.setExif("PixelYDimension",u),m.set("exif",g.getBinary()),p.hasEventListener("ExifData")&&p.trigger("ExifData",e,g.EXIF()),p.hasEventListener("GpsData")&&p.trigger("GpsData",e,g.GPS())));if(n.quality)try{s=o.toDataURL(r,n.quality/100)}catch(y){s=o.toDataURL(r)}}else s=o.toDataURL(r);s=s.substring(s.indexOf("base64,")+7),s=atob(s),m&&m.headers&&m.headers.length&&(s=m.restore(s),m.purge()),o.parentNode.removeChild(o),i({success:!0,data:s})}else i({success:!1})},f.src=s})}function l(){function n(n,r){var i=e?0:-8*(r-1),s=0,o;for(o=0;o<r;o++)s|=t.charCodeAt(n+o)<<Math.abs(i+o*8);return s}function i(e,n,r){var r=arguments.length===3?r:t.length-n-1;t=t.substr(0,n)+e+t.substr(r+n)}function s(t,n,r){var s="",o=e?0:-8*(r-1),u;for(u=0;u<r;u++)s+=String.fromCharCode(n>>Math.abs(o+u*8)&255);i(s,t,r)}var e=!1,t;return{II:function(t){if(t===r)return e;e=t},init:function(n){e=!1,t=n},SEGMENT:function(e,n,r){switch(arguments.length){case 1:return t.substr(e,t.length-e-1);case 2:return t.substr(e,n);case 3:i(r,e,n);break;default:return t}},BYTE:function(e){return n(e,1)},SHORT:function(e){return n(e,2)},LONG:function(e,t){if(t===r)return n(e,4);s(e,t,4)},SLONG:function(e){var t=n(e,4);return t>2147483647?t-4294967296:t},STRING:function(e,t){var r="";for(t+=e;e<t;e++)r+=String.fromCharCode(n(e,1));return r}}}function c(e){var t={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},n=[],i,s,o=r,u=0,a;i=new l,i.init(e);if(i.SHORT(0)!==65496)return;s=2,a=Math.min(1048576,e.length);while(s<=a){o=i.SHORT(s);if(o>=65488&&o<=65495){s+=2;continue}if(o===65498||o===65497)break;u=i.SHORT(s+2)+2,t[o]&&i.STRING(s+4,t[o].signature.length)===t[o].signature&&n.push({hex:o,app:t[o].app.toUpperCase(),name:t[o].name.toUpperCase(),start:s,length:u,segment:i.SEGMENT(s,u)}),s+=u}return i.init(null),{headers:n,restore:function(e){i.init(e);var t=new c(e);if(!t.headers)return!1;for(var r=t.headers.length;r>0;r--){var o=t.headers[r-1];i.SEGMENT(o.start,o.length,"")}t.purge(),s=i.SHORT(2)==65504?4+i.SHORT(4):2;for(var r=0,u=n.length;r<u;r++)i.SEGMENT(s,0,n[r].segment),s+=n[r].length;return i.SEGMENT()},get:function(e){var t=[];for(var r=0,i=n.length;r<i;r++)n[r].app===e.toUpperCase()&&t.push(n[r].segment);return t},set:function(e,t){var r=[];typeof t=="string"?r.push(t):r=t;for(var i=ii=0,s=n.length;i<s;i++){n[i].app===e.toUpperCase()&&(n[i].segment=r[ii],n[i].length=r[ii].length,ii++);if(ii>=r.length)break}},purge:function(){n=[],i.init(null)}}}function h(){function u(t,n){var i=e.SHORT(t),u,a,f,l,c,h,p,d,v=[],m={};for(u=0;u<i;u++){p=h=t+12*u+2,f=n[e.SHORT(p)];if(f===r)continue;l=e.SHORT(p+=2),c=e.LONG(p+=2),p+=4,v=[];switch(l){case 1:case 7:c>4&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.BYTE(p+a);break;case 2:c>4&&(p=e.LONG(p)+s.tiffHeader),m[f]=e.STRING(p,c-1);continue;case 3:c>2&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.SHORT(p+a*2);break;case 4:c>1&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.LONG(p+a*4);break;case 5:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.LONG(p+a*4)/e.LONG(p+a*4+4);break;case 9:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4);break;case 10:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4)/e.SLONG(p+a*4+4);break;default:continue}d=c==1?v[0]:v,o.hasOwnProperty(f)&&typeof d!="object"?m[f]=o[f][d]:m[f]=d}return m}function a(){var n=r,i=s.tiffHeader;return e.II(e.SHORT(i)==18761),e.SHORT(i+=2)!==42?!1:(s.IFD0=s.tiffHeader+e.LONG(i+=2),n=u(s.IFD0,t.tiff),s.exifIFD="ExifIFDPointer"in n?s.tiffHeader+n.ExifIFDPointer:r,s.gpsIFD="GPSInfoIFDPointer"in n?s.tiffHeader+n.GPSInfoIFDPointer:r,!0)}function f(n,r,o){var u,a,f,l=0;if(typeof r=="string"){var c=t[n.toLowerCase()];for(hex in c)if(c[hex]===r){r=hex;break}}u=s[n.toLowerCase()+"IFD"],a=e.SHORT(u);for(i=0;i<a;i++){f=u+12*i+2;if(e.SHORT(f)==r){l=f+8;break}}return l?(e.LONG(l,o),!0):!1}var e,t,s={},o;return e=new l,t={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},o={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return s={tiffHeader:10},t===r||!t.length?!1:(e.init(t),e.SHORT(0)===65505&&e.STRING(4,5).toUpperCase()==="EXIF\0"?a():!1)},EXIF:function(){var e;e=u(s.exifIFD,t.exif);if(e.ExifVersion&&n.typeOf(e.ExifVersion)==="array"){for(var r=0,i="";r<e.ExifVersion.length;r++)i+=String.fromCharCode(e.ExifVersion[r]);e.ExifVersion=i}return e},GPS:function(){var e;return e=u(s.gpsIFD,t.gps),e.GPSVersionID&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){return e!=="PixelXDimension"&&e!=="PixelYDimension"?!1:f("exif",e,t)},getBinary:function(){return e.SEGMENT()}}}var s={},o;n.runtimes.Html5=n.addRuntime("html5",{getFeatures:function(){var r,i,s,u,a,f;return i=s=a=f=!1,e.XMLHttpRequest&&(r=new XMLHttpRequest,s=!!r.upload,i=!!r.sendAsBinary||!!r.upload),i&&(u=!!(r.sendAsBinary||e.Uint8Array&&e.ArrayBuffer),a=!(!File||!File.prototype.getAsDataURL&&!e.FileReader||!u),f=!!File&&!!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),o=n.ua.safari&&n.ua.windows,{html5:i,dragdrop:function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),jpgresize:a,pngresize:a,multipart:a||!!e.FileReader||!!e.FormData,canSendBinary:u,cantSendBlobInFormData:!!(n.ua.gecko&&e.FormData&&e.FileReader&&!FileReader.prototype.readAsArrayBuffer),progress:s,chunks:f,multi_selection:!n.ua.safari||!n.ua.windows,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,i){function c(e){var t,i,o=[],u,a={};for(i=0;i<e.length;i++){t=e[i];if(a[t.name])continue;a[t.name]=!0,u=n.guid(),s[u]=t,o.push(new n.File(u,t.fileName||t.name,t.fileSize||t.size))}o.length&&r.trigger("FilesAdded",o)}var u,l;u=this.getFeatures();if(!u.html5){i({success:!1});return}r.bind("Init",function(e){var i,s,o=[],u,a,f=e.settings.filters,l,h,d=t.body,v;i=t.createElement("div"),i.id=e.id+"_html5_container",n.extend(i.style,{position:"absolute",background:r.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:r.settings.shim_bgcolor?"":0}),i.className="plupload html5",r.settings.container&&(d=t.getElementById(r.settings.container),n.getStyle(d,"position")==="static"&&(d.style.position="relative")),d.appendChild(i);e:for(u=0;u<f.length;u++){l=f[u].extensions.split(/,/);for(a=0;a<l.length;a++){if(l[a]==="*"){o=[];break e}h=n.mimeTypes[l[a]],h&&n.inArray(h,o)===-1&&o.push(h)}}i.innerHTML='<input id="'+r.id+'_html5"  style="font-size:999px" type="file" accept="'+o.join(",")+'" '+(r.settings.multi_selection&&r.features.multi_selection?'multiple="multiple"':"")+" />",i.scrollTop=100,v=t.getElementById(r.id+"_html5"),e.features.triggerDialog?n.extend(v.style,{position:"absolute",width:"100%",height:"100%"}):n.extend(v.style,{cssFloat:"right",styleFloat:"right"}),v.onchange=function(){var e=window.URL||window.webkitURL;window.fileURL=e.createObjectURL(this.files[0]),c(this.files),this.value=""},s=t.getElementById(e.settings.browse_button);if(s){var m=e.settings.browse_button_hover,g=e.settings.browse_button_active,y=e.features.triggerDialog?s:i;m&&(n.addEvent(y,"mouseover",function(){n.addClass(s,m)},e.id),n.addEvent(y,"mouseout",function(){n.removeClass(s,m)},e.id)),g&&(n.addEvent(y,"mousedown",function(){n.addClass(s,g)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(s,g)},e.id)),e.features.triggerDialog&&n.addEvent(s,"click",function(n){var r=t.getElementById(e.id+"_html5");r&&!r.disabled&&r.click(),n.preventDefault()},e.id)}}),r.bind("PostInit",function(){var e=t.getElementById(r.settings.drop_element);if(e){if(o){n.addEvent(e,"dragenter",function(i){var s,o,u;s=t.getElementById(r.id+"_drop"),s||(s=t.createElement("input"),s.setAttribute("type","file"),s.setAttribute("id",r.id+"_drop"),s.setAttribute("multiple","multiple"),n.addEvent(s,"change",function(){c(this.files),n.removeEvent(s,"change",r.id),s.parentNode.removeChild(s)},r.id),e.appendChild(s)),o=n.getPos(e,t.getElementById(r.settings.container)),u=n.getSize(e),n.getStyle(e,"position")==="static"&&n.extend(e.style,{position:"relative"}),n.extend(s.style,{position:"absolute",display:"block",top:0,left:0,width:u.w+"px",height:u.h+"px",opacity:0})},r.id);return}n.addEvent(e,"dragover",function(e){e.preventDefault()},r.id),n.addEvent(e,"drop",function(e){var t=e.dataTransfer;t&&t.files&&c(t.files),e.preventDefault()},r.id)}}),r.bind("Refresh",function(e){var i,s,o,u,a;i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(e.settings.container)),o=n.getSize(i),u=t.getElementById(r.id+"_html5_container"),n.extend(u.style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}),r.features.triggerDialog&&(n.getStyle(i,"position")==="static"&&n.extend(i.style,{position:"relative"}),a=parseInt(n.getStyle(i,"z-index"),10),isNaN(a)&&(a=0),n.extend(i.style,{zIndex:a}),n.extend(u.style,{zIndex:a-1})))}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById(e.id+"_html5");r&&(r.disabled=n)}),r.bind("CancelUpload",function(){l&&l.abort&&l.abort()}),r.bind("UploadFile",function(t,r){function h(e,t,n){var r;if(!File.prototype.slice)return(r=File.prototype.webkitSlice||File.prototype.mozSlice)?r.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(i){return e.slice(t,n-t)}}function p(s){function c(){function S(i){var s=0,f="----pluploadboundary"+n.guid(),h,d="--",v="\r\n",S="";l=new XMLHttpRequest,l.upload&&(l.upload.onprogress=function(e){r.loaded=Math.min(r.size,a+e.loaded-s),t.trigger("UploadProgress",r)}),l.onreadystatechange=function(){var e,s;if(l.readyState==4&&t.state!==n.STOPPED){try{e=l.status}catch(u){e=0}if(e>=400)t.trigger("Error",{code:n.HTTP_ERROR,message:n.translate("HTTP Error."),file:r,status:e});else{if(m){s={chunk:o,chunks:m,response:l.responseText,status:e},t.trigger("ChunkUploaded",r,s),a+=b;if(s.cancelled){r.status=n.FAILED;return}r.loaded=Math.min(r.size,(o+1)*y)}else r.loaded=r.size;t.trigger("UploadProgress",r),i=p=h=S=null,!m||++o>=m?(r.status=n.DONE,t.trigger("FileUploaded",r,{response:l.responseText,status:e})):c()}}};if(t.settings.multipart&&u.multipart){g.name=r.target_name||r.name,l.open("post",E,!0),n.each(t.settings.headers,function(e,t){l.setRequestHeader(t,e)});if(typeof i!="string"&&!!e.FormData){h=new FormData,n.each(n.extend(g,t.settings.multipart_params),function(e,t){h.append(t,e)}),h.append(t.settings.file_data_name,i),l.send(h);return}if(typeof i=="string"){l.setRequestHeader("Content-Type","multipart/form-data; boundary="+f),n.each(n.extend(g,t.settings.multipart_params),function(e,t){S+=d+f+v+'Content-Disposition: form-data; name="'+t+'"'+v+v,S+=unescape(encodeURIComponent(e))+v}),w=n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",S+=d+f+v+'Content-Disposition: form-data; name="'+t.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(r.name))+'"'+v+"Content-Type: "+w+v+v+i+v+d+f+d+v,s=S.length-i.length,i=S;if(l.sendAsBinary)l.sendAsBinary(i);else if(u.canSendBinary){var x=new Uint8Array(i.length);for(var T=0;T<i.length;T++)x[T]=i.charCodeAt(T)&255;l.send(x.buffer)}return}}E=n.buildUrl(t.settings.url,n.extend(g,t.settings.multipart_params)),l.open("post",E,!0),l.setRequestHeader("Content-Type","application/octet-stream"),n.each(t.settings.headers,function(e,t){l.setRequestHeader(t,e)}),l.send(i)}var p,d,m,g,y,b,w,E=t.settings.url;if(r.status==n.DONE||r.status==n.FAILED||t.state==n.STOPPED)return;g={name:r.target_name||r.name},i.chunk_size&&r.size>i.chunk_size&&(u.chunks||typeof s=="string")?(y=i.chunk_size,m=Math.ceil(r.size/y),b=Math.min(y,r.size-o*y),typeof s=="string"?p=s.substring(o*y,o*y+b):p=h(s,o*y,o*y+b),g.chunk=o,g.chunks=m):(b=r.size,p=s),t.settings.multipart&&u.multipart&&typeof p!="string"&&f&&u.cantSendBlobInFormData&&u.chunks&&t.settings.chunk_size?(f.onload=function(){S(f.result)},f.readAsBinaryString(p)):S(p)}var o=0,a=0,f="FileReader"in e?new FileReader:null;c()}var i=t.settings,o,c;o=s[r.id],u.jpgresize&&t.settings.resize&&/\.(png|jpg|jpeg)$/i.test(r.name)?f.call(t,r,t.settings.resize,/\.png$/i.test(r.name)?"image/png":"image/jpeg",function(e){e.success?(r.size=e.data.length,p(e.data)):u.chunks?p(o):a(o,p)}):!u.chunks&&u.jpgresize?a(o,p):p(o)}),r.bind("Destroy",function(e){var r,i,s=t.body,o={inputContainer:e.id+"_html5_container",inputFile:e.id+"_html5",browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(r in o)i=t.getElementById(o[r]),i&&n.removeAllEvents(i,e.id);n.removeAllEvents(t.body,e.id),e.settings.container&&(s=t.getElementById(e.settings.container)),s.removeChild(t.getElementById(o.inputContainer))}),i({success:!0})}})}(window,document,plupload),function(e,t,n,r){function i(e){return t.getElementById(e)}n.runtimes.Html4=n.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,s){r.bind("Init",function(s){function T(){var e,u,l,c;p=n.guid(),v.push(p),e=t.createElement("form"),e.setAttribute("id","form_"+p),e.setAttribute("method","post"),e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.setAttribute("target",s.id+"_iframe"),e.style.position="absolute",u=t.createElement("input"),u.setAttribute("id","input_"+p),u.setAttribute("type","file"),u.setAttribute("accept",g),u.setAttribute("size",1),c=i(s.settings.browse_button),s.features.triggerDialog&&c&&n.addEvent(i(s.settings.browse_button),"click",function(e){u.disabled||u.click(),e.preventDefault()},s.id),n.extend(u.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"}),n.extend(e.style,{overflow:"hidden"}),l=s.settings.shim_bgcolor,l&&(e.style.background=l),m&&n.extend(u.style,{filter:"alpha(opacity=0)"}),n.addEvent(u,"change",function(t){var o=t.target,a,l=[],h;o.value&&(i("form_"+p).style.top="-1048575px",a=o.value.replace(/\\/g,"/"),a=a.substring(a.length,a.lastIndexOf("/")+1),l.push(new n.File(p,a)),s.features.triggerDialog?n.removeEvent(c,"click",s.id):n.removeAllEvents(e,s.id),n.removeEvent(u,"change",s.id),T(),l.length&&r.trigger("FilesAdded",l))},s.id),e.appendChild(u),o.appendChild(e),s.refresh()}function N(){var r=t.createElement("div");r.innerHTML='<iframe id="'+s.id+'_iframe" name="'+s.id+'_iframe" src="'+l+':&quot;&quot;" style="display:none"></iframe>',u=r.firstChild,o.appendChild(u),n.addEvent(u,"load",function(t){var r=t.target,i,o;if(!c)return;try{i=r.contentWindow.document||r.contentDocument||e.frames[r.id].document}catch(u){s.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),file:c});return}o=i.body.innerHTML,o&&(c.status=n.DONE,c.loaded=1025,c.percent=100,s.trigger("UploadProgress",c),s.trigger("FileUploaded",c,{response:o}))},s.id)}var o=t.body,u,l="javascript",c,h,p,v=[],m=/MSIE/.test(navigator.userAgent),g=[],y=s.settings.filters,w,E,S,x;e:for(w=0;w<y.length;w++){E=y[w].extensions.split(/,/);for(x=0;x<E.length;x++){if(E[x]==="*"){g=[];break e}S=n.mimeTypes[E[x]],S&&n.inArray(S,g)===-1&&g.push(S)}}g=g.join(","),s.settings.container&&(o=i(s.settings.container),n.getStyle(o,"position")==="static"&&(o.style.position="relative")),s.bind("UploadFile",function(e,r){var s,o;if(r.status==n.DONE||r.status==n.FAILED||e.state==n.STOPPED)return;s=i("form_"+r.id),o=i("input_"+r.id),o.setAttribute("name",e.settings.file_data_name),s.setAttribute("action",e.settings.url),n.each(n.extend({name:r.target_name||r.name},e.settings.multipart_params),function(e,r){var i=t.createElement("input");n.extend(i,{type:"hidden",name:r,value:e}),s.insertBefore(i,s.firstChild)}),c=r,i("form_"+p).style.top="-1048575px",s.submit()}),s.bind("FileUploaded",function(e){e.refresh()}),s.bind("StateChanged",function(t){t.state==n.STARTED?N():t.state==n.STOPPED&&e.setTimeout(function(){n.removeEvent(u,"load",t.id),u.parentNode&&u.parentNode.removeChild(u)},0),n.each(t.files,function(e,t){if(e.status===n.DONE||e.status===n.FAILED){var r=i("form_"+e.id);r&&r.parentNode.removeChild(r)}})}),s.bind("Refresh",function(e){var r,s,o,u,f,l,c,h,d;r=i(e.settings.browse_button),r&&(f=n.getPos(r,i(e.settings.container)),l=n.getSize(r),c=i("form_"+p),h=i("input_"+p),n.extend(c.style,{top:f.y+"px",left:f.x+"px",width:l.w+"px",height:l.h+"px"}),e.features.triggerDialog&&(n.getStyle(r,"position")==="static"&&n.extend(r.style,{position:"relative"}),d=parseInt(r.style.zIndex,10),isNaN(d)&&(d=0),n.extend(r.style,{zIndex:d}),n.extend(c.style,{zIndex:d-1})),o=e.settings.browse_button_hover,u=e.settings.browse_button_active,s=e.features.triggerDialog?r:c,o&&(n.addEvent(s,"mouseover",function(){n.addClass(r,o)},e.id),n.addEvent(s,"mouseout",function(){n.removeClass(r,o)},e.id)),u&&(n.addEvent(s,"mousedown",function(){n.addClass(r,u)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(r,u)},e.id)))}),r.bind("FilesRemoved",function(e,t){var n,r;for(n=0;n<t.length;n++)r=i("form_"+t[n].id),r&&r.parentNode.removeChild(r)}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById("input_"+p);r&&(r.disabled=n)}),r.bind("Destroy",function(e){var r,s,u,f={inputContainer:"form_"+p,inputFile:"input_"+p,browseButton:e.settings.browse_button};for(r in f)s=i(f[r]),s&&n.removeAllEvents(s,e.id);n.removeAllEvents(t.body,e.id),n.each(v,function(e,t){u=i("form_"+e),u&&o.removeChild(u)})}),T()}),s({success:!0})}})}(window,document,plupload),define("plupload",["jquery"],function(){}),define("videopreview/views/uploader",["vendor","views","facade","videopreview/models/videoup","text!videopreview/templates/upload.html","plupload"],function(e,t,n,r){var i=require("text!videopreview/templates/upload.html"),s,o=e.$,u=n._,a=t.SectionView,f=e.Mustache;return s=a.extend({name:"Video Preview Form View",id:"videoPreviewForm",template:i,data:i,events:{"change input:file":"play","click #uploadfiles":"uploadFiles"},initialize:function(e){a.prototype.initialize.call(this,e),u.bindAll(this,"beforeRender","render","afterRender");var t=this;this.render=u.wrap(this.render,function(e){return t.beforeRender(),e(),t}),o("#imgUploadModal").modal("show")},beforeRender:function(){console.log("beforeRender")},afterRender:function(){},uploadFiles:function(e){this.uploader=this.model.uploader,console.log(this.uploader,"up");if(o("input#title").val()==""){alert("Please enter a title for this video.");return}this.uploader.settings.multipart_params.name=o("input#title").val(),this.uploader.settings.multipart_params.mm=o("input#mm").is(":checked"),this.uploader.settings.multipart_params.sports_id=o("select#sports_id").val(),o("#uploadfiles").addClass("isUploading"),this.uploader.start(),e.preventDefault()},plupInit:function(){},play:function(e){var t=window.fileURL;Channel("select-video-preview-change").publish(t)},videoUploadClick:function(e){console.log("called",this.file),e.preventDefault(),o("#errormsg").hide(),o("#imageup").attr("disabled","disabled"),Channel("mediaup-add-video").publish(this.file)}}),s}),define("text!videopreview/templates/preview.html",[],function(){return'<video  width="320" height="240" controls autoplay></video>'}),define("videopreview/views/preview",["vendor","views","utils","text!videopreview/templates/preview.html"],function(e,t,n){var r=require("text!videopreview/templates/preview.html"),i,s=e.$,o=t.SectionView;return i=o.extend({name:"Video Preview View",id:"videoPreviewWindow",template:r,data:r,initialize:function(e){o.prototype.initialize.call(this,e),Channel("select-video-preview-change").subscribe(this.changeVideo)},changeVideo:function(e){document.querySelector(this.$el.selector+" video").src=e},displayMessage:function(e,t){var n=this.$el.find(".message");n.html(e),n.className=t?"error":"info"}}),i}),define("videopreview",["require","text!videopreview/templates/basic.html","facade","controller","models","views","utils","videopreview/models/base","videopreview/models/videoup","videopreview/views/uploader","videopreview/views/preview"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=s.LayoutView,p=n.$,d=n._,v=o.debug,m=o.lib.Channel,g=["/pages/imageup/imageup.css"];return c=r.extend({initialize:function(e){return m("load:css").publish(g),d.bindAll(this),this.handleOptions(e),this.init(e),this},init:function(e){this.url=e.url,this.attr=e.attr,v.log("VideoPreview Init"),this.setupLayout(),this.showVideoPreview()},setupLayout:function(){return this.scheme=[],p("div#modalPopup").remove(),p("body").append('<div id="modalPopup"></div>'),pageLayout=new h({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,console.log(this.layout),this.layout},showVideoPreview:function(e){var t=new a,n=this,r=new l({name:"Video Preview View",model:t,destination:".modal-body #preview"},this.attr);this.scheme.push(r);var i=new f({name:"Video Upload View",model:t,destination:"#main-content-img"},this.attr);this.scheme.push(i),this.layout.render(),this.afterRender(t)},afterRender:function(e){e.uploader=e.doUpload(this.url),e.uploader.bind("Init",function(e,t){p("#filelist").html("<div></div>")});try{e.uploader.init()}catch(t){alert(t)}e.uploader.bind("FilesAdded",function(t,n){maxCountError=!1,p.each(n,function(n,r){e.uploader.settings.max_file_count&&n>=e.uploader.settings.max_file_count?(maxCountError=!0,setTimeout(function(){t.removeFile(r)},50)):p("#filelist").append('<div id="'+r.id+'">'+r.name+" ("+plupload.formatSize(r.size)+") <b></b>"+"</div>"),maxCountError&&p("#resultdiv").html("You can only select one video at a time.").show()}),t.refresh()}),e.uploader.bind("UploadProgress",function(e,t){p("#"+t.id+" b").html(t.percent+"%")}),e.uploader.bind("Error",function(e,t){p("#filelist").append("<div>Error: "+t.code+", Message: "+t.message+(t.file?", File: "+t.file.name:"")+"</div>"),e.refresh()})},uploadVideo:function(e){alert("inside uploadvideo"),console.log("Called",e);var t=new a({file:e})}}),c}),define("text!game/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header" class="profile-header"></div>\r\n	\r\n	<div class="green-left-heading">MESSAGE BOARD</div>\r\n	<div id="commenton-wrap" class="clearfix clear commentson-outer-box-h"></div>\r\n	<div id="comment_div" class="clearfix"></div>\r\n	\r\n	\r\n	<div class="green-left-heading">PHOTO/VIDEO</div>\r\n	<div class="row-fluid" id="main-content">\r\n	<!-- <div id="video-wrap" class="clearfix"></div> -->\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<div id="add-media" class="clearfix">add media</div>\r\n	</div>\r\n	\r\n	<div id="roster-wrap" class="clearfix clear"></div>\r\n	\r\n	<div class="green-left-heading participants-heading-h hide">PARTICIPANTS</div>\r\n	<div id="participants_div" class="clearfix clear"></div>\r\n\r\n	\r\n	<div class="row-fluid">\r\n		<div class="span4" id="main-sidebar">\r\n			<div id="org-wrap" class="clearfix hide"></div>\r\n			<div id="related-wrap" class="clearfix"></div>\r\n			<div  class="clearfix"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	\r\n	\r\n	\r\n<!--div class="row-fluid">\r\n    <div class="span4" id="main-sidebar">\r\n    \r\n        <div id="add-media" class="clearfix">\r\n        </div>\r\n        \r\n        <div>MESSAGE BOARD</div>\r\n    	<div class="commentson-outer-box-h clear"></div>\r\n    	<div id="comment_div" class="clearfix"></div>\r\n        \r\n        <div id="roster-wrap" class="clearfix">\r\n        </div>\r\n    \r\n    </div>\r\n    <div class="span8" id="main-content">\r\n        \r\n        <div id="video-wrap" class="clearfix">\r\n        </div>\r\n        \r\n       \r\n        \r\n        <div id="comment-wrap" class="clearfix">\r\n        </div>\r\n        \r\n    </div>\r\n</div-->\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n</div>\r\n'}),define("text!votes/templates/vote.html",[],function(){return'{{#payload}}\r\n<a href="javascript:void(0);" class="vote {{#has_voted}}team-noaction-h link-disabled{{/has_voted}}{{^has_voted}}team-action-h{{/has_voted}}">Vote</a>\r\n<a href="javascript:void(0);" class="follow {{#is_following}}follow-noaction-h link-disabled{{/is_following}}{{^is_following}}follow-action-h{{/is_following}}">Follow</a>\r\n{{/payload}}'}),define("votes/views/vote",["require","text!votes/templates/vote.html","views","vendor","facade","utils","jqueryui","controller","votes/models/vote","votes/models/follow"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("votes/models/vote"),d=e("votes/models/follow");return n=o.extend({template:t,events:{"click .team-action-h":"vote","click .follow-action-h":"follow"},vote:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.voteModelOb.save(),u.when(this.voteModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")})},follow:function(e){console.log(e);if(!this.checkForUser()){routing.trigger("showSignup");return}this.followModelOb.save(),fitness-overview-data-piece,u.when(this.followModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")}),h("new-fan").publish()},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){var t=this;a.bindAll(this),o.prototype.initialize.call(this,e)},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=this.model.get("payload");r.has_voted?this.$el.find(".team-action-h").addClass("link-disabled"):(this.voteModelOb=new p,this.voteModelOb.subject_id=r.id,this.voteModelOb.entity_id=r.enttypes_id,this.voteModelOb.setData()),r.is_following?this.$el.find(".follow-action-h").addClass("link-disabled"):(this.followModelOb=new d,this.followModelOb.subject_id=r.id,this.followModelOb.entity_id=r.enttypes_id)}}),n}),define("game/models/basics",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/game/basics/"+this.id:"/api/game/basics/"+this.id}}),n}),define("game/models/addmedia",["models/base"],function(e){var t;return t=e.extend({defaults:{links:[{label:"Photo",link:"javascript:void(0);",id:"addPhoto"},{label:"Video",link:"javascript:void(0);",id:"addVideo"}]}}),t}),define("sportorg/models/teamroster",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{team_id:0,team_name:null,rosters:[{name:null,user_picture:null,grad_year:0,sport_name:null,position:null}]},desc:"Team Roster information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/teamrosters",["facade","collections","sportorg/models/teamroster","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(!u.isUndefined(r)&&r!=null&&r){for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}e.deferred.resolve(t)}}),s}),define("game/collections/teamrosters",["facade","sportorg/collections/teamrosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/roster/"+this.id:"/api/team/roster/"+this.id}}),r}),define("media/models/video",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{video_id:0,video_title:null,video_quality:0,video_thumb:null,video_src:null,org_name:null,teams:[{complevel:null,season:null,grad_year:0,team_name:null,schedule:{schedule_date:null,other_team:null,schedule_summary:null}}],games:[{team1_name:null,team2_name:null}],video_desc:null,user_name:null,post_date:null,tags_count:0,tags:[],num_votes:0,num_views:0,num_comments:0,social_links:[{"class":null,title:null,link:null}]},desc:"Video information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("media/collections/videos",["facade","collections","media/models/video","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("game/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/videos/"+this.id:"/api/game/videos/"+this.id}}),r}),define("game/collections/images",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/images/"+this.id:"/api/game/images/"+this.id}}),r}),define("game/collections/participants",["facade","collections","utils"],function(e,t,n){var r=e._,i=t.BaseCollection,s=n.lib.Channel;return i.extend({id:undefined,url:function(){return testpath?testpath+"/game/users/"+this.id:"/api/game/users/"+this.id}})}),define("site/models/comment",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("site/collections/comments",["facade","collections","site/models/comment","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("game/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/comments/"+this.id:"/api/game/comments/"+this.id}}),r}),define("game/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/game/comments/"+this.id:"/api/game/comments/"+this.id}}),r}),define("text!game/templates/header.html",[],function(){return'{{#payload}}\r\n<div class="row-fluid">\r\n\r\n	<div class="game-heading">\r\n		<!--div class="sports-h"></div-->\r\n		<div class="game-general">\r\n			<div class="stretch"></div>\r\n			{{#shared}}\r\n				{{#shared.sport}}<span class="sport-h" data-id="{{sports_id}}">{{shared.sport}}</span>{{/shared.sport}}\r\n				{{#shared.complevel}}<span>{{shared.complevel}}</span>{{/shared.complevel}}\r\n				{{#shared.season}}<span>{{shared.season}}</span>{{/shared.season}}\r\n			{{/shared}}\r\n			{{^shared}}\r\n				{{#event_name}}<span class="sport-h" data-id="{{sports_id}}">{{event_name}}</span>{{/event_name}}\r\n			{{/shared}}\r\n		</div>\r\n\r\n		<h3>{{game_day}} {{game_time}}</h3>\r\n		<p>\r\n			{{game_location}}\r\n		</p>\r\n		<a href="javascript: void(0);" class="common-btn game-edit-btn-h common-default-sky-dark pull-right">Edit Game</a>\r\n	</div>\r\n\r\n	<ul class="span3 image-outer-h">\r\n			</ul>\r\n\r\n	<!--{{#game_picture}}\r\n	<a href="javascript: void(0);" class="header-image-container image-outer-h">\r\n	<div class="image-item-container">\r\n		<img src="{{game_picture.types.standard_thumb.url}}" alt="{{game_name}}" />\r\n		<div class="action-section">\r\n			{{#game_picture.is_owner}}\r\n			<div class="action-block left-block edit object-edit-h" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>E</span>\r\n			</div>\r\n			<div class="action-block right-block delete object-delete-h" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>D</span>\r\n			</div>\r\n			{{/game_picture.is_owner}}\r\n			{{^game_picture.is_owner}}\r\n			<div class="action-block left-block vote" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>V</span>\r\n			</div>\r\n			<div class="action-block right-block follow" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>F</span>\r\n			</div>\r\n			{{/game_picture.is_owner}}\r\n		</div>\r\n	</div> </a>\r\n	{{/game_picture}}-->\r\n\r\n	<ul class="teams-list">\r\n		{{#teams}}\r\n		<li class="team-item">\r\n			<div class=\'score-box score-box-h {{#isWinner}}win{{/isWinner}}\'>\r\n				<a href="javascript: void(0);" title="edit score" class="edit-score-h"> <span style="width:100%; height: 100%">{{points_scored}}</span> </a>\r\n\r\n				<input type="hidden" value="{{points_scored}}" data-id="{{games_teams_link_id}}" class="edit-score-input-h input-mini" />\r\n			</div>\r\n			<div class="org-info">\r\n				<span class="org-name"><a href="/#team/{{id}}">{{org_sport_link_obj.org.org_name}}, {{complevels_obj.complevel_name}}, {{seasons_obj.season_name}} {{year}}</a></span>\r\n				<span class="org-location"> {{team_location}} </span>\r\n			</div>\r\n		</li>\r\n		{{/teams}}\r\n	</ul>\r\n	<div id="votes-area-h"></div>\r\n</div>\r\n\r\n<div id="modalPopupGameEdit" class="modal photo-frame-model hide fade">\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">\r\n			&times;\r\n		</button>\r\n	</div>\r\n	<form action="#" class="update-date-time-h" name="update-date-time">\r\n	<div class="modal-body page-content-h">\r\n\r\n			<div class="row-fluid">\r\n				<label>Event Name</label>\r\n				<input type="text" id="event_name" value="{{event_name}}" />\r\n			</div>\r\n			<div class="row-fluid">\r\n			<label>Date &amp; Time</label>\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" value="{{gameDay}}" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" value="{{game_hour}}" placeholder="Time" maxlength="5" />\r\n			<span class="spn-ddl-time-period_h"></span>\r\n			</div>\r\n			<div class="row-fluid"><label>Location</label></div>\r\n			\r\n			<textarea placeholder="Address" class="location-h address-h" rows="3" cols="25">{{game_location}}</textarea>\r\n			<a href="javascript: void(0);" title="Verify Address" class="verify-address-h">Verify Address</a>\r\n			<span class="address-error hide address-error-status-h"></span>\r\n			<div class="view-map-h"></div>\r\n\r\n\r\n	</div>\r\n	<div class="modal-footer"><input type="submit" class="common-btn common-btn-validation" name="submit_edit-form" value="Update" />	</div>\r\n	</form>\r\n</div>\r\n{{/payload}}\r\n'}),define("game/models/score",["models/base"],function(e){return e.extend({url:function(){return testpath?testpath+"/game/score/":"/api/game/score/"+this.gameId+"/?games_teams_link_id="+this.teams_id+"&score="+this.score}})}),define("text!usercontrols/location/templates/layout.html",[],function(){return'<div>\r\n	Location: <textarea placeholder="Address" class="location-h address-h" rows="3" cols="25"></textarea>\r\n	<span class="address-error hide address-error-status-h"></span>\r\n	<a href="javascript: void(0);" class="common-btn common-btn-validation verify-address-h">Verify Address</a>\r\n	<a href="javascript: void(0);" class="common-btn common-btn-direction link-disabled set-address-h">Set Address</a>\r\n	 <div id="map-canvas" style="width: 90%; height: 300px; margin-top: 40px;"></div>\r\n</div>'}),define("usercontrols/location/models/verify-adress",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/location/add?address="+this.address:"/api/location/add?address="+this.address}})}),define("usercontrols/location/models/save",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/game/basics/"+this.id:"/api/game/basics/"+this.id}})}),define("usercontrols/location/views/location",["require","text!usercontrols/location/templates/layout.html","facade","views","utils","vendor","usercontrols/location/models/verify-adress","usercontrols/location/models/save"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=e("usercontrols/location/models/verify-adress"),l=e("usercontrols/location/models/save"),c=a.Mustache,h=r.$,p=i.BaseView,d=r.Backbone,v;return d.View.extend({template:t,events:{"click .verify-address-h":"verifyAddress","click .set-address-h":"setLocation"},initialize:function(e){v=this,v.game_id=e.game_id||undefined,v.location=e,v.selectedOptions=[],v.setOptions(e),v.render()},setLocation:function(e){var t=confirm("Are you sure want to set new address?");if(t&&this.locationId){var n=new l;n.id=this.game_id,n.set({locations_id:this.locationId,id:this.game_id}),n.save(),h.when(n.request).done(function(){routing.trigger("popup-close")})}},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new f,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),h.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id;if(e.locationId){e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.latitude=e.adressModel.get("payload").lat,e.location.latitude=e.adressModel.get("payload").lon,e.$el.find(".set-address-h").removeClass("link-disabled");var t=new google.maps.LatLng(e.adressModel.get("payload").lat,e.adressModel.get("payload").lon);e.marker.setPosition(t),e.map.panTo(t)}})},intializeMap:function(){console.log(v.location);var e=new google.maps.LatLng(v.location.latitude,v.location.longitude),t={zoom:13,center:e,scaleControl:!0,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.$el.find("#map-canvas")[0],t),this.marker=new google.maps.Marker({position:e,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=c.to_html(e.template,{location:e.locaion});return h(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("game/views/header",["require","text!game/templates/header.html","facade","views","game/models/score","game/models/basics","votes/models/vote","votes/models/follow","usercontrols/location/views/location","usercontrols/location/models/verify-adress","usercontrols/location/models/save","chrome/views/header","usercontrol/dropdown/view/dropdown","media/views/image-item"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("game/models/score"),o=e("game/models/basics"),u=e("votes/models/vote"),a=e("votes/models/follow"),f=e("media/views/image-item"),l=e("usercontrols/location/views/location"),c=e("usercontrol/dropdown/view/dropdown"),h=e("usercontrols/location/models/verify-adress"),p=e("usercontrols/location/models/save"),d=i.SectionView;return n=d.extend({id:"main-header",template:t,events:{"click .edit-score-h":"editScore","blur .edit-score-input-h":"resumeEditScore","click .vote":"vote","click .follow":"follow","click .object-edit-h":"editObject","click .object-delete-h":"deleteObject","submit .update-date-time-h":"updateDateTime","click .game-edit-btn-h":"openEditPopup","click .verify-address-h":"verifyAddress","blur .address-h":"verifyAddress"},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},location:{lat:undefined,lon:undefined},initialize:function(e){d.prototype.initialize.call(this,e);var t=this.model.get("payload"),n;if(t.teams){if(t.teams.length)try{n=t.teams[0].org_name+" VS "+t.teams[1].org_name,n+=" "+t.shared.complevel}catch(r){n="Game Page"}}else n=t.event_name;n+=" | "+t.shared.sport+" | "+t.game_day,document.title=n,this.setDateFields()},setDateFields:function(){var e=this.model.get("payload"),t=e.game_time;console.log(t);if(t!=undefined)try{var n=t.split(" ");console.log(n),n.length&&(e.game_hour=n[0],e.game_ampm=n[1],console.log("full payload now",e),this.model.set("payload",e))}catch(r){}},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},openEditPopup:function(){if(!this.checkForUser()){routing.trigger("showSignup");return}$("#modalPopupGameEdit").modal(),this.location.lon=this.model.get("payload").location.lon,this.location.lat=this.model.get("payload").location.lat,this.showLocation()},showLocation:function(){routing.trigger("show_location",this.location.lat,this.location.lon,".view-map-h",function(){})},setLocation:function(e){var t=confirm("Are you sure want to set new address?");if(t&&this.locationId){var n=new p;n.id=this.game_id,n.set({locations_id:this.locationId,id:this.game_id}),n.save(),$.when(n.request).done(function(){routing.trigger("popup-close")})}},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new h,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),$.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id,e.locationId&&(e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.lon=e.adressModel.get("payload").lon,e.location.lat=e.adressModel.get("payload").lat,e.showLocation(),e.$el.find(".set-address-h").removeClass("link-disabled"))})},editObject:function(){alert("Coming soon")},deleteObject:function(){alert("Coming soon")},gameEditBtn:function(){this.$el.find(".update-date-time-h").removeClass("hide")},tags:{rgxTime:/^(0?[1-9]|1[012])(:[0-5]\d)$/,rgxTimeWhole:/^(0?[1-9]|1[012])$/},formatDate:function(e,t,n){var r=$.datepicker.formatDate("yy-mm-dd",e);try{var i=t.split(":");return console.log(i),i.length==1&&(t+=":00"),t+=" "+n,r+=" "+t,r}catch(s){return!1}},updateDateTime:function(e){e.preventDefault();var t=!0,n=this,r=$(this.el).find(".txt-game-date_h").datepicker("getDate"),i=$(this.el).find(".txtTime").val(),s=$(this.el).find("#hdn_time-period_h").val(),t=!0;if(!r||!i)$(n.destination).find(".section-game-date_h").find(".field-message_h").html("Please Se").fadeIn(),t=!1;else{var o=i.match(n.tags.rgxTime)||i.match(n.tags.rgxTimeWhole);console.log("orginal date",r),console.log("orginal time",i),console.log("ampm",s),o?($(n.el).find(".section-game-date_h").find(".field-message_h").html("").fadeOut(),r=this.formatDate(r,i,s),r||(t=!1)):(console.log("NOT VALID"),$(n.el).find(".section-game-date_h").find(".field-message_h").html(n.messages.selectValidTime).fadeIn(),t=!1)}console.log("new date",r);var u=$(n.el).find("#event_name").val(),a=this,f=new p;f.id=this.model.id,console.log(f,u),f.set({game_datetime:r,locations_id:this.locationId,id:this.model.id,event_name:u}),f.save(),$.when(f.request).done(function(){a.updateHeaderData(f.id)})},updateHeaderData:function(e){var t=this;t.model.id=e,t.model.fetch(),$.when(t.model.request).done(function(){t.setDateFields(),console.error(t.model.toJSON()),$("#modalPopupGameEdit").modal("hide"),t.render()})},cancelDateTimeBtn:function(){this.$el.find(".update-date-time-h").addClass("hide")},afterRender:function(){this.$el.find(".image-outer-h").mouseover(function(){$(this).find(".action-block").css({opacity:90})}).mouseout(function(){$(this).find(".action-block").css({opacity:0})}),this.$el.find(".date-time-h").datetimepicker({timeFormat:"hh:mm:ss",dateFormat:"yy-mm-dd",showTimezone:!0,changeMonth:!0,changeYear:!0})},vote:function(e){e.preventDefault(),console.log(this.model);var t=new u;t.userId=this.model.id,t.entity_id=this.model.get("payload").enttypes_id,t.setData(),t.save()},follow:function(e){e.preventDefault(),console.log(e.target);var t=new a;t.userId=this.model.id,t.entity_id=this.model.get("payload").enttypes_id,t.save()},editScore:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}$(e.currentTarget).hide(),$(e.currentTarget).parents(".score-box-h").find(".edit-score-input-h").attr("type","text").focus()},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},resumeEditScore:function(e){var t=new s;t.teams_id=$(e.currentTarget).data("id"),t.score=$(e.target).val(),t.gameId=this.model.id,t.set({id:$(e.target).data("id"),games_teams_link_id:$(e.target).data("id"),score:$(e.target).val()}),t.save(),this.$el.find(".edit-score-input-h").attr("type","hidden"),this.$el.find(".edit-score-h").show(),$.when(t.request).done(function(){$(e.currentTarget).parents(".score-box-h").find(".edit-score-h span").html(t.get("score"))})},childViews:{},render:function(e,t,n){d.prototype.render.call(this,e,t,n),$(this.el).find(".txt-game-date_h").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});var r=[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],i={};i.records=r,i.recordId="name",i.recordValue="value";var s=this,o=new c({data:i,elementId:"hdn_time-period_h",destination:".spn-ddl-time-period_h",targetView:s,selectedValue:this.model.get("payload").game_ampm,callback:function(e){}});this.renderImage()},renderImage:function(){this.headerImage=new f({model:this.model}),this.headerImage.render(),this.$el.find(".image-outer-h").html(this.headerImage.$el)}}),n}),define("text!media/templates/add-media.html",[],function(){return'{{#links}}<a href="{{link}}" title="{{label}}" id="{{id}}">{{label}}</a>{{/links}}\r\n'}),define("game/views/add-media",["require","text!media/templates/add-media.html","game/models/addmedia","facade","views","sportorg/models/team"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("sportorg/models/team"),u=r._;return GameAddMediaView=s.extend({id:"add-media",template:t,events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup"},game_model:{},initialize:function(e){s.prototype.initialize.call(this,e)},openAddvideoPopup:function(e){var t="/api/user/addvideo/"+this.model.id;Channel("add-video").publish(t)},setOptions:function(e){if(!this.model)throw new Error("AddMediaView expects option with model property.")},childViews:{},render:function(e,t,n){s.prototype.render.call(this,e,t,n)},openAddImagePopup:function(e){if(this.game_model.attributes.payload.sports_id>0){var t="/api/game/addimage/"+this.game_model.attributes.id,n={sports_id:this.game_model.attributes.payload.sports_id};routing.trigger("add-image",t,n)}else try{var r=new o({id:this.game_model.attributes.payload.teams[0].id});r.fetch();var i=this;$.when(r.request).done(function(){var e="/api/game/addimage/"+i.game_model.attributes.id,t={sports_id:r.attributes.payload.org_sport_link_obj.sports_id};routing.trigger("add-image",e,t)})}catch(s){alert("Whaaaa...?  It seems like the sport isn't set for this game (weird), which means we can't add the photo.  Shoot an email to support@athletez.com and we'll figure out what went wrong.")}}}),GameAddMediaView}),define("text!site/templates/comment-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid" data-id="bbbbbbbb">\r\n	<div class="user-photo">\r\n		<a href="#profile/{{user.id}}" title="{{user.name}}">\r\n			<img src="{{base_url}}{{poster_picture}}" alt="{{poster}}" />\r\n		</a>\r\n	</div>\r\n\r\n	<div>\r\n		<div class="bubble">\r\n			<div class="pointer"></div>\r\n			<div class="content">\r\n\r\n				<span class="comment-date"><a href="#profile/{{user.id}}" title="{{user.name}}">{{user.name}}</a>  {{poster}} {{comment_date}}</span>\r\n				\r\n				<p class="comment-text">{{comment}}</p>\r\n\r\n				{{#is_owner}}<a href="javascript: void(0);" title="delete" class="delete-comment-h comment-delete">Delete</a>{{/is_owner}}\r\n\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n{{/payload}}\r\n\r\n\r\n\r\n'}),define("site/views/comment-item",["vendor","views","utils","text!site/templates/comment-item.html","common/models/delete"],function(e,t,n,r){var i,s=t.BaseView,o=require("common/models/delete"),u=e.Mustache;return i=s.extend({tagName:"li",className:"comment",events:{"click .delete-comment-h":"deleteComments"},initialize:function(e){e.template?this.template=e.template:this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());this.$el.html(e);var t=this.model.get("payload");console.log("profile payload = ",t);var n=this;if(t)try{var r=t.user.user_picture_obj.types.small_thumb.url;n.$(".user-photo img").attr("src",r)}catch(i){console.log(i)}return this},deleteComments:function(e){console.log(this.model),e.stopPropagation(),e.preventDefault();var t=this,n=new o;console.log("payload",this.model.get("payload")),n.subject_id=this.model.get("payload").id,n.enttypes_id=this.model.get("payload").enttypes_id,n.removeNode=$(e.currentTarget).parents("li.comment"),n.destroyAndRemove()}}),i}),define("text!site/templates/comment-form.html",[],function(){return'<a href="javascript: void(0);" class="add-comment-h">Comment</a>\r\n{{#payload}}\r\n\r\n<form class="add-comment-form-h hide" method="post" action="#">\r\n<div class="row-fluid">\r\n    <div class="field-message submit-result"></div>\r\n    <textarea style="width:85%;-webkit-border-radius: 15px; border-radius: 15px; height: 20px;\r\n	margin-top: 4%;" id="new-comment" placeholder="Leave a comment" ></textarea>\r\n    <br/><input type="button" id="comment-submit" value="Submit"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("site/views/comment-form",["require","text!site/templates/comment-form.html","facade","views","site/models/comment"],function(e){var t,n=e("text!site/templates/comment-form.html"),r=e("facade"),i=e("views"),s=e("site/models/comment"),o=i.BaseView;return t=o.extend({tagName:"li",template:n,events:{"click #comment-submit":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("CommentFormView expected options.collection.");!this.model},render:function(){console.log("RENDER CALLED!!!!"),o.prototype.render.call(this),this.input=this.$("#new-comment");var e=this.model.get("payload");console.log("return payloady",e);var t=this;if(e)var n=e.user_picture,r=e.email;return this},submitHandler:function(e){e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();t!=""&&this.input.val("")}}),t}),define("text!site/templates/comment-list.html",[],function(){return'<div class="comment-outer-h">\r\n<ul id="comment-list"></ul>\r\n</div>\r\n<div class="clear">\r\n	<a href="javascript: void(0);" class="see-more-h">See More</a>\r\n</div>'}),define("site/views/comment-list",["facade","views","utils","site/views/comment-item","site/views/comment-form","text!site/templates/comment-list.html"],function(e,t,n,r,i,s){var o,u,a=n.lib.Channel,f=require("vendor"),l=t.CollectionView,c=t.SectionView,h=f.Mustache;return u=l.extend(c.prototype),o=u.extend({__super__:l.prototype,listView:"#comment-list",_tagName:"li",_className:"comment",page:1,page_limit:5,prepend:!1,_view:r,template:s,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=h.to_html(this.template);return this.$el.html(e),this},initialize:function(e){this.renderTemplate();var t=this;this.collection=e.collection,console.log(this.collection.toJSON()),t.allData=this.collection.toArray(),t.seeMore(),l.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CommentListView expected options.collection.");_.bindAll(this),this.addSubscribers(),this.setupFormView(),console.log(this.collection.toJSON())},seeMore:function(e){var t=this.allData.length,n=t<this.page_limit?t:this.page_limit,r=t-this.page*n,i=r+this.page_limit;r<=0&&this.$el.find(".see-more-h").hide(),this.prepend=!0,e?this.collection.add(this.allData.slice(r,i)):this.collection.reset(this.allData.slice(r,i)),this.page++,this.prepend=!1,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},childViews:{},setupFormView:function(){function r(n){t.model=n,t.render(),$(e.listView).prepend(t.el)}var e=this,t=new i({collection:this.collection}),n=this.addChildView(t);console.log("Form:",t),this.childViews.form=t,this.callbacks.add(function(){n()}),a("commentform:fetch").subscribe(r)}}),o}),define("profile/models/commentonform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/commentonform/"+this.id:"/api/user/basics/"+this.id},initialize:function(e,n){i.bindAll(this),t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),routing.trigger("profilecommentonform:fetch",e)}}),r}),define("profile/views/commenton-form",["require","text!site/templates/comment-form.html","profile/models/commentonform","site/views/comment-form","models/base","views"],function(e,t,n,r,i){var s,o=e("views"),u=o.BaseView;return s=u.extend({initialize:function(e){console.error(e),_.bindAll(this),this.setOptions(),u.prototype.initialize.call(this,e)},el:"#comment_div",template:t,events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox"},setOptions:function(e){if(!this.collection)throw new Error("ProfileCommentOnFormView expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(e){var t=this.$el.find(".add-comment-form-h");t.hasClass("hide")?($(e.target).html("Hide"),t.removeClass("hide")):($(e.target).html("Comment"),t.addClass("hide"))},refreshComments:function(e){this.$("#new-comment").val("")},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=this.model.get("id");var s=new i(r);s.url=function(){return debug.log(n),_.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/comment/add/":"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.on("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return u.prototype.render.call(this),this.input=this.$("#new-comment"),this.collection.length||$(".add-comment-h").trigger("click"),console.log("run here now",this.el),this}}),s}),define("game/views/commenton-list",["facade","utils","site/views/comment-list","profile/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({name:"games comments on view",initialize:function(e){o.bindAll(this),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){alert("refresh"),s(e)})}}),s}),define("text!sportorg/templates/teamroster-item.html",[],function(){return'\r\n{{#payload}}\r\n    <h3>{{name}}</h3>\r\n        <img src="{{user_picture}}" alt="{{name}}"/><br/>\r\n        {{name}} \'{{grad_year}}<br/>\r\n        {{sport_name}}<br/>\r\n        {{position}}<br/>\r\n        {{team_name}}<br/>\r\n    <br/><br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/teamroster-item",["vendor","views","utils","text!sportorg/templates/teamroster-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"teamroster",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/teamroster-list",["facade","views","utils","sportorg/views/teamroster-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"teamroster-list",name:"Team Roster List",tagName:"ul",_tagName:"li",_className:"teamroster",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("TeamRosterListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("text!media/templates/video-item.html",[],function(){return'<input type="hidden" class="id" value="{{id}}"/>\r\n{{#payload}}    \r\n    <img src="{{base_url}}{{video_thumb}}" alt="{{video_title}}"/>\r\n<div class="row-fluid" style="display:none;">\r\n    <div class="span6">\r\n        <img src="{{base_url}}{{video_thumb}}" alt="{{video_title}}"/>\r\n    </div>\r\n    <div class="span6">\r\n        {{video_title}}<br/>\r\n        Teams: \r\n        {{#teams}}\r\n            {{.}}&nbsp;\r\n        {{/teams}}\r\n        <br/>\r\n        Games: \r\n        {{#games}}\r\n            {{.}}&nbsp; \r\n        {{/games}}\r\n        <br/>\r\n        Posted by {{user_name}}, {{post_date}}<br/>\r\n        {{num_votes}} Votes, {{num_views}} Views, {{num_comments}} Comments<br/>\r\n        <p>{{video_desc}}</p>\r\n        {{#tags_count}}\r\n            {{tags_count}} Tagged<br/>\r\n            {{#tags}}\r\n                <img src="{{base_url}}{{.}}"/>\r\n            {{/tags}}\r\n        {{/tags_count}}\r\n    </div>\r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("media/views/video-item",["vendor","views","utils","text!media/templates/video-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"video",events:{click:"changeVideo"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeVideo:function(){Channel("changevideo"+this.model.collection.id).publish(this.model)}}),i}),define("text!media/templates/video-player.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter"><img src="{{base_url}}{{video_src}}" alt="{{video_title}}"/></div>\r\n    <h3>{{video_title}}</h3>\r\n    {{#games}} \r\n        {{team1_name}} vs {{team2_name}}\r\n    {{/games}}    \r\n    Votes: {{num_votes}}, Views: {{num_views}}, Comments: {{num_comments}}<br/>\r\n    <br>\r\n\r\n		{{#video_type}}\r\n				{{video_type_name}}\r\n				{{meta_details.url}}\r\n				<br>\r\n		{{/video_type}}\r\n    <div class="social-links">\r\n    {{#social_links}}\r\n        <a class="{{class}}" href="{{link}}" title="{{title}}">{{title}}</a>\r\n    {{/social_links}}\r\n    </div>\r\n{{/payload}}\r\n\r\n'}),define("media/views/video-player",["require","text!media/templates/video-player.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.BaseView,o=r._;return n=s.extend({tagName:"li",className:"video-player",template:t,setOptions:function(e){if(!this.model)throw new Error("VideoPlayerView expected options.model.")},render:function(){s.prototype.render.call(this)}}),n}),define("text!media/templates/add-video.html",[],function(){return'\r\n{{#payload}}\r\n<form>\r\n<div class="row-fluid">\r\n    <input type="text" name="title" id="title" placeholder="Video Title"/><br/>\r\n    ...<br/>\r\n    <input type="button" id="addvideo" value="Add Video"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("media/views/add-video",["require","text!media/templates/add-video.html","facade","views","media/models/video"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("media/models/video"),o=i.BaseView,u=r._;return n=o.extend({tagName:"li",template:t,events:{"click #addvideo":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("AddVideoView expected options.collection.");this.model||(this.model=new s({id:this.collection.id}),this.model.fetch())},render:function(){o.prototype.render.call(this),this.input=this.$("#title")},submitHandler:function(e){alert("AddVideoView"),e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();if(t!=""){var n=this.model.get("payload");n.video_title=this.input.val(),this.model.save();var r=this.model.clone();r.id=Math.ceil(Math.random()*1e5),this.collection.push(r),this.input.val("")}}}),n}),define("media/views/video-list",["facade","views","utils","media/views/video-item","media/views/video-player","media/views/add-video"],function(e,t,n,r,i,s){var o,u,a=e.$,f=e._,l=n.lib.Channel,c=t.CollectionView,h=t.SectionView;return u=c.extend(h.prototype),o=u.extend({__super__:c.prototype,id:"video-list",name:"Video List",tagName:"ul",_tagName:"li",_className:"video",_view:r,initialize:function(e){c.prototype.initialize.call(this,e);if(!this.collection)throw new Error("VideoListView expected options.collection.");f.bindAll(this),this.addSubscribers(),this.setupPlayerView(),this.setupAddView()},childViews:{},setupAddView:function(){function r(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new s({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),l("addvideo:fetch").subscribe(r)},setupPlayerView:function(){function r(e){t.model=e,t.render()}if(this.collection.size()==0)return;var e=this,t=new i({collection:this.collection,model:this.collection.at(0)}),n=this.addChildView(t);this.childViews.player=t,this.callbacks.add(function(){n(),t.render(),e.$el.prepend(t.el)}),l("changevideo"+this.collection.id).subscribe(r)}}),o}),define("game/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/addvideo/"+this.id:"/api/game/addvideo?game_id="+this.id},initialize:function(e,n){t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gameaddvideo:fetch").publish(e)}}),r}),define("game/views/add-video",["require","game/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("GameAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id}),this.model.fetch())}}),r}),define("game/views/video-list",["facade","utils","media/views/video-list","game/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gameaddvideo:fetch").subscribe(i)}}),i}),define("text!media/templates/image-board.html",[],function(){return'<!--{{#payload}}\r\n    <div class="textcenter"><img src="{{base_url}}{{image_path}}" alt="{{image_title}}"/></div>\r\n    {{#image_title}}<h3>{{image_title}}</h3>{{/image_title}}\r\n    {{#num_votes}}Votes: {{num_votes}} <br/>{{/num_votes}}\r\n{{/payload}}-->'}),define("media/views/image-board",["require","text!media/templates/image-board.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.BaseView,o=r._;return n=s.extend({tagName:"li",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){s.prototype.render.call(this)}}),n}),define("text!media/templates/add-image.html",[],function(){return'\r\n{{#payload}}\r\n<form>\r\n<div class="row-fluid">\r\n    <input type="text" name="title" id="title" placeholder="Image Title"/><br/>\r\n    ...<br/>\r\n    <input type="button" id="addimage" value="Add Image"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("media/views/add-image",["require","text!media/templates/add-image.html","facade","views","media/models/image"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("media/models/image"),o=i.BaseView;return n=o.extend({tagName:"li",template:t,events:{"click #addimage":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("AddImageView expected options.collection.");!this.model},render:function(){o.prototype.render.call(this),this.input=this.$("#title")},submitHandler:function(e){e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();if(t!=""){var n=this.model.get("payload");n.image_title=this.input.val(),this.model.save();var r=this.model.clone();r.id=Math.ceil(Math.random()*1e5),this.collection.push(r),this.input.val("")}}}),n}),define("text!media/templates/image-list.html",[],function(){return'<ul class="image-list">\r\n</ul>\r\n<!--{{#target}}\r\n<div class="image-drop-area-outer">\r\n	<div class="image-drop-area" id="image-place-holder">\r\n		<div class="drop-text">DROP PHOTOS HERE</div>\r\n		<div>OR CLICK TO UPLOAD</div>\r\n		\r\n	</div>\r\n</div>\r\n{{/target}}-->\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">More</a></div>\r\n'}),define("media/views/image-list",["facade","views","utils","media/views/image-item","media/views/image-board","media/views/add-image","text!media/templates/image-list.html"],function(e,t,n,r,i,s,o){var u,a,f=e.$,l=e._,c=require("vendor"),h=n.lib.Channel,p=t.CollectionView,d=t.SectionView,v=c.Mustache;return a=p.extend(d.prototype),u=a.extend({__super__:p.prototype,template:o,_tagName:"li",_className:"image",page:0,page_limit:8,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore","click .open-photo-player-h":"initPhotoPlayer","dragover #image-place-holder":"drag","drop #image-place-holder":"drop"},renderTemplate:function(){var e=v.to_html(this.template,{target:this.target_id});return this.$el.html(e),this},drag:function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},drop:function(e){var t=this;e.stopPropagation(),e.preventDefault();var n=e.originalEvent.dataTransfer.files;this.files_drag=e.originalEvent.dataTransfer.files;var r=[],i=[],s=0;for(var o=0,u;u=n[o];o++){if(!u.type.match("image.*"))continue;var a=new FileReader;a.onload=function(e){return function(r){var o="preview_"+s;s++,i.push({preview_id:o,drag_info:t.files_drag,width:"150",height:"150",filesrc:r.target.result,title:escape(e.name)}),s==n.length&&(data={data:i},t.openImageUploader(data))}}(u),a.readAsDataURL(u)}},openImageUploader:function(e){console.error(this.collection);var t=this.sport_id,n=this.target_url+this.target_id,r={sports_id:t},i=e;routing.trigger("add-image",n,r,i)},initialize:function(e){e.name?this.name=e.name:this.name="image list",e.collecton&&(this.collection=e.collection),this.target_id=e.target_id,this.target_url=e.target_url,this.sport_id=e.sport_id,this.user_id=e.user_id,this.renderTemplate();var t=this;t.allData=this.collection.toArray(),t.seeMore(),p.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");l.bindAll(this),this.addSubscribers(),this.setupBoardView(),this.setupAddView()},initPhotoPlayer:function(e){var t=f(e.target).parents("li").index();t<0&&(t=0),routing.trigger("photo-player-init",t,this.allData,this.user_id,!0)},seeMore:function(e){var t=this.allData.length,n=this.page*this.page_limit,r=n+this.page_limit;t<=r&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(n,r)):this.collection.reset(this.allData.slice(n,r)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},childViews:{},setupAddView:function(){function r(e){t.model=e,t.render(),f(this.listView).append(t.el)}var e,t=new s({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),h("addimage:fetch").subscribe(r)},filterWithImageType:function(e){var t=this.collection;return f.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t},setupBoardView:function(){function s(e){n.model=e,n.render()}if(this.collection.size()==0)return;var e=this.filterWithImageType(this.imagetype),t,n=new i({collection:e,model:e.at(0)}),r=this.addChildView(n);this.childViews.board=n,this.callbacks.add(function(){r(),n.render(),f(this.listView).prepend(n.el)}),h("changeimage"+this.collection.id).subscribe(s)}}),u}),define("profile/views/image-video-list",["facade","utils","media/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",name:"Image List",setupAddView:function(){}}),r}),define("game/models/commentform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({defaults:{payload:{}},url:function(){return testpath?testpath+"/game/commentform/"+this.id:"/api/game/commentform/"+this.id},initialize:function(e,n){i.bindAll(this),t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gamecommentform:fetch").publish(e)}}),r}),define("game/views/comment-form",["require","game/models/commentform","site/views/comment-form"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("GameCommentFormView expected options.collection.");this.model||(this.model=new t({id:this.collection.id}),this.model.fetch())}}),r}),define("game/views/comment-list",["facade","utils","site/views/comment-list","game/views/comment-form"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupFormView:function(){function i(n){t.model=n,t.render(),e.$el.prepend(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gamecommentform:fetch").subscribe(i)}}),i}),define("text!roster/templates/roster.html",[],function(){return'<div class="green-left-heading heading-h"></div>\r\n<div  class="clearfix clear roster-images-h"></div>'}),define("roster/models/roster",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({}),n}),define("roster/collections/roster",["facade","sportorg/collections/teamrosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/roster/"+this.id:"/api/team/roster/"+this.id}}),r}),define("roster/views/image-list",["facade","utils","media/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",tagName:"ul",setupAddView:function(){}}),r}),define("roster/views/roster",["require","text!roster/templates/roster.html","views","vendor","facade","utils","jqueryui","controller","roster/models/roster","roster/collections/roster","roster/views/image-list"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("roster/models/roster"),d=e("roster/views/image-list"),v=e("roster/collections/roster");return n=o.extend({template:t,events:{},initialize:function(e){var t=this;o.prototype.initialize.call(this,e),t.team_id=e.team_id,t.team_name=e.team_name,t.viewName=e.viewName||"Image List"+Math.random(),a.bindAll(this),t.team_id&&(t.collection1=new v,t.collection1.id=t.team_id,t.collection1.fetch(),u.when(t.collection1.request).done(function(){t.setupTeamRosterListView()}))},setupTeamRosterListView:function(){var e;e=new d({collection:this.collection1,name:this.viewName,model:new p}),this.$el.find(".roster-images-h").html(e.$el)},render:function(e,t,n){o.prototype.render.call(this,e,t,n),this.$el.find(".heading-h").html(this.team_name)}}),n}),define("text!game/templates/participats-list.html",[],function(){return'<div class="clear">\r\n	<a href="javascript: void(0);" class="add-to-event" title="Add me to this Event">Add me to this Event</a>\r\n</div>\r\n<ul class="image-list">\r\n</ul>\r\n\r\n<!--a href="javascript: void(0);" class="add-comment">Add Comment</a>\r\n<a href="javascript: void(0);" class="add-media">Add Media</a-->\r\n\r\n\r\n<!--{{#target}}\r\n<div class="image-drop-area-outer">\r\n	<div class="image-drop-area" id="image-place-holder">\r\n		<div class="drop-text">DROP PHOTOS HERE</div>\r\n		<div>OR CLICK TO UPLOAD</div>\r\n	</div>\r\n</div>\r\n{{/target}}-->\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">More</a></div>\r\n'}),define("game/models/addparticipate",["facade","media/models/image","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/uslgamelink/add/":"/api/uslgamelink/add/"}}),r}),define("common/models/add",["facade","models/base"],function(e,t){var n=e._;return t.extend({defaults:n.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),t!=undefined?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this}})}),define("game/views/participants-list",["facade","views","utils","media/views/image-item","text!game/templates/participats-list.html","game/models/addparticipate","common/models/add"],function(e,t,n,r,i,s,o){var u,a,f=e.$,l=e._,c=require("vendor"),h=n.lib.Channel,p=t.CollectionView,d=t.SectionView,v=c.Mustache;return ParticipantsView=p.extend(d.prototype),ParticipantsView.extend({__super__:p.prototype,template:i,_tagName:"li",_className:"image",page:0,page_limit:8,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=v.to_html(this.template,{target:this.target_id});return this.$el.html(e),this},addParticipant:function(){var e=new s,t=this;e.set({games_id:this.game_id,sports_id:this.sports_id}),e.save(),f.when(e.request).done(function(){var n=new o;n.processItemFromPayload(e.toJSON()),t.$el.find(".add-to-event").hide(),t.collection.add(n)})},initialize:function(e){var t=this;f(document).off("click",".add-to-event"),f(document).on("click",".add-to-event",function(){t.addParticipant()}),f(".participants-heading-h").removeClass("hide"),e.name?this.name=e.name:this.name="image list",e.collecton&&(this.collection=e.collection),this.controller=e.controller,this.sports_id=e.sports_id,this.game_id=this.collection.id,this.renderTemplate();var n=this.collection.toArray(),r=n[0].get("payload"),i=[];for(var s in r)console.error(routing.loggedInUserId==r[s].id),routing.loggedInUserId==r[s].id&&this.$el.find(".add-to-event").hide(),i.push({payload:r[s]});this.collection.reset(i),this.target_id=e.target_id,this.target_url=e.target_url,this.sport_id=e.sport_id;var t=this;t.allData=this.collection.toArray(),t.seeMore(),p.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");l.bindAll(this),this.addSubscribers(),this.setupAddView()},seeMore:function(e){var t=this.allData.length,n=this.page*this.page_limit,r=n+this.page_limit;t<=r&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(n,r)):this.collection.reset(this.allData.slice(n,r)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupAddView&&this.setupAddView())},childViews:{},setupAddView:function(){function r(e){t.model=e,t.render(),f(this.listView).append(t.el)}var e,t=new AddImageView({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),h("addimage:fetch").subscribe(r)},filterWithImageType:function(e){var t=this.collection;return f.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t}})}),define("game/views/participants-list-main",["facade","views","utils","game/views/participants-list"],function(e,t,n,r){return r.extend({imagetype:"large_thumb",setupAddView:function(){}})}),define("game",["require","text!game/templates/layout.html","votes/views/vote","facade","controller","models","views","utils","game/models/basics","game/models/addmedia","game/collections/teamrosters","game/collections/videos","game/collections/images","game/collections/participants","game/collections/comments","game/collections/commentson","game/views/header","game/views/add-media","game/views/commenton-list","sportorg/views/teamroster-list","game/views/video-list","profile/views/image-video-list","game/views/comment-list","game/views/commenton-list","roster/views/roster","game/views/participants-list-main"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("game/models/basics"),l=e("game/models/addmedia"),c=e("game/collections/teamrosters"),h=e("game/collections/videos"),p=e("game/collections/images"),d=e("game/collections/comments"),v=e("game/collections/commentson"),m=e("game/collections/participants"),g=e("game/views/header"),y=e("game/views/add-media"),b=e("sportorg/views/teamroster-list"),w=e("game/views/video-list"),E=e("profile/views/image-video-list"),S=e("game/views/comment-list"),x=e("game/views/commenton-list"),T=e("media/models/image"),N=e("roster/views/roster"),C=e("game/views/participants-list-main"),k=u.LayoutView,L=i.$,A=i._,O=a.debug,M=a.lib.Channel,_=["/pages/game/game.css"];return r=s.extend({rosterViewsCount:0,initialize:function(e){return M("load:css").publish(_),A.bindAll(this),this.scheme=[],this.handleOptions(e),this.init(),this},handleOptions:function(e){this.id=e.gameId,this.userId=e.userId},init:function(){this.setupLayout().render(),this.createData(),this.handleDeferreds()},createData:function(){this.basics=new f({id:this.id}),this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new l,this.addmedia.id=this.id},handleDeferreds:function(){var e=this;L.when(this.basics.request).done(function(){console.error(e.basics),e.setupHeaderView(),e.setupAddMediaView();var t=e.basics.get("payload"),n=t.enttypes_id;e.images=new p,e.images.id=e.id,e.images.targetElement="#image-wrap",e.images.fetch();var r=t.teams,i=r?r.length:0;for(var s=0;s<i;s++)e.setupRosterView(r[s].id,r[s].org_sport_link_obj.org.name);e.commentson=new v,e.commentson.subject_entity_type=n,e.commentson.id=e.id,e.commentson.targetElement="#comment_div",e.commentson.fetch();var o=e.basics.get("payload"),u=!A.isUndefined(o.teams)&&o.teams?o.teams.length:0;u||(e.participants=new m,e.participants.id=e.id,e.commentson.targetElement="#roster-wrap",e.participants.fetch(),L.when(e.participants.request).done(function(){e.setupParticipantsListView()})),L.when(e.commentson.request).done(function(){e.setupCommentsOnListView()}),L.when(e.images.request).done(function(){e.setupImageListView()})})},initVoteView:function(){var e=new n({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},setupRosterView:function(e,t){L("#roster_wrap_"+this.rosterViewsCount).length||L("#roster-wrap").append('<div id="roster_wrap_'+this.rosterViewsCount+'" class="clear"></div>');var n,r=i.Backbone.Collection.extend({});n=new N({model:new r,team_id:e,team_name:t,name:"roster images"+Math.random()*Math.random(),destination:"#roster_wrap_"+this.rosterViewsCount}),this.scheme.push(n),this.layout.render(),this.rosterViewsCount++},setupHeaderView:function(){var e;e=new g({model:this.basics,name:"Header",destination:"#main-header"}),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(){var e;e=new y({model:this.addmedia,name:"Add Media",destination:"#add-media"}),e.game_model=this.basics,this.scheme.push(e),this.layout.render()},reloadParticipateView:function(){var e=this,t;this.participantsView&&(L(this.participantsView.destination).html(""),t=L.inArray(this.participantsView,this.scheme),~t&&this.scheme.splice(t,1)),e.participants.fetch(),L.when(e.participants.request).done(function(){console.error(e.participants),e.setupParticipantsListView()})},setupParticipantsListView:function(){this.participantsView=new C({collection:this.participants,name:"participants view",controller:this,sport_id:this.basics.get("payload").sports_id,destination:"#participants_div"}),this.scheme.push(this.participantsView),this.layout.render()},setupTeamRosterListView:function(){alert(L("#roster_wrap_"+this.rosterViewsCount).length),L("#roster_wrap_"+this.rosterViewsCount).length||L("#roster-wrap").append('<div id="#roster_wrap_'+this.rosterViewsCount+'" class="clear"></div>');var e;e=new E({collection:this.teamrosters,name:"roster images",destination:"#roster_wrap_"+this.rosterViewsCount}),this.scheme.push(e),this.layout.render(),this.rosterViewsCount++},setupTeamRosterSecondListView:function(){var e;e=new E({collection:this.teamrostersSecond,name:"roster roster second images",destination:"#roster-second-wrap"}),this.scheme.push(e),this.layout.render()},setupVideoListView:function(){var e;e=new w({collection:this.videos,destination:"#video-wrap"}),this.scheme.push(e),this.layout.render()},setupImageListView:function(){var e=this,t;t=new E({collection:this.images,name:"image list",target_id:this.id,target_url:"/api/game/addimage/",sport_id:L(".sport-h").data("id"),destination:"#image-wrap"}),this.imageListView=t,routing.on("image-upload-success",function(t){e.updateImages(t)}),this.scheme.push(t),this.layout.render()},updateImages:function(e){var t=new T;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON())},setupCommentListView:function(){},setupCommentsOnListView:function(){var e;e=new x({collection:this.commentson,destination:".commentson-outer-box-h",name:"games comment on view"}),this.scheme.push(e),this.layout.render()},setupLayout:function(){var e;return e=new k({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),r}),define("text!team/templates/layout.html",[],function(){return'<div class="template-container team-template-outer">\r\n<div id="main-header"></div>\r\n\r\n<div id="menu-container"></div>\r\n\r\n<div class="green-left-heading">MESSAGE BOARD</div>\r\n<div  class="clearfix clear commentson-outer-box-h profile-comment-list-box"></div>\r\n<div id="comment_div" class="clearfix"></div>\r\n\r\n\r\n<div class="green-left-heading">PHOTO/VIDEO</div>\r\n	<div class="row-fluid" id="main-content">\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<div id="add-media" class="clearfix">add media</div>\r\n	</div>\r\n	\r\n	<div class="row-fluid">\r\n		<div class="span4" id="main-sidebar">\r\n			<div id="related-wrap" class="clearfix"></div>\r\n			<div  class="clearfix"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="green-left-heading">GAMES</div>\r\n	<div id="games_div" class="clearfix">\r\n	</div>\r\n	\r\n	<div class="green-left-heading">FANS</div>\r\n	<div id="fans-div" class="clearfix clear">&nbsp;</div>\r\n\r\n	<div id="roster-wrap" class="clearfix clear"></div>\r\n\r\n<div id="votes-area-h"></div>\r\n<!--div class="row-fluid">\r\n    <div class="span4" id="main-sidebar">\r\n    \r\n        <div id="add-media" class="clearfix">\r\n        </div>\r\n        \r\n        Upcoming<br/>\r\n        <div id="upcoming-schedule" class="clearfix">\r\n        </div>\r\n        \r\n        Recent<br/>\r\n        <div id="recent-schedule" class="clearfix">        \r\n        </div>\r\n        \r\n        <a href="#">Missing a Game?</a>\r\n        \r\n        <div id="competitor-teams" class="clearfix">\r\n        </div>\r\n    \r\n    </div>\r\n    <div class="span8" id="main-content">\r\n    	\r\n    	\r\n    	\r\n        Roster\r\n        <div id="roster-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        Videos\r\n        <div id="video-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        Photos\r\n        <div id="image-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        FanBoard\r\n        <div id="comment-wrap" class="clearfix">\r\n        </div>\r\n        \r\n    </div>\r\n</div-->\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n</div>\r\n'}),define("team/models/basics",["facade","sportorg/models/team"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/team/basics/"+this.id:"/api/team/basics/"+this.id}}),n}),define("team/models/addmedia",["models/base"],function(e){var t;return t=e.extend({id:undefined,defaults:{links:[{label:"Photo",link:"javascript: void(0);",id:"addPhoto"},{label:"Video",link:"javascript: void(0);",id:"addVideo"}]}}),t}),define("team/collections/upcoming_schedules",["facade","sportorg/collections/games","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/upcoming_schedules/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/upcoming_schedules/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/recent_schedules",["facade","sportorg/collections/games","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/recent_schedules/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/recent_schedules/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/competitor_teams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/competitor_teams/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/competitor_teams/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("sportorg/models/roster",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,user_picture:null,grad_year:0,sport_name:null,position:null,num_votes:0,num_followers:0},desc:"Roster information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/rosters",["facade","collections","sportorg/models/roster","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("team/collections/rosters",["facade","sportorg/collections/rosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/rosters/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/rosters/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/videos/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/videos/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/images",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/media/"+this.team_id+"/"+this.sport_id:"/api/team/media/"+this.team_id+"?sport_id="+this.sport_id}}),r}),define("team/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/comments/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("profile/collections/commentsof",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/commentsof/"+this.id:"/api/user/commentsof/"+this.id}}),r}),define("team/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id:"/api/team/comments/"+this.id}}),r}),define("team/collections/orgs",["facade","sportorg/collections/orgs","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/games/"+this.id:"/api/team/games/"+this.id}}),r}),define("team/collections/fans",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/followers/"+this.id+"/"+this.sport_id:"/api/team/followers/"+this.id+"?sport_id="+this.sport_id}}),r}),define("text!team/templates/header.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid">\r\n	\r\n	<div class="profile-heading">\r\n            <h3 class="username">{{org_sport_link_obj.org.org_name	}}</h3>\r\n            <h4>{{org_sport_link_obj.sport.sport_name}} | {{complevels_obj.complevel_name}} | {{seasons_obj.season_name}} \'{{year}}</h4>\r\n            <a href="javascript: void(0);" title="Edit Team">Edit Team</a>\r\n            \r\n            <div id="votes-area-h"></div>\r\n    </div>\r\n	\r\n    <!--div class="span4 textcenter">\r\n        {{#picture}}\r\n        <img src="{{picture}}" alt="{{name}}" />\r\n        {{/picture}}\r\n    </div>\r\n    <div class="span8">\r\n        <div>\r\n            <h3 class="teamname">{{name}}</h3>\r\n            <div class="teamloaction">{{location}}</div>\r\n            <div class="votes">Votes: {{num_votes}}</div>\r\n            <div class="followers">Followers: {{num_followers}}</div>\r\n        </div>\r\n        <div id="sports-info"></div>\r\n    </div-->\r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/sport-select.html",[],function(){return'<select name="sport" id="select-sport">\r\n{{#payload}}\r\n    <option value="{{sport_id}}">{{sport_name}}</option>    \r\n{{/payload}}\r\n</select>\r\n'}),define("team/collections/sports",["facade","sportorg/collections/sports","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/sports/"+this.id:"/api/org/sports/"+this.id}}),r}),define("text!team/templates/sport-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="sport-info sport-info-{{sport_id}}" style="display:none">\r\n    <div class="complevels"></div>     \r\n</div>            \r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/complevel-select.html",[],function(){return'<select name="complevel" class="select-complevel">\r\n{{#payload}}\r\n    <option value="{{complevel_id}}">{{complevel_name}}</option>    \r\n{{/payload}}\r\n</select>\r\n'}),define("sportorg/collections/complevels",["facade","collections","sportorg/models/complevel","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload||[];for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("team/collections/complevels",["facade","sportorg/collections/complevels","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/complevels/"+this.id+"/"+this.sport_id:"/api/org/complevels/"+this.id+"?sports_id="+this.sport_id}}),r}),define("text!team/templates/complevel-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="complevel-info complevel-info-{{sport_id}}-{{complevel_id}}" style="display:none">\r\n    <div class="seasons"></div>     \r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/seasonteam-select.html",[],function(){return'<select name="season" id="select-season">\r\n{{#payload}}\r\n    <option value="{{seasons_id}}">{{seasons_obj.season_name}} {{year}}</option>\r\n{{/payload}}\r\n</select>\r\n'}),define("sportorg/models/season",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,season_name:null},desc:"Season information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/seasons",["facade","collections","sportorg/models/season","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("team/collections/seasons",["facade","sportorg/collections/seasons","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/seasons/"+this.id+"/"+this.sport_id+"/"+this.complevel_id:"/api/org/seasons/"+this.id+"?sports_id="+this.sport_id+"&complevels_id="+this.complevel_id}}),r}),define("team/collections/seasonteams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/seasonteams/"+this.id+"/"+this.sport_id+"/"+this.complevel_id:"/api/org/seasonteams/"+this.id+"?sports_id="+this.sport_id+"&complevels_id="+this.complevel_id}}),r}),define("text!team/templates/season-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="season-info season-info-{{sport_id}}-{{complevel_id}}-{{season_id}}" style="display:none">\r\n    \r\n</div>            \r\n{{/payload}}\r\n\r\n'}),define("team/views/season-item",["vendor","views","utils","text!team/templates/season-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=n.lib.Channel,i=o.extend({tagName:"li",className:"complevel",initialize:function(e){function o(){a("refresh-teampage").publish(n,i,s)}this.template=r;var t=this;this.id=e.model.collection.id;var n=this.model.collection.sport_id,i=this.model.collection.complevel_id,s=this.model.get("payload").season_id;a("teamseasons:select"+n+"-"+i+"-"+s).subscribe(o)},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}});return i}),define("team/views/season-list",["facade","views","utils","team/views/season-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"season-list",name:"Season List",tagName:"ul",_tagName:"li",_className:"season",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SeasonListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/complevel-item",["vendor","views","utils","text!team/templates/complevel-item.html","text!team/templates/seasonteam-select.html","team/collections/seasons","team/collections/seasonteams","team/views/season-list"],function(e,t,n,r,s){var o,u=e.$,a=t.BaseView,f=e.Mustache,l=n.lib.Channel,c=require("team/views/season-list"),h=require("team/collections/seasons");return SeasonTeamList=require("team/collections/seasonteams"),o=a.extend({tagName:"li",className:"complevel",rendered:!1,events:{"change #select-season":"selectSeason"},initialize:function(e){function n(){if(t.rendered){t.selectSeason();return}t.rendered=!0,t.initList()}this.template=r,this.selectSeasonTemplate=s;var t=this;this.id=e.model.collection.id;var i=this.model.collection.sport_id;l("teamcomplevels:select"+i+"-"+this.model.get("payload").complevel_id).subscribe(n)},initList:function(){var e=this;this.seasons=new SeasonTeamList,this.seasons.id=this.id,this.seasons.sport_id=this.model.collection.sport_id,this.seasons.complevel_id=this.model.get("payload").complevel_id,this.seasons.fetch();var t=this.seasons.sport_id,n=this.seasons.complevel_id;u.when(this.seasons.request).done(function(){e.setupSeasonListView(t,n),l("teamseasons"+t+"-"+n+":fetch").publish(),e.select_season=e.$("#select-season"),e.selectSeason()})},setupSeasonListView:function(e,t){function s(){r.render(),n.$el.find(".seasons").html(r.el);var e={payload:[]},t=r.collection;if(t.length){for(i=0;i<t.length;i++)e.payload[i]=t.at(i).get("payload");var s=f.to_html(n.selectSeasonTemplate,e);n.$el.find(".seasons").prepend(s)}else n.$el.find(".seasons").html("")}var n=this,r=new c({collection:this.seasons});l("teamseasons"+e+"-"+t+":fetch").subscribe(s)},render:function(){var e=this.model.collection.sport_id,t=this.model.get("payload");t.sport_id=e,this.model.set("payload",t);var n=f.to_html(this.template,this.model.toJSON());return this.$el.html(n),this},selectSeason:function(){var e=this.select_season.val(),t=this.model.collection.sport_id,n=this.model.get("payload").complevel_id;this.$(".season-info").stop().slideUp(),this.$(".season-info-"+t+"-"+n+"-"+e).stop().slideDown(),l("teamseasons:select"+t+"-"+n+"-"+e).publish()}}),o}),define("team/views/complevel-list",["facade","views","utils","team/views/complevel-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return TeamComplevelListAbstract=f.extend(l.prototype),i=TeamComplevelListAbstract.extend({__super__:f.prototype,id:"complevel-list",name:"Complevel List",tagName:"ul",_tagName:"li",_className:"complevel",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ComplevelListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/sport-item",["vendor","views","utils","text!team/templates/sport-item.html","text!team/templates/complevel-select.html","team/collections/complevels","team/views/complevel-list"],function(e,t,n,r,s){var o,u=e.$,a=t.BaseView,f=e.Mustache,l=n.lib.Channel,c=require("team/views/complevel-list"),h=require("team/collections/complevels");return o=a.extend({tagName:"li",className:"sport",rendered:!1,events:{"change #select-complevel":"selectComplevel"},initialize:function(e){function n(){if(t.rendered){t.selectComplevel();return}t.rendered=!0,t.initList()}this.template=r,this.selectComplevelTemplate=s;var t=this;this.id=e.model.collection.id,l("teamsports:select"+this.model.get("payload").sport_id).subscribe(n)},initList:function(){var e=this;this.complevels=new h,this.complevels.id=this.id,this.complevels.sport_id=this.model.get("payload").sport_id,this.complevels.fetch();var t=this.complevels.sport_id;u.when(this.complevels.request).done(function(){e.setupComplevelListView(t),l("teamcomplevels"+t+":fetch").publish(),e.select_complevel=e.$("#select-complevel"),e.selectComplevel()})},setupComplevelListView:function(e){function r(){n.render(),t.$el.find(".complevels").html(n.el);var e={payload:[]},r=n.collection;if(r.length){for(i=0;i<r.length;i++)e.payload[i]=r.at(i).get("payload");var s=f.to_html(t.selectComplevelTemplate,e);t.$el.find(".complevels").prepend(s)}else t.$el.find(".complevels").html("")}var t=this,n=new c({collection:this.complevels});l("teamcomplevels"+e+":fetch").subscribe(r)},render:function(){var e=f.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},selectComplevel:function(){var e=this.select_complevel.val(),t=this.model.get("payload").sport_id;this.$(".complevel-info").stop().slideUp(),this.$(".complevel-info-"+t+"-"+e).stop().slideDown(),l("teamcomplevels:select"+t+"-"+e).publish()}}),o}),define("team/views/sport-list",["facade","views","utils","team/views/sport-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/header",["require","text!team/templates/header.html","text!team/templates/sport-select.html","team/models/basics","facade","views","utils","vendor","team/collections/sports","team/views/sport-list","usercontrol/dropdown/view/dropdown","team/collections/seasonteams","team/collections/complevels"],function(e,t,n){var r,s=e("facade"),o=e("views"),u=e("team/models/basics"),a=o.SectionView,f=e("team/views/sport-list"),l=e("team/collections/sports"),c=e("usercontrol/dropdown/view/dropdown"),h=e("team/collections/seasonteams"),p=e("team/collections/complevels"),d=e("utils"),v=d.lib.Channel,m=e("vendor"),g=m.Mustache,y=s.$,b=s._;return r=a.extend({template:t,selectSportTemplate:n,events:{},initialize:function(e){this.controllerObject=e.controllerObject,a.prototype.initialize.call(this,e),b.bindAll(this)},selectSport:function(e){self.select_sport=self.$("#select-sport");var t=this.select_sport.val()},updateHeaderData:function(e){var t=this;t.model.id!=e&&(t.model.id=e,t.model.fetch(),y.when(t.model.request).done(function(){t.render();var e=t.model.get("payload"),n=e.id,r=e.org_sport_link_obj.org.name;t.controllerObject.setupRosterView(n,r)}))},showAllTeamData:function(){routing.trigger("refresh-teampage",y("#sports-h").val(),y("#team-h").val(),this.season.id)},insertOption:function(e,t){var n="",r=t.length;for(var i=0;i<r;i++)n+='<option value="'+t[i].payload.sport_id+'">'+t[i].payload.sport_name+"</option>";e.html(n)},setupSportListView:function(){function r(){t.render(),e.$el.find("#sports-info").html(t.el);var n={payload:[]},r=t.collection;if(r.length){for(i=0;i<r.length;i++)n.payload[i]=r.at(i).get("payload");var s=g.to_html(e.selectSportTemplate,n);e.$el.find("#sports-info").prepend(s)}else e.$el.find("#sports-info").html("")}var e=this,t=new f({collection:this.sports}),n=this.addChildView(t);this.childViews.sportListView=t,this.callbacks.add(function(){n()}),v("teamsports:fetch").subscribe(r)},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},getName:function(){var e=this.model.get("payload").org_name;return this.model.get("payload").complevels_obj.complevel_name&&(e+=" | "+this.model.get("payload").complevels_obj.complevel_name),this.model.get("payload").org_sport_link_obj.sport.sport_name&&(e+=" | "+this.model.get("payload").org_sport_link_obj.sport.sport_name),this.model.get("payload").seasons_obj.season_name&&(e+=" | "+this.model.get("payload").seasons_obj.season_name),this.model.get("payload").year&&(e+=" | "+this.model.get("payload").year),e},childViews:{},render:function(e,t,n){document.title=this.getName(),a.prototype.render.call(this,e,t,n)}}),r}),define("profile/models/addmedia",["models/base"],function(e){var t;return t=e.extend({defaults:{links:[{label:"",link:"javascript:void(0);",id:"addPhoto"},{label:"",link:"javascript:void(0);",id:"addVideo"}],userid:null}}),t}),define("team/views/add-media",["require","text!media/templates/add-media.html","profile/models/addmedia","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=r._;return n=s.extend({template:t,events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup","click #addGame":"openAddGamePopup"},setOptions:function(e){if(!this.model)throw new Error("ProfileAddMediaView expects option with model property.");this.model.userid=e.userid},openAddGamePopup:function(){routing.trigger("add-game",this.model.userid)},openAddImagePopup:function(e){var t=$("#sports-h").val(),n=$("#team-h").val(),r="/api/team/addimage/"+n,r="/api/team/addimage/"+n,i={sports_id:t};routing.trigger("add-image",r,i)},openAddvideoPopup:function(e){var t="/api/user/addvideo/"+this.model.id;Channel("add-video").publish(t)}}),n}),define("text!sportorg/templates/competitorteam-item.html",[],function(){return'\r\n{{#payload}}\r\n    <h3>{{name}}</h3>\r\n    <img src="{{picture}}" alt="{{name}}"/><br/>\r\n    {{sport}}<br/>\r\n    {{complevel}}<br/>\r\n    {{season}}<br/>\r\n    <br/><br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/competitorteam-item",["vendor","views","utils","text!sportorg/templates/competitorteam-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"team",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/competitorteam-list",["facade","views","utils","sportorg/views/competitorteam-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"team-list",name:"Team List",tagName:"ul",_tagName:"li",_className:"team",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CompetitorTeamListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/commentof-list",["facade","utils","site/views/comment-list"],function(e,t,n){var r;return r=n.extend({name:"team Commentof List",setupFormView:function(){}}),r}),define("team/views/commenton-form",["require","text!site/templates/comment-form.html","profile/models/commentonform","site/views/comment-form","models/base","views"],function(e,t,n,r,i){var s,o=e("views"),u=o.BaseView;return s=u.extend({initialize:function(e){console.error(e),this.$el.unbind(),_.bindAll(this),this.setOptions(),u.prototype.initialize.call(this,e)},el:"#comment_div",template:t,name:"Comment Form",events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox"},setOptions:function(e){if(!this.collection)throw new Error("ProfileCommentOnFormView expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(){var e=this.$el.find(".add-comment-form-h");console.log(e),e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")},refreshComments:function(e){this.$("#new-comment").val("")},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=this.model.get("id");var s=new i(r);s.url=function(){return debug.log(n),_.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/comment/add/":"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.trigger("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return u.prototype.render.call(this),this.input=this.$("#new-comment"),this.collection.length||$(".add-comment-h").trigger("click"),this}}),s}),define("team/views/commenton-list",["facade","utils","site/views/comment-list","team/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),e.name&&(this.name=e.name),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){s(e)})}}),s}),define("text!sportorg/templates/roster-item.html",[],function(){return'\r\n{{#payload}}\r\n    <img src="{{user_picture}}" alt="{{name}}"/><br/>\r\n    {{name}} \'{{grad_year}}<br/>\r\n    {{sport_name}}<br/>\r\n    {{position}}<br/>\r\n    {{team_name}}<br/>\r\n    {{num_votes}} Votes<br/>\r\n    {{num_followers}} Followers<br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/roster-item",["vendor","views","utils","text!sportorg/templates/roster-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"roster",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/roster-list",["facade","views","utils","sportorg/views/roster-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"roster-list",name:"Roster List",tagName:"ul",_tagName:"li",_className:"roster",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("RosterListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/addvideo/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/addvideo?team_id="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamaddvideo:fetch").publish(e)}}),r}),define("team/views/add-video",["require","team/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("TeamAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/video-list",["facade","utils","media/views/video-list","team/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("teamaddvideo:fetch").subscribe(i)}}),i}),define("team/models/addimage",["facade","media/models/image","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/addimage/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/addimage?team_id="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamaddimage:fetch").publish(e)}}),r}),define("team/views/add-image",["require","team/models/addimage","media/views/add-image"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("AddImageView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/image-list",["facade","utils","media/views/image-list","team/views/add-image"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("teamaddimage:fetch").subscribe(i)}}),i}),define("team/models/commentform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/comments/"+this.id+"?id1="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamcommentform:fetch").publish(e)}}),r}),define("team/views/comment-form",["require","team/models/commentform","site/views/comment-form"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("CommentFormView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/comment-list",["facade","utils","site/views/comment-list","team/views/comment-form"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupFormView:function(){function i(n){t.model=n,t.render(),e.$el.prepend(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),s("teamcommentform:fetch").subscribe(i)}}),i}),define("text!team/templates/menu.html",[],function(){return'<div id="sports-info">\r\n	<div class="sports-h drop-down-main-outer"></div>\r\n	<div class="season-h drop-down-main-outer"></div>\r\n	<div class="team-h drop-down-main-outer"></div>\r\n</div>\r\n'}),define("team/views/menu",["require","text!team/templates/menu.html","text!team/templates/sport-select.html","team/models/basics","facade","views","utils","vendor","team/collections/sports","team/views/sport-list","usercontrol/dropdown/view/dropdown","team/collections/seasonteams","team/collections/complevels"],function(e,t,n){var r=e("facade"),s=e("views"),o=e("team/models/basics"),u=s.SectionView,a=e("team/views/sport-list"),f=e("team/collections/sports"),l=e("usercontrol/dropdown/view/dropdown"),c=e("team/collections/seasonteams"),h=e("team/collections/complevels"),p=e("utils"),d=p.lib.Channel,v=e("vendor"),m=v.Mustache,g=r.$,y=r._;return u.extend({template:t,selectSportTemplate:n,events:{},initialize:function(e){this.headerView=e.headerView,u.prototype.initialize.call(this,e),this.initSportList()},selectSport:function(e){self.select_sport=self.$("#select-sport");var t=this.select_sport.val()},updateHeaderData:function(e){this.model.id!=e&&this.headerView.updateHeaderData(e)},getTeam:function(){var e=this;this.season=new c,this.season.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.season.sport_id=g("#sports-h").val(),this.season.complevel_id=g("#season-h").val(),this.season.fetch(),g.when(this.season.request).done(function(){var t={};t.records=e.season.toJSON(),t.recordId="id",t.recordValue="season_label";var n=new l({data:t,title:"Team",elementId:"team-h",destination:".team-h",selectedValue:e.model.id,targetView:e,callback:function(t){e.updateHeaderData(g("#team-h").val()),e.showAllTeamData()}})})},showAllTeamData:function(){routing.trigger("refresh-teampage",g("#sports-h").val(),g("#team-h").val(),this.season.id)},getComplevels:function(){var e=this;this.complevel=new h,this.complevel.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.complevel.sport_id=g("#sports-h").val(),this.complevel.fetch(),g.when(this.complevel.request).done(function(){var t={};t.records=e.complevel.toJSON(),t.recordId="complevel_id",t.recordValue="complevel_name";var n=new l({data:t,title:"Season",elementId:"season-h",destination:".season-h",selectedValue:e.model.get("payload").complevels_obj.complevel_id,targetView:e,callback:function(t){console.error("comp level call"),e.getTeam()}})})},initSportList:function(){console.error(this.model.toJSON());var e=this;this.sports=new f,this.sports.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.sports.fetch(),g.when(this.sports.request).done(function(){var t={};t.records=e.sports.toJSON(),t.recordId="sport_id",t.recordValue="sport_name";var n=new l({data:t,elementId:"sports-h",title:"Sport",selectedValue:e.model.get("payload").org_sport_link_obj.sports_id,destination:".sports-h",targetView:e,callback:function(t){e.getComplevels()}})})},insertOption:function(e,t){var n="",r=t.length;for(var i=0;i<r;i++)n+='<option value="'+t[i].payload.sport_id+'">'+t[i].payload.sport_name+"</option>";e.html(n)},setupSportListView:function(){function r(){t.render(),e.$el.find("#sports-info").html(t.el);var n={payload:[]},r=t.collection;if(r.length){for(i=0;i<r.length;i++)n.payload[i]=r.at(i).get("payload");var s=m.to_html(e.selectSportTemplate,n);e.$el.find("#sports-info").prepend(s)}else e.$el.find("#sports-info").html("")}var e=this,t=new a({collection:this.sports}),n=this.addChildView(t);this.childViews.sportListView=t,this.callbacks.add(function(){n()}),d("teamsports:fetch").subscribe(r)},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},childViews:{},render:function(e,t,n){u.prototype.render.call(this,e,t,n)}})}),define("text!schedules/templates/schedule-item.html",[],function(){return'{{#payload}}\r\n	<div class="select-team">\r\n	{{#teams}}\r\n		<div class="org-name">\r\n			<a href="/#team/{{team_id}}"><span class="team-label">{{org_name}} | {{complevel}} | {{season}} {{year}}</span></a>\r\n			<a href="javascript: void(0);" data-team-id="{{team_id}}" data-sport-id="0" title="add game" class="add-game-h right-with-icon">Add Game</a>\r\n			<!--<a href="javascript: void(0);" data-sport-id="0" title="add team" class="add-event-h">Click here to Add Event.</a>-->\r\n		</div>\r\n			<div class="game-box-outer">\r\n				<ul>\r\n				{{#schedules}}\r\n					<li data-game-id="{{id}}">\r\n						<a href="#game/{{id}}" data-team-id="{{team_id}}" class="{{#isWinner}}win{{/isWinner}}{{^isWinner}}background-blue{{/isWinner}} team-info-h">\r\n							<div class="game-info hide">\r\n								<span class="game-day">{{gameDay}}</span>{{#teams}}<span class="team-name" data-winner="{{isWinner}}" data-team-id="{{id}}">\r\n								&nbsp; vs. {{team_name}}</span>{{/teams}}\r\n								<span class="game-score">{{#teams}}{{#points_scored}}<span class="team-score {{#isWinner}}win{{/isWinner}}{{^isWinner}}loss{{/isWinner}}">{{points_scored}}</span>{{/points_scored}}{{/teams}}</span>\r\n							</div>\r\n						</a>\r\n					</li>\r\n				{{/schedules}}\r\n			</ul>\r\n		</div>\r\n	{{/teams}}\r\n	</div>\r\n{{/payload}}'}),define("text!schedules/templates/schedule-single-item.html",[],function(){return'{{#payload}}\r\n<a href="#game/{{id}}" data-team-id="{{teams_id}}" class="background-blue team-info-h">\r\n	<div class="game-info hide">\r\n		<span class="game-day">{{gameDay}}</span>{{#teams}}<span class="team-name" data-winner="{{isWinner}}" data-team-id="{{id}}">\r\n									&nbsp; vs. {{team_name}}</span>{{/teams}}\r\n		<span class="game-score">{{#teams}}{{#points_scored}}<span class="team-score {{#isWinner}}win{{/isWinner}}{{^isWinner}}loss{{/isWinner}}">{{points_scored}}</span>{{/points_scored}}{{/teams}}</span>\r\n	</div>\r\n</a>\r\n{{/payload}}'}),define("text!schedules/templates/schedule-event-item.html",[],function(){return'{{#payload}}\r\n	<a href="#game/{{id}}" class="background-blue team-info-h">\r\n			<div class="game-info hide">\r\n				{{event_name}} | {{game_day}}<br/>\r\n				{{game_location}}\r\n			</div>\r\n	</a>\r\n{{/payload}}'}),define("schedules/views/schedule-item",["vendor","views","utils","text!schedules/templates/schedule-item.html","text!schedules/templates/schedule-single-item.html","text!schedules/templates/schedule-event-item.html"],function(e,t,n,r,i,s){var o=e.$,u=t.BaseView,a=e.Mustache;return u.extend({tagName:"li",className:"org",events:{"change #select-team":"selectTeam"},initialize:function(e){console.log(e),e.model&&e.model.collection&&(this.teams_id=e.model.collection.id),e.teamView&&(this.teamView=e.teamView),e.eventView&&(this.eventView=e.eventView)},render:function(){if(this.teamView){this.mpay=this.model.get("payload"),this.template=i;var e=a.to_html(this.template,{payload:this.mpay,teams_id:this.teams_id});o(this.el).attr("data-team-id",this.teams_id)}else if(this.eventView&&this.eventView!=""){delete this.teams_id,this.template=s;var e=a.to_html(this.template,this.model.toJSON())}else{delete this.teams_id,this.template=r;var e=a.to_html(this.template,this.model.toJSON())}return this.$el.html(e),this.select_team=this.$("#select-team"),console.log(this.select_team),this.selectTeam(),this.setWins(),this},setWins:function(){var e=this.teams_id!=undefined?this.teams_id:o(this.el).find("div.org-name a.add-game-h").attr("data-team-id"),t=this;console.log(e);var n=o(this.el).attr("data-team-id")?o(this.el):o(this.el).find("ul li");console.log("Loop",n),n.each(function(){console.log(this),o(this).find('span.team-name[data-team-id="'+e+'"][data-winner="true"]').length&&o(this).find("a.team-info-h").addClass("win").removeClass("background-blue"),o(this).find('span.team-name[data-winner="true"]').length||o(this).find("a.team-info-h").addClass("noscore").removeClass("background-blue"),o(this).find('span.team-name[data-team-id="'+e+'"]').hide()})},selectTeam:function(e){var t=this.select_team.val();this.$(".team-info").stop().slideUp(),this.$(".team-info-"+t).stop().slideDown(),console.log(t)}})}),define("text!schedules/templates/schedule-list.html",[],function(){return'{{#data}}\r\n	<div>\r\n		{{#eventPage}}\r\n			<span class="event-sport-label">{{eventPage}} Events</span>\r\n			<a href="javascript: void(0);" title="add team" class="add-event-h right-with-icon">Add Event / Meet</a>\r\n		{{/eventPage}}\r\n\r\n		{{^eventPage}}\r\n			<span class="event-sport-label">&nbsp;</span>\r\n			<a href="javascript: void(0);" title="add game" class="add-game-h right-with-icon">Add Game.</a>\r\n		{{/eventPage}}\r\n	</div>\r\n<div class="select-team">\r\n	<div class="game-box-outer">\r\n		<ul class="schedule-list-h">\r\n			\r\n		</ul>\r\n	</div>\r\n</div>\r\n</div>\r\n{{/data}}\r\n{{^data}}\r\n<div class="info">\r\n	{{#eventPage}}\r\n	<div>\r\n		<a href="javascript: void(0);" title="Add an Event" class="add-event-h right-with-icon">Add Event / Meet</a>\r\n	</div>\r\n	{{/eventPage}}\r\n	{{^eventPage}}\r\n	<div>\r\n		<a href="javascript: void(0);" title="add game" class="add-game-h right-with-icon">Add Game.</a>\r\n	</div>\r\n	{{/eventPage}}\r\n\r\n</div>\r\n{{/data}}\r\n'}),define("schedules/views/schedule-list",["vendor","facade","views","utils","schedules/views/schedule-item","utils/storage","text!schedules/templates/schedule-list.html","chrome/views/header"],function(e,t,n,r,i,s,o,u,a){var f,l,c=t.$,h=t._,p=r.lib.Channel,d=n.CollectionView,v=e.Mustache,m=n.SectionView;return l=d.extend(m.prototype),f=l.extend({__super__:d.prototype,id:"schedule-list",name:"schedule List",tagName:"ul",_tagName:"li",_className:"org",_view:i,events:{"click .add-game-h":"addGame","click .add-event-h":"addEvent","mouseover .team-info-h":"showinfo","mouseout .team-info-h":"showinfo"},showinfo:function(e){e.preventDefault(),c(e.target).parents(".game-info").length||(c(e.target).find(".game-info").hasClass("hide")?c(e.target).find(".game-info").removeClass("hide"):c(".game-info").addClass("hide"))},checkForUser:function(){return!h.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},getUserId:function(){if(!h.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn)return routing.loggedInUserId},addGame:function(e){var t=this;if(!this.checkForUser()){routing.trigger("showSignup");return}!h.isUndefined(this.teamRecords)&&this.teamRecords?routing.trigger("add-game",0,c("#team-h").val(),c("#sports-h").val(),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("common-popup-close")}):routing.trigger("add-game",0,c(e.currentTarget).data("team-id"),c(e.currentTarget).data("sport-id"),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("common-popup-close")})},addEvent:function(e){var t=this;if(!this.checkForUser()){c("#userlogin").trigger("click");return}!h.isUndefined(this.teamRecords)&&this.teamRecords?routing.trigger("add-event",0,c("#sports-h").val(),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("popup-close")}):(console.log(c(".selected-sport-h").data("id")),routing.trigger("add-event",0,c(".selected-sport-h").data("id"),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("popup-close")}))},initialize:function(e){var t=this;console.log("OPTIONS",e),t.eventPage=e.eventPage||!1,t.teamRecords=e.teamRecords,t.controller=e.controller||!1,!h.isUndefined(e.teamRecords)&&e.teamRecords&&(console.log("Team Records",e.teamRecords,e),t.renderTemplate(),t.listView=".schedule-list-h",t.singleView=!0),!h.isUndefined(e.eventPage)&&e.eventPage&&(t.renderTemplate(t.eventPage),t.listView=".schedule-list-h",t.eventView=!0),d.prototype.initialize.call(t,e);if(!t.collection)throw new Error("Schedule expected options.collection.");h.bindAll(t),t.addSubscribers(),console.error(t.collection)},afterRender:function(){},renderTemplate:function(e){var t=v.to_html(o,{data:this.collection.length,eventPage:e});return console.error(t),this.$el.html(t),this}}),f}),define("profile/views/fans-image-list",["facade","utils","media/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",setupAddView:function(){}}),r}),define("team",["require","text!team/templates/layout.html","votes/views/vote","facade","controller","models","views","utils","team/models/basics","team/models/addmedia","team/collections/upcoming_schedules","team/collections/recent_schedules","team/collections/competitor_teams","team/collections/rosters","team/collections/videos","team/collections/images","team/collections/comments","profile/collections/commentsof","team/collections/commentson","team/collections/orgs","team/collections/fans","team/views/header","team/views/add-media","sportorg/views/competitorteam-list","team/views/commentof-list","team/views/commenton-list","sportorg/views/roster-list","team/views/video-list","team/views/image-list","team/views/comment-list","team/views/menu","media/models/image","schedules/views/schedule-list","roster/views/roster","profile/views/fans-image-list","votes/views/vote"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("team/models/basics"),l=e("team/models/addmedia"),c=e("team/collections/upcoming_schedules"),h=e("team/collections/recent_schedules"),p=e("team/collections/competitor_teams"),d=e("team/collections/orgs"),v=e("team/collections/videos"),m=e("team/collections/images"),g=e("team/collections/fans"),y=e("team/collections/comments"),b=e("profile/collections/commentsof"),w=e("team/collections/commentson"),E=e("team/views/header"),S=e("team/views/add-media"),x=e("schedules/views/schedule-list"),T=e("sportorg/views/competitorteam-list"),N=e("team/views/video-list"),C=e("team/views/image-list"),k=e("sportorg/views/teamroster-list"),L=e("team/views/comment-list"),A=e("team/views/commentof-list"),O=e("team/views/commenton-list"),M=e("profile/views/fans-image-list"),_=e("team/views/menu"),D=e("roster/views/roster"),P=e("media/models/image"),H=e("votes/views/vote"),B=u.LayoutView,j=i.$,F=i._,I=a.debug,q=a.lib.Channel,R=["/pages/team/team.css"];return r=s.extend({initialize:function(e){var t=this;return q("load:css").publish(R),F.bindAll(t),this.scheme=[],this.handleOptions(e),this.init(),this},handleOptions:function(e){this.id=e.teamId,this.userId=e.userId},init:function(){this.setupLayout().render(),this.createData(),this.handleDeferreds()},createData:function(){function t(t,n,r){e.refreshPage(),e.games=new d,e.games.id=n,e.games.sport_id=t,e.games.targetElement="#games_div",e.games.fetch(),e.images=new m,e.images.team_id=n,e.images.sport_id=t,e.images.targetElement="#image-wrap",e.images.fetch(),e.fans=new g,e.fans.id=n,e.fans.sport_id=t,e.fans.targetElement="#fans-div",e.fans.fetch();var i=e.basics.get("payload").enttypes_id;e.commentson=new w,e.commentson.subject_entity_type=i,e.commentson.savePath="/team/addcomment/"+n,e.commentson.id=n,e.commentson.targetElement="#comment_div",e.commentson.fetch(),e.handleDeferredsDynamic()}this.basics=new f({id:this.id}),this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new l,this.addmedia.id=this.id;var e=this;routing.on("refresh-teampage",function(e,n,r){t(e,n,r)})},handleDeferreds:function(){var e=this;j.when(this.basics.request).done(function(){e.setupHeaderView(),e.setupRosterView(),e.setupAddMediaView(),e.userId&&e.setUpVoteView()})},setupCommentOfListView:function(){var e;e=new A({collection:this.commentsof,destination:".commentsoff-outer-box-h",name:"team comments off view"})},deleteOldView:function(e){var t=this.scheme.length;for(var n=0;n<t;n++)this.scheme[n].name==e&&this.scheme[n].remove()},setupRosterView:function(e,t){if(!e&&!t)var n=this.basics.get("payload"),e=n.id,t=n.org_sport_link_obj.org.name;this.oldRosterViewName&&this.deleteOldView(this.oldRosterViewName),this.oldRosterViewName="roster images"+Math.random();var r,s=i.Backbone.Collection.extend({});r=new D({model:new s,team_id:e,team_name:t,name:this.oldRosterViewName,destination:"#roster-wrap"}),this.scheme.push(r),this.layout.render()},setupCommentOnListView:function(){this.commentOnListView=new O({collection:this.commentson,destination:".commentson-outer-box-h",name:"team comments on view "}),this.scheme.push(this.commentOnListView),this.layout.render()},refreshPage:function(){var e;this.commentOnListView&&(this.commentOnListView.unbind().remove(),j(this.commentOnListView.destination).unbind().html(""),e=j.inArray(this.commentOnListView,this.scheme),~e&&this.scheme.splice(e,1)),this.votesView&&(j(this.votesView.destination).unbind().html(""),e=j.inArray(this.votesView,this.scheme),~e&&this.scheme.splice(e,1),this.setUpVoteView()),this.gamesView&&(j(this.gamesView.destination).html(""),e=j.inArray(this.gamesView,this.scheme),~e&&this.scheme.splice(e,1)),this.fansListView&&(j(this.fansListView.destination).html(""),e=j.inArray(this.fansListView,this.scheme),~e&&this.scheme.splice(e,1)),this.imageListView&&(j(this.imageListView.destination).html(""),e=j.inArray(this.imageListView,this.scheme),~e&&this.scheme.splice(e,1))},handleDeferredsDynamic:function(){var e=this;j.when(e.commentson.request).done(function(){e.setupCommentOnListView()}),j.when(e.games.request).done(function(){e.setupGameView()}),j.when(e.fans.request).done(function(t){e.setupFansListView()}),j.when(this.images.request).done(function(){e.setupImages()})},setupFansListView:function(){this.fansListView=new M({collection:this.fans,destination:"#fans-div",name:"fansView"}),this.scheme.push(this.fansListView),this.layout.render()},setupHeaderView:function(){var e,t=this;e=new E({model:this.basics,name:"Header",controllerObject:t,destination:"#main-header"});var n=new _({model:this.basics,name:"Menu View",headerView:e,controllerObject:t,destination:"#menu-container"});this.scheme.push(n),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(){var e;console.error("add media model"),console.error(this.addmedia.toJSON()),e=new S({model:this.addmedia,team_id:this.basics.id,name:"Add_Media",destination:"#add-media"}),this.scheme.push(e),this.layout.render()},setUpVoteView:function(){this.votesView=new H({model:this.basics,id:this.id,destination:"#votes-area-h",name:"votes_view"}),this.scheme.push(this.votesView),this.layout.render()},setupUpcomingSchedules:function(){var e;e=TeamScheduleListView.extend({name:"Upcoming_Schedule_List"}),this.upcomingScheduleListView=new e({collection:this.upcoming_schedules,destination:"#upcoming-schedule",name:"upcoming_schedule"}),this.scheme.push(this.upcomingScheduleListView),this.layout.render()},setupRecentSchedules:function(){var e;e=TeamScheduleListView.extend({name:"Recent_Schedule_List"}),this.recentScheduleListView=new e({collection:this.recent_schedules,destination:"#recent-schedule",name:"recent_schedule"}),this.scheme.push(this.recentScheduleListView),this.layout.render()},getOrgData:function(){var e,t=this;this.gamesView&&(j(this.gamesView.destination).html(""),e=j.inArray(this.gamesView,this.scheme),~e&&this.scheme.splice(e,1)),t.games.fetch(),j.when(t.games.request).done(function(){t.setupGameView()})},setupGameView:function(){var e=x.extend({tagName:"div"});this.gamesView=new e({teams_id:this.id,controller:this,collection:this.games,destination:"#games_div",teamRecords:!0}),this.scheme.push(this.gamesView),this.layout.render()},setupCompetitorTeams:function(){this.competitorTeamListView=new T({collection:this.competitor_teams,destination:"#competitor-teams",name:"competitor_teams"}),this.scheme.push(this.competitorTeamListView),this.layout.render()},setupRosters:function(){this.rosterListView=new k({collection:this.rosters,destination:"#roster-wrap",name:"roster_wrap"}),this.scheme.push(this.rosterListView),this.layout.render()},setupVideos:function(){this.videoListView=new N({collection:this.videos,destination:"#video-wrap",name:"video_wrap"}),this.scheme.push(this.videoListView),this.layout.render()},initVoteView:function(){var e=new n({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},setupImages:function(e){var t=this;routing.off("image-upload-success"),routing.on("image-upload-success",function(e){t.updateImages(e)}),this.imageListView=new C({collection:this.images,destination:"#image-wrap",target_id:this.id,target_url:"/api/team/addimage/",sport_id:j("#sports-h").val(),name:"image_wrap ",user_id:this.userId}),this.scheme.push(this.imageListView),this.layout.render()},updateImages:function(e){var t=new P;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON())},setupComments:function(){this.commentListView=new L({collection:this.comments,destination:"#comment-wrap",name:"comment_wrap"}),this.scheme.push(this.commentListView),this.layout.render()},setupLayout:function(){var e;return e=new B({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),r}),define("text!profilesetting/templates/layout.html",[],function(){return'<div class="span12 main-container">\r\n	<div id="main-header-prof-setting" class="profile-header"></div>\r\n\r\n	<!-- Basic Info Section Starts-->\r\n	<div class="row-fluid" id="section-basics-prof-setting"></div>\r\n	<!-- Basic Info Section Ends-->\r\n\r\n	<!-- Team Info Section Starts-->\r\n	<div class="row-fluid section-teams-prof-setting">\r\n		<!-- High School Section Starts-->\r\n		<div id="section-school-prof-setting" class="row-fluid sub-section-prof-setting">\r\n\r\n			<div id="content-school-prof-setting">\r\n			</div>\r\n			<br/>\r\n\r\n		</div>\r\n		<!-- High School Section Ends-->\r\n\r\n		<!--Club Info Section Starts-->\r\n<div id="section-club-prof-setting" class="row-fluid sub-section-prof-setting">\r\n			\r\n			<div id="content-club-prof-setting">\r\n			</div>\r\n			<br/>\r\n\r\n		</div>\r\n		<!--Club Info Section Ends-->\r\n\r\n		<!--Individual Sports Section Starts-->\r\n		<div id="section-individual-prof-setting">\r\n\r\n		</div>\r\n		<!--Individual Sports Section Ends-->\r\n	</div>\r\n	<!-- Team Info Section Ends-->\r\n\r\n	<div id="main-footer-prof-setting">\r\n\r\n	</div>\r\n</div>\r\n'}),define("profilesetting/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("text!profilesetting/templates/basic_info_header.html",[],function(){return'{{#payload}}\r\n<div class="span3 profile-image">\r\n	<img id="img-profile-prof-setting" src="{{user_picture_obj.types.large_thumb.url}}" />\r\n	<a href="javascript:void(0);" id="change_user_pic">Change User Picture</a>\r\n</div>\r\n<div class="span6" id="user_profile_data">\r\n	<h2 id="user_name">{{first_name}} {{last_name}}</h2>\r\n	<p id="user_height">\r\n		{{#height_in}} {{height_in}} INCHES{{/height_in}}\r\n	</p>\r\n	<p id="user_weight">\r\n		{{#weight_lb}}{{weight_lb}} LBS{{/weight_lb}}\r\n	</p>\r\n	<div class="resume_button" id="edit_profile_info">Edit</div>\r\n</div>\r\n{{/payload}}'}),define("text!profilesetting/templates/basic_info_header_edit.html",[],function(){return'{{#payload}}\r\n		<div id="edit_profile_info_section">\r\n			<div><span>Name: </span><input type="text" id="txt_user_name" model-property="name" value="{{name}}" /></div>\r\n			<div><span>Height (in):</span><input type="text" id="txt_user_height" model-property="height_in" value="{{height_in}}" /></div>\r\n			<div><span>Weight (lbs)</span><input type="text" id="txt_user_weight" model-property="weight_lb" value="{{weight_lb}}" /></div>\r\n			<div style="font-size: .8em; font-weight: bolder;">Change Password</div>\r\n			<!--<div><span>Current</span><input type="password" id="txt_current_password" model-property="current_password"  placeholder="Current Password" /></div>-->\r\n\r\n			<div><span>New</span><input type="password" id="txt_new_password" model-property="password" placeholder="New Password" /></div>\r\n			<div><span>Again</span><input type="password" id="txt_re_new_password" model-property="re_password" placeholder="New Password Again" /></div>\r\n			<a href="javascript:void(0);" class="resume_button" id="save_user_data">Save</a>\r\n		</div>\r\n{{/payload}}'}),define("text!usercontrols/imagecropper/templates/layout.html",[],function(){return'<iframe id="cropper_iframe"></iframe>'}),define("usercontrols/imagecropper/imagecropper",["require","text!usercontrols/imagecropper/templates/layout.html","facade","controller","views"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("views"),o=e("utils"),u=r.$,a=r._,f=o.lib.Channel,l=s.LayoutView;return n=i.extend({cssArr:["/usercontrols/imagecropper/imagecropper.css"],events:{"click button.close":"alertsomething"},initialize:function(e){console.log("init");var t=this;f("load:css").publish(this.cssArr),a.bindAll(this),console.log(e),this.image_o=e.image_o?e.image_o:"",this.image_e=e.image_e?e.image_e:"",this.modelHTML='<div id="modalPopup" class="modal imagecropper hide fade model-popup-h"><div class="modal-header"><span>Athletez Profile Pic Editor</span><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></div><div class="modal-body page-content-h"></div></div>',this.setupLayout().render(),this.handleDeferreds()},handleDeferreds:function(){},setupLayout:function(){var e=this;this.scheme=[],u(".model-popup-h").remove(),u("body").append(this.modelHTML);var n=new l({scheme:this.scheme,destination:".modal-body",template:t,displayWhen:"ready"});this.layout=n,u("#modalPopup button.close").bind("click",function(){e.notifyUpdate()});var r="/vendor/plugins/iedit2/index.html?vh=500&vw=500&sx=0&sy=0&sz=100&t=Profile%20Picture&edit=";return this.image_e!=""&&(r+="&edit="+this.image_e),this.image_o!=""&&(r+="&o="+this.image_o),u("#modalPopup iframe#cropper_iframe").attr("src",r),u("#modalPopup").modal(),this.layout},notifyUpdate:function(){f("userpic-changed").publish()}}),n}),define("profilesetting/views/basic_info",["require","text!profilesetting/templates/basic_info_header.html","text!profilesetting/templates/basic_info_header_edit.html","profilesetting/models/basic_info","facade","views","utils","vendor","usercontrols/imagecropper/imagecropper"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("profilesetting/models/basic_info"),u=s.SectionView,a=e("utils"),f=a.lib.Channel,l=e("vendor"),c=l.Mustache,h=i.$,p=e("usercontrols/imagecropper/imagecropper");return r=u.extend({id:"basic_info",template:t,events:{"click .btn-prof-setting-h":"initialize","click #edit_profile_info":"editProfile","click #change_user_pic":"changeUserpic"},initialize:function(e){this.initBasicView(),e.length>0&&u.prototype.initialize.call(this,e)},initBasicView:function(){var e=this;this.basicInfoModel=new o,this.basicInfoModel.fetch(),h.when(this.basicInfoModel.request).done(function(){e.basicInfoModel.set("id",e.basicInfoModel.get("payload").id),e.setupBasicView()})},setupBasicView:function(){var e=this,t=c.to_html(e.template,this.basicInfoModel.toJSON());console.log(t),h("#section-basics-prof-setting").html(t),h("#change_user_pic").bind("click",function(){e.changeUserpic()}),h("#edit_profile_info").bind("click",function(){e.editProfile()})},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},editProfile:function(){var e=this,t=c.to_html(n,this.basicInfoModel.toJSON());h("div#user_profile_data").html(t),h("#save_user_data").bind("click",function(){e.saveProfileBasics()})},saveProfileBasics:function(){var e=this,t={};h("div#user_profile_data").find("input").each(function(){t[h(this).attr("model-property")]=h(this).val()}),this.basicInfoModel.save(t,{success:function(){e.initBasicView()}})},changeUserpic:function(){var e=this.basicInfoModel.get("payload");console.log(e);var t=this,n=new p({image_o:e.user_picture_obj.pre_crop_url,image_e:e.user_picture_obj.image_path});f("userpic-changed").subscribe(function(){t.initBasicView()})}}),r}),define("text!profilesetting/templates/highschool.html",[],function(){return'<div class="row-fluid">\r\n	<span class="green-left-heading">School</span>\r\n</div>\r\n<div id="btn-Add-School" class="clearfix div-add-dotted">\r\n	+ Add a school\r\n</div>\r\n<div id="section-Add-Sports-school" class="displayNone add-org-fields">\r\n	<div>\r\n		<span class="span2">What State?</span>\r\n		<input type="text" id="txt-school-state" placeholder="Just Start Typing"/>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n\r\n	<div>\r\n		<span class="span2">What School?</span>\r\n		<input type="text" id="txt-school-school" placeholder="Just Start Typing" disabled="disabled"/>\r\n		<a class="add-school-h" href="javascript: void(0);">Add a New School</a>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n	<div class="div-sports-wrapper displayNone">\r\n		<div id="def-school-sports-section" class="school-sports-section">\r\n\r\n		</div>\r\n		<!--<span class="floatLeft"><a href="javascript:void(0)" class=" well-small btn-add-sports" >Add Sports</a> </span>-->\r\n	</div>\r\n<!-- <span class="floatRight"><a href="javascript:void(0)" class=" well-small btn-primary btn-finish-addsports" >Finish</a> </span> -->\r\n</div>\r\n<!--SCHOOL LISTING SECTION HERE-->\r\n<!--lIST-->\r\n<div class="row-fluid section-team-list-detail">\r\n\r\n</div>\r\n\r\n<!--lIST-->\r\n'}),define("text!profilesetting/templates/sportslevel.html",[],function(){return'<div class="section-sportslevel">\r\n	<div>\r\n		<span class="span2">Choose Sport</span>\r\n		<!-- class="ddl-school-sports"-->\r\n		<select class="ddl-sports" orgsid="{{orgsId}}" tabindex="0">\r\n			<option value="">Select Sport</option>\r\n			{{#sports}}\r\n			<option value="{{sport_id}}">{{sport_name}}</option>\r\n			{{/sports}}\r\n		</select>\r\n\r\n		<p class="field-error"></p>\r\n\r\n		<p class="field-message"></p>\r\n\r\n		<span><a href="javascript:void(0)" class="btn-Remove-Sport" tabindex="0">Remove</a> </span>\r\n	</div>\r\n\r\n	<div class="clearfix inner-section">\r\n		<div class="sub-section-prof-setting">\r\n			<div>\r\n\r\n				<div class="spn-black-heading spn-sport-name">\r\n				</div>\r\n				<!--class="div-school-sports-level"-->\r\n				<div class="div-sports-level"></div>\r\n\r\n			</div>\r\n			<div class="">\r\n				<!--<span class="floatLeft"><a href="javascript:void(0)" class="btn-add-level" orgsid="{{orgsId}}" tabindex="0">Add Level</a> </span>-->\r\n				<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Finish</a> </span>\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>'}),define("text!profilesetting/templates/level.html",[],function(){return'<div class="div-levels seasons-records">\r\n	{{#sport}}\r\n		<div class="org-sport-list-header">\r\n			<div class="sport-name"><img src="{{icon}}" />{{sports_name}}</div>\r\n		</div>\r\n	{{/sport}}\r\n	<div class="well-small span12">\r\n		<!-- class="ddl-school-complevel"-->\r\n		<select class="ddl-complevel" orgsid="{{orgsId}}" sportsid="{{sportsId}}">\r\n			<option value="">Select Level</option>\r\n			{{#levels}}\r\n			<option value="{{complevel_id}}">{{complevel_name}}</option>\r\n			{{/levels}}\r\n		</select>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n	<!-- id="div-school-seasons"-->\r\n	<div class="div-seasons complevels-wrapper displayNone">\r\n		<div class="arrow-container">\r\n			<a href="javascript:void(0)" class="down arrow up-arrow-h" title="up">&uarr;</a>\r\n		</div>\r\n		<div class="complevels-container">		\r\n			<div class="complevels-inner">\r\n				{{#Data}}\r\n					<div class="season-array">\r\n						<div class="year-label">{{year}}</div>\r\n						{{#seasons}}\r\n							<span class="single-season">\r\n								<input type="checkbox" class="chkSeasons chkSeasons-{{season_id}}-{{year}}" seasonId = \'{{season_id}}\' year=\'{{year}}\' orgsid="{{orgsId}}" sportsid="{{sportsId}}"/>\r\n								<label>&nbsp;{{season_name}} </label>\r\n								<a href="javascript:void(0)" class="btnOpenPositions displayNone" disabled="disabled" >Positions</a>\r\n							</span>\r\n						{{/seasons}}\r\n					</div>\r\n				{{/Data}}\r\n			</div>\r\n		</div>\r\n		<div class="arrow-container">\r\n			<a href="javascript:void(0)" class="down arrow down-arrow-h" title="down">&darr;</a>\r\n		</div>\r\n\r\n	</div>\r\n	\r\n	<!--	Modal Section to display positions	-->\r\n	<!--modal-school-positions-->\r\n<div class="modal hide fade position-modal modal-positions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n<div class="modal-header">\r\n<button type="button" class="close btn-Close-Positions" data-dismiss="modal" aria-hidden="true">×</button>\r\n<h3 id="myModalLabel">Positions</h3>\r\n</div>\r\n<div class="modal-body modal-position-body">\r\n	\r\n</div>\r\n<div class="modal-footer">\r\n<button class="btn btn-Close-Positions" data-dismiss="modal" aria-hidden="true">Finish</button>\r\n<!--<button class="btn btn-primary btn-Save-Positions">Finish</button> -->\r\n</div>\r\n</div>\r\n</div>\r\n'}),define("profilesetting/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("profilesetting/collections/schools",["facade","utils","sportorg/collections/orgs","sportorg/models/org"],function(e,t,n,r){var i;return i=n.extend({url:function(){var e=this;return testpath?testpath+"/api/org/search/"+this.sport_id:"/api/org/search?sports_club="+e.sports_club+"&states_id="+e.states_id+"&org_name="+e.org_name},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profilesetting/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({sport_type:1,male:1,female:0,url:function(){return testpath?testpath+"/api/sport/listall":(this.gender==undefined,"/api/sport/listall/?sport_type="+this.sport_type+"&male="+this.male+"&female="+this.female+"&sport_type_id="+this.sport_type_id)}}),i}),define("text!profilesetting/templates/teamlist.html",[],function(){return'{{#orgs}}\r\n	<div class="div-sports-wrapper"  orgsId="{{org_id}}">\r\n		<div class="school-sports-section"></div>\r\n	</div>\r\n	<div class="org-sport-list">\r\n		<div class="org-sport-list-header">\r\n			<div class="org-name">{{org_name}}, {{city}}, {{state}}</div>\r\n			<div class="add-sport"><a class="btn-add-sports" href="javascript:void(0)" orgsId="{{org_id}}">Add Sport</a></div>\r\n		</div>\r\n		{{#sports}}\r\n\r\n			<div class="org-sport-list-header">\r\n				<div class="sport-name"><img src="{{icon}}" />{{sports_name}} - <a href="javascript:void(0)" class="edit-team"  orgsId="{{org_id}}" sportId="{{sports_id}}">Edit</a></div>\r\n			</div>\r\n\r\n			<div>\r\n				{{#complevels}}\r\n\r\n					{{#seasons}}\r\n				<div class="season-list">\r\n						<span>{{complevel}}</span>\r\n						<span>{{season}} {{year}}</span>\r\n						<span>\r\n							{{#positions}}<span class="position-listing">{{name}}</span>{{/positions}}\r\n							{{^positions}}No Positions&nbsp;{{/positions}}\r\n						</span>\r\n				</div>\r\n					{{/seasons}}\r\n\r\n				{{/complevels}}\r\n			</div>\r\n\r\n\r\n		{{/sports}}</div>\r\n{{/orgs}}'}),define("profilesetting/collections/teams",["facade","utils","sportorg/collections/teams","sportorg/models/team"],function(e,t,n,r){var i;return i=n.extend({url:function(){var e=this;return testpath?testpath+" /api/user/orgs/"+e.user_id+"?groupby=complevel ":" /api/user/orgs/"+e.user_id+"?groupby=complevel&org_type="+e.org_type},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},data:{user_id:self.user_id,sports_club:self.sports_club}}),i}),define("profilesetting/views/teams",["require","text!profilesetting/templates/teamlist.html","facade","views","utils","vendor","profilesetting/collections/teams"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("profilesetting/collections/teams"),p=o.extend({template:t,controls:{},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property."},initialize:function(e){var t=this;t.setOptions(e),t.render()},setOptions:function(e){var t=this;if(!e.user_id&&!e.destination)throw new Error("Parameters missing for Seasons View");this.destination=e.destination,this.user_id=e.user_id,this.sports_club=e.sports_club,this.el=e.destination,this.org_type=e.org_type},bindEvents:function(){},GetData:function(){var e=this,t={user_id:e.user_id,sports_club:this.sports_club},n=new h(t);n.user_id=e.user_id,n.sports_club=this.sports_club,n.org_type=this.org_type,console.log("Team Request Abort Request Function"),e.teamFetchRequest=e.abortRequest(e.teamFetchRequest);var r=n.fetch();e.teamFetchRequest.push(r),c.when(n.request).done(function(){if(n.isError())return;var t=n.toJSON();if(t.length){var r=[];for(var i=0;i<t.length;i++)r.push(t[i].payload);e.Teams=t;var s=l.to_html(e.template,{orgs:r});c(e.el).html(s)}else c(e.el).html(e.messages.dataNotExist)})},render:function(){var e=this;e.GetData()}});return p}),define("profilesetting/models/complevel",["facade","sportorg/models/complevel"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/org/basics/"+this.orgs_id+"?id1="+this.orgs_id)},fetchSuccess:function(e,t){}}),n}),define("text!profilesetting/templates/season-item.html",[],function(){return'<div class="span12 well-small">\r\n	<a href="javascript:void(0)" class="down arrow">&uarr;</a>\r\n</div>\r\n{{#Data}}\r\n<div class="span12">\r\n	<span class="span3"><strong>{{year}}</strong></span>\r\n	{{#seasons}}\r\n	<span class="span3">\r\n		<input type="checkbox" class="chkSeasons" year=\'{{year}}\' seasonId = \'{{season_id}}\' />\r\n		<label>&nbsp;{{season_name}} </label>\r\n		<a href="javascript:void(0)" class="btnOpenPositions">Positions</a>\r\n		 </span>\r\n	{{/seasons}}\r\n</div>\r\n{{/Data}}\r\n<div class="span12 well-small">\r\n	<a href="javascript:void(0)" class="down arrow">&darr;</a>\r\n</div>'}),define("profilesetting/views/seasons",["require","text!profilesetting/templates/season-item.html","facade","views","utils","vendor","profilesetting/models/complevel"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,r=o.extend({template:t,events:{},controls:{chkSeasons:".chkSeasons"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property."},properties:{show_prev_year:2},initialize:function(e){n=this,n.setOptions(e),n.render()},setOptions:function(e){if(!e.orgs_id||!e.user_id||!e.sport_id||!e.complevel_id)throw new Error("Parameters missing for Seasons View");this.destination=e.destination,this.collection=e.collection,this.sport_id=e.sports_id,this.org_id=e.orgs_id,this.user_id=e.user_id,this.complevel_id=e.complevel_id,this.el=e.destination,this.properties.show_prev_year=e.show_prev_year||this.properties.show_prev_year},bindEvents:function(){},GetData:function(e){var t=[],r=(new Date).getFullYear();for(var i=n.properties.show_prev_year;i>=0;i--){var s={year:r,seasons:e};t.push(s),r--}return{Data:t}},render:function(){var e=l.to_html(n.template,n.GetData(this.collection));c(n.destination).html(e)}});return r}),define("text!profilesetting/templates/positions.html",[],function(){return'{{#Data}}\r\n<span id="pos-{{id}}" class="span3 spn-position-title_h" positionId=\'{{id}}\'>{{name}} </span>\r\n{{/Data}}\r\n'}),define("sportorg/models/position",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,sport_name:null,stattab_id:0,stattab_name:null,stattab_classname:null},desc:"Position information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/positions",["facade","collections","sportorg/models/position","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null){for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}}),s}),define("profilesetting/collections/positions",["facade","collections","sportorg/collections/positions","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/sport/positions/"+this.sport_id+"?id1="+this.sport_id)}}),i}),define("profilesetting/views/positions",["require","text!profilesetting/templates/positions.html","facade","views","utils","vendor","profilesetting/collections/positions"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=e("profilesetting/collections/positions"),c=f.Mustache,h=i.$,r=o.extend({template:t,events:{},controls:{spnPositionTitle:".spn-position-title_h",divLevels:".div-levels",btnPositions:".btnOpenPositions",btnClose:".btn-Close-Positions"},messages:{},properties:{},initialize:function(e){n=this,n.setOptions(e),n.BindPositions(),n.bindEvents()},bindEvents:function(){},MarkPosition:function(e){h(e).hasClass("active")?h(e).addClass("active"):h(e).removeClass("active")},setOptions:function(e){if(!e.sport_id)throw new Error("Sport_id is missing for Positions View",e);this.destination=e.destination,this.sport_id=e.sport_id,this.el=e.destination,this.target=e.target},BindPositions:function(){if(n.sport_id){var e=new l;e.sport_id=n.sport_id,e.fetch(),h.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();n.positions=[];if(t!=null&&t.length){n.positions=[];for(var r in t)n.positions.push(t[r].payload)}else n.positions=[];n.render()})}},render:function(){var e=c.to_html(n.template,{Data:n.positions||[]});h(n.destination).html(e),n.positions!=null&&n.positions.length>0?h(n.destination).parents(n.controls.divLevels).find(n.controls.btnPositions).fadeIn():h(n.destination).parents(n.controls.divLevels).find(n.controls.btnPositions).fadeOut()}});return r}),define("profilesetting/models/team",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"team_id",url:function(){this.orgs_id==undefined;if(this.type=="add")return"/api/user/addteam/"+this.user_id;if(this.type=="delete")return"/api/user/team/"+this.user_id}}),n}),define("profilesetting/models/position",["facade","sportorg/models/position"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"position_id",url:function(){return this.orgs_id==undefined,this.type=="save"?"/api/user/position/"+this.user_id:this.type=="delete"?"/api/user/position/"+this.user_id+"?user_id="+this.user_id:"/api/user/position/"+this.user_id}}),n}),define("profilesetting/views/highschool",["require","text!profilesetting/templates/highschool.html","text!profilesetting/templates/sportslevel.html","text!profilesetting/templates/level.html","facade","views","utils","vendor","profilesetting/collections/states","profilesetting/collections/schools","profilesetting/collections/sports","profilesetting/views/teams","profilesetting/models/complevel","profilesetting/views/seasons","profilesetting/views/positions","profilesetting/models/team","profilesetting/models/position"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/states"),v=e("profilesetting/collections/schools"),m=e("profilesetting/collections/sports"),g=e("profilesetting/models/complevel"),y=e("profilesetting/views/seasons"),b=e("profilesetting/views/positions"),w=e("profilesetting/views/teams"),E=e("profilesetting/models/team"),S=e("profilesetting/models/position"),s=a.extend({template:t,events:{"keyup #txt-school-state":"keyupState","blur #txt-school-state":"changeState","keyup #txt-school-school":"keyupSchool","blur #txt-school-school":"changeSchool","change .ddl-sports":"changeSports","change .ddl-complevel":"changeCompLevel","change .chkSeasons":"AddSportsItem","click .btn-add-level":"AddLevel","click .spn-position-title_h":"MarkPosition","click .btn-add-sports":"AddSports","click .btn-Remove-Sport":"RemoveSports","click #btn-Add-School":"SetUpAddSchool","click .delete-team":"DeleteTeam","click .btn-Save-Positions":"SavePositions","click .btn-Close-Positions":"ClosePositions","click .btn-Finish-Sports":"FinishSports","click .edit-team":"EditTeam","click .btnOpenPositions":"displayPositionPopup","click .add-school-h":"openAddHighSchoolPopup","click .up-arrow-h":"levelUpArrow","click .down-arrow-h":"levelDownArrow"},controls:{txtStates:"#txt-school-state",txtSchools:"#txt-school-school",content:"#content-school-prof-setting",fieldMessage:".field-message",fieldError:".field-error",ddlSports:".ddl-sports",ddlComplevel:".ddl-complevel",modalPosition:".modal-positions",modalPositionBody:".modal-position-body",modalPositionsTitle:".spn-position-title_h",divSportsNameHeading:".spn-sport-name",divMainSportsSection:"#def-school-sports-section",divLevels:".div-sports-level",divSeasons:".div-seasons",divsportsLevel:".section-sportslevel",divSubLevels:".div-levels",divSchoolSportsSection:".school-sports-section",divSportsWrapper:".div-sports-wrapper",btnRemoveSports:".btn-Remove-Sport",divTeamListDetail:".section-team-list-detail",divAddSportSection:"#section-Add-Sports-school",btnAddSports:".btn-add-sports",btnClosePositions:".btn-Close-Positions",btnFinishSports:".btn-Finish-Sports",btnOpenPositions:".btnOpenPositions",chkSeasons:".chkSeasons",btnAddLevel:".btn-add-level"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property.",selectSport:"Please select sport",selectState:"Please insert state",selectSchool:"Please insert School",SelectLevel:"Plesae Select Comp Level"},properties:{show_prev_year:30},states:[],schools:[],initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},openAddHighSchoolPopup:function(){var e=this;routing.trigger("add-school-init","","","school",function(t){console.log(t),e.$el.find(e.controls.txtSchools).val(t.name),e.$el.find(e.controls.txtStates).val(t.locationState.name),e.states_id="",e.orgs_id="",e.states_id=t.locationState.id,e.$(i.controls.txtSchools).removeAttr("disabled"),e.orgs_id=t.org_id,e.$el.find(e.controls.divMainSportsSection).find(e.controls.ddlSports).length<1&&e.fillSports(e.orgs_id,e.controls.divMainSportsSection),e.$el.find(".add-school-h").hide()})},init:function(){i.setupView(),i.SetUpTeamsView()},render:function(){var e=this;a.prototype.render.call(this)},setupView:function(){},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender},keyupState:function(e){var t=p(e.target).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!="")if(r==1){i.$(e.target).parents(i.controls.divAddSportSection).find(i.controls.txtSchools).attr("disabled","disabled").val(""),i.RemoveSportsSection();var s=new d;s.state_name=t,console.log("State Request Abort Request Function AddGame/Main.js"),i.stateFetchRequest=i.stateFetchRequest||[],i.stateFetchRequest.push(i.cityFetchRequest||[]),i.stateFetchRequest.push(i.schoolFetchRequest||[]),i.stateFetchRequest=i.abortRequest(i.stateFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.stateFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var e=s.toJSON();e==null||e.length<1?i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html("").fadeOut(),i.states=[];for(var t in e)i.states.push(e[t].payload);i.states.forEach(function(e,t){n.push(e.name)});try{i.$el.find(i.controls.txtStates).autocomplete("destroy")}catch(r){}i.$el.find(i.controls.txtStates).autocomplete({source:n}),i.$el.find(i.controls.txtStates).trigger("keydown")})}else i.changeState(e)},changeState:function(e){var t=p(e.target).val(),n=!1;i.states_id="",i.states.forEach(function(e,r){e["name"]==t&&(n=!0,i.states_id=e.id,i.$(i.controls.txtSchools).removeAttr("disabled"))}),n||(i.states_id=0,i.$(i.controls.txtSchools).attr("disabled","disabled"))},keyupSchool:function(e){var t=p(e.target).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!=""&&r==1){i.RemoveSportsSection();var s=new v;s.sports_club=0,s.states_id=i.states_id,s.org_name=t,console.log("School Request Abort Request Function"),i.schoolFetchRequest=i.abortRequest(i.schoolFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.schoolFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html("").stop().fadeOut(),i.schools=[];for(var r in t)i.schools.push(t[r].payload);i.schools.forEach(function(e,t){n.push(e.org_name)});try{i.$el.find(i.controls.txtSchools).autocomplete("destroy")}catch(o){}p(e.target).autocomplete({source:n}),p(e.target).trigger("keydown")})}else i.RemoveSportsSection(),i.changeSchool(e)},changeSchool:function(e){var t=i.$(e.target).val();i.orgs_id=0,i.schools.forEach(function(e,n){e["org_name"]==t&&(i.orgs_id=e.org_id,i.$el.find(i.controls.divMainSportsSection).find(i.controls.ddlSports).length<1&&i.fillSports(i.orgs_id,i.controls.divMainSportsSection))})},RemoveSportsSection:function(){i.$el.find(i.controls.divMainSportsSection).html("")},fillSports:function(e,t){console.log("Fill Sports",e);if(i.sports&&i.sports.length>0)i.SetupSportsView(e,t);else{var n=new m;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,i.gender=="male"?n.male=1:i.gender=="famale"&&(n.female=0),n.fetch(),p.when(n.request).done(function(){if(n.isError())return;var r=n.toJSON();(r==null||r.length<1)&&i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn(),i.sports=[];for(var s in r)i.sports.push(r[s].payload);i.sort(i.sports,"sport_name",!1),i.SetupSportsView(e,t)})}},changeSports:function(e){console.log("SPORTS",i.sports);var t=p(e.target).val(),n=p(e.target).attr("orgsid");console.log("Event Target Sports List",p(e.target),t,n);if(t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){i.sport_id=t;var r=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels);console.log("CALLED",r),r.html(""),i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",t),i.fillCompLevel(n,r,t)}else i.sport_id=0},SetupSportsView:function(e,t){console.log("Setup Sports View",i.sports);var r=h.to_html(n,{sports:i.sports,orgsId:e});i.$(t).append(r),p(t).parents(i.controls.divSportsWrapper).find(i.controls.btnAddSports).attr("orgsid",e),p(t).parents(i.controls.divSportsWrapper).fadeIn()},findSportById:function(e){if(!(i.sports&&i.sports.length<1))return 0;for(var t=0;t<i.sports.length;t++)if(i.sports[t].id==e)return i.sports[t]},fillCompLevel:function(e,t,n){i.compLevel_id=undefined;if(e&&e>0){var r=new g;console.log("List",r),r.orgs_id=e,console.log("Complevels Request Abort Request Function"),i.compFetchRequest=i.abortRequest(i.compFetchRequest);var s=r.fetch();i.compFetchRequest.push(s),p.when(r.request).done(function(){if(r.isError())return;var s=r.toJSON();i.compLevel=[];if(s!=null&&s.payload!=null||s.payload.complevels!=null&&s.payload.complevels.length){i.seasons=s.payload.seasons||[];for(var o in s.payload.complevels)i.compLevel.push(s.payload.complevels[o]);var u=i.findSportById(n);i.SetUpCompLevelView(e,t,u)}})}else p(t).html("")},changeCompLevel:function(e){var t=p(e.target).val();i.compLevel_id=0;for(var n in i.compLevel)if(i.compLevel[n].complevel_id==t){i.compLevel_id=t,console.log("if"),i.$(e.target).attr("disabled","disabled"),i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeIn();return}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeOut()},SetUpCompLevelView:function(e,t,n){var s=n.sports_id,o=i.GetSeasonsData(i.seasons,e,s),u=h.to_html(r,{levels:i.compLevel,Data:o,sport:n});i.$(t).append(u);var a=i.$(t).find(i.controls.modalPositionBody);i.fillPositions(s,a)},levelUpArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=t.find(".complevels-container").height();if(n>r)var i=n-r;else var i=0;t.find(".complevels-container").animate({scrollTop:i})},levelDownArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=n+t.find(".complevels-container").height();t.find(".complevels-container").animate({scrollTop:r})},GetSeasonsData:function(e,t,n){var r=[],s=(new Date).getFullYear();for(var o=i.properties.show_prev_year;o>=0;o--){var u={year:s,seasons:e,orgsId:t,sportsId:n};r.push(u),s--}return r},fillPositions:function(e,t){console.log("fillpositions",e,t),e?(console.log("sport_id",e,"destination",t),this.positionView=new b({name:"settings-high-school-positions",destination:t,sport_id:e}),i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html("").fadeOut()):i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html(i.messages.selectSport).stop().fadeIn()},displayPositionPopup:function(e){i.clickedPositionTarget=p(e.target);if(p(e.target).parent().find(i.controls.chkSeasons).is(":checked")){var t=p(e.target).attr("teamid");console.log(p(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle));if(p(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).length>0){i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).attr("teamid",t).removeClass("active");var n=p(e.target).attr("positions");console.log("ids",n);if(n){var r=n.split(",");p.each(r,function(t,n){i.$(e.target).parents(i.controls.divSubLevels).find("#pos-"+n).addClass("active")})}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPosition).modal("show")}else alert("No Positions exists for the sport")}else alert("Select Season")},MarkPosition:function(e){var t=i.$(e.target),n=p(e.target).attr("teamid"),r=p(e.target).attr("positionId"),s={id1:i.user_id,user_id:i.user_id,positions_id:r,teams_id:n};if(t.hasClass("active")){s.position_id=r;var o=new S(s);o.user_id=i.user_id,o.type="delete",o.destroy({data:s}),p.when(o.request).done(function(){t.removeClass("active")})}else{var o=new S(s);o.user_id=i.user_id,t.addClass("active"),o.type="save",o.save()}},AddLevel:function(e){var t=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels),n=p(e.target).attr("orgsid"),r=p(e.target).attr("sportid");n&&n!=0&&n!=null&&n!=""?(console.log("destination add level function",t),i.fillCompLevel(n,t,r)):console.error("Orgs Id is ",n)},AddSports:function(e){var t=i.$(e.target).attr("orgsid"),n=p(i.controls.divSportsWrapper+'[orgsId="'+t+'"] '+i.controls.divSchoolSportsSection);t&&t!=0&&t!=null&&t!=""&&(i.fillSports(t,n),p(n).parents(i.controls.divSportsWrapper).fadeIn())},RemoveSports:function(e){i.$(e.target).parents(i.controls.divsportsLevel).remove()},SetUpTeamsView:function(){console.log("Highschool teams view Set Up Teams View"),this.teamsView=new w({user_id:i.user_id,destination:i.controls.divTeamListDetail,sports_club:0,org_type:"school"})},SetUpAddSchool:function(){i.$el.find(i.controls.divAddSportSection).fadeIn()},AddSportsItem:function(e){if(p(e.target).is(":checked")&&p(e.target).attr("seasonid")&&p(e.target).attr("year")){var t=p(e.target).attr("orgsid"),n=p(e.target).parents(i.controls.divSubLevels).find(i.controls.ddlComplevel).val();if(t&&t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){var r={orgs_id:t,teams_id:0,id1:i.user_id,user_id:i.user_id,sports_id:p(e.target).attr("sportsid"),complevels_id:n,seasons_id:p(e.target).attr("seasonid"),year:p(e.target).attr("year")},s=new E(r);s.type="add",s.user_id=i.user_id,s.save(),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();if(t!=null&&t.payload!=null||t.payload.id!=null)p(e.target).attr("teamid",t.payload.team_id),p(e.target).parent().find(i.controls.btnOpenPositions).attr("teamid",t.payload.id).removeAttr("disabled")})}else{var o=p(e.target).parents(i.controls.divLevels).find(i.controls.ddlComplevel);p(o).parent().find(i.controls.fieldError).html(i.messages.SelectLevel).stop().fadeIn(),p(e.target).parent().find(i.controls.btnOpenPositions).attr("disabled","disabled")}}else!p(e.target).is(":checked")&&p(e.target).attr("teamid")&&i.DeleteTeam(e)},DeleteTeam:function(e){var t=p(e.target).attr("teamid");if(t){var n={};n.user_id=i.user_id,n.team_id=t;var r=new E(n);r.user_id=i.user_id,r.team_id=t,r.type="delete",r.destroy({data:{user_id:i.user_id,teams_id:t},processData:!0,success:function(){p(e.target).removeAttr("teamid"),p(e.target).parent().find(i.controls.btnOpenPositions).removeAttr("teamid").attr("disabled","disabled")}})}},FinishSports:function(){i.ClearAddNewForm(),i.init()},ClearAddNewForm:function(){i.RemoveSportsSection(),i.$(i.controls.txtStates).val(""),i.states_id=undefined,i.$(i.controls.txtSchools).attr("disabled","disabled").val(""),i.orgs_id=undefined,i.$el.find(".add-school-h").show(),i.$el.find(i.controls.divAddSportSection).fadeOut()},EditTeam:function(e){console.log("Event",e.target);var t=p(e.target).attr("orgsId"),n=p(e.target).attr("sportId"),r=p(e.target).parent(),s='<div class="section-sportslevel"><div class="div-sports-level"></div>';s+='<a tabindex="0" orgsid="'+t+'" class="btn-add-level" href="javascript:void(0)">Add Level</a>',s+='<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Finish</a> </span>',s+="</div>",p(r).html(s);var o=p(r).find(i.controls.divLevels);p.each(i.teamsView.Teams,function(e,r){console.log("team",r),t==r.payload.org_id&&p.each(r.payload.sports,function(e,r){console.log("sport",r);if(r.sports_id==n){i.SetUpEditTeamView(t,o,n,r);return}})})},SetUpEditTeamView:function(e,t,n,r){i.compLevel_id=undefined;if(e&&e>0){var s=new g;s.orgs_id=e,s.fetch(),console.log("Complevel Model Request Abort Request Function"),i.compLevelFetchRequest=i.abortRequest(i.compLevelFetchRequest),i.compLevelFetchRequest=s.fetch(),p.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();i.compLevel=[];if(n!=null&&n.payload!=null||n.payload.complevels!=null&&n.payload.complevels.length){i.seasons=n.payload.seasons||[];for(var o in n.payload.complevels)i.compLevel.push(n.payload.complevels[o]);p.each(r.complevels,function(n,s){i.SetUpCompLevelView(e,t,r);var o=i.$(t).find(i.controls.divSubLevels);if(o[n]){var u=i.$(o[n]).find(i.controls.ddlComplevel);p(u).val(s.complevels_id).attr("disabled","disabled"),p(o[n]).find(i.controls.divSeasons).fadeIn(),p.each(s.seasons,function(e,t){p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).attr("checked","checked").attr("teamid",t.team_id),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("teamid",t.team_id);var r="";t.positions&&p.each(t.positions,function(e,t){t&&(r+=t.id+",")}),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("positions",r)})}})}}),i.$(t).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",n)}},ClosePositions:function(e){if(i.clickedPositionTarget){var t=p(e.target).parents(i.controls.modalPosition).find(i.controls.modalPositionsTitle),n="";t.each(function(){p(this).hasClass("active")&&(n+=p(this).attr("positionid")+",")}),p(i.clickedPositionTarget).attr("positions",n),i.clickedPositionTarget=undefined}}});return s}),define("text!profilesetting/templates/club.html",[],function(){return'<div class="row-fluid">\r\n	<span class="green-left-heading">Clubs</span>\r\n</div>\r\n<div id="btn-Add-club" class="div-add-dotted">\r\n	+ Add a Club\r\n</div>\r\n<div id="section-Add-Sports-club" class="displayNone add-org-fields">\r\n<div>\r\n	<span class="span2">What State?</span>\r\n	<input type="text" id="txt-club-state" placeholder="Just Start Typing" tabindex="0"/>\r\n	<p class="field-error"></p>\r\n	<p class="field-message"></p>\r\n</div>\r\n\r\n<div>\r\n	<span class="span2">What Club?</span>\r\n	<input type="text" id="txt-club-club" placeholder="Just Start Typing" disabled="disabled" tabindex="1"/>\r\n	<a class="add-club-h" href="javascript: void(0);">Add a New Club</a>\r\n	<p class="field-error"></p>\r\n	<p class="field-message"></p>\r\n</div>\r\n<div class="div-sports-wrapper displayNone">\r\n	<div id="def-club-sports-section" class="school-sports-section">\r\n\r\n	</div>\r\n	<!--<span class="floatLeft"><a href="javascript:void(0)" class="btn-add-sports" >Add Sports</a> </span>-->\r\n</div>\r\n<!--<span class="floatRight"><a href="javascript:void(0)" class=" well-small btn-primary" >Save</a> </span> -->\r\n</div>\r\n<!--CLUBs LISTING SECTION HERE-->\r\n<!--lIST-->\r\n<div class="row-fluid section-team-list-detail-club">\r\n\r\n</div>\r\n'}),define("profilesetting/views/club",["require","text!profilesetting/templates/club.html","text!profilesetting/templates/sportslevel.html","text!profilesetting/templates/level.html","facade","views","utils","vendor","profilesetting/collections/states","profilesetting/collections/schools","profilesetting/collections/sports","profilesetting/views/teams","profilesetting/models/complevel","profilesetting/views/seasons","profilesetting/views/positions","profilesetting/models/team","profilesetting/models/position"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/states"),v=e("profilesetting/collections/schools"),m=e("profilesetting/collections/sports"),g=e("profilesetting/models/complevel"),y=e("profilesetting/views/seasons"),b=e("profilesetting/views/positions"),w=e("profilesetting/views/teams"),E=e("profilesetting/models/team"),S=e("profilesetting/models/position"),s=a.extend({template:t,events:{"keyup #txt-club-state":"keyupState","blur #txt-club-state":"changeState","keyup #txt-club-club":"keyupSchool","blur #txt-club-club":"changeSchool","change .ddl-sports":"changeSports","change .ddl-complevel":"changeCompLevel","change .chkSeasons":"AddSportsItem","click .btn-add-level":"AddLevel","click .spn-position-title_h":"MarkPosition","click .btn-add-sports":"AddSports","click .btn-Remove-Sport":"RemoveSports","click #btn-Add-club":"SetUpAddSchool","click .delete-team":"DeleteTeam","click .btn-Save-Positions":"SavePositions","click .btn-Close-Positions":"ClosePositions","click .btn-Finish-Sports":"FinishSports","click .edit-team":"EditTeam","click .btnOpenPositions":"displayPositionPopup","click .add-club-h":"openAddClubPopup","click .up-arrow-h":"levelUpArrow","click .down-arrow-h":"levelDownArrow"},controls:{txtStates:"#txt-club-state",txtSchools:"#txt-club-club",content:"#content-club-prof-setting",fieldMessage:".field-message",fieldError:".field-error",ddlSports:".ddl-sports",ddlComplevel:".ddl-complevel",modalPosition:".modal-positions",modalPositionBody:".modal-position-body",modalPositionsTitle:".spn-position-title_h",divSportsNameHeading:".spn-sport-name",divMainSportsSection:"#def-club-sports-section",divLevels:".div-sports-level",divSeasons:".div-seasons",divsportsLevel:".section-sportslevel",divSubLevels:".div-levels",divSchoolSportsSection:".school-sports-section",divSportsWrapper:".div-sports-wrapper",btnRemoveSports:".btn-Remove-Sport",divTeamListDetail:".section-team-list-detail-club",divAddSportSection:"#section-Add-Sports-club",btnAddSports:".btn-add-sports",btnClosePositions:".btn-Close-Positions",btnFinishSports:".btn-Finish-Sports",btnOpenPositions:".btnOpenPositions",chkSeasons:".chkSeasons",btnAddLevel:".btn-add-level"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property.",selectSport:"Please select sport",selectState:"Please insert state",selectSchool:"Please insert Club",SelectLevel:"Plesae Select Comp Level"},properties:{show_prev_year:30},states:[],schools:[],initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},levelUpArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=t.find(".complevels-container").height();if(n>r)var i=n-r;else var i=0;t.find(".complevels-container").animate({scrollTop:i})},levelDownArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=n+t.find(".complevels-container").height();t.find(".complevels-container").animate({scrollTop:r})},openAddClubPopup:function(){var e=this;routing.trigger("add-school-init","","","club",function(t){console.log(t),e.$el.find(e.controls.txtSchools).val(t.name),e.$el.find(e.controls.txtStates).val(t.locationState.name),e.states_id="",e.orgs_id="",e.states_id=t.locationState.id,e.$(i.controls.txtSchools).removeAttr("disabled"),e.orgs_id=t.org_id,e.$el.find(e.controls.divMainSportsSection).find(e.controls.ddlSports).length<1&&i.fillSports(e.orgs_id,e.controls.divMainSportsSection),e.$el.find(".add-club-h").hide()})},init:function(){i.setupView(),i.SetUpTeamsView()},render:function(){var e=this;a.prototype.render.call(this)},setupView:function(){},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender},keyupState:function(e){var t=p(i.controls.txtStates).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!="")if(r==1){i.$(i.controls.txtSchools).attr("disabled","disabled").val(""),i.RemoveSportsSection();var s=new d;s.state_name=t,console.log("State Request Abort Request Function AddGame/Main.js"),i.stateFetchRequest=i.stateFetchRequest||[],i.stateFetchRequest.push(i.cityFetchRequest||[]),i.stateFetchRequest.push(i.schoolFetchRequest||[]),i.stateFetchRequest=i.abortRequest(i.stateFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.stateFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var e=s.toJSON();e==null||e.length<1?i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html("").fadeOut(),i.states=[];for(var t in e)i.states.push(e[t].payload);i.states.forEach(function(e,t){n.push(e.name)});try{i.$el.find(i.controls.txtStates).autocomplete("destroy")}catch(r){}i.$el.find(i.controls.txtStates).autocomplete({source:n}),i.$el.find(i.controls.txtStates).trigger("keydown")})}else i.changeState(e)},changeState:function(e){var t=p(e.target).val(),n=!1;i.states_id="",i.states.forEach(function(e,r){e["name"]==t&&(n=!0,i.states_id=e.id,i.$el.find(i.controls.txtSchools).removeAttr("disabled"))}),n||(i.states_id=0,i.$el.find(i.controls.txtSchools).attr("disabled","disabled").val(""))},keyupSchool:function(e){var t=p(e.target).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!=""&&r==1){i.RemoveSportsSection();var s=new v;s.sports_club=1,s.states_id=i.states_id,s.org_name=t,console.log("School Request Abort Request Function"),i.schoolFetchRequest=i.abortRequest(i.schoolFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.schoolFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html("").stop().fadeOut(),i.schools=[];for(var r in t)i.schools.push(t[r].payload);i.schools.forEach(function(e,t){n.push(e.org_name)});try{i.$el.find(i.controls.txtSchools).autocomplete("destroy")}catch(o){}p(e.target).autocomplete({source:n}),i.$el.find(i.controls.txtSchools).trigger("keydown")})}else i.RemoveSportsSection(),i.changeSchool(e)},changeSchool:function(e){var t=this.$(e.target).val();i.orgs_id=0,i.schools.forEach(function(e,n){e["org_name"]==t&&(i.orgs_id=e.org_id,i.$el.find(i.controls.divMainSportsSection).find(i.controls.ddlSports).length<1&&i.fillSports(i.orgs_id,i.controls.divMainSportsSection))})},RemoveSportsSection:function(){i.$el.find(i.controls.divMainSportsSection).html("")},fillSports:function(e,t){if(i.sports&&i.sports.length>0)i.SetupSportsView(e,t);else{var n=new m;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,i.gender=="male"?n.male=1:i.gender=="famale"&&(n.female=0),n.fetch(),p.when(n.request).done(function(){if(n.isError())return;var r=n.toJSON();(r==null||r.length<1)&&i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn(),i.sports=[];for(var s in r)i.sports.push(r[s].payload);i.sort(i.sports,"sport_name",!1),i.SetupSportsView(e,t)})}},changeSports:function(e){console.log("SPORTS",i.sports);var t=p(e.target).val(),n=p(e.target).attr("orgsid");console.log("Event Target Sports List",p(e.target),t,n);if(t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){i.sport_id=t;var r=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels);console.log("CALLED",r),r.html(""),i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",t),i.fillCompLevel(n,r,t)}else i.sport_id=0},SetupSportsView:function(e,t){var r=h.to_html(n,{sports:i.sports,orgsId:e});i.$(t).append(r),p(t).parents(i.controls.divSportsWrapper).find(i.controls.btnAddSports).attr("orgsid",e),p(t).parents(i.controls.divSportsWrapper).fadeIn()},findSportById:function(e){if(i.sports.length<1)return 0;for(var t=0;t<i.sports.length;t++)if(i.sports[t].id==e)return i.sports[t]},fillCompLevel:function(e,t,n){i.compLevel_id=undefined;if(e&&e>0){var r=new g;r.orgs_id=e,console.log("Complevels Request Abort Request Function"),i.compFetchRequest=i.abortRequest(i.compFetchRequest);var s=r.fetch();i.compFetchRequest.push(s),p.when(r.request).done(function(){if(r.isError())return;var s=r.toJSON();i.compLevel=[];if(s!=null&&s.payload!=null||s.payload.complevels!=null&&s.payload.complevels.length){i.seasons=s.payload.seasons||[];for(var o in s.payload.complevels)i.compLevel.push(s.payload.complevels[o]);var u=i.findSportById(n);i.SetUpCompLevelView(e,t,u)}})}else p(t).html("")},changeCompLevel:function(e){var t=p(e.target).val();i.compLevel_id=0;for(var n in i.compLevel)if(i.compLevel[n].complevel_id==t){i.compLevel_id=t,i.$(e.target).attr("disabled","disabled"),i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeIn();return}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeOut()},SetUpCompLevelView:function(e,t,n){var s=n.sports_id,o=i.GetSeasonsData(i.seasons,e,s),u=h.to_html(r,{levels:i.compLevel,Data:o,sport:n});i.$(t).append(u);var a=i.$(t).find(i.controls.modalPositionBody);i.fillPositions(s,a)},GetSeasonsData:function(e,t,n){var r=[],s=(new Date).getFullYear();for(var o=i.properties.show_prev_year;o>=0;o--){var u={year:s,seasons:e,orgsId:t,sportsId:n};r.push(u),s--}return r},fillPositions:function(e,t){e?(this.positionView=new b({name:"settings-club-positions",destination:t,sport_id:e}),i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html("").fadeOut()):i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html(i.messages.selectSport).stop().fadeIn()},displayPositionPopup:function(e){i.clickedPositionTarget=p(e.target);var t=p(e.target).attr("teamid");if(p(e.target).parent().find(i.controls.chkSeasons).is(":checked"))if(p(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).length>0){i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).attr("teamid",t).removeClass("active");var n=p(e.target).attr("positions");if(n){var r=n.split(",");p.each(r,function(t,n){i.$(e.target).parents(i.controls.divSubLevels).find("#pos-"+n).addClass("active")})}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPosition).modal("show")}else alert("No Positions exists for the sport");else alert("Select Season")},MarkPosition:function(e){var t=i.$(e.target),n=p(e.target).attr("teamid"),r=p(e.target).attr("positionId"),s={id1:i.user_id,user_id:i.user_id,positions_id:r,teams_id:n};if(t.hasClass("active")){s.position_id=r;var o=new S(s);o.user_id=i.user_id,o.type="delete",o.destroy({data:s}),p.when(o.request).done(function(){t.removeClass("active")})}else{var o=new S(s);o.user_id=i.user_id,t.addClass("active"),o.type="save",o.save()}},AddLevel:function(e){var t=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels),n=p(e.target).attr("orgsid"),r=p(e.target).attr("sportid");n&&n!=0&&n!=null&&n!=""?i.fillCompLevel(n,t,r):console.error("Orgs Id is ",n)},AddSports:function(e){var t=i.$(e.target).attr("orgsid"),n=p(i.controls.divSportsWrapper+'[orgsId="'+t+'"] '+i.controls.divSchoolSportsSection);t&&t!=0&&t!=null&&t!=""&&(i.fillSports(t,n),p(n).parents(i.controls.divSportsWrapper).fadeIn())},RemoveSports:function(e){i.$(e.target).parents(i.controls.divsportsLevel).remove()},SetUpTeamsView:function(){this.teamsView=new w({user_id:i.user_id,destination:i.controls.divTeamListDetail,sports_club:1,org_type:"club"})},SetUpAddSchool:function(){i.$el.find(i.controls.divAddSportSection).fadeIn()},AddSportsItem:function(e){if(p(e.target).is(":checked")&&p(e.target).attr("seasonid")&&p(e.target).attr("year")){var t=p(e.target).attr("orgsid"),n=p(e.target).parents(i.controls.divSubLevels).find(i.controls.ddlComplevel).val();if(t&&t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){var r={orgs_id:t,teams_id:0,id1:i.user_id,user_id:i.user_id,sports_id:p(e.target).attr("sportsid"),complevels_id:n,seasons_id:p(e.target).attr("seasonid"),year:p(e.target).attr("year")},s=new E(r);s.type="add",s.user_id=i.user_id,s.save(),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();if(t!=null&&t.payload!=null||t.payload.id!=null)p(e.target).attr("teamid",t.payload.team_id),p(e.target).parent().find(i.controls.btnOpenPositions).attr("teamid",t.payload.id).removeAttr("disabled")})}else{console.error("OrgsId & ComplevelIds are",t,n);var o=p(e.target).parents(i.controls.divLevels).find(i.controls.ddlComplevel);p(o).parent().find(i.controls.fieldError).html(i.messages.SelectLevel).stop().fadeIn(),p(e.target).parent().find(i.controls.btnOpenPositions).attr("disabled","disabled")}}else!p(e.target).is(":checked")&&p(e.target).attr("teamid")&&i.DeleteTeam(e)},DeleteTeam:function(e){var t=p(e.target).attr("teamid");if(t){var n={};n.user_id=i.user_id,n.team_id=t;var r=new E(n);r.user_id=i.user_id,r.team_id=t,r.type="delete",r.destroy({data:{user_id:i.user_id,teams_id:t},processData:!0,success:function(){p(e.target).removeAttr("teamid"),p(e.target).parent().find(i.controls.btnOpenPositions).removeAttr("teamid").removeAttr("positions").attr("disabled","disabled")}})}},FinishSports:function(){i.ClearAddNewForm(),i.init()},ClearAddNewForm:function(){i.RemoveSportsSection(),i.$(i.controls.txtStates).val(""),i.states_id=undefined,i.$(i.controls.txtSchools).attr("disabled","disabled").val(""),i.orgs_id=undefined,i.$el.find(i.controls.divAddSportSection).fadeOut(),i.$el.find(".add-club-h").show()},EditTeam:function(e){console.log("self.teamsView.Teams",i.teamsView.Teams);var t=p(e.target).attr("orgsId"),n=p(e.target).attr("sportId"),r=p(e.target).parent(),s='<div class="section-sportslevel"><div class="div-sports-level"></div>';s+='<a tabindex="0" orgsid="'+t+'" class="btn-add-level" href="javascript:void(0)">Add Level</a>',s+='<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Finish</a> </span>',s+="</div>",p(r).html(s);var o=p(r).find(i.controls.divLevels);p.each(i.teamsView.Teams,function(e,s){console.log("team",s),t==s.payload.org_id&&p.each(s.payload.sports,function(e,s){console.log("sport",s);if(s.sports_id==n){i.SetUpEditTeamView(t,r,n,s);return}})})},SetUpEditTeamView:function(e,t,n,r){i.compLevel_id=undefined;if(e&&e>0){var s=new g;s.orgs_id=e,console.log("Complevel Model Request Abort Request Function"),i.compLevelFetchRequest=i.abortRequest(i.compLevelFetchRequest),i.compLevelFetchRequest=s.fetch(),p.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();i.compLevel=[];if(n!=null&&n.payload!=null||n.payload.complevels!=null&&n.payload.complevels.length){i.seasons=n.payload.seasons||[];for(var o in n.payload.complevels)i.compLevel.push(n.payload.complevels[o]);p.each(r.complevels,function(n,s){i.SetUpCompLevelView(e,t,r);var o=i.$(t).find(i.controls.divSubLevels);if(o[n]){var u=i.$(o[n]).find(i.controls.ddlComplevel);p(u).val(s.complevels_id).attr("disabled","disabled"),p(o[n]).find(i.controls.divSeasons).fadeIn(),p.each(s.seasons,function(e,t){p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).attr("checked","checked").attr("teamid",t.team_id),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("teamid",t.team_id);var r="";t.positions&&p.each(t.positions,function(e,t){t&&(r+=t.id+",")}),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("positions",r)})}})}}),i.$(t).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",n)}},ClosePositions:function(e){if(i.clickedPositionTarget){var t=p(e.target).parents(i.controls.modalPosition).find(i.controls.modalPositionsTitle),n="";t.each(function(){p(this).hasClass("active")&&(n+=p(this).attr("positionid")+",")}),p(i.clickedPositionTarget).attr("positions",n),i.clickedPositionTarget=undefined}}});return s}),define("profilesetting/models/high_school",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!profilesetting/templates/individualsports.html",[],function(){return'<div class="sub-section-prof-setting">\r\n\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Individual Sports</span>\r\n	</div>\r\n	<span style="padding:10px 50px 10px 50px; font-weight: bold; font-size:.9em; display: block;">Individual sports are sports that you participate in without a team.&nbsp;&nbsp;An easy way to understand it is when you go to a Meet / Event and dominate, did YOU win, or did your TEAM win?  If you won, chances are you want to choose your sport below.\r\n		Another question you can ask, is "Can you compete in an event for this sport without a team?".<br/><br/>\r\n		There are gray areas like boxing gyms or MMA gyms where you belong to and compete for a gym, but it\'s you that wins the fight and it\'s two people competing, not two teams.&nbsp;&nbsp;We\'re working on building support for that, but now, use the individual sport section to add the sport to your profile.<br/><br/>\r\n	If you are dealing with a team sport, go to the sections above to select your team.&nbsp;&nbsp;There is a section for school-based teams and one for club-based teams.&nbsp;&nbsp;If you can\'t find it in the auto-complete search, you can add a new one.&nbsp;&nbsp;If you find this confusing, please don\'t hesitate to send an email to weare@athletez.com</span>\r\n	<div class="section-individual-sports">\r\n		<div class="org-sport-list">\r\n			<div class="org-sport-list-header">\r\n				<div class="org-name">Select The Sports you Participate in</div>\r\n			</div>\r\n			<div class="sports-list-individial-sports"></div>\r\n		</div>\r\n	</div>\r\n</div>'}),define("text!profilesetting/templates/sportscheckbox.html",[],function(){return'{{#sports}}\r\n	<div>\r\n		<div class="org-sport-list-header">\r\n			<div class="sport-name">\r\n				<input type="checkbox" id="chk-ind-{{sport_id}}" class="chk-single" sportid="{{sport_id}}" />\r\n\r\n				<img src="{{icon}}" />\r\n\r\n				{{sports_name}}\r\n			</div>\r\n		</div>\r\n	</div>\r\n{{/sports}}'}),define("text!profilesetting/templates/sportitem.html",[],function(){return'<div class="span12">\r\n	Users Sports\r\n</div>\r\n{{#sports}}\r\n<div class="span12">\r\n<span class="span3">\r\n			<label>{{sport_name}}</label></span>\r\n			<span class="span3">\r\n				\r\n				<a href="javascript:void(0)" class="delete-individualsport" sportid="{{sport_id}}">Delete</a>\r\n				</span>\r\n</div>\r\n{{/sports}}'}),define("profilesetting/collections/individualsports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({sport_type:1,male:1,female:0,url:function(){if(testpath)return testpath+"/api/user/sports";if(this.type=="get")return"/api/user/sports/"+this.user_id+"?team_type=individual"},data:{sports_id:this.sports_id}}),i}),define("profilesetting/models/sport",["facade","sportorg/models/sport"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"user_id",url:function(){this.orgs_id==undefined;if(this.type=="save")return"/api/user/addsport/"+this.user_id;if(this.type=="delete")return"/api/user/sport/"+this.user_id}}),n}),define("profilesetting/views/individuals",["require","text!profilesetting/templates/individualsports.html","text!profilesetting/templates/sportscheckbox.html","text!profilesetting/templates/sportitem.html","facade","views","utils","vendor","profilesetting/collections/individualsports","profilesetting/collections/sports","profilesetting/models/sport"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/individualsports"),v=e("profilesetting/models/sport"),m=e("profilesetting/collections/sports"),s=a.extend({template:t,events:{"change .select-all":"CheckAll","change .chk-single":"CheckSingle","click .delete-individualsport":"DeleteSport"},controls:{content:"#section-individual-prof-setting",sportslist:".sports-list-individial-sports",btnSave:".btn-Save-Individual-Sports",chkAll:".select-all",chkSingle:".chk-single",userSportsList:".sports-list-user-individual-sports"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property."},initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},init:function(){i.setupSportsView()},render:function(){a.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender,this.destination=e.destination},setUpUsersSports:function(){console.log("setUpSportsView Individual View");var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(r,{sports:i.sports});console.log("Users Own Sports",i.sports),i.$(i.controls.userSportsList).html(s)})},setUpUsersSportsCheck:function(){console.log("setUpSportsView Individual View Check");var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1),p.each(i.sports,function(e,t){i.$el.find("#chk-ind-"+t.sport_id).attr("checked","checked")})})},setupSportsView:function(){console.log("setUpSportsView Individual View");var e=new m;e.user_id=i.user_id,e.sport_type_id=2,e.male=1,e.female=0,i.gender=="male"?e.male=1:i.gender=="famale"&&(e.female=0),e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var r in t)i.sports.push(t[r].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(n,{sports:i.sports});i.$(i.controls.sportslist).html(s),i.setUpUsersSportsCheck()})},SaveSport:function(e){console.log("Save Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n=new v;n.user_id=i.user_id,n.sports_id=t,n.type="save",console.log("Save Model Request Abort Request Function"),i.sportsModelFetchRequest=i.abortRequest(i.sportsModelFetchRequest),i.compLevelFetchRequest=n.save({sports_id:t}),p.when(n.request).done(function(){i.setUpUsersSportsCheck()})}},DeleteSport:function(e){console.log("Delete Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n={user_id:i.user_id,sports_id:t},r=new v(n);r.user_id=i.user_id,r.type="delete",r.destroy({data:n,processData:!0,success:function(){i.setUpUsersSportsCheck()}})}},CheckAll:function(e){p(e.target).is(":checked")?i.$(i.controls.chkSingle).attr("checked","checked"):i.$(i.controls.chkSingle).removeAttr("checked","checked")},CheckSingle:function(e){p(e.target).is(":checked")?i.SaveSport(e):i.DeleteSport(e)}});return s}),define("profilesetting",["require","text!profilesetting/templates/layout.html","facade","controller","models","views","utils","profilesetting/models/basic_info","profilesetting/views/basic_info","profilesetting/views/highschool","profilesetting/views/club","profilesetting/models/high_school","profilesetting/views/individuals"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("profilesetting/models/basic_info"),d=e("profilesetting/views/basic_info"),v=e("profilesetting/views/highschool");ClubView=e("profilesetting/views/club"),IndividualSportsView=e("profilesetting/views/individuals");var m=e("profilesetting/models/high_school"),g=e("profilesetting/collections/individualsports");return n=i.extend({cssArr:["/pages/profilesetting/profilesettings.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),this.scheme=[],e.id&&(this.id=e.id,this.init()),this},init:function(){this.setupLayout().render(),this.setupView(),this.handleDeferreds()},setupLayout:function(){var e;return this.layout?this.layout:(e=new h({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout)},setupView:function(){var e=this;this.basicInfoModel=new p,this.basicInfoModel.id=e.id,this.basicInfoModel.fetch(),a.when(this.basicInfoModel.request).done(function(){var t=e.basicInfoModel.toJSON();e.gender=t.payload.gender,e.setUpBasicView(),e.addHighSchool(),e.SetUpClubView(),e.setUpIndividualView()})},setUpBasicView:function(){this.basicView=new d({id:self.id})},addHighSchool:function(){var e=this;this.schoolView=new v({model:new m,name:"settings-high-school",destination:"#content-school-prof-setting",user_id:e.id,gender:e.gender}),this.scheme.push(this.schoolView),this.layout.render()},setUpIndividualView:function(){var e=this;this.individualSportsView=new IndividualSportsView({model:new g({user_id:e.id}),name:"settings-individual-sports",destination:"#section-individual-prof-setting",user_id:e.id,gender:e.gender}),this.scheme.push(this.individualSportsView),this.layout.render()},SetUpClubView:function(){var e=this;this.clubView=new ClubView({model:new m,name:"settings-club",destination:"#content-club-prof-setting",user_id:e.id,gender:e.gender}),this.scheme.push(this.clubView),this.layout.render()}}),n}),define("text!userresume/templates/layout.html",[],function(){return'<div class="main-container" style="margin : auto">\r\n	<!-- Basic Info Section Starts-->\r\n	<div id="section-basics-prof-setting" style=""></div>\r\n	<!-- Basic Info Section Ends-->\r\n\r\n<!-- Sent Resume Section Starts\r\n	<div id="section-sent-resume">\r\n\r\n	</div>-->\r\n<!-- Sent Resume Section Ends -->\r\n\r\n<!-- Rd Tree Section Starts -->\r\n	<div id="section-RD-Tree">\r\n		\r\n	</div>\r\n<!-- Rd Tree Section Ends -->\r\n\r\n<!-- Academic Gpa Section Starts -->\r\n	<div id="section-academic">\r\n		\r\n	</div>\r\n<!-- Academic Gpa Section Ends -->\r\n\r\n<!-- User Awards Section Starts -->\r\n	<div id="section-awards">\r\n		\r\n	</div>\r\n<!-- User Awards Section Ends -->\r\n\r\n<!-- User References Section Starts -->\r\n	<div id="section-references">\r\n		\r\n	</div>\r\n<!-- User Reference Section Ends -->\r\n\r\n<!-- User Contacts Section Starts\r\n	<div id="section-contacts">\r\n		\r\n	</div>\r\n<!-- User Contacts Section Ends -->\r\n\r\n\r\n	<div id="main-footer-prof-setting">\r\n	</div>\r\n</div>\r\n'}),define("text!userresume/templates/sentresume.html",[],function(){return'<div class="row-fluid sub-section-prof-setting well well-large">\r\n<div class="row-fluid">\r\n	<span class="spn-black-heading  well-small">Sent Resumes</span>\r\n</div>\r\n<div id="btn-Add-Resume" class="clearfix div-add-dotted well-small">\r\n	+ Send Resume\r\n</div>\r\n<table class="row-fluid">\r\n	<tr>\r\n		<th>Id</th>\r\n		<th>Sports Id</th>\r\n		<th>Users Id</th>\r\n		<th>College Coach Id</th>\r\n	</tr>\r\n	{{#resumes}}\r\n	<tr>\r\n		<td>{{id}}</td>\r\n		<td>{{sports_id}}</td>\r\n		<td>{{users_id}}</td>\r\n		<td>{{college_coach_id}}</td>\r\n	</tr>\r\n	{{/resumes}}\r\n</table>\r\n</div>'}),define("text!userresume/templates/basic_info_header.html",[],function(){return'{{#payload}}\r\n<div class="span3">\r\n	<img id="img-profile-prof-setting" src="{{user_picture}}" />\r\n</div>\r\n<div class="span6">\r\n	<h2>{{name}}</h2>\r\n	<p>\r\n		{{user_height}} INCHES\r\n	</p>\r\n	<p>\r\n		{{user_weight}} LBS\r\n	</p>\r\n</div>\r\n{{/payload}}'}),define("text!userresume/templates/rdtree.html",[],function(){return'<div class="sub-section-prof-setting">\r\n<div class="row-fluid">\r\n	<span class="green-left-heading">Work Outs</span>\r\n</div>\r\n<div id="container-rdtree" class="row-fluid inset-data-entry">\r\n	{{#rdtrees}}\r\n	<div class="section-rdtree-items_h">\r\n		<div><span class="standard-subsection-header" style="margin-top:15px;">{{title}}</span></div>\r\n		{{#data}}\r\n			<div class="rd-entry">\r\n				<span>{{#icon}}<img src="{{icon}}" />{{/icon}}{{name}}</span>\r\n				<span>\r\n					<input type="text" class="txtRdTrees_h" treeId="{{id}}" value="{{val}}" resumeDataId="{{resumeDataId}}"/>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					\r\n				</span>\r\n			</div>\r\n		{{/data}}\r\n		<!--<a href="javascript:void(0)" class="resume_button btn-Finish-RdTree_h displayNone">FINISH</a>-->\r\n	</div>\r\n	{{/rdtrees}}\r\n</div>\r\n</div>'}),define("text!userresume/templates/academic.html",[],function(){return'<div class="sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Academic</span>\r\n	</div>\r\n	<div class="inset-data-entry">\r\n		<div id="container-academic-gpa"></div>\r\n		<div id="container-StandardizedTest"></div>\r\n		<div id="container-ApTest"></div>\r\n	</div>\r\n</div>'}),define("text!userresume/templates/awards.html",[],function(){return'<div class="row-fluid sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Awards</span>\r\n	</div>\r\n\r\n	<div class="inset-data-entry section-new-award">\r\n		<div class="div-add-dotted well-small btn-Add-award_h" testids="{{TestIds}}">\r\n			+ Add an Award\r\n		</div>\r\n		<div class="section-new-controls displayNone">\r\n			<div class="clearfix row-fluid">\r\n				<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span>\r\n					<select class="ddl-sports-awards_h"></select>\r\n				</span>\r\n				<span>\r\n					<input type="text" class="txtAwards_h txt_name_h" placeholder="Award Name" value="{{name}}"/>\r\n				</span>\r\n				<span>\r\n					<input type="text" class="txtAwards_h txt_year_h" placeholder="Year Awarded" value="{{year}}"/>\r\n				</span>\r\n				</div>\r\n				<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span>\r\n					<textarea class="txtAwards_h txt_description_h" placeholder="Description">{{description}}</textarea>\r\n				</span>\r\n				</div>\r\n			</div>\r\n			<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span class=""><a href="javascript:void(0)" class="resume_button btn-Save_award_h" >Save</a> <a href="javascript:void(0)" class="resume_button btn-Cancel-New">Cancel</a> <span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n			</div>\r\n		</div>\r\n		<br/>\r\n	</div>\r\n	<div id="section-list-awards" class="row-fluid">\r\n\r\n	</div>\r\n</div>'}),define("text!userresume/templates/contact.html",[],function(){return"<div>Contact</div>"}),define("text!userresume/templates/references.html",[],function(){return'<div class="row-fluid sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">References</span>\r\n	</div>\r\n\r\n	<div class="inset-data-entry section-new-reference">\r\n		<div class="div-add-dotted well-small btn-Add-reference_h" testids="{{TestIds}}">\r\n			+ Add an Reference\r\n		</div>\r\n		<div class="well section-new-controls displayNone">\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Sport:</span>\r\n				<span class=""> <select class="ddl-sports-references_h"></select> </span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Name:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_name_h" value="{{name}}"/>\r\n				</span>\r\n			</div>\r\n\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Description:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_description_h" value="{{description}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Email:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_email_h" value="{{year}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Relationship:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_relation_h" value="{{year}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Phone:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_phone_h" value="{{description}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="span12"> <a href="javascript:void(0)" class="resume_button btn-Save_reference_h" >Save</a> <a href="javascript:void(0)" class="resume_button btn-Cancel-New">Cancel</a> <span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n			</div>\r\n		</div>\r\n		<br/>\r\n	</div>\r\n	<div id="section-list-references" class="row-fluid">\r\n\r\n	</div>\r\n</div>'}),define("user/models/resume",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/resume",["facade","user/models/resume"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("user/models/rdtree",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/rdtree",["facade","user/models/rdtree"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,resume_data_id:this.resume_data_id,user_value:this.user_value},processData:!0,url:function(){return this.action=="save"?"api/resumedataval/add/"+this.treeId+"?id1="+this.treeId:this.action=="update"?"api/resumedataval/basics/"+this.treeId+"?id1="+this.treeId:this.action=="delete"?"api/user/gpa/"+this.user_id+"?id1="+this.user_id:"api/user/addgpa/"+this.user_id+"?id1="+this.user_id},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){console.log("Show Error Message Rdtree.js Model",e),$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/gpa",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="delete"?"api/user/gpa/"+this.user_id+"?id1="+this.user_id:"api/user/addgpa/"+this.user_id+"?id1="+this.user_id},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/award",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="update"?"api/awards/basics/"+this.award_id+"?id1="+this.award_id:this.action=="save"?"api/awards/add/":(this.action=="delete","api/awards/base/"+this.award_id+"?id1="+this.award_id)},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/contact",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/reference",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",processData:!0,url:function(){return this.action=="update"?"api/references/basics/"+this.reference_id+"?id1="+this.reference_id:this.action=="save"?"api/references/add/":(this.action=="delete","api/references/base/"+this.reference_id+"?id1="+this.reference_id)},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("user/collections/resumes",["facade","collections","user/models/resume","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/sentresumes",["facade","collections","user/collections/resumes","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/sent_resume/"+this.user_id:(this.user_id==undefined,"api/user/sent_resumes/"+this.user_id+"?id1="+this.user_id)}});return i}),define("userresume/views/sentresumeview",["require","text!userresume/templates/sentresume.html","facade","views","utils","vendor","userresume/collections/sentresumes"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/sentresumes"),h=s.extend({template:t,events:{},controls:{},messages:{dataNotExist:"Data Not Exists For Resumes."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},render:function(){var e=this;s.prototype.render.call(this)},setupView:function(){var e=this,t={user_id:e.user_id},n=new c(t);n.user_id=e.user_id,n.fetch(),l.when(n.request).done(function(){if(n.isError())return;var t=n.toJSON();if(t.length){var r=[];l.each(t,function(e,t){r.push(t.payload)}),e.Resumes=t;var i=f.to_html(e.template,{resumes:r});l(e.el).html(i)}else l(e.el).html(e.messages.dataNotExist)})}});return h}),define("user/collections/rdtree",["facade","collections","user/models/rdtree","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/rdtree",["facade","collections","user/collections/rdtree","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/rdtree/"+this.user_id:(this.user_id==undefined,"api/user/rdtree/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){var r={title:t.payload.name},i=[];for(var s in t.payload.data){var o=t.payload.data[s],u={name:o.name,id:o.id,type:o.type,val:o.val||"",resumeDataId:o.resume_data_id,icon:o.icon||null};i.push(u)}r.data=i,n.push(r)}),n}});return i}),define("userresume/views/rdtree",["require","text!userresume/templates/rdtree.html","facade","views","utils","vendor","userresume/collections/rdtree","userresume/models/rdtree"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/rdtree"),h=e("userresume/models/rdtree"),p=s.extend({template:t,events:{"click .btn-edit-rdtree_h":"MarkEdit","click .txtRdTrees_h":"MakeEdit","click .btn-Finish-RdTree_h":"FinishEdit","blur .txtRdTrees_h":"SaveResumeData"},controls:{btnEditRdTree:".btn-edit-rdtree_h",btnFinishRdTree:".btn-Finish-RdTree_h",sectionRdTreeItems:".section-rdtree-items_h",txtRdTree:".txtRdTrees_h"},messages:{dataNotExist:"Data Not Exists For RD Trees."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},setupView:function(){var e=this,t={user_id:e.user_id},n=new c(t);n.user_id=e.user_id,n.fetch(),l.when(n.request).done(function(){if(n.isError())return;e.Tree=n.parseAsRequired(),console.log("d",e.Tree);var t=f.to_html(e.template,{rdtrees:e.Tree});l(e.el).html(t)})},MarkEdit:function(e){console.log(e),l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).removeAttr("disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnFinishRdTree).fadeIn()},MarkEdit:function(e){console.log(e),l(e.target).fadeOut(),l(e.target).removeAttr("disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnFinishRdTree).fadeIn()},FinishEdit:function(e){l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).attr("disabled","disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnEditRdTree).fadeIn()},SaveResumeData:function(e){var t=l(e.target).attr("treeId"),r=l(e.target).attr("resumeDataId"),i=l(e.target).val(),s={treeId:t,user_id:n.user_id,resume_data_id:r,user_value:i},o=new h(s);o.treeId=t,o.user_id=n.user_id,o.target=l(e.target),t>0?(o.action="update",o.save({id1:t})):(o.action="save",o.save()),l.when(o.request).done(function(t){console.log("response",t),t.payload!=null&&t.payload.id>0&&(console.log(t.payload),l(e.target).attr("treeId",t.payload.id)),l('.txtRdTrees_h[resumedataid="'+t.payload.resume_data_id+'"]').val(t.payload.user_value),l(e.target).parent().find(".error_h").html("").fadeOut(),l(e.target).parent().find(".success_h").html("").fadeOut()})}});return p}),define("text!userresume/templates/gpa.html",[],function(){return'<span class="standard-subsection-header">GPA</span>\r\n<div class="div-add-dotted well-small btn-Add-gpa" testids="{{TestIds}}">\r\n	+ Add a Gpa\r\n</div>\r\n<div class="section-Add-Gpa displayNone">\r\n	<div class="alert alert-danger displayNone error_h"></div>\r\n	<span class="span5">Year : \r\n		<select class="txtGpaYear_h">\r\n			<option value="">Select</option>\r\n			<option value="Senior">Senior</option>\r\n			<option value="Junior">Junior</option>\r\n			<option value="">Sophomore</option>\r\n			<option value="Freshman">Freshman</option>\r\n		</select>\r\n		</span>\r\n	<span class="span5">Score : <input type="text" class="txtGpaScore_h"/></span>\r\n	<p ><button class="resume_button btn-Save-Gpa">Save</button></p>\r\n</div>\r\n<a href="javascript:void(0)" id="edit-gpa-btn" class="edit edit-gpa displayNone"></a>\r\n{{#data}}\r\n			<div class="row-fluid">\r\n				<span class="span3">{{year}}</span>\r\n				<span class="span9">\r\n					<input type="text" class="txtGpa_h" year="{{year}}" gpaId="{{id}}" value="{{gpa}}" disabled="disabled"/>\r\n					<a href="javascript:void(0)" class="remove btn-delete-gpa" year="{{year}}"></a>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					</span>\r\n					\r\n			</div>\r\n		{{/data}}\r\n		<button class="resume_button btn-finish-gpa_h displayNone">Finish</button>'}),define("text!userresume/templates/test.html",[],function(){return'<span class="standard-subsection-header">{{Test_Type}} Tests</span>\r\n<div class="clearfix ">\r\n<div class="div-add-dotted well-small btn-Add-test" testids="{{TestIds}}">\r\n	+ Add a Test\r\n</div>\r\n<div class="section-modal-academic-tests_h"> </div>\r\n</div>\r\n\r\n<div class="section-test-topics_h">\r\n	\r\n</div>'}),define("text!userresume/templates/testtopics.html",[],function(){return'\r\n{{#data}}\r\n			<div class="row-fluid item-test-topic_h item-test-{{id}}">\r\n				<div>\r\n				<span class="span3"><h4>{{testname}} :</h4></span> <span class="span3"><a href="javascript:void(0)" class="edit edit-test"></a></span>\r\n				<span class="span9">\r\n					{{#topics}}\r\n					<div class="row-fluid">\r\n						<span class="span3">{{name}}</span>\r\n						<span class="span9"><input type="text" class="txtTestScore_h" testId="{{id}}" topicId="{{topicid}}" initial="{{score}}" value="{{score}}" disabled="disabled"/>\r\n<a href="javascript:void(0)" class="remove btn-delete-test_h" testId="{{id}}" topicId="{{topicid}}"></a>\r\n							<span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n						</span>\r\n					</div>\r\n					 {{/topics}}\r\n				</span>\r\n				</div>\r\n				<div>\r\n					</div>\r\n					<a href="javascript:void(0)" class="btn btn-primary btn-finish-test-topic_h displayNone" >Finish</a>\r\n				</div>\r\n			</div>\r\n		 {{/data}}'}),define("text!userresume/templates/testlist.html",[],function(){return'<div class="modal hide fade tests-modal_h" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n<div class="modal-header">\r\n<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n<h3 id="myModalLabel">Add a Test ({{Test_Type}})</h3>\r\n</div>\r\n<div class="modal-body  well">\r\n	{{#data}}\r\n	<div class="row-fluid">\r\n		<span class="span3">\r\n		<input type="checkbox" class="chk-test-{{type}}_h chk-{{id}}" testid="{{id}}" /> </span> &nbsp;\r\n		<span class="span3"> {{testname}} </span>\r\n	</div>\r\n		{{/data}}\r\n</div>\r\n<div class="modal-footer">\r\n<button class="btn" data-dismiss="modal" aria-hidden="true">Finish</button>\r\n<!--<button class="btn btn-primary btn-Save-Positions">Finish</button> -->\r\n</div>\r\n</div>'}),define("user/collections/gpa",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/gpa",["facade","collections","user/collections/gpa","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/gpa/"+this.user_id:(this.user_id==undefined,"api/user/gpa/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload;n.push({gpa:r.gpa,year:r.year})}}),n}});return i}),define("user/collections/tests",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/tests",["facade","collections","user/collections/tests","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/tests/"+this.user_id:(this.user_id==undefined,"api/user/tests/"+this.user_id+"?id1="+this.user_id+"&standardized="+(this.includeStandard||0)+"&ap="+(this.includeAp||0))},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:r.id,testname:r.name,type:r.test_type,topics:[]};for(var s in r.topics)i.topics.push({topicid:s,name:r.topics[s].name,score:r.topics[s].score==0?"":r.topics[s].score});n.push(i)}}),n}});return i}),define("userresume/collections/academictests",["facade","collections","user/collections/tests","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/academictest/listall/"+this.user_id:(this.user_id==undefined,"api/academictest/listall/0?id1="+this.user_id+"&standardized="+(this.includeStandard||0)+"&ap="+(this.includeAp||0))},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:r.id,testname:r.name,type:r.test_type,topics:[]};if(r.topics!=null)for(var s in r.topics)i.topics.push({topicid:s,name:r.topics[s].name,score:r.topics[s].score||""});n.push(i)}}),n}});return i}),define("userresume/models/test",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"academics_tests_topics_id",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="update"?"api/user/testscore/"+this.users_id+"?id1="+this.users_id:this.action=="save"?"api/user/addtestscore/"+this.users_id+"?id1="+this.users_id:this.action=="delete"?"api/user/testscore/"+this.users_id+"?id1="+this.users_id:"api/user/addtestscore/"},showSuccessMessage:function(e){console.log("showSuccessMessage test"),$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/views/academic",["require","text!userresume/templates/academic.html","text!userresume/templates/gpa.html","text!userresume/templates/test.html","text!userresume/templates/testtopics.html","text!userresume/templates/testlist.html","facade","views","utils","vendor","userresume/collections/gpa","userresume/collections/tests","userresume/collections/academictests","userresume/models/gpa","userresume/models/test"],function(e,t,n,r,i,s){var o,u=e("facade"),a=e("views"),f=a.SectionView,l=e("utils"),c=l.lib.Channel,h=e("vendor"),p=h.Mustache,d=u.$,v=e("userresume/collections/gpa"),m=e("userresume/collections/tests"),g=e("userresume/collections/academictests"),y=e("userresume/models/gpa"),b=e("userresume/models/test"),w=f.extend({events:{"click .edit-gpa":"EditGpa","click .edit-test":"EditTest","click .btn-Add-test":"OpenTestPopUp","change .chk-test-Standardized_h":"AddStandardTest","change .chk-test-AP_h":"AddAPTest","click .btn-finish-test-topic_h":"FinishTest","click .btn-finish-gpa_h":"FinishGpa","blur .txtGpa_h":"SaveGpa","click .btn-delete-gpa":"DeleteGpa","click .btn-Add-gpa":"AddGpa","click .btn-Save-Gpa":"SaveNewGpa","blur .txtTestScore_h":"SaveTestScore","click .btn-delete-test_h":"DeleteTestScore"},controls:{BtnFinishTestTopics:".btn-finish-test-topic_h",BtnEditTest:".edit-test",BtnFinishGpa:".btn-finish-gpa_h",BtnEditGpa:".edit-gpa",BtnSaveGpa:".btn-Save-Gpa",ContainerGpa:"#container-academic-gpa",ContainerStandard:"#container-StandardizedTest",ContainerAP:"#container-ApTest",SectionModalTests:".section-modal-academic-tests_h",SectionTestTopics:".section-test-topics_h",ItemTestTopic:".item-test-topic_h",SectionAddGpa:".section-Add-Gpa",TxtScore:".txtTestScore_h",ModalBox:".tests-modal_h",TxtGpa:".txtGpa_h",TxtGpaYear:".txtGpaYear_h",TxtGpaScore:".txtGpaScore_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistGPA:"No GPAs entered yet.",dataNotExistTests:"No Tests entered yet.",YearScoreIsRequired:"Year And Score Are Required.",MandatoryFieldsTest:"Please enter a score."},initialize:function(e){f.prototype.initialize.call(this,e),o=this,o.setOptions(e),this.init()},render:function(){f.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){o.setupView()},setupView:function(){o.setUpMainView(),o.setUpGpaView(),o.setUpStandardTestView(),o.setUpAPTestView()},setUpMainView:function(){d(o.el).html(o.template)},setUpGpaView:function(){var e={user_id:o.user_id},t=new v(e);t.user_id=o.user_id,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.gpa=t.parseAsRequired();var e=p.to_html(n,{data:o.gpa}),r=d(o.el).find(o.controls.ContainerGpa);r.html(e),parseInt(t.models.length)>0?r.find("a#edit-gpa-btn").css("visibility","visible"):r.find("a#edit-gpa-btn").css("visibility","hidden")})},EditGpa:function(e){d(e.target).parent().find(o.controls.TxtGpa).removeAttr("disabled"),d(e.target).parent().find(o.controls.BtnFinishGpa).fadeIn(),d(e.target).fadeOut()},SaveGpa:function(e){var t=d(e.target).attr("year"),n=d(e.target).val(),r={user_id:o.user_id,gpa:n,year:t},i=new y(r);i.user_id=o.user_id,i.target=d(e.target),i.save()},DeleteGpa:function(e){var t=d(e.target).attr("year"),n={user_id:o.user_id,year:t,id1:1},r=new y(n);r.user_id=o.user_id,r.id1=1,r.action="delete",r.target=d(e.target),r.idAttribute="year",r.destroy({data:{user_id:o.user_id,year:t},success:function(){o.setUpGpaView()}}),d.when(r.request).done(function(){d(e.target).parent().find(o.controls.TxtGpa).val("")})},FinishGpa:function(e){d(e.target).parent().find(o.controls.TxtGpa).attr("disabled","disabled"),d(e.target).parent().find(o.controls.BtnEditGpa).fadeIn(),d(e.target).fadeOut()},AddGpa:function(e){o.$(o.controls.SectionAddGpa).fadeIn().css("display","inline-block")},SaveNewGpa:function(e){var t=o.$(o.controls.SectionAddGpa).find(o.controls.TxtGpaYear).val(),n=o.$(o.controls.SectionAddGpa).find(o.controls.TxtGpaScore).val();if(t==""||n=="")o.$(o.controls.SectionAddGpa).find(o.controls.lblError).html(o.messages.YearScoreIsRequired).fadeIn();else{o.$(o.controls.SectionAddGpa).find(o.controls.lblError).html("").fadeOut();var r={user_id:o.user_id,gpa:n,year:t},i=new y(r);i.user_id=o.user_id,i.target=d(e.target).parent(),i.save(),d.when(i.request).done(function(){o.setUpGpaView()})}},setUpStandardTestView:function(){var e={user_id:o.user_id},t=new m(e);t.user_id=o.user_id,t.includeStandard=1,t.includeAp=0,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.standardTests=t.parseAsRequired();var e="";d.each(o.standardTests,function(t,n){e+=n.id+","});var n=p.to_html(r,{Test_Type:"Standardized",TestIds:e});d(o.el).find(o.controls.ContainerStandard).html(n);var s=p.to_html(i,{Test_Type:"Standardized",data:o.standardTests});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionTestTopics).html(s),o.setUpStandardTestListAllView()})},setUpStandardTestListAllView:function(){var e={user_id:o.user_id},t=new g(e);t.user_id=o.user_id,t.includeStandard=1,t.includeAp=0,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.standardTestsListAll=t.parseAsRequired();if(o.standardTestsListAll.length>0){var e=p.to_html(s,{Test_Type:"Standardized",data:o.standardTestsListAll});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionModalTests).html(e)}else o.$el(o.controls.ContainerStandard).find(o.controls.SectionModalTests).html(o.messages.dataNotExistTests)})},AddStandardTest:function(e){var t=d(e.target).attr("testid");if(d(e.target).is(":checked")){var n=[];d.each(o.standardTestsListAll,function(e,r){r.id==t&&n.push(r)});var r=p.to_html(i,{Test_Type:"Standardized",data:n});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionTestTopics).append(r)}else d(o.el).find(o.controls.ContainerStandard).find(".item-test-"+t).remove()},setUpAPTestView:function(){var e={user_id:o.user_id},t=new m(e);t.user_id=o.user_id,t.includeStandard=0,t.includeAp=1,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.apTests=t.parseAsRequired();var e="";d.each(o.apTests,function(t,n){e+=n.id+","});var n=p.to_html(r,{Test_Type:"AP",TestIds:e});d(o.el).find(o.controls.ContainerAP).html(n);var s=p.to_html(i,{Test_Type:"AP",data:o.apTests});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionTestTopics).html(s),o.setUpAPTestListAllView()})},setUpAPTestListAllView:function(){var e={user_id:o.user_id},t=new g(e);t.user_id=o.user_id,t.includeStandard=0,t.includeAp=1,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.apTestsListAll=t.parseAsRequired();if(o.apTestsListAll.length>0){var e=p.to_html(s,{Test_Type:"AP",data:o.apTestsListAll});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionModalTests).html(e)}else d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionModalTests).html(o.messages.dataNotExistTests)})},AddAPTest:function(e){var t=d(e.target).attr("testid");if(d(e.target).is(":checked")){var n=[];d.each(o.apTestsListAll,function(e,r){r.id==t&&n.push(r)});var r=p.to_html(i,{Test_Type:"Standardized",data:n});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionTestTopics).append(r)}else d(o.el).find(o.controls.ContainerAP).find(".item-test-"+t).remove()},EditTest:function(e){d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.TxtScore).removeAttr("disabled"),d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.BtnFinishTestTopics).fadeIn(),d(e.target).fadeOut()},FinishTest:function(e){d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.TxtScore).attr("disabled","disabled"),d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.BtnEditTest).fadeIn(),d(e.target).fadeOut()},OpenTestPopUp:function(e){var t=d(e.target).attr("testids"),n=t.split(",");d.each(n,function(t,n){o.$(e.target).parent().find(o.controls.ModalBox).find(".chk-"+n).attr("checked","checked")}),o.$(e.target).parent().find(o.controls.ModalBox).modal("show")},SaveTestScore:function(e){var t=d(e.target).attr("topicId"),n=d(e.target).val(),r=d(e.target).attr("initial"),i="save";if(d.trim(n)==""){d(e.target).parent().find(o.controls.lblError).html(o.messages.MandatoryFieldsTest).fadeIn();return}d(e.target).parent().find(o.controls.lblError).html("").fadeOut();var s={id1:o.user_id,academics_topics_id:t,score:n,users_id:o.user_id};r!=""&&(i="update",s.academics_tests_topics_id=t);var u=d(e.target).attr("testscoreid"),a=new b(s);a.users_id=o.user_id,a.action=i,a.target=d(e.target),a.save({success:function(){}}),d.when(a.request).done(function(){d(e.target).attr("initial",n)})},DeleteTestScore:function(e){var t=d(e.target).attr("topicid"),n={users_id:o.user_id,id1:1,academics_tests_topics_id:t},r=new b(n);r.users_id=o.user_id,r.id1=o.user_id,r.academics_tests_topics_id=t,r.action="delete",r.target=d(e.target),r.destroy({data:{users_id:o.user_id,academics_tests_topics_id:t},success:function(){d(e.target).val("").attr("initial","")}}),d.when(r.request).done(function(){d(e.target).parent().find(o.controls.TxtScore).val("")})}});return w}),define("text!userresume/templates/listAwards.html",[],function(){return'{{#data}}\r\n	<div class="section-rdtree-items_h inset-data-entry">\r\n		<div class="row-fluid awards-sports-header"><span class="standard-subsection-header">{{#icon}}<img src="{{icon}}" />{{/icon}}{{sports_name}}</span></div>\r\n		{{#awards}}\r\n		<div class="section-new-award" style="background-color: #eeeeee; border-bottom: 1px solid #ccc;">\r\n			<div class="row-fluid section-new-controls">\r\n				<span class=""><span class="award-labels">Award Name:</span> <input type="text" class="txtAwards_h txt_name_h" value="{{name}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Year Awarded:</span> <input type="text" class="year txtAwards_h txt_year_h" value="{{year}}" disabled="disabled"/></span>\r\n				<span>\r\n					<a href="javascript:void(0)" class="edit edit_award_h"></a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Update_award_h displayNone" sportid="{{sports_id}}" awardid="{{id}}">Save</a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Cancel-Existing_award_h displayNone">Cancel</a>\r\n					<a href="javascript:void(0)" class="remove btn-remove_award_h" awardid="{{id}}"></a>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n\r\n				</span>\r\n\r\n				<span><textarea style="width:90%;" type="text" class="txtAwards_h txt_description_h" disabled="disabled">{{description}}</textarea></span>\r\n\r\n			</div>\r\n		</div>	\r\n		{{/awards}}\r\n	</div>\r\n	{{/data}}'}),define("user/collections/awards",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("userresume/collections/awards",["facade","collections","user/collections/awards","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/awards/"+this.user_id:(this.user_id==undefined,"api/user/awards/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={sports_id:r.id,sports_name:r.name,icon:r.icon,awards:[]};$.each(r.awards,function(e,t){i.awards.push({id:t.id,name:t.name,description:t.description,year:t.year})}),n.push(i)}}),n}});return i}),define("userresume/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({sport_type:1,male:1,female:0,url:function(){return testpath?testpath+"/api/sport/listall":(this.gender==undefined,"/api/sport/listall/?sport_type="+this.sport_type+"&male="+this.male+"&female="+this.female+"&sport_type_id="+this.sport_type_id)}}),i}),define("userresume/views/awards",["require","text!userresume/templates/awards.html","text!userresume/templates/listAwards.html","facade","views","utils","vendor","userresume/collections/awards","userresume/collections/sports","userresume/models/award"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("userresume/collections/awards"),p=e("userresume/collections/sports"),d=e("userresume/models/award"),v=o.extend({template:t,events:{"click .btn-Add-award_h":"AddNewAward","click .btn-Save_award_h":"SaveNewAward","click .btn-Update_award_h":"UpdateAward","click .btn-Cancel-New":"CancelNew","click .btn-Cancel-Existing_award_h":"CancelExisting","click .btn-remove_award_h":"RemoveAward","click .edit_award_h":"EditAward"},controls:{listContainer:"#section-list-awards",newAwardContainer:".section-new-award",newAwardControls:".section-new-controls",btnAddAwardsExisting:".btn-Add-Existing",btnAddNew:".btn-Add",btnCancelExisting:".btn-Cancel-Existing_award_h",btnRemoveExisting:".btn-remove_award_h",btnUpdateAwardExisting:".btn-Update_award_h",btnEditAward:".edit_award_h",ddlSports:".ddl-sports-awards_h",newControls:".txtAwards_h",txtName:".txt_name_h",txtDescription:".txt_description_h",txtYear:".txt_year_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistAwards:"No Awards Entered Yet.",MandatoryFields:"All fields are mandatory."},initialize:function(e){o.prototype.initialize.call(this,e),r=this,r.setOptions(e),this.init()},render:function(){o.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){r.setupView()},setupView:function(){r.setUpMainView(),r.setUpListView()},setUpMainView:function(){var e=l.to_html(r.template,{});c(r.el).html(e)},setUpListView:function(){var e={user_id:r.user_id},t=new h(e);t.user_id=r.user_id,t.fetch(),c.when(t.request).done(function(){if(t.isError())return;r.awards=t.parseAsRequired();if(r.awards.length>0){var e=l.to_html(n,{data:r.awards});c(r.el).find(r.controls.listContainer).html(e)}else c(r.el).find(r.controls.listContainer).html(r.messages.dataNotExistAwards)})},ClearControls:function(e){console.log(c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls)),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newControls).val(""),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls).fadeOut()},AddNewAward:function(e){r.ClearControls(e);var t=c(e.target).parents(r.controls.newAwardContainer).find(r.controls.ddlSports);c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls).fadeIn();if(r.sports&&r.sports.length>0){r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport");return}var n=new p;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,r.gender=="male"?n.male=1:r.gender=="famale"&&(n.female=0),n.fetch(),c.when(n.request).done(function(){if(n.isError())return;var e=n.toJSON();(e==null||e.length<1)&&r.$(r.controls.ddlSports).parent().find(r.controls.fieldMessage).html(r.messages.dataNotExist).stop().fadeIn(),r.sports=[];for(var i in e)r.sports.push(e[i].payload);r.sort(r.sports,"sport_name",!1),r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport")})},AddExistingAward:function(){console.log("Add Existing")},SaveAward:function(e,t){var n=c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls),i=c(e.target).attr("sportid")||n.find(r.controls.ddlSports).val(),s=n.find(r.controls.txtName).val(),o=n.find(r.controls.txtYear).val(),u=n.find(r.controls.txtDescription).val();if(i==""||i<1||c.trim(s)==""||c.trim(u)==""||c.trim(o)==""){n.find(r.controls.lblError).html(r.messages.MandatoryFields).fadeIn();return}n.find(r.controls.lblError).html("").fadeOut();var a={description:u,name:s,sports_id:i,year:o,users_id:r.user_id},f=0;t=="update"&&(f=c(e.target).attr("awardid"),a.id1=c(e.target).attr("awardid"));var l=new d(a);l.users_id=r.user_id,l.award_id=f,l.action=t,l.target=c(e.target),l.save(),c.when(l.request).done(function(){r.ClearControls(e),r.setUpListView()})},SaveNewAward:function(e){r.SaveAward(e,"save")},EditAward:function(e){c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newControls).removeAttr("disabled"),c(e.target).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnUpdateAwardExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnCancelExisting).fadeIn()},UpdateAward:function(e){r.SaveAward(e,"update")},CancelNew:function(e){r.ClearControls(e)},CancelExisting:function(e){c(e.target).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnUpdateAwardExisting).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnEditAward).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find("textarea, input").attr("disabled","disabled")},RemoveAward:function(e){var t=c(e.target).attr("awardid"),n={id1:t,award_id:t,users_id:r.user_id},i=new d(n);i.id1=t,i.users_id=r.user_id,i.award_id=t,i.action="delete",i.target=c(e.target),i.destroy({success:function(){r.setUpListView()}})}});return v}),define("user/collections/contacts",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}});return i}),define("userresume/collections/contacts",["facade","collections","user/collections/contacts","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/contact/"+this.user_id:(this.user_id==undefined,"api/user/contact/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload;n.push({gpa:r.gpa,year:r.year})}}),n}});return i}),define("userresume/views/contacts",["require","text!userresume/templates/contact.html","facade","views","utils","vendor","userresume/collections/contacts"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/contacts"),h=s.extend({template:t,events:{},controls:{},messages:{dataNotExistContacts:"No Contacts."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},setupView:function(){n.setUpMainView(),n.setUpListView()},setUpMainView:function(){},setUpListView:function(){var e={user_id:n.user_id},r=new c(e);r.user_id=n.user_id,r.fetch(),l.when(r.request).done(function(){if(r.isError())return;n.contacts=r.parseAsRequired();if(n.contacts.length>0){var e=f.to_html(t,{data:n.contacts});l(n.el).find(n.el).html(e)}else n.$el(n.controls.ContainerGpa).html(n.messages.dataNotExistContacts)})}});return h}),define("text!userresume/templates/listReferences.html",[],function(){return'\r\n{{#data}}\r\n<div class="section-rdtree-items_h inset-data-entry">\r\n	<div class="row-fluid awards-sports-header"><span class="standard-subsection-header">{{#icon}}<img src="{{icon}}" />{{/icon}}{{sports_name}}</span></div>\r\n\r\n		{{#references}}\r\n		<div class="section-new-reference"  style="background-color: #eeeeee; border-bottom: 1px solid #ccc; padding-bottom: 10px;">\r\n			<div class="row-fluid section-new-controls">\r\n\r\n				<span class=""><span class="award-labels">Reference Name:</span> <input type="text" class="txtReferences_h txt_name_h" value="{{name}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Relationship:</span> <input type="text" class="txtReferences_h txt_relation_h" value="{{relation}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Phone:</span> <input type="text" class="txtReferences_h txt_phone_h" value="{{phone}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Email:</span> <input type="text" class="txtReferences_h txt_email_h" value="{{email}}" disabled="disabled"/></span>\r\n				<span><textarea style="width:90%;" type="text" class="txtReferences_h txt_description_h" disabled="disabled">{{description}}</textarea></span>\r\n				<br />\r\n				<span class="">\r\n					<a href="javascript:void(0)" class="edit edit_reference_h"></a><a href="javascript:void(0)" class="remove btn-remove_reference_h" referenceid="{{id}}"></a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Update_reference_h displayNone" sportid="{{sports_id}}" referenceid="{{id}}">Save</a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Cancel-Existing_reference_h displayNone">Cancel</a>\r\n\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					\r\n				</span>\r\n				</div>\r\n		</div>	\r\n		{{/references}}\r\n	</div>\r\n	{{/data}}'}),define("user/collections/references",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("userresume/collections/references",["facade","collections","user/collections/references","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/references/"+this.user_id:"api/user/references/"+this.user_id+"?id1="+this.user_id},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return console.log("models References",t),t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={sports_id:r.id,sports_name:r.name,icon:r.icon,references:[]};$.each(r.references,function(e,t){i.references.push({id:t.id,name:t.name,description:t.long_description,relation:t.relation,email:t.email,phone:t.phone})}),n.push(i)}}),console.log("del",n),n}});return i}),define("userresume/views/references",["require","text!userresume/templates/references.html","text!userresume/templates/listReferences.html","facade","views","utils","vendor","userresume/collections/references","userresume/collections/sports","userresume/models/reference"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("userresume/collections/references"),p=e("userresume/collections/sports"),d=e("userresume/models/reference"),v=o.extend({template:t,events:{"click .btn-Add-reference_h":"AddNewReference","click .btn-Save_reference_h":"SaveNewReference","click .btn-Update_reference_h":"UpdateReference","click .btn-Cancel-New":"CancelNew","click .btn-Cancel-Existing_reference_h":"CancelExisting","click .btn-remove_reference_h":"RemoveReference","click .edit_reference_h":"EditReference"},controls:{listContainer:"#section-list-references",newReferenceContainer:".section-new-reference",newReferenceControls:".section-new-controls",btnAddReferencesExisting:".btn-Add-Existing",btnAddNew:".btn-Add",btnCancelExisting:".btn-Cancel-Existing_reference_h",btnRemoveExisting:".btn-remove_reference_h",btnUpdateReferenceExisting:".btn-Update_reference_h",btnEditReference:".edit_reference_h",ddlSports:".ddl-sports-references_h",newControls:".txtReferences_h",txtName:".txt_name_h",txtDescription:".txt_description_h",txtYear:".txt_year_h",txtEmail:".txt_email_h",txtPhone:".txt_phone_h",txtRelation:".txt_relation_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistReferences:"No References entered yet.",MandatoryFields:"All Fields are Mandatory."},initialize:function(e){o.prototype.initialize.call(this,e),r=this,r.setOptions(e),this.init()},render:function(){o.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){r.setupView()},setupView:function(){r.setUpMainView(),r.setUpListView()},setUpMainView:function(){var e=l.to_html(r.template,{});c(r.el).html(e)},setUpListView:function(){var e={user_id:r.user_id},t=new h(e);t.user_id=r.user_id,t.fetch(),c.when(t.request).done(function(){if(t.isError())return;r.references=t.parseAsRequired();if(r.references.length>0){var e=l.to_html(n,{data:r.references});c(r.el).find(r.controls.listContainer).html(e)}else c(r.el).find(r.controls.listContainer).html(r.messages.dataNotExistReferences)})},ClearControls:function(e){c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newControls).val(""),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls).fadeOut()},AddNewReference:function(e){r.ClearControls(e);var t=c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.ddlSports);c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls).fadeIn();if(r.sports&&r.sports.length>0){r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport");return}var n=new p;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,r.gender=="male"?n.male=1:r.gender=="famale"&&(n.female=0),n.fetch(),c.when(n.request).done(function(){if(n.isError())return;var e=n.toJSON();(e==null||e.length<1)&&r.$(r.controls.ddlSports).parent().find(r.controls.fieldMessage).html(r.messages.dataNotExist).stop().fadeIn(),r.sports=[];for(var i in e)r.sports.push(e[i].payload);r.sort(r.sports,"sport_name",!1),r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport")})},AddExistingReference:function(){console.log("Add Existing")},SaveReference:function(e,t){var n=c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls),i=c(e.target).attr("sportid")||n.find(r.controls.ddlSports).val(),s=n.find(r.controls.txtName).val(),o=n.find(r.controls.txtDescription).val(),u=n.find(r.controls.txtRelation).val(),a=n.find(r.controls.txtEmail).val(),f=n.find(r.controls.txtPhone).val();if(i==""||i<1||c.trim(s)==""||c.trim(f)==""){n.find(r.controls.lblError).html(r.messages.MandatoryFields).fadeIn();return}n.find(r.controls.lblError).html("").fadeOut();var l={users_id:r.user_id,sports_id:i,name:s,relation:u,email:a,phone:f,long_description:o},h=0;t=="update"&&(h=c(e.target).attr("referenceid"),l.id1=c(e.target).attr("referenceid"));var p=new d(l);p.users_id=r.user_id,p.reference_id=h,p.action=t,p.target=c(e.target),p.save(),c.when(p.request).done(function(){r.ClearControls(e),r.setUpListView()})},SaveNewReference:function(e){r.SaveReference(e,"save")},EditReference:function(e){c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newControls).removeAttr("disabled"),c(e.target).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnUpdateReferenceExisting).fadeIn(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnCancelExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeOut()},UpdateReference:function(e){r.SaveReference(e,"update")},CancelNew:function(e){r.ClearControls(e)},CancelExisting:function(e){c(e.target).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnUpdateReferenceExisting).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnEditReference).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeIn()},RemoveReference:function(e){var t=c(e.target).attr("referenceid"),n={id1:t,reference_id:t,users_id:r.user_id},i=new d(n);i.id1=t,i.users_id=r.user_id,i.reference_id=t,i.action="delete",i.target=c(e.target),i.destroy({success:function(){r.setUpListView()}})}});return v}),define("userresume",["require","text!userresume/templates/layout.html","text!userresume/templates/sentresume.html","text!userresume/templates/basic_info_header.html","text!userresume/templates/rdtree.html","text!userresume/templates/academic.html","text!userresume/templates/awards.html","text!userresume/templates/contact.html","text!userresume/templates/references.html","facade","controller","models","views","utils","profilesetting/models/basic_info","userresume/models/resume","userresume/models/rdtree","userresume/models/gpa","userresume/models/award","userresume/models/contact","userresume/models/reference","profilesetting/views/basic_info","userresume/views/sentresumeview","userresume/views/rdtree","userresume/views/academic","userresume/views/awards","userresume/views/contacts","userresume/views/references"],function(e,t,n,r,i,s,o,u,a){var f,l=e("facade"),c=e("controller"),h=e("models"),p=e("views"),d=e("utils"),v=l.$,m=l._,g=d.debug,y=d.lib.Channel,b=p.LayoutView,w=e("profilesetting/models/basic_info"),E=e("userresume/models/resume"),S=e("userresume/models/rdtree"),x=e("userresume/models/gpa"),T=e("userresume/models/award"),N=e("userresume/models/contact"),C=e("userresume/models/reference"),k=e("profilesetting/views/basic_info"),L=e("userresume/views/sentresumeview"),A=e("userresume/views/rdtree"),O=e("userresume/views/academic"),M=e("userresume/views/awards"),_=e("userresume/views/contacts"),D=e("userresume/views/references"),f=c.extend({cssArr:["/pages/profilesetting/profilesettings.css"],events:{},initialize:function(e){return y("load:css").publish(this.cssArr),m.bindAll(this),e.id&&(this.id=e.id,this.init()),this},init:function(){this.setupLayout().render(),this.setupView(),this.handleDeferreds()},setupLayout:function(){var e;if(this.layout)return this.layout;var e=new b({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"});return this.layout=e,this.layout},setupView:function(){var e=this;this.basicInfoModel=new w,this.basicInfoModel.id=e.id,this.basicInfoModel.fetch(),v.when(this.basicInfoModel.request).done(function(){var t=e.basicInfoModel.toJSON();e.gender=t.payload.gender,e.setUpBasicView(),e.setUpSentResumeView(),e.setUpRdTreeView(),e.setUpAcademicView(),e.setUpAwardsView(),e.setUpContactsView(),e.setUpReferenceView()})},setUpBasicView:function(){var e=this;this.basicView=new k({model:new w,template:r,name:"basic-info",destination:"#section-basics-prof-setting",user_id:e.id,id:e.id})},setUpSentResumeView:function(){var e=this;this.sentResumeView=new L({model:new E,template:n,name:"sent-resume",destination:"#section-sent-resume",user_id:e.id,id:e.id}),this.scheme.push(this.sentResumeView),this.layout.render()},setUpRdTreeView:function(){var e=this;this.rdTreeView=new A({model:new S,template:i,name:"rd-tree",destination:"#section-RD-Tree",user_id:e.id}),this.scheme.push(this.rdTreeView),this.layout.render()},setUpAcademicView:function(){var e=this;this.academicView=new O({model:new x,template:s,name:"resume-academic",destination:"#section-academic",user_id:e.id}),this.scheme.push(this.academicView),this.layout.render()},setUpAwardsView:function(){var e=this;this.awardsView=new M({model:new T,template:o,name:"resume-awards",destination:"#section-awards",user_id:e.id}),this.scheme.push(this.awardsView),this.layout.render()},setUpContactsView:function(){var e=this;this.contactsView=new _({model:new N,template:u,name:"resume-contacts",destination:"#section-contacts",user_id:e.id}),this.scheme.push(this.contactsView),this.layout.render()},setUpReferenceView:function(){var e=this;this.referenceView=new D({model:new C,template:a,name:"resume-references",destination:"#section-references",user_id:e.id}),this.scheme.push(this.referenceView),this.layout.render()}});return f}),define("site/models/phrase",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("packages/site/collections/phrases",["facade","collections","site/models/phrase","utils","controller"],function(e,t,n,r,i){var s,o=t.BaseCollection,u=t.ApplicationStates;return _=e._,Channel=r.lib.Channel,s=o.extend({model:n,url:function(){return base_url+"api/phrase/listall"},saveToLocalStorage:function(e){var t=i.prototype.appStates;t&&(t.add({name:"phrases",data:this.toJSON(),storage:"localStorage",expires:new Date(Date.now()+3154e5)}),t.save("phrases"))},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.saveToLocalStorage(e)}}),s}),define("usercontrols/tag/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return"/api/sport/listall/"}}),i}),define("usercontrols/tag/tag",["require","text!usercontrols/tag/templates/layout.html","facade","controller","models","views","usercontrols/tag/models/basic_info","usercontrols/tag/collections/sports","usercontrols/tag/views/main"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("usercontrols/tag/models/basic_info"),d=e("usercontrols/tag/views/main"),n=i.extend({cssArr:["/usercontrols/tag/tag.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.gender&&(this.gender=e.gender),this.init(),this},init:function(){this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){console.log("Set Up Layout Tag");if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setUpMainView:function(){console.log("Set Up Main View Tag"),c("tag-team-success").subscribe(this.tagFunction);var e=this;this.tagView=new d({model:new p,template:t,name:"tag-main",destination:"#main",user_id:e.id,channel:"tag-team-success"}),this.scheme.push(this.tagView),this.layout.render()},tagFunction:function(e){alert(JSON.stringify(e))}});return n}),define("text!usercontrols/addgame/templates/layout.html",[],function(){return'\r\n	<div class="well-large container_add_game">\r\n	<!-- <h4>Add Game</h4> -->\r\n	<!-- <div class="green-left-heading ">DATE</div> -->\r\n<div class="clear"></div>\r\n	<div class="section-Add-Sports_h">\r\n		<div class="section-game-date_h floatLeft">\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" placeholder="Time" maxlength="5" />\r\n			\r\n			<span class="spn-ddl-time-period_h"></span>\r\n			<!-- <select class="ddl-time-period_h ddlTime">\r\n			<option value="AM">AM</option>\r\n			<option value="PM">PM</option>\r\n			</select> -->\r\n		\r\n			<div class="clear"></div>\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n		<div class="clear"></div>\r\n		<!-- <div class="row-fluid">\r\n			Select Sport:\r\n		</div> -->\r\n	<!-- <div class="green-left-heading">SPORT</div> -->\r\n	<div class="clear"></div>\r\n		<div class="row-fluid section-game-sports_h">\r\n<span class="span-ddl-sports_h">\r\n			<!-- <select class="ddl-game-sports_h"></select> -->\r\n				</span>\r\n			<div class="clear"></div>	\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n<div class="clear"></div>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-game-teams_h team-one_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 1</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 1 :\r\n			<div class="clear"></div>\r\n			<span class="span_ddl_team_h span_ddl_team_one_h"></span>\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a>\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt txt-game-team_h displayNone" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n			<!-- <a href="javascript:void(0)" class="btn-ddl-team-game_h">Choose from select ?</a> -->\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score : \r\n			<input type="text" class="txt-score-team_h" />\r\n		</div>\r\n		<div class="section-game-radio_h">			\r\n			Home &nbsp;<input type="radio" name="rdo-team1_h" value="home" class="rdo-game-location_h rdo-game-location-one-home_h" team="one"> &nbsp;&nbsp;\r\n			Away &nbsp;<input type="radio" name="rdo-team1_h" value="away" class="rdo-game-location_h" team="one">\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n	<div class="section-individual-game_h displayNone">\r\n		<input type="text"class="txt-individual-game_h" placeholder="Enter Game" />\r\n		<span class="indicator_h"></span>\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-individual-location_h displayNone" placeholder="Enter Location Id"  />\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n			<div class="clear"></div>\r\n\r\n	</div>\r\n\r\n	<div class="section-game-teams_h team-two_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 2</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 2 :\r\n			<div class="clear"></div>\r\n			<!-- <span class="span_ddl_team_h span_ddl_team_two_h"></span> -->\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<!-- <a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a> -->\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt-game-team_h" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score :\r\n			<input type="text" class="txt-score-team_h"/>\r\n		</div>\r\n		<div class="section-game-radio_h">\r\n			Home &nbsp;<input type="radio" name="rdo-team2_h" value="home" class="rdo-game-location_h rdo-game-location-two-home_h"  team="two"> &nbsp;&nbsp;\r\n			Away  &nbsp;<input type="radio" name="rdo-team2_h" value="away" class="rdo-game-location_h"   team="two">			\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n	<div class="section-main-location_h displayNone">\r\n		<!-- <div class="green-left-heading">LOCATION</div> -->\r\n		<!--div class="clear"></div>\r\n		<strong>Location : </strong>		\r\n<div class="clear"></div>\r\n		<input type="text" class="txt-game-location-id_h displayNone"-->\r\n		<div class="location-view-h">&nbsp;</div>\r\n		<input type="hidden" class="txt-game-location-id_h displayNone"/>\r\n		<div class="div-game-location_h"></div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div>\r\n\r\n	</div>\r\n	<div class="clear"></div>\r\n\r\n<!--END MODAL BODY--></div>\r\n<div class="modal-footer">\r\n	<button class="btn btn-primary btn-game-Finish_h floatRight displayNone">Create Game</button>\r\n	<button class="btn btn-primary btn-game-individual-Finish_h floatRight displayNone">Add Me To That Event</button>\r\n	<button class="btn btn-primary btn-game-individual-Create_h floatRight displayNone">Create Event</button>\r\n</div>'}),define("user/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("usercontrols/addgame/collections/teams",["facade","collections","sportorg/collections/teams","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.team_name&&(e+="searchtext="+encodeURI(this.team_name)),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.sports_id&&(e+="&sports_id="+this.sports_id),"/api/team/search?"+e}}),i}),define("usercontrols/addgame/collections/teams_user",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return"/api/user/teams/"+this.user_id+"?sport_id="+this.sports_id},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:null,fulladdress:""};r&&r.org_sport_link_obj&&r.org_sport_link_obj.org&&r.org_sport_link_obj.org.locations&&(i=r.org_sport_link_obj.org.locations);var s={team_id:r.id,team_name:r.team_name,location_id:i.id,location_name:i.full_address};n.push(s)}}),n},AppendItem:function(e){var t=this,n=t.toJSON(),r={payload:e};return n.push(r),n}}),i}),define("usercontrols/addgame/collections/games_search",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.game_name&&(e+="searchtext="+this.game_name),this.sports_id&&(e+="&sports_id="+this.sports_id),"/api/game/search?"+e}}),i}),define("usercontrols/addgame/models/team",["facade","sportorg/models/team"],function(e,t){var n,r=e._;return n=t.extend({parseAsRequired:function(e){var t=this,n={};if(e!=null&&e.payload!=null){var r=e.payload,i={id:null,fulladdress:""},s={id:null,sport_name:""};r&&r.org_sport_link_obj&&(r.org_sport_link_obj.org&&r.org_sport_link_obj.org.locations&&(i=r.org_sport_link_obj.org.locations),r.org_sport_link_obj.sport&&(s=r.org_sport_link_obj.sport)),n={team_id:r.id,team_name:r.team_name,location_id:i.id,location_name:i.full_address,sports_name:s.sport_name,sports_id:s.id}}return n}}),n}),define("usercontrols/addgame/models/team_add",["facade","sportorg/models/team"],function(e,t){var n,r=e._;return n=t.extend({url:function(){var e="";return this.games_id&&(e+="?games_id="+this.games_id),"/api/team/game/"+this.teams_id+e}}),n}),define("usercontrols/addgame/models/game",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"game_id",url:function(){return"/api/game/add/"+this.game_id}}),n}),define("usercontrols/addgame/models/uslgamelink",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"game_id",url:function(){return"/api/uslgamelink/add/"}}),n}),define("text!usercontrols/location/templates/get-view-location.html",[],function(){return'<textarea placeholder="Address" class="location-h address-h" rows="3" cols="25"></textarea>\r\n<span class="address-error hide address-error-status-h"></span>\r\n<a href="javascript: void(0);" class="verify-address-h">Verify Address</a>\r\n <div id="map-canvas-h" style="width: 90%; height: 300px; margin-top: 40px; display: none;"></div>\r\n'}),define("usercontrol/location/views/get-view-location",["require","text!usercontrols/location/templates/get-view-location.html","facade","views","utils","vendor","usercontrols/location/models/verify-adress"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=e("usercontrols/location/models/verify-adress"),l=a.Mustache,c=r.$,h=i.BaseView,p=r.Backbone,d;return p.View.extend({template:t,events:{"click .verify-address-h":"verifyAddress","blur .address-h":"verifyAddress"},initialize:function(e){d=this,d.location={},e.callback&&(this.callback=e.callback),d.location.latitude=!_.isUndefined(e)&&!_.isUndefined(e.latitude)?e.latitude:undefined,d.location.longitude=!_.isUndefined(e)&&!_.isUndefined(e.longitude)?e.longitude:undefined,d.setOptions(e),d.render()},intializeMap:function(){},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new f,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),e.callback(""),c.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id;if(e.locationId){e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.latitude=e.adressModel.get("payload").lat,e.location.latitude=e.adressModel.get("payload").lon,e.$el.find(".set-address-h").removeClass("link-disabled"),e.callback(e.locationId);if(e.map){var t=new google.maps.LatLng(e.adressModel.get("payload").lat,e.adressModel.get("payload").lon);e.marker.setPosition(t),e.map.panTo(t)}else e.createMap()}})},createMap:function(){var e=this,t=new google.maps.LatLng(e.location.latitude,e.location.latitude),n={zoom:13,center:t,scaleControl:!0,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};this.$el.find("#map-canvas-h").show(),this.map=new google.maps.Map(document.getElementById("map-canvas-h"),n),this.marker=new google.maps.Marker({position:t,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=l.to_html(e.template,{location:e.locaion});return c(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("usercontrols/addgame/views/main",["require","text!usercontrols/addgame/templates/layout.html","facade","views","utils","vendor","sportorg/collections/sports_listall","location/collections/states","usercontrols/addgame/collections/teams","location/collections/cities","usercontrols/addgame/collections/teams_user","usercontrols/addgame/collections/teams","usercontrols/addgame/collections/games_search","usercontrols/addgame/models/team","usercontrols/addgame/models/team_add","usercontrols/addgame/models/game","usercontrols/addgame/models/uslgamelink","usercontrol/dropdown/view/dropdown","usercontrol/location/views/get-view-location"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/addgame/collections/teams_user"),m=e("usercontrols/addgame/collections/teams"),g=e("usercontrols/addgame/models/team"),y=e("usercontrols/addgame/models/team_add"),b=e("usercontrols/addgame/models/game"),w=e("usercontrols/addgame/collections/games_search"),E=e("usercontrol/dropdown/view/dropdown"),S=e("usercontrol/location/views/get-view-location"),x=e("usercontrols/addgame/models/uslgamelink"),T=s.extend({template:t,gameData:{},teams:[],events:{"change .ddl-game-sports_h":"changeSport","keyup .txt-game-state_h":"keyupState","blur .txt-game-state_h":"changeState","keyup .txt-game-city_h":"keyupCity","blur .txt-game-city_h":"changeCity","keyup .txt-game-team_h":"keyupTeam","blur .txt-game-team_h":"changeTeam","keyup .txt-individual-game_h":"keyupIndividualGame","blur .txt-individual-game_h":"changeindividualGame","change .ddl-game-userteams_h":"changeUserTeam","click .btn-new-team-game_h":"showAddTeam","click .btn-ddl-team-game_h":"showDdlTeam","click .rdo-game-location_h":"showLocation","click .btn-game-Finish_h":"finishGame","change .txt-game-date_h":"CheckTeamControlsVisibility","click .btn-game-individual-Create_h":"createIndividualEvent","click .btn-game-individual-Finish_h":"goThereIndividualGame"},controls:{sectionAddSports:".section-Add-Sports_h",sectionDate:".section-game-date_h",txtGameDate:".txt-game-date_h",txtGameTime:".txt-game-time_h",spnTimePeriod:".spn-ddl-time-period_h",ddlTimePeriod:".ddl-time-period_h",spnSports:".span-ddl-sports_h",ddlSports:".ddl-game-sports_h",sectionTeams:".section-game-teams_h",ddlUserTeams:".ddl-game-userteams_h",spanddlteam:".span_ddl_team_h",spanddlteamtwo:".span_ddl_team_two_h",spanddlteamone:".span_ddl_team_one_h",btnNewTeam:".btn-new-team-game_h",btnDdlTem:".btn-ddl-team-game_h",sectionNewTeam:".section-new-team_h",txtState:".txt-game-state_h",txtCity:".txt-game-city_h",txtTeam:".txt-game-team_h",txtScore:".txt-score-team_h",btnFinish:".btn-game-Finish_h",sectionTeamOne:".team-one_h",sectionTeamTwo:".team-two_h",sectionScore:".section-score_h",sectionRadio:".section-game-radio_h",rdoTeamOne:".rdo-game-location-one-home_h",rdoTeamTwo:".rdo-game-location-two-home_h",rdoLocation:".rdo-game-location_h",sectionMainLocation:".section-main-location_h",sectionLocation:".div-game-location_h",txtLocationId:".txt-game-location-id_h",sectionIndividual:".section-individual-game_h",txtIndividualGame:".txt-individual-game_h",btnIndividualFinish:".btn-game-individual-Finish_h",txtIndividualLocation:".txt-individual-location_h",btnIndividualGameCreate:".btn-game-individual-Create_h",fieldMessage:".field-message_h",secSports:".section-game-sports_h",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnTimePeriodData:"hdn_time-period_h",hdnTimePeriod:"#hdn_time-period_h",indicator:".indicator_h"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",sportId:"sportid",locationId:"locationid",gameId:"gameid"},inlineTemplates:{},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},tags:{individual:"individual",team:"team",rgxTime:/^(0?[1-9]|1[012])(:[0-5]\d)$/,rgxTimeWhole:/^(0?[1-9]|1[012])$/},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this),l(n.el).find(n.controls.txtGameDate).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});var e=[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],t={};t.records=e,t.recordId="name",t.recordValue="value";var r=new E({data:t,elementId:n.controls.hdnTimePeriodData,destination:n.controls.spnTimePeriod,targetView:n,selectedValue:"PM",callback:function(e){}})},afterRender:function(){var e=this,t=new S({callback:function(t){var n=t!=""?!0:!1;e.$el.find(".btn-game-Finish_h").attr("disable",n),e.$el.find(".txt-game-location-id_h").val(t)}});this.$el.find(".location-view-h").html(t.el)},setOptions:function(e){this.user_id=e.user_id;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null,this.team_id=e.teams_id||null},init:function(){n.setupView()},setupView:function(){n.setUpMainView();if(n.team_id){var e=new g;e.id=n.team_id,e.fetchSuccess=function(t,r){var i=e.parseAsRequired(r);n.team=i,n.sports_id=i.sports_id||null,n.fillSports()},e.fetch()}else n.fillSports()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e)},fillSports:function(){var e=new h;e.processResult=function(t){var r=e.ParseForDropdown();n.SetupSportsView(r)},e.fetch()},SetupSportsView:function(e){n.sports=e;var t={};t.records=n.sports,t.recordId="id",t.recordValue="custom_name";var r=new E({data:t,title:"Select Sport",elementId:n.controls.hdnSportsIdData,destination:n.controls.spnSports,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeSport(e)}})},changeSport:function(e){if(e&&e!=0){l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).fadeIn(),l(n.destination).find("input").attr(n.attributes.sportId,e);var t=n.getTeamType(e);t&&n.fillTeams(e)}else l(n.destination).find(n.controls.btnFinish).fadeOut(),l(n.destination).find(n.controls.sectionTeams).fadeOut(),l(n.destination).find("input").removeAttr(n.attributes.stateId);n.CheckTeamControlsVisibility()},setFirstTeam:function(e){console.log("setFirstTeam");var t=!1;if(n.team_id){for(var r in n.teams)n.teams[r].payload.id==n.team_id&&(t=!0);if(!t)if(n.team)n.setSelectedTeam(n.team);else{var i=new g;i.id=n.team_id,i.fetchSuccess=function(e,t){var r=i.parseAsRequired(t);n.team=r,n.setSelectedTeam(r)},i.fetch()}n.CheckTeamControlsVisibility()}},setSelectedTeam:function(e){console.log("setSelectedTeam");if(e){console.log("data",e);var t=e.team_name,r=e.team_id;l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,r),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.spanddlteamone).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).val(t).show(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.indicator).addClass("valid").removeClass("invalid").show()}},fillTeams:function(e){var t=new v;t.user_id=n.user_id,t.sports_id=e,t.processResult=function(e){var r={team_name:"Team Not Found",id:-1},i=t.AppendItem(r);n.setUpUserTeams(i)};var r=t.fetch()},setUpUserTeams:function(e){n.teams=e||[],n.setFirstTeam(n.team_id);var t={};t.records=n.teams,t.recordId="id",t.recordValue="team_name";var r=new E({data:t,elementId:"hdn_team_id",targetView:n,destination:n.controls.spanddlteamone,selectedValue:n.team_id||null,callback:function(e){n.changeUserTeamOne(e)}})},changeUserTeamOne:function(e){console.log("result1",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamOne).find("input:checked").removeAttr("checked"),n.showLocation())},changeUserTeamTwo:function(e){console.log("result",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamTwo).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamTwo).find("input:checked").removeAttr("checked"),n.showLocation())},showAddTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.spanddlteam).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).show(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},showDdlTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).val("").hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.ddlUserTeams).val("").show(),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},keyupState:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.stateId),n.CheckTeamControlsVisibility();var i=new p;i.state_name=l(e.target).val(),console.log("State Request Abort Request Function AddGame/Main.js"),n.stateFetchRequest=n.stateFetchRequest||[],n.stateFetchRequest.push(n.cityFetchRequest||[]),n.stateFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.stateFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.stateFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.states=[];for(var s in t)n.states.push(t[s].payload);n.states.forEach(function(e,t){r.push(e.name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else n.changeState(e)},changeState:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.stateId);var r=!1;n.states_id="",n.states&&n.states.forEach(function(i,s){i["name"]==t&&(r=!0,n.states_id=i.id,l(e.target).attr(n.attributes.stateId,n.states_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).attr(n.attributes.stateId,n.states_id).fadeIn(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).attr(n.attributes.stateId,n.states_id).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide())}),r||(n.states_id=0,l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).removeAttr(n.attributes.stateId).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).removeAttr(n.attributes.stateId).fadeOut()),n.CheckTeamControlsVisibility()},keyupCity:function(e){var t=l(e.target).val(),r=[];if(t.length>2)if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.cityId),n.CheckTeamControlsVisibility();var i=new d;i.states_id=n.states_id,i.city_name=l(e.target).val(),n.cityFetchRequest=n.cityFetchRequest||[],n.cityFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.cityFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.cityFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.cities=[];for(var s in t)n.cities.push(t[s]);n.cities.forEach(function(e,t){r.push(e.city)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeCity(e)},changeCity:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.cityId);var r=!1;n.city_id="",n.cities&&n.cities.forEach(function(i,s){i["city"]==t&&(r=!0,n.city_id=i.id,l(e.target).attr(n.attributes.cityId,n.city_id))}),r||(n.city_id=0),n.CheckTeamControlsVisibility()},keyupTeam:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility();var s=new m;s.states_id=l(e.target).attr(n.attributes.stateId),s.city_id=l(e.target).attr(n.attributes.cityId),s.sports_id=l(e.target).attr(n.attributes.sportId),s.team_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.TeamFetchRequest=n.abortRequest(n.TeamFetchRequest);var o=s.fetch();n.TeamFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.teams=[];for(var i in t)n.teams.push(t[i].payload);n.teams.forEach(function(e,t){r.push(e.team_name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeTeam(e)},changeTeam:function(e){var t=l(e.target).val(),r=!1;n.team_id=0,n.teams&&n.teams.forEach(function(i,s){var o=i.team_name;o==t&&(r=!0,n.team_id=i.id,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())});if(n.team){var i=n.team.team_name,s=n.team.team_id;i==t&&(r=!0,n.team_id=s,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())}r||(l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show()),n.CheckTeamControlsVisibility()},keyupIndividualGame:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility();var s=new w;s.game_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.individualGameFetchRequest=n.abortRequest(n.individualGameFetchRequest);var o=s.fetch();n.individualGameFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.eventNotFound(e):n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.individualGames=[];for(var i in t)n.individualGames.push(t[i].payload);n.individualGames.forEach(function(e,t){var n=e.event_name+" "+e.game_name;r.push(n)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeIndividualGame(e)},changeIndividualGame:function(e,t){var r=l(e.target).val(),i=!1;n.individual_game_id=0,n.individualGames&&n.individualGames.forEach(function(t,s){var o=t.event_name+" "+t.game_name;o==r&&(i=!0,n.individual_game_id=t.id,l(e.target).attr(n.attributes.gameId,n.individual_game_id))}),i?n.eventFound(e):n.eventNotFound(e),n.CheckTeamControlsVisibility()},eventNotFound:function(e){l(n.destination).find(n.controls.btnIndividualGameCreate).show(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.gameId)},eventFound:function(e){l(n.destination).find(n.controls.btnIndividualGameCreate).hide(),l(n.destination).find(n.controls.btnIndividualFinish).show(),l(e.target).parent().find(n.controls.fieldMessage).html(n.messages.gameFound).fadeIn()},createIndividualEvent:function(e){var t=!0,r="",i=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),s=l(n.destination).find(n.controls.txtGameTime).val(),o=l(n.destination).find(n.controls.hdnTimePeriod).val(),u=n.location_id||l(n.controls.txtLocationId).val()||0,a=l(n.destination).find(n.controls.txtIndividualGame).val(),f=l(n.destination).find(n.controls.hdnSportsId).val();f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),t=!1);if(!i||!s)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),t=!1;else{var c=s.match(n.tags.rgxTime)||s.match(n.tags.rgxTimeWhole);console.log("orginal date",i),console.log("orginal time",s),console.log("timeZone",o);if(!c)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),t=!1;else{l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut();try{var h=s.split(":");h&&(console.log(h),o!="PM"&&h[0]!="12"&&i.setHours(h[0]),h.length>1&&i.setMinutes(h[1]),o=="PM"&&i.addHours(12))}catch(p){}}console.log("new date",i)}u||(r+=n.messages.selectLocation,t=!1),l.trim(a)==""&&(r+="<br/>"+n.messages.enterEventName,t=!1);if(t){var d=i;l(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut();var v={game_datetime:d,locations_id:u,event_name:a,sports_id:f,users_id:n.user_id},m=new b(v);m.save({}),l.when(m.request).done(function(e){n.game_id=e.payload.id,n.gameData={game_datetime:d,games_id:n.game_id,event_name:a,locations_id:u,sports_id:f,users_id:n.user_id},routing.trigger(n.channel,n.gameData)})}else l(e.target).parent().find(n.controls.fieldMessage).html(r).fadeIn()},goThereIndividualGame:function(e){var t=l(n.destination).find(n.controls.hdnSportsId).val(),r={users_id:n.user_id,sports_id:t,games_id:n.individual_game_id},i=new x(r);i.save(),l.when(i.request).done(function(e){n.goThereSuccess(e)})},goThereSuccess:function(e){if(e&&e.payload!=null){var t=e.payload.game;t&&(n.gameData={type:n.tags.individual,game_datetime:t.gameDay,event_name:t.event_name,game_location:t.game_location,games_id:t.id,sports_id:e.payload.usl?e.payload.usl.sports_id:null,users_id:n.user_id},routing.trigger(n.channel,e))}},CheckTeamControlsVisibility:function(){var e=l(n.destination).find(n.controls.hdnSportsId).val();if(e&&e!=""&&e!=0){var t=n.getTeamType(e);if(!t)l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionIndividual).show();else{var r=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),i=new Date;r!=null&&i>=r?l(n.destination).find(n.controls.sectionScore).show():(l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.txtScore).val("")),l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controlsbtnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).show(),l(n.destination).find(n.controls.sectionMainLocation).show()}}else l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionMainLocation).hide();e=l(n.destination).find(n.controls.txtTeam).attr(n.attributes.teamId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnTeamDone).show():l(n.destination).find(n.controls.btnTeamDone).hide()},getTeamType:function(e){if(e&&e!=""&&e!=0){var t=!0;console.log("getteamtype",e);for(var r in n.sports)n.sports[r].payload.id==e&&(console.log("payload",n.sports[r].payload),n.sports[r].payload.team_type=="Individual"&&(t=!1));return t}return!1},showLocation:function(e){l(n.destination).find(n.controls.sectionMainLocation).show();var t=0,r=e?l(e.target).val():"away";if(r=="home")t=l(e.target).attr(n.attributes.teamId);else{var i=l(n.destination).find(n.controls.rdoLocation+":checked");i.each(function(){r=l(this).val(),r=="home"&&(t=l(this).attr(n.attributes.teamId))})}if(t){var s=new g;s.id=t,s.fetchSuccess=function(e,t){var r=s.parseAsRequired(t);n.setLocation(r)},s.fetch()}else l(n.destination).find(n.controls.txtLocationId).val("").fadeIn(),n.clearLocation()},setLocation:function(e){e.location_id?(n.location_id=e.location_id||0,l(n.destination).find(n.controls.txtLocationId).val("").fadeOut(),l(".address-h").val(e.location_name),l(".txt-game-location-id_h").val(e.location_id),l(".verify-address-h").trigger("click")):l(n.destination).find(n.controls.txtLocationId).val("").fadeIn()},clearLocation:function(){l(".address-h").val(""),l(".txt-game-location-id_h").val("")},formatDate:function(e,t,n){var r=l.datepicker.formatDate("yy-mm-dd",e);try{var i=t.split(":");return console.log(i),i.length==1&&(t+=":00"),t+=" "+n,r+=" "+t,r}catch(s){return!1}},finishGame:function(){l(n.destination).find(n.controls.fieldMessage).html("").hide();var e=!0,t=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),r=l(n.destination).find(n.controls.txtGameTime).val(),i=l(n.destination).find(n.controls.hdnTimePeriod).val(),s=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).attr(n.attributes.teamId),o=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtScore).val(),u=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtTeam).attr(n.attributes.teamId),a=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtScore).val(),f=l(n.destination).find(n.controls.hdnSportsId).val(),c=n.location_id||l(n.controls.txtLocationId).val()||0;f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),e=!1);if(!t||!r)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),e=!1;else{var h=r.match(n.tags.rgxTime)||r.match(n.tags.rgxTimeWhole);console.log("orginal date",t),console.log("orginal time",r),console.log("ampm",i),h?(l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut(),t=this.formatDate(t,r,i),t||(e=!1)):(console.log("NOT VALID"),l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),e=!1)}console.log("new date",t),c||(l(n.destination).find(n.controls.sectionMainLocation).find(n.controls.fieldMessage).html(n.messages.selectLocation).fadeIn(),e=!1),s>0||(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1),u>0||(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1);if(e){var p=t,d={game_datetime:p,locations_id:c,teamOneId:s,teamTwoId:u,sports_id:f,users_id:n.user_id},v=new b(d);v.save({}),l.when(v.request).done(function(e){console.log(e);if(e!=null&&e.payload!=null){n.game_id=e.payload.id;var t=l(n.destination).find(n.controls.rdoTeamOne).is(":checked"),r={game_datetime:p,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:o,users_id:n.user_id},i=new y(r);i.teams_id=s,i.save();var c={game_datetime:p,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:a,users_id:n.user_id};t=l(n.destination).find(n.controls.rdoTeamTwo).is(":checked");var h=new y(c);h.teams_id=u,h.save(),n.gameData={type:n.tags.team,game_datetime:p,games_id:n.game_id,team_id_one:s,team_id_two:u,sports_id:f,users_id:n.user_id},routing.trigger(n.channel,e)}})}}});return T}),define("usercontrols/addgame/addgame",["require","text!usercontrols/addgame/templates/layout.html","facade","controller","models","views","user/models/basic_info","usercontrols/addgame/views/main","jquery.slimscroll"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("user/models/basic_info"),d=e("usercontrols/addgame/views/main"),n=i.extend({cssArr:["/usercontrols/addgame/addgame.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.sports_id&&(this.sports_id=e.sports_id),e.teams_id&&(this.teams_id=e.teams_id),this.callback=e.callback,e.popup&&(this.popup=!0,this.modelHTML='<div id="addGamePopup"></div>'),e.gender&&(this.gender=e.gender),this.init(),this},init:function(){this.popup?this.setupPopupLayout().render():this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setupPopupLayout:function(){var e;this.scheme=[];var e=new h({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e,this.modelBoxId="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);var t={};return t.height="500px",t.width="90%",t.title="Add Game",t.id=this.modelBoxId,routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;routing.off("add-game-success"),routing.on("add-game-success",function(t){e.addGameFunction(t)});var n=this,r="#"+this.modelBoxId+" #modalBody";this.addGameView=new d({model:new p,template:t,name:"add-game-main",destination:r,user_id:n.id,channel:"add-game-success",sports_id:this.sports_id,teams_id:this.teams_id}),this.scheme.push(this.addGameView),this.layout.render()},addGameFunction:function(e){this.callback&&this.callback(e)}});return n}),define("text!usercontrols/photo-player/templates/comments.html",[],function(){return'\r\n\r\n{{#payload}}\r\n<div class="photo-player-coment"> \r\n	<div class="user-photo">\r\n		<img src="{{base_url}}{{poster_picture}}" alt="{{poster}}" />\r\n	</div> \r\n    <div class="content">\r\n    	<!--span class="comment-date">{{poster}} {{comment_date}}</span-->\r\n    	<span class="user-comment">{{user.first_name}} </span>\r\n    	<p class="comment-text">{{comment}}</p>\r\n    </div>\r\n</div>\r\n{{/payload}}\r\n\r\n\r\n\r\n'}),define("usercontrols/photo-player/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/media/comments/"+this.id:"/api/media/comments/"+this.id}}),r}),define("text!usercontrols/photo-player/templates/player.html",[],function(){return'<div class="image-bg">\r\n	<div class="image-controls">\r\n		<ul class="image-actions">\r\n			<li><a href="javascript: void(0);" class="photo-player-tag-photo-h" title="tag photo">Tag Photo</a></li>\r\n			<li><a href="javascript: void(0);" class="photo-player-tag-myself-h" title="tag my self">Tag Myself</a></li>\r\n			<li><a href="javascript: void(0);" class="photo-player-vote-h" title="vote">Vote</a></li>\r\n		</ul>\r\n\r\n		<div class="left-arrow-container left-arrow photo-player-back pull-left">\r\n			<a href="javascript: void(0)" class="photo-player-arrow back-arrow-h">\r\n				<img src="http://cdn.athletez.com/resources/img/left_arrow.png" />\r\n			</a>\r\n		</div>\r\n		<div class="right-arrow-container right-arrow photo-player-next pull-right">\r\n			<a href="javascript: void(0)" class="photo-player-arrow next-arrow-h">\r\n				<img src="http://cdn.athletez.com/resources/img/right_arrow.png" />\r\n			</a>	\r\n		</div>\r\n	</div>\r\n	<div id="video_container" class="hidden"><span>Loading Video...</span></div>\r\n	<div class="loading_image"><img src="" class="photo-player-main-image large-image-h" /></div>\r\n\r\n	<div class="thumbs-outer">\r\n		<div class="thumbs-inner">\r\n			<ul class="images-list thumb-image-list-h"></ul>\r\n		</div>\r\n	</div>\r\n\r\n</div>\r\n\r\n'}),define("text!usercontrols/photo-player/templates/image-thumbs.html",[],function(){return'{{#data}}\r\n<li>\r\n	<a href="javascript: void(0);" class="thumb-link-h" data-index="{{_index}}" title="thumb">\r\n			<img style="{{#styles}}{{property}} : {{value}}; {{/styles}}" src="{{_thumbnail}}" alt="{{_thumbnail}}"/>\r\n	</a>\r\n</li>{{/data}}'}),function(e){jQuery.fn.extend({slimScrollHorizontal:function(t){var n={wheelStep:20,height:"auto",width:"250px",size:"7px",color:"#000",position:"bottom",distance:"1px",start:"left",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200,barZ:99,wrapperPos:"relative",wrapperBottom:"0px"},r=e.extend(n,t);return this.each(function(){function w(e,t,n){var i=e;g.css("left")=="auto"&&g.css("left","0px");if(t){i=parseInt(g.css("left"))+e*parseInt(r.wheelStep)/100*g.outerWidth();var s=d.outerWidth()-g.outerWidth();i=Math.min(Math.max(i,0),s),g.css({left:i+"px"})}f=parseInt(g.css("left"))/(d.outerWidth()-g.outerWidth()),i=f*(d[0].scrollWidth-d.outerWidth());if(n){i=e;var u=i/d[0].scrollWidth*d.outerWidth();g.css({left:u+"px"})}d.scrollLeft(i),x(),T()}function S(){a=Math.max(d.outerWidth()/d[0].scrollWidth*d.outerWidth(),h),g.css({width:a+"px"})}function x(){S(),clearTimeout(s);if(f==~~f){p=r.allowPageScroll;if(l!=f){var e=~~f==0?"left":"right";d.trigger("slimscroll",e)}}l=f;if(a>=d.outerWidth()){p=!0;return}g.stop(!0,!0).fadeIn("fast"),r.railVisible&&m.stop(!0,!0).fadeIn("fast")}function T(){r.alwaysVisible||(s=setTimeout(function(){(!r.disableFadeOut||!t)&&!n&&!i&&(g.fadeOut("slow"),m.fadeOut("slow"))},1e3))}var t,n,i,s,u,a,f,l,c="<div></div>",h=30,p=!1,d=e(this);if(d.parent().hasClass("slimScrollDiv")){scroll&&(g=d.parent().find(".slimScrollBar"),m=d.parent().find(".slimScrollRail"),w(d.scrollLeft()+parseInt(scroll),!1,!0));return}var v=e(c).addClass(r.wrapperClass).css({position:r.wrapperPos,bottom:r.wrapperBottom,overflow:"hidden",width:r.width,height:r.height});d.css({overflow:"hidden",width:r.width,height:r.height});var m=e(c).addClass(r.railClass).css({width:"100%",height:r.size,position:"absolute",bottom:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.size,background:r.railColor,opacity:r.railOpacity,zIndex:90}),g=e(c).addClass(r.barClass).css({background:r.color,height:r.size,position:"absolute",bottom:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.size,BorderRadius:r.size,MozBorderRadius:r.size,WebkitBorderRadius:r.size,zIndex:r.barZ}),y=r.position=="top"?{top:r.distance}:{bottom:r.distance};m.css(y),g.css(y),d.wrap(v),d.parent().append(g),d.parent().append(m),g.draggable({axis:"x",containment:"parent",start:function(){i=!0},stop:function(){i=!1,T()},drag:function(t){w(0,e(this).position().left,!1)}}),m.hover(function(){x()},function(){T()}),g.hover(function(){n=!0},function(){n=!1}),d.hover(function(){t=!0,x(),T()},function(){t=!1,T()}),d.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(u=e.originalEvent.touches[0].pageX)}),d.bind("touchmove",function(e){e.originalEvent.preventDefault();if(e.originalEvent.touches.length){var t=(u-e.originalEvent.touches[0].pageX)/r.touchScrollStep;w(t,!0)}});var b=function(e){if(!t)return;var e=e||window.event,n=0;e.wheelDelta&&(n=-e.wheelDelta/120),e.detail&&(n=e.detail/3),w(n,!0),e.preventDefault&&!p&&e.preventDefault(),p||(e.returnValue=!1)},E=function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",b,!1),this.addEventListener("mousewheel",b,!1)):document.attachEvent("onmousewheel",b)};E(),S(),r.start=="right"?(g.css({left:d.outerWidth()-g.outerWidth()}),w(0,!0)):typeof r.start=="object"&&(w(e(r.start).position().left,null,!0),r.alwaysVisible||g.hide())}),this}}),jQuery.fn.extend({slimscrollHorizontal:jQuery.fn.slimScrollHorizontal})}(jQuery),define("jquery.slimscroll.hor",function(){}),define("media/models/tag",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/ent/addtag/"}}),n}),define("usercontrols/photo-player/models/tag-myself",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/ent/addtag/"+this.user_id}}),n}),define("usercontrols/photo-player/views/main",["require","text!usercontrols/photo-player/templates/player.html","text!usercontrols/photo-player/templates/image-thumbs.html","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","votes/models/vote","jwplayer","jqueryui","jquery.slimscroll.hor","usercontrols/tag/models/basic_info","usercontrols/tag/views/main","media/models/tag","usercontrols/photo-player/models/tag-myself"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=o.SectionView,a=e("utils"),f=a.lib.Channel,l=e("vendor"),c=e("usercontrols/tag/views/main"),h=e("usercontrols/tag/models/basic_info"),p=l.Mustache,d=s.$,v=e("votes/models/vote"),m=e("media/models/tag"),g=e("usercontrols/photo-player/models/tag-myself");try{console.log("jwplayer",jwplayer)}catch(y){console={},console.log=function(e){}}return jwplayer.key="yXOw2TpDcCoCnbWyVSCoEYA4tepkpjiVEtLEfSBIfZQ=",PhotoPlayerView=u.extend({template:t,thumbTemplate:n,events:{"click .back-arrow-h":"backButton","click .next-arrow-h":"nextButton","click .thumb-link-h":"changeImage","click .photo-player-vote-h":"vote","click .photo-player-tag-photo-h":"setUpTagPhotoView","click .photo-player-tag-myself-h":"TagMyself"},initialize:function(e){this.collection=e.collection,console.log("***************************************************************************************options",e),this.setOptions(e),this.id=e.id,this.index=e.index,u.prototype.initialize.call(this,e),this.setUpMainView(),this.json=this.model.toJSON(),this.render(),this.initThumbsSection(),this.loadImage(!0),f("tag-image-success-photo").empty(),f("tag-image-success-photo").subscribe(this.tagFunction)},vote:function(e){console.log("vote",this.json);if(d(e.currentTarget).hasClass("voted"))return;var t=this,n=new v;n.userId=this.json[this.index].payload.id,n.entity_id=this.json[this.index].payload.enttypes_id,n.set({subject_type_id:n.entity_id,subject_id:n.userId}),n.save(),d.when(n.request).done(function(){t.$el.find(".photo-player-vote-h").addClass("voted")})},changeImage:function(e){var t=d(e.currentTarget);this.index=t.attr("data-index"),this.loadImage(),this.changeThumbPosition()},backButton:function(e){this.index>0&&(this.index--,this.loadImage(),this.changeThumbPosition())},nextButton:function(e){console.log("next"),this.index<this.json.length&&(this.index++,this.loadImage(),this.changeThumbPosition())},changeThumbPosition:function(){var e=this.$el.find(".thumb-image-list-h"),t=this.$el.find(".selected-photo-thumb"),n=t.position(),r=e.position(),i=e.width(),s=0,o=this.$el.find(".thumbs-outer"),u=o.width();if(n.left<0)s=n.left+r.left;else if(n.left+t.width()>u)s=n.left-u,s+=r.left<0?-r.left:-r.left,s+=t.width()+20;else{var a=r.left<0?-r.left:r.left;s=+a-t.width()}s&&this.$el.find(".thumbs-outer").animate({scrollLeft:s+"px"},400)},initThumbsSection:function(){var e=this,t=this.json.length,n={},r=null;n.data=[];for(var i=0;i<t;i++){var s=this.json[i].payload,o={_enttypes_id:s.enttypes_id,_id:s.id,_index:i};switch(s.enttypes_id){case"23":typeof s.standard_thumb=="object"?(r=s.standard_thumb,o._thumbnail=r.url):o._thumbnail=s.thumbs,o._label=s.media.name,o._link="javascript: void(0);",s.media.hasOwnProperty("is_owner")&&(show_edit=s.media.is_owner);break;case"21":o._label=s.media_obj.name,o._link="javascript: void(0);",typeof s.types=="object"&&(typeof s.types.standard_thumb=="object"?(r=s.types.standard_thumb,o._thumbnail=r.url):typeof s.types.small_thumb=="object"?(r=s.types.large_thumb,o._thumbnail=r.url):typeof s.types.large_thumb=="object"?(r=s.types.large_thumb,o._thumbnail=r.url):typeof s.types.original=="object"&&(r=s.types.original,o._thumbnail=r.url)),s.media_obj.hasOwnProperty("is_owner")&&(show_edit=s.media_obj.is_owner);break;case"1":typeof s.user_picture_obj=="object"&&typeof s.user_picture_obj.types=="object"&&(typeof s.user_picture_obj.types.standard_thumb=="object"?(r=s.user_picture_obj.types.standard_thumb,o._thumbnail=r.url):typeof s.user_picture_obj.types.large_thumb=="object"?(r=s.user_picture_obj.types.large_thumb,o._thumbnail=r.url):typeof s.user_picture_obj.types.original=="object"&&(r=s.user_picture_obj.types.original,o._thumbnail=r.url)),o._label=s.label,o._sublabel="Coming Soon",o._link="/#profile/"+s.id,s.hasOwnProperty("is_owner")&&(show_edit=s.is_owner);break;case"8":o._detailclass="game",o._thumbnail=s.game_picture!==null?s.game_picture.types.small_thumb.url:"http://lorempixel.com/output/sports-q-c-440-440-4.jpg",r=s.game_picture!==null?s.game_picture.types.small_thumb:{height:440,width:440,url:"http://cdn.athletez.com/resources/icons/game/square_game.png"},o._label=s.game_day,o._link="/#game/"+s.id;var u="",a=s.teams.length,f=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};for(var i=0;i<a;i++)u+="<span>",u+=f(s.teams[i].team_name),u+="</span>",i+1<s.teams.length&&(u+=" VS. ");s.hasOwnProperty("is_owner")&&(show_edit=s.is_owner),o._sublabel=u}if(r!="undefined"&&r!=null){var l=r.width/110,c=r.height/110;r.width=parseInt(r.width),r.height=parseInt(r.height);var h=r.width>r.height?-(r.width/c-110)/2:-(r.height/l-110)/2;h>0&&(h=0),o.styles={},r.width>r.height?o.styles=[{property:"min-width",value:r.width/c+"px"},{property:"left",value:h+"px"}]:o.styles=[{property:"min-height",value:r.height/l+"px"},{property:"top",value:h+"px"}]}n.data.push(o)}this.id=o._id;var d=p.to_html(this.thumbTemplate,n);this.$el.find(".thumb-image-list-h").html(d),setTimeout(function(){e.changeThumbPosition()},1e3),this.thumbScroll()},thumbScroll:function(){this.$el.find(".thumbs-outer").slimscrollHorizontal({height:"110px",width:"100%",alwaysVisible:!1,start:"left",position:"bottom",wheelStep:10,barZ:9999,wrapperPos:"absolute",wrapperBottom:"0px",opacity:.7,color:"#9cca3c"})},loadImage:function(e){var t=d("div#video_container"),n=d("div.loading_image");t.hasClass("hidden")||t.addClass("hidden"),n.hasClass("hidden")&&n.removeClass("hidden");var r=this,i=this.json[r.index].payload,s={_enttypes_id:i.enttypes_id,_id:i.id,_media_id:i.media_id,_currentIndex:r.index};r.index>=this.json.length-1?this.$el.find(".next-arrow-h").addClass("disable-arrow-link"):this.$el.find(".next-arrow-h").removeClass("disable-arrow-link"),r.index==0?this.$el.find(".back-arrow-h").addClass("disable-arrow-link"):this.$el.find(".back-arrow-h").removeClass("disable-arrow-link");var o;switch(i.enttypes_id){case"23":this.setupVideo(i),s._thumbnail=i.thumbs,s._label=i.media.name,s._link="javascript: void(0);";break;case"21":typeof i.types=="object"&&i.types.large_format&&(o=i.types.large_format),s._label=i.media_obj.name,s._link="javascript: void(0);";break;case"1":typeof i.user_picture_obj=="object"&&(s._thumbnail=i.user_picture_obj.types.large_thumb.url),s._label=i.label,s._sublabel="Coming Soon",s._link="/#profile/"+i.id,i.hasOwnProperty("is_owner")&&(show_edit=i.is_owner);break;case"8":s._detailclass="game",s._thumbnail=i.game_picture!==null?i.game_picture.types.large_thumb.url:"http://lorempixel.com/output/sports-q-c-440-440-4.jpg",s._label=i.game_day,s._link="/#game/"+i.id;var u="",a=i.teams.length,f=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};for(var l=0;l<a;l++)u+="<span>",u+=f(i.teams[l].team_name),u+="</span>",l+1<i.teams.length&&(u+=" VS. ");i.hasOwnProperty("is_owner")&&(show_edit=i.is_owner),s._sublabel=u}if(o!="undefined"&&o!=null){var c=this,h=this.$el.find("div.loading_image");h.css("opacity","0");function p(e){var t=e.data.self,n=e.data.image_object,r=parseInt(t.$el.height())*.8,i=parseInt(n.height)>=380?parseInt(n.height):380;if(n.width>n.height||n.width==n.height){var s=r<i?10:(r-i)/2;e.data.el.css({"max-width":"100%",top:s+"px"})}else if(r>i){var s=(r-i)/2;e.data.el.css({"max-height":r+"px",top:s+"px"})}else e.data.el.css({"max-height":r+"px",top:"0px"});e.data.el.css("opacity","100"),e.data.el.find(".large-image-h").off("load")}h.find(".large-image-h").attr("src",o.url).on("load",{el:h,self:this,image_object:o},p)}this.$el.find(".thumb-image-list-h li").removeClass("selected-photo-thumb"),this.$el.find(".thumb-link-h[data-index="+this.index+"]").parents("li").addClass("selected-photo-thumb"),routing.trigger("photo-player-section-reload",s._enttypes_id,s._media_id)},setupVideo:function(e){function n(){var n=jwplayer(t.playerId),r=t.$el,i={},s=[];for(var o=0;o<e.video_type.length;o++){console.log(e.video_type[o]);var u;u={file:e.video_type[o].meta_details.url},s.push(u)}i.playlist=[{image:e.thumbs,mediaid:e.media.name,sources:s}],i.title=e.media.name,i.primary="html5",i.duration=e.video_type[0].meta_details.duration_in_ms*1e3,i.modes=[{type:"html5",src:"http://s3.amazonaws.com/mikewbucket/jw/jwplayer.html5.js"},{type:"flash",src:"http://s3.amazonaws.com/mikewbucket/jw/jwplayer.flash.swf"}],i.skin="http://s3.amazonaws.com/mikewbucket/jw/skins/glow.xml",i.height=r.height()*.8,i.width=r.width(),console.error(i),n.setup(i)}var t=this,r=setInterval(function(){var e=d("#jw_container");e.length||(d("div.image-bg div.loading_image").addClass("hidden"),d("div#video_container").removeClass("hidden")),t.playerId&&d("#"+t.playerId).remove(),t.playerId="jw-container-"+Math.floor(Math.random()*90+10);var i=d("<div></div>").attr("id",t.playerId);d("div#video_container").append(i).removeClass("hidden"),d("#"+t.playerId).css("z-index","9999"),console.log("Set CSS",d("#"+t.playerId).css("z-index","9999")),clearInterval(r),n()},500)},showImage:function(e){e.find("div.loading_image").css("opacity","100")},setOptions:function(e){this.userId=e.user_id||null,this.sportsId=e.sports_id||null,this.scheme=e.scheme,this.layout=e.layout},setUpMainView:function(){var e=this,t=p.to_html(e.template,{});d(e.$el).html(t)},setUpTagPhotoView:function(){var e=this;console.log("image payload",this.json[this.index].payload),console.log("tagtemplate",r);var t=this.json[this.index].payload,n=null,i=null,s=null;t&&t.media_obj&&(i=t.media_obj.sports_id||null,s=t.media_obj.users_id||null,n=t.media_obj.is_owner||null),this.tagViewPhoto=new c({model:new h,template:r,name:"tag-image "+(new Date).toString(),destination:"#image-tagging-photo",user_id:s,sports_id:i,is_owner:n,channel:"tag-image-success-photo"}),e.scheme.push(this.tagViewPhoto),e.layout.render()},tagFunction:function(e){var t=this,n=e||{},r={media_id:this.json[this.index].payload.media_id,tag_array:JSON.stringify(n)},i=new m(r);i.save(),d.when(i.request).done(function(){t.setUpTagViewSection()})},setUpTagViewSection:function(){var e=this,t=this.json[e.index].payload,n={_enttypes_id:t.enttypes_id,_id:t.id,_media_id:t.media_id,_currentIndex:e.index};routing.trigger("tags-fetch-new-form-data",n._enttypes_id,n._media_id)},TagMyself:function(){var e=this,t={1:[this.getUserId()]},n={media_id:this.json[this.index].payload.media_id,tag_array:JSON.stringify(t)},r=new g(n);r.user_id=this.getUserId(),r.save(),d.when(r.request).done(function(){e.setUpTagViewSection()})},getUserId:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?routing.loggedInUserId:null}}),PhotoPlayerView}),define("usercontrols/photo-player/models/commentonform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/commentonform/"+this.id:"/api/user/basics/"+this.id},initialize:function(e,n){t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),routing.trigger("profilecommentonform:fetch",e)}}),r}),define("usercontrols/photo-player/views/comment-form",["require","text!site/templates/comment-form.html","usercontrols/photo-player/models/commentonform","site/views/comment-form","models/base","views","chrome/views/header"],function(e,t,n,r,i){var s,o=e("views"),u=e("chrome/views/header"),a=o.BaseView;return s=a.extend({initialize:function(e){console.error(e),_.bindAll(this),this.setOptions(),a.prototype.initialize.call(this,e)},el:".comment-input-outer-h",template:t,events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox"},setOptions:function(e){if(!this.collection)throw new Error("comment form view expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(){var e=this.$el.find(".add-comment-form-h");e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")},refreshComments:function(e){this.$("#new-comment").val("")},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=this.model.get("id");var s=new i(r);s.url=function(){return debug.log(n),_.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/media/addcomment/"+r.subject_id+"?comment="+r.comment:"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.on("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return a.prototype.render.call(this),this.input=this.$("#new-comment"),console.log("run here now",this.el),this}}),s}),define("usercontrols/photo-player/views/comments",["facade","utils","site/views/comment-list","usercontrols/photo-player/views/comment-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),this.options.collection=this.collection,this.name=e.name,this._template=e.template,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function s(e){console.log("Comments callback",e.user_pic_small),n.model=e,n.render()}function o(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}var e=this,t=this,n=new r({collection:this.collection}),i=this.addChildView(n);this.callbacks.add(function(){i()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){s(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){o(e)})}}),s}),define("usercontrol/photo-player/models/tags",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/user/basics/"+this.id}}),n}),define("usercontrols/photo-player/collections/tags",["facade","collections","utils","usercontrol/photo-player/models/tags"],function(e,t,n,r){var i,s=t.BaseCollection;return i=s.extend({model:r,url:function(){return testpath?testpath+"/media/tags/"+this.id:"/api/media/tags/"+this.id},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("text!usercontrol/photo-player/templates/tags.html",[],function(){return'<div class="prof-name-area"></div>\r\n<div class="tags-outer-h">\r\n	<ul id="tags-list"></ul>\r\n</div>\r\n<div class="clear">\r\n</div>'}),define("text!usercontrol/photo-player/templates/tag-item.html",[],function(){return'<div class="row-fluid">\r\n    <div class="tags-name">\r\n	    {{#_thumbnail}}<img src="{{_thumbnail}}" class="tag-thumb" />{{/_thumbnail}}\r\n	    {{^_thumbnail}}<div style="display: inline-block;border: 1px solid #CCC;background-color: #D45F10;color: black;font-size: .7em;text-align: center;overflow: hidden;" class="tag-thumb">No Picture</div>{{/_thumbnail}}\r\n    	<span>\r\n			<a href="{{_link}}" style="display: inline-block;"><span class="labelSpan">{{{_label}}}</span></a>\r\n		</span>\r\n	    {{#show_edit}}\r\n	    <a href="javascript:void(0);" class="deleteTag" title="Delete Tag" data-enttypes-id="{{_enttypes_id}}" data-subject-id="{{_id}}">&times;</a>\r\n	    {{/show_edit}}\r\n		<span class="tags-number">{{count}}</span>\r\n    </div>\r\n</div>\r\n'}),define("usercontrol/photo-player/views/tags-item",["vendor","views","utils","text!usercontrol/photo-player/templates/tag-item.html","common/models/delete"],function(e,t,n,r,i){var s,o=t.BaseView,u=e.Mustache;return s=o.extend({tagName:"li",template:r,className:"tag",events:{"click .deleteTag":"deleteTag"},initialize:function(e){},filterData:function(){var e=this,t=this.model.get("payload"),n={_enttypes_id:t.enttypes_id,_id:t.id},r=!1,i=null;n.Sportsteam=null,console.log(t.subject,"for testing");switch(t.subject_enttypes_id){case"23":n._thumbnail=t.thumbs,n._label=t.media.name,n._link="javascript: void(0);",t.media.hasOwnProperty("is_owner")&&(r=t.media.is_owner);break;case"21":typeof t.types=="object"?typeof t.types.standard_thumb=="object"?(i=t.types.standard_thumb,n._thumbnail=i.url):typeof t.types.large_thumb=="object"?(i=t.types.large_thumb,n._thumbnail=i.url):typeof t.types.original=="object"&&(i=t.types.original,n._thumbnail=i.url):n._label=t.media_obj.name,n._link="javascript: void(0);",t.media_obj.hasOwnProperty("is_owner")&&(r=t.media_obj.is_owner);break;case"1":typeof t.subject.user_picture_obj=="object"&&typeof t.subject.user_picture_obj.types=="object"&&(typeof t.subject.user_picture_obj.types.standard_thumb=="object"?(i=t.subject.user_picture_obj.types.standard_thumb,n._thumbnail=i.url):typeof t.subject.user_picture_obj.types.large_thumb=="object"?(i=t.subject.user_picture_obj.types.large_thumb,n._thumbnail=i.url):typeof t.subject.user_picture_obj.types.original=="object"&&(i=t.subject.user_picture_obj.types.original,n._thumbnail=i.url)),n._label=t.subject.label,n._link="/#profile/"+t.subject.id,t.hasOwnProperty("is_owner")&&(r=t.is_owner);break;case"8":n._detailclass="game",i=t.subject.game_picture!==null?t.subject.game_picture.types.standard_thumb:{height:440,width:440,url:"http://lorempixel.com/output/sports-q-g-440-440-3.jpg"},n._thumbnail=i.url,n._link="/#game/"+t.subject.id;var s="",o=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},a=t.subject.teams?t.subject.teams.length:0;for(var f=0;f<a;f++){if(f%2==1)var l="game-match-name1",c="game-score1";else var l="game-match-name",c="game-score";s+='<div class="'+l+'">',console.log(t.subject.teams[f].team_name+",score="+t.subject.teams[f].points_scored+",i="+f),s+=o(t.subject.teams[f].team_name),s+="</div>",s+='<div class="'+c+'">',s+='<span class="scoreAlign">',s+=t.subject.teams[f].points_scored!=null?t.subject.teams[f].points_scored:"--",s+="</span>",s+="</div>"}n._label=s!=""?s:t.subject.event_name,console.log(n._label),t.hasOwnProperty("is_owner")&&(r=t.is_owner);if(!this.Sportsteam&&a){this.Sportsteam=!0;var h=t.subject.shared.season,p=h.split(" "),d='<div class="name"><span class="topalign">'+t.subject.shared.sport+'</span></div>	<div class="game"><span class="topalign">'+t.subject.shared.complevel+'</span></div><div class="season"><span class="topalign">'+p[2]+"</span></div>";$(".headerinfo").html(d)}break;case"5":n._detailclass="team",i=t.subject.picture!==null?t.subject.picture:{height:440,width:440,url:"http://lorempixel.com/output/sports-q-g-440-440-3.jpg"},n._thumbnail="",n._link="/#team/"+t.subject_id;var s=t.subject.team_name;t.hasOwnProperty("is_owner")&&(r=t.is_owner),n._label=s}n.show_edit=r==1?!0:undefined,console.log(n);var v=u.to_html(this.template,n);this.$el.html(v)},render:function(){return this.filterData(),this},deleteTag:function(e){var t=new i;t.subject_id=$(e.target).parent().attr("data-subject-id"),t.enttypes_id=$(e.target).parent().attr("data-enttypes-id"),t.removeNode=$(e.target).parents("li.tags-li"),console.log(t),t.destroyAndRemove()}}),s}),define("usercontrols/photo-player/models/tags",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/user/basics/"+this.id}}),n}),define("usercontrols/photo-player/views/tags",["facade","vendor","utils","views","text!usercontrol/photo-player/templates/tags.html","usercontrol/photo-player/views/tags-item","usercontrols/photo-player/models/tags","jquery.slimscroll"],function(e,t,n,r){var i,s=e._,o=r.CollectionView,u=r.SectionView,a=t.Mustache,f=n.lib.Channel,l=require("text!usercontrol/photo-player/templates/tags.html"),c=require("usercontrol/photo-player/views/tags-item"),h=require("usercontrols/photo-player/models/tags");return CommentListAbstract=o.extend(u.prototype),i=CommentListAbstract.extend({__super__:o.prototype,listView:"#tags-list",_tagName:"li",_className:"tags-li",page:1,page_limit:5,prepend:!1,_view:c,template:l,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=a.to_html(this.template);return this.$el.html(e),this},initialize:function(e){this.renderTemplate();var t=this;this.name=e.name,this.collection=e.collection,console.log(this.collection.toJSON()),t.allData=this.collection.toArray(),t.cleardata(),t.getprofile(),$(".photo-player-right-area").slimScroll({height:"100%"}),t.seeMore(),console.log(this.collection.toJSON()),o.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CommentListView expected options.collection.");s.bindAll(this),this.addSubscribers()},seeMore:function(e){var t=this.allData.length,n=t<this.page_limit?t:this.page_limit,r=t-this.page*n,i=r+this.page_limit;r<=0&&this.$el.find(".see-more-h").hide(),this.prepend=!0,e?this.collection.add(this.allData.slice(r,i)):this.collection.reset(this.allData.slice(r,i)),this.page++,this.prepend=!1,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},getprofile:function(){var e=window.location.href,t=e.split("/"),n=t[t.length-1];this.id=n;var r="/api/user/basics/"+this.id;this.model.set("url",r);var i=new h({id:n});i.fetch({success:function(e){var t='<div class="user-photo-profile"><img src='+e.attributes.payload.user_picture_obj.image_path+' alt=""></div><div class="content-prof-sub"><span class="user-comment">Uploaded By&nbsp;</span><span class="user-comment">'+e.attributes.payload.label+'</span><p class="comment-text">'+e.attributes.payload.user_picture_obj.media_obj.timePosted+"</p></div>";$(".prof-name-area").html(t)}})},cleardata:function(){$(".headerinfo").empty(),$(".teamName-area").empty(),$(".prof-name-area").empty()},childViews:{}}),i}),define("usercontrols/photo-player/photo-player",["require","text!usercontrols/photo-player/templates/comments.html","text!usercontrols/tag/templates/layout.html","facade","controller","models","views","usercontrols/photo-player/collections/comments","usercontrols/photo-player/views/main","usercontrols/photo-player/views/comments","usercontrols/photo-player/collections/tags","usercontrols/photo-player/views/tags","usercontrols/photo-player/models/tags","usercontrols/tag/views/main","usercontrols/tag/models/basic_info"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=i.$,l=i._,c=a.debug,h=a.lib.Channel,p=u.LayoutView,d=i.Backbone,v=e("usercontrols/photo-player/collections/comments"),m=e("usercontrols/photo-player/collections/tags"),g=e("usercontrols/photo-player/views/main"),y=e("usercontrols/photo-player/views/comments"),b=e("usercontrols/photo-player/views/tags"),w=e("usercontrols/photo-player/models/tags"),E=e("usercontrols/tag/views/main"),S=e("usercontrols/tag/models/basic_info"),r=s.extend({cssArr:["/usercontrols/photo-player/photoPlayer.css"],events:{},initialize:function(e){console.log("LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL",e),console.log("init");var t=this;h("load:css").publish(this.cssArr),l.bindAll(this),e.id&&(this.id=e.id),this.index=e.index,e.userId&&(this.userId=e.userId),e.array&&(this.collectionArray=!0),e._collection&&(this._collection=e._collection),this.modelHTML='<div id="photoPlayerModal" class="modal photo-frame-model hide fade model-popup-h"><div class="modal-body page-content-h"><div class="photo-player-area-h photo-player"></div><div class="photo-player-right-area"><div class="right-area-header"><div class="headerinfo"></div><div class="closer"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">	&times;</button></div></div><div class="teamName-area"></div><div class="tags-area-h"></div><div class="comment-area coment-area-h"></div><div class="comment-input-outer-h comment-input-outer" class="clearfix"></div><div id="image-tagging-photo"></div></div></div></div>',routing.off("photo-player-section-reload"),routing.on("photo-player-section-reload",function(e,n){t.id=n,f("#image-tagging-photo").html(""),t.setUpCommentView(e,n),t.setUpTagView(e,n)}),routing.off("comments-fetch-new-form-data"),routing.on("comments-fetch-new-form-data",function(e,n){t.setUpCommentView(e,n)}),routing.off("tags-fetch-new-form-data"),routing.on("tags-fetch-new-form-data",function(e,n){t.setUpTagView(e,n)}),this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},handleDeferreds:function(){},setupLayout:function(){this.scheme=[],f(".model-popup-h").remove(),f("body").append(this.modelHTML);var e=new p({scheme:this.scheme,destination:"#modalPopup",template:"",displayWhen:"ready"});return this.layout=e,f("#photoPlayerModal").modal("show"),this.layout},setUpMainView:function(){var e=this;if(e.collectionArray){var t=d.Collection.extend(),n=new t;n.reset(e._collection)}else n=e._collection;var r=new g({model:n,name:"photo player",destination:".photo-player-area-h",index:e.index,user_id:e.userId||null,sports_id:e.sports_id||null,scheme:this.scheme,layout:this.layout});this.scheme.push(r),this.layout.render()},setUpTagView:function(e,t){var n=this.scheme.length;for(var r=0;r<n;r++)this.scheme[r].name==this.oldTagView&&this.scheme[r].remove();var i=this;i.oldTagView="tag section"+Math.random(),f(".tags-area-h").unbind().html(""),i.tags=new m,i.tags.id=t,i.tags.fetch(),f.when(i.tags.request).done(function(){var t=new w,n=new b({collection:i.tags,userId:i.userId,name:i.oldTagView,model:t,entity_type_id:e,destination:".tags-area-h"});i.scheme.push(n),i.layout.render()})},setUpCommentView:function(e,n){var r=this.scheme.length;for(var i=0;i<r;i++)this.scheme[i].name==this.oldView&&this.scheme[i].remove();var s=this,o;s.oldView="comment section"+Math.random(),f(".coment-area-h, .comment-input-outer-h").unbind().html(""),s.commentson=new v,s.commentson.subject_entity_type=e,s.commentson.id=n,s.commentson.fetch(),f.when(s.commentson.request).done(function(){o=new y({collection:s.commentson,userId:s.userId,name:s.oldView,_template:t,destination:".coment-area-h"}),s.scheme.push(o),s.layout.render()})},setUpOthersView:function(){},setUpTagPhotoView:function(e,t){console.log("tagtemplate",n);var r=this;this.tagViewPhoto=new E({model:new S,template:n,name:"tag-image "+(new Date).toString(),destination:"#image-tagging-photo",user_id:r.userId||null,sports_id:r.sports_id,channel:"tag-image-success-photo"}),r.scheme.push(this.tagViewPhoto),r.layout.render()},tagFunction:function(e){var t=this;alert(JSON.stringify(e))}});return r}),define("usercontrols/add-club/collections/complevel",["facade","collections","utils","usercontrol/photo-player/models/tags"],function(e,t,n,r){var i,s=t.BaseCollection;return i=s.extend({model:r,url:function(){return testpath?testpath+"/media/tags/":"/api/complevelprofile/search/"}}),i}),define("usercontrols/add-club/collections/profile",["facade","collections","utils","models"],function(e,t,n,r){var i,s=r.BaseModel,o=t.BaseCollection;return o.extend({model:e.Backbone.Model.extend(),url:function(){return testpath?testpath+"/seasonprofile/search/":"/api/seasonprofile/search/"}})}),define("text!usercontrols/add-club/templates/layout.html",[],function(){return'<div class="add-club-school-outer">\r\n	<div class="name-outer">\r\n		<label>Name</label>\r\n		<input type="text" class="name-h" class="name" placeholder="Please enter name." />\r\n	</div>\r\n	<div class="club-season-profile">\r\n		<label>Which of these most closely matches the seasons that your club competes?</label>\r\n		<div class="profile-h"></div>\r\n	</div>\r\n	<div class="comptetion-level-type">\r\n		<label>Which best describes the levels your club has?</label>\r\n		<div class="comp-levels-h"></div>\r\n	</div>\r\n	\r\n	<div class="address">\r\n		<label>Address</label>\r\n		<textarea placeholder="Address" max-length rows="3" class="address-h" cols="25"></textarea>\r\n		<span class="address-error hide address-error-status-h"></span>\r\n		<a href="javascript: void(0);" class="verify-address-h">VERIFY ADDRESS</a>		\r\n	</div>\r\n	\r\n	<div class="location-map-h"></div>\r\n	\r\n	<div class="clear location-buttons">\r\n		<a href="javascript: void(0);" class="common-btn common-btn-direction cancel-h" title="cancel">Cancel</a>\r\n		<a href="javascript: void(0);" class="common-btn common-btn-direction finish-h" title="finish">Finish</a>\r\n	</div>\r\n\r\n	\r\n	\r\n</div>'}),define("usercontrol/add-club/collections/complevel",["facade","collections","utils","usercontrol/photo-player/models/tags"],function(e,t,n,r){var i,s=t.BaseCollection;return i=s.extend({model:r,url:function(){return testpath?testpath+"/media/tags/":"/api/complevelprofile/search/"}}),i}),define("usercontrol/add-club/models/adress",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/location/add?address="+this.address:"/api/location/add?address="+this.address}})}),define("usercontrol/add-club/models/add",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/org/add":"/api/org/add"}})}),define("usercontrols/add-club/views/main",["require","text!usercontrols/add-club/templates/layout.html","facade","views","utils","vendor","usercontrol/add-club/collections/complevel","usercontrol/add-club/models/adress","usercontrol/add-club/models/add","usercontrol/dropdown/view/dropdown"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrol/add-club/collections/complevel"),h=e("usercontrol/add-club/models/adress"),p=e("usercontrol/add-club/models/add"),d=e("usercontrol/dropdown/view/dropdown");return PhotoPlayerView=s.extend({template:t,events:{"click .verify-address-h":"verifyAddress","click .finish-h":"addClub","blur .address-h":"verifyAddress"},stateData:{},initialize:function(e){this.model=e.model,this.id=e.id,this.addType=e.addType,this.callback=e.callback,this.addressValid=!1,s.prototype.initialize.call(this,e),this.setUpMainView(),this.render(),this.setProfiles()},openLocationPopup:function(e,t){var n=this;routing.trigger("show_location",e,t,".location-map-h",function(){})},addClub:function(){var e=this,t=!0;if(this.$el.find(".name-h").val()=="")return alert("Please enter name."),!1;if(!this.addressValid)return alert("Please choose valid address"),!1;this.verifyAddress(function(){t&&e.saveData()})},saveData:function(){var e=this,t=new p,n={};n.name=this.$el.find(".name-h").val(),n.complevel_profiles_id=this.$el.find("#comp-levels-h").val(),n.location_id=e.locationId,n.season_profiles_id=this.$el.find("#profile-h").val(),n.sports_club=e.addType=="school"?"0":"1",t.set(n),t.save(),l.when(t.request).done(function(){console.log(t.get("payload"));var r=t.get("payload");n.locationState=e.stateData,n.org_id=r.id,e.callback&&e.callback(n),alert(e.addType+" added successfully"),routing.trigger("popup-close")})},verifyAddress:function(e){var t=this,n=t.$el.find(".address-h").val(),r=new h;t.stateData={},r.address=n,r.url(),r.set({address:n}),r.showError=function(e,n){try{t.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}t.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},r.save({dataType:"json"}),t.$el.find(".address-h").removeClass("address-verified"),l.when(r.request).done(function(){t.locationId=r.get("payload").id,t.stateData=r.get("payload").states_obj,t.locationId?(typeof e!="function"&&t.openLocationPopup(r.get("payload").lat,r.get("payload").lon),t.$el.find(".address-error-status-h").addClass("hide"),t.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),t.addressValid=!0,typeof e=="function"&&e()):t.addressValid=!1})},setProfiles:function(){var e=this,t=e.model.toJSON(),n=e.model.toJSON(),r={};r.records=[];for(var i in n[0].payload){var s=[];for(var o in n[0].payload[i].seasons)s.push(n[0].payload[i].seasons[o].name);r.records.push({payload:{id:n[0].payload[i].id,name:s.join(", ")}})}console.error(t),r.recordId="id",r.recordValue="name";var u=new d({data:r,title:"Club's Season Profile",elementId:"profile-h",destination:".profile-h",targetView:e,callback:function(t){e.getCompLevels()}})},getCompLevels:function(){var e=this;e.compLevel=new c,e.compLevel.fetch(),l.when(e.compLevel.request).done(function(){console.error(e.compLevel);var t=e.compLevel.toJSON(),n={};n.records=[];for(var r in t[0].payload){var i=[];for(var s in t[0].payload[r].levels)i.push(t[0].payload[r].levels[s].name);n.records.push({payload:{id:t[0].payload[r].id,name:i.join(", ")}})}n.recordId="id",n.recordValue="name";var o=new d({data:n,title:"Team",elementId:"comp-levels-h",destination:".comp-levels-h",targetView:e,callback:function(e){}})})},setUpMainView:function(){var e=this,t={};t.type=e.addType;var n=f.to_html(e.template,t);l(e.$el).html(n)}}),PhotoPlayerView}),define("usercontrols/add-club/add-club",["require","text!usercontrols/photo-player/templates/comments.html","facade","controller","models","views","user/models/basic_info","usercontrols/add-club/collections/complevel","usercontrols/add-club/collections/profile","usercontrols/add-club/views/main"],function(e,t){var n=e("facade"),r=e("controller"),i=e("models"),s=e("views"),o=e("utils"),u=n.$,a=n._,f=o.debug,l=o.lib.Channel,c=s.LayoutView,h=n.Backbone,p=e("user/models/basic_info"),d=e("usercontrols/add-club/collections/complevel"),v=e("usercontrols/add-club/collections/profile"),m=e("usercontrols/add-club/views/main");return r.extend({cssArr:["/usercontrols/add-club/add-club.css"],events:{},initialize:function(e){console.log("init");var t=this;l("load:css").publish(this.cssArr),a.bindAll(this),e.id&&(this.id=e.id),e.index&&(this.index=e.index),e.userId&&(this.userId=e.userId),e.type&&(this.type=e.type),this.callback=e.callback,e._collection&&(this._collection=e._collection),this.modelHTML='<div class="add-club-area-h photo-player"></div>',this.setupLayout().render(),this.setUpMainView()},setupLayout:function(){this.scheme=[];var e=new c({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e;var t={};return t.height="500px",t.width="90%",t.title=this.type=="school"?"Add School":"Add Club",routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;e.seasonProfile=new v,e.seasonProfile.fetch(),u.when(e.seasonProfile.request).done(function(){var t=new m({model:e.seasonProfile,name:"add club",destination:"#modalBody",addType:e.type,callback:e.callback});e.scheme.push(t),e.layout.render()})}})}),define("text!usercontrols/location/templates/view-location.html",[],function(){return'<div id="map-canvas" style="width: 90%; height: 300px; margin-top: 40px;"></div>\r\n'}),define("usercontrols/location/views/view-location",["require","text!usercontrols/location/templates/view-location.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=i.BaseView,h=r.Backbone,p;return h.View.extend({template:t,events:{},initialize:function(e){p=this,p.game_id=e.game_id,p.location=e,p.selectedOptions=[],p.setOptions(e),p.render()},intializeMap:function(){console.log(p.location);var e=new google.maps.LatLng(p.location.latitude,p.location.longitude),t={zoom:13,center:e,scaleControl:!0,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.$el.find("#map-canvas")[0],t),this.marker=new google.maps.Marker({position:e,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=f.to_html(e.template,{location:e.locaion});return l(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("text!usercontrols/addevent/templates/layout.html",[],function(){return'<div class="well-large container_add_game">\r\n	<!-- <h4>Add Game</h4> -->\r\n	<!-- <div class="green-left-heading ">DATE</div> -->\r\n<div class="clear"></div>\r\n	<div class="section-individual-game_h displayNone">\r\n		<input type="text"class="txt-individual-game_h" placeholder="Enter Event" />\r\n		<span class="indicator_h"></span>\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-individual-location_h displayNone" placeholder="Enter Location Id"  />\r\n			<div class="clear"></div>\r\n		<button class="btn btn-primary btn-game-individual-Finish_h floatRight displayNone">\r\n			Go There !\r\n		</button>\r\n		<button class="btn btn-primary btn-game-individual-Create_h floatRight displayNone">\r\n			Create !\r\n		</button>\r\n	</div>\r\n	<div class="section-Add-Sports_h">\r\n		<div class="section-game-date_h floatLeft">\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" placeholder="Time" maxlength="5" />\r\n			\r\n			<span class="spn-ddl-time-period_h"></span>\r\n			<!-- <select class="ddl-time-period_h ddlTime">\r\n			<option value="AM">AM</option>\r\n			<option value="PM">PM</option>\r\n			</select> -->\r\n		\r\n			<div class="clear"></div>\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n		<div class="clear"></div>\r\n		<!-- <div class="row-fluid">\r\n			Select Sport:\r\n		</div> -->\r\n	<!-- <div class="green-left-heading">SPORT</div> -->\r\n	<div class="clear"></div>\r\n		<div class="row-fluid section-game-sports_h">\r\n<span class="span-ddl-sports_h">\r\n			<!-- <select class="ddl-game-sports_h"></select> -->\r\n				</span>\r\n			<div class="clear"></div>	\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n<div class="clear"></div>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-game-teams_h team-one_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 1</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 1 :\r\n			<div class="clear"></div>\r\n			<span class="span_ddl_team_h span_ddl_team_one_h"></span>\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a>\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt txt-game-team_h displayNone" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n			<!-- <a href="javascript:void(0)" class="btn-ddl-team-game_h">Choose from select ?</a> -->\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score : \r\n			<input type="text" class="txt-score-team_h" />\r\n		</div>\r\n		<div class="section-game-radio_h">			\r\n			Home &nbsp;<input type="radio" name="rdo-team1_h" value="home" class="rdo-game-location_h rdo-game-location-one-home_h" team="one"> &nbsp;&nbsp;\r\n			Away &nbsp;<input type="radio" name="rdo-team1_h" value="away" class="rdo-game-location_h" team="one">\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n\r\n\r\n	<div class="section-game-teams_h team-two_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 2</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 2 :\r\n			<div class="clear"></div>\r\n			<!-- <span class="span_ddl_team_h span_ddl_team_two_h"></span> -->\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<!-- <a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a> -->\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt-game-team_h" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score :\r\n			<input type="text" class="txt-score-team_h"/>\r\n		</div>\r\n		<div class="section-game-radio_h">\r\n			Home &nbsp;<input type="radio" name="rdo-team2_h" value="home" class="rdo-game-location_h rdo-game-location-two-home_h"  team="two"> &nbsp;&nbsp;\r\n			Away  &nbsp;<input type="radio" name="rdo-team2_h" value="away" class="rdo-game-location_h"   team="two">			\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n<br/>\r\n<br/>\r\n	<div class="section-main-location_h displayNone">\r\n		<!-- <div class="green-left-heading">LOCATION</div> -->\r\n		<!--div class="clear"></div>\r\n		<strong>Location : </strong>		\r\n<div class="clear"></div>\r\n		<input type="text" class="txt-game-location-id_h displayNone"-->\r\n		<div class="location-view-h">&nbsp;</div>\r\n		<input type="hidden" class="txt-game-location-id_h displayNone"/>\r\n		<div class="div-game-location_h"></div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<span class="displayNone field-message field-message_h"></span>\r\n\r\n	<div class="clear"></div>\r\n	<div>\r\n	<button class="btn btn-primary btn-game-Finish_h floatRight displayNone">\r\n		Create ! \r\n	</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n</div>'}),define("usercontrols/addevent/views/main",["require","text!usercontrols/addevent/templates/layout.html","facade","views","utils","vendor","sportorg/collections/sports_listall","location/collections/states","usercontrols/addgame/collections/teams","location/collections/cities","usercontrols/addgame/collections/teams_user","usercontrols/addgame/collections/teams","usercontrols/addgame/collections/games_search","usercontrols/addgame/models/team","usercontrols/addgame/models/team_add","usercontrols/addgame/models/game","usercontrols/addgame/models/uslgamelink","usercontrol/dropdown/view/dropdown","usercontrol/location/views/get-view-location"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/addgame/collections/teams_user"),m=e("usercontrols/addgame/collections/teams"),g=e("usercontrols/addgame/models/team"),y=e("usercontrols/addgame/models/team_add"),b=e("usercontrols/addgame/models/game"),w=e("usercontrols/addgame/collections/games_search"),E=e("usercontrol/dropdown/view/dropdown"),S=e("usercontrol/location/views/get-view-location"),x=e("usercontrols/addgame/models/uslgamelink");return s.extend({template:t,gameData:{},teams:[],events:{"change .ddl-game-sports_h":"changeSport","keyup .txt-game-state_h":"keyupState","blur .txt-game-state_h":"changeState","keyup .txt-game-city_h":"keyupCity","blur .txt-game-city_h":"changeCity","keyup .txt-game-team_h":"keyupTeam","blur .txt-game-team_h":"changeTeam","keyup .txt-individual-game_h":"keyupIndividualGame","blur .txt-individual-game_h":"changeindividualGame","change .ddl-game-userteams_h":"changeUserTeam","click .btn-new-team-game_h":"showAddTeam","click .btn-ddl-team-game_h":"showDdlTeam","click .rdo-game-location_h":"showLocation","click .btn-game-Finish_h":"finishGame","change .txt-game-date_h":"CheckTeamControlsVisibility","click .btn-game-individual-Create_h":"createIndividualEvent","click .btn-game-individual-Finish_h":"goThereIndividualGame"},controls:{sectionAddSports:".section-Add-Sports_h",sectionDate:".section-game-date_h",txtGameDate:".txt-game-date_h",txtGameTime:".txt-game-time_h",spnTimePeriod:".spn-ddl-time-period_h",ddlTimePeriod:".ddl-time-period_h",spnSports:".span-ddl-sports_h",ddlSports:".ddl-game-sports_h",sectionTeams:".section-game-teams_h",ddlUserTeams:".ddl-game-userteams_h",spanddlteam:".span_ddl_team_h",spanddlteamtwo:".span_ddl_team_two_h",spanddlteamone:".span_ddl_team_one_h",btnNewTeam:".btn-new-team-game_h",btnDdlTem:".btn-ddl-team-game_h",sectionNewTeam:".section-new-team_h",txtState:".txt-game-state_h",txtCity:".txt-game-city_h",txtTeam:".txt-game-team_h",txtScore:".txt-score-team_h",btnFinish:".btn-game-Finish_h",sectionTeamOne:".team-one_h",sectionTeamTwo:".team-two_h",sectionScore:".section-score_h",sectionRadio:".section-game-radio_h",rdoTeamOne:".rdo-game-location-one-home_h",rdoTeamTwo:".rdo-game-location-two-home_h",rdoLocation:".rdo-game-location_h",sectionMainLocation:".section-main-location_h",sectionLocation:".div-game-location_h",txtLocationId:".txt-game-location-id_h",sectionIndividual:".section-individual-game_h",txtIndividualGame:".txt-individual-game_h",btnIndividualFinish:".btn-game-individual-Finish_h",txtIndividualLocation:".txt-individual-location_h",btnIndividualGameCreate:".btn-game-individual-Create_h",fieldMessage:".field-message_h",secSports:".section-game-sports_h",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnTimePeriodData:"hdn_time-period_h",hdnTimePeriod:"#hdn_time-period_h",indicator:".indicator_h"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",sportId:"sportid",locationId:"locationid",gameId:"gameid"},inlineTemplates:{},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},tags:{individual:"individual",team:"team",rgxTime:/^(0?[1-9]|1[012])(:[0-5]\d)$/,rgxTimeWhole:/^(0?[1-9]|1[012])$/},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this),l(n.el).find(n.controls.txtGameDate).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});var e=[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],t={};t.records=e,t.recordId="name",t.recordValue="value";var r=new E({data:t,elementId:n.controls.hdnTimePeriodData,destination:n.controls.spnTimePeriod,targetView:n,selectedValue:"PM",callback:function(e){}})},afterRender:function(){var e=this,t=new S({callback:function(t){var n=t!=""?!0:!1;e.$el.find(".btn-game-Finish_h").attr("disable",n),e.$el.find(".txt-game-location-id_h").val(t)}});this.$el.find(".location-view-h").html(t.el)},setOptions:function(e){this.user_id=e.user_id;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null,this.team_id=e.teams_id||null},init:function(){n.setupView()},setupView:function(){n.setUpMainView();if(n.team_id){var e=new g;e.id=n.team_id,e.fetchSuccess=function(t,r){var i=e.parseAsRequired(r);n.team=i,n.sports_id=i.sports_id||null,n.fillSports()},e.fetch()}else n.fillSports()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e)},fillSports:function(){var e=new h;e.processResult=function(t){var r=e.ParseForDropdown();n.SetupSportsView(r)},e.fetch()},SetupSportsView:function(e){n.sports=e;var t={};t.records=n.sports,t.recordId="id",t.recordValue="custom_name";var r=new E({data:t,title:"Select Sport",elementId:n.controls.hdnSportsIdData,destination:n.controls.spnSports,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeSport(e)}})},changeSport:function(e){if(e&&e!=0){l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).fadeIn(),l(n.destination).find("input").attr(n.attributes.sportId,e);var t=n.getTeamType(e);t&&n.fillTeams(e)}else l(n.destination).find(n.controls.btnFinish).fadeOut(),l(n.destination).find(n.controls.sectionTeams).fadeOut(),l(n.destination).find("input").removeAttr(n.attributes.stateId);n.CheckTeamControlsVisibility()},setFirstTeam:function(e){console.log("setFirstTeam");var t=!1;if(n.team_id){for(var r in n.teams)n.teams[r].payload.id==n.team_id&&(t=!0);if(!t)if(n.team)n.setSelectedTeam(n.team);else{var i=new g;i.id=n.team_id,i.fetchSuccess=function(e,t){var r=i.parseAsRequired(t);n.team=r,n.setSelectedTeam(r)},i.fetch()}n.CheckTeamControlsVisibility()}},setSelectedTeam:function(e){console.log("setSelectedTeam");if(e){console.log("data",e);var t=e.team_name,r=e.team_id;l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,r),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.spanddlteamone).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).val(t).show(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.indicator).addClass("valid").removeClass("invalid").show()}},fillTeams:function(e){var t=new v;t.user_id=n.user_id,t.sports_id=e,t.processResult=function(e){var r={team_name:"Team Not Found",id:-1},i=t.AppendItem(r);n.setUpUserTeams(i)};var r=t.fetch()},setUpUserTeams:function(e){n.teams=e||[],n.setFirstTeam(n.team_id);var t={};t.records=n.teams,t.recordId="id",t.recordValue="team_name";var r=new E({data:t,elementId:"hdn_team_id",targetView:n,destination:n.controls.spanddlteamone,selectedValue:n.team_id||null,callback:function(e){n.changeUserTeamOne(e)}})},changeUserTeamOne:function(e){console.log("result1",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamOne).find("input:checked").removeAttr("checked"),n.showLocation())},changeUserTeamTwo:function(e){console.log("result",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamTwo).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamTwo).find("input:checked").removeAttr("checked"),n.showLocation())},showAddTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.spanddlteam).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).show(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},showDdlTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).val("").hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.ddlUserTeams).val("").show(),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},keyupState:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.stateId),n.CheckTeamControlsVisibility();var i=new p;i.state_name=l(e.target).val(),console.log("State Request Abort Request Function AddGame/Main.js"),n.stateFetchRequest=n.stateFetchRequest||[],n.stateFetchRequest.push(n.cityFetchRequest||[]),n.stateFetchRequest.push(n.teamFetchRequest||[]),n.stateFetchRequest=n.abortRequest(n.stateFetchRequest),l(e.target).addClass("ui-autocomplete-loading");var s=i.fetch();n.stateFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.states=[];for(var s in t)n.states.push(t[s].payload);n.states.forEach(function(e,t){r.push(e.name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else n.changeState(e)},changeState:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.stateId);var r=!1;n.states_id="",n.states&&n.states.forEach(function(i,s){i["name"]==t&&(r=!0,n.states_id=i.id,l(e.target).attr(n.attributes.stateId,n.states_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).attr(n.attributes.stateId,n.states_id).fadeIn(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).attr(n.attributes.stateId,n.states_id).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide())}),r||(n.states_id=0,l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).removeAttr(n.attributes.stateId).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).removeAttr(n.attributes.stateId).fadeOut()),n.CheckTeamControlsVisibility()},keyupCity:function(e){var t=l(e.target).val(),r=[];if(t.length>2)if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.cityId),n.CheckTeamControlsVisibility();var i=new d;i.states_id=n.states_id,i.city_name=l(e.target).val(),n.cityFetchRequest=n.cityFetchRequest||[],n.cityFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.cityFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.cityFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.cities=[];for(var s in t)n.cities.push(t[s]);n.cities.forEach(function(e,t){r.push(e.city)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeCity(e)},changeCity:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.cityId);var r=!1;n.city_id="",n.cities&&n.cities.forEach(function(i,s){i["city"]==t&&(r=!0,n.city_id=i.id,l(e.target).attr(n.attributes.cityId,n.city_id))}),r||(n.city_id=0),n.CheckTeamControlsVisibility()},keyupTeam:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility();var s=new m;s.states_id=l(e.target).attr(n.attributes.stateId),s.city_id=l(e.target).attr(n.attributes.cityId),s.sports_id=l(e.target).attr(n.attributes.sportId),s.team_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.TeamFetchRequest=n.abortRequest(n.TeamFetchRequest);var o=s.fetch();n.TeamFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.teams=[];for(var i in t)n.teams.push(t[i].payload);n.teams.forEach(function(e,t){r.push(e.team_name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeTeam(e)},changeTeam:function(e){var t=l(e.target).val(),r=!1;n.team_id=0,n.teams&&n.teams.forEach(function(i,s){var o=i.team_name;o==t&&(r=!0,n.team_id=i.id,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())});if(n.team){var i=n.team.team_name,s=n.team.team_id;i==t&&(r=!0,n.team_id=s,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())}r||(l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show()),n.CheckTeamControlsVisibility()},keyupIndividualGame:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility();var s=new w;s.game_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.individualGameFetchRequest=n.abortRequest(n.individualGameFetchRequest);var o=s.fetch();n.individualGameFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.eventNotFound(e):(n.eventFound(e),n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut()),n.individualGames=[];for(var i in t)n.individualGames.push(t[i].payload);n.individualGames.forEach(function(e,t){var n=e.event_name+" "+e.game_name;r.push(n)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r,select:function(e,t){n.individualGames.forEach(function(e,r){console.log(t.item.label+"----"+i);var i=e.event_name+" "+e.game_name;t.item.label==i&&(n.individual_game_id=e.id)}),n.$el.find(".section-main-location_h").hide(),n.$el.find(".section-game-date_h").hide()}}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeIndividualGame(e)},changeIndividualGame:function(e,t){var r=l(e.target).val(),i=!1;n.individual_game_id=0,n.individualGames&&n.individualGames.forEach(function(t,s){var o=t.event_name+" "+t.game_name;o==r&&(i=!0,n.individual_game_id=t.id,l(e.target).attr(n.attributes.gameId,n.individual_game_id))}),i?n.eventFound(e):n.eventNotFound(e),n.CheckTeamControlsVisibility()},eventNotFound:function(e){this.$el.find(".section-main-location_h").show(),this.$el.find(".section-game-date_h").show(),l(n.destination).find(n.controls.btnIndividualGameCreate).show(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.gameId)},eventFound:function(e){this.$el.find(".section-main-location_h").hide(),this.$el.find(".section-game-date_h").hide(),l(n.destination).find(n.controls.btnIndividualGameCreate).hide(),l(n.destination).find(n.controls.btnIndividualFinish).show(),l(e.target).parent().find(n.controls.fieldMessage).html(n.messages.gameFound).fadeIn()},createIndividualEvent:function(e){var t=!0,r="",i=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),s=l(n.destination).find(n.controls.txtGameTime).val(),o=l(n.destination).find(n.controls.hdnTimePeriod).val(),u=n.location_id||l(n.controls.txtLocationId).val()||0,a=l(n.destination).find(n.controls.txtIndividualGame).val(),f=l(n.destination).find(n.controls.hdnSportsId).val();f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),t=!1);if(!i||!s)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),t=!1;else{var c=s.match(n.tags.rgxTime)||s.match(n.tags.rgxTimeWhole);console.log("orginal date",i),console.log("orginal time",s),console.log("timeZone",o);if(!c)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),t=!1;else{l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut();try{var h=s.split(":");h&&(console.log(h),o!="PM"&&h[0]!="12"&&i.setHours(h[0]),h.length>1&&i.setMinutes(h[1]),o=="PM"&&i.addHours(12))}catch(p){}}console.log("new date",i)}u||(r+=n.messages.selectLocation,t=!1),l.trim(a)==""&&(r+="<br/>"+n.messages.enterEventName,t=!1);if(t){var d=i;l(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut();var v={game_datetime:d,locations_id:u,event_name:a,sports_id:f,users_id:n.user_id},m=new b(v);m.save({}),l.when(m.request).done(function(e){routing.trigger(n.channel,e)})}else l(e.target).parent().find(n.controls.fieldMessage).html(r).fadeIn()},goThereIndividualGame:function(e){var t=l(n.destination).find(n.controls.hdnSportsId).val(),r={users_id:n.user_id,sports_id:t,games_id:n.individual_game_id},i=new x(r);i.save(),l.when(i.request).done(function(e){n.goThereSuccess(e)})},goThereSuccess:function(e){if(e&&e.payload!=null){var t=e.payload.game;t&&(n.gameData={type:n.tags.individual,game_datetime:t.gameDay,event_name:t.event_name,game_location:t.game_location,games_id:t.id,sports_id:e.payload.usl?e.payload.usl.sports_id:null},routing.trigger(n.channel,n.gameData))}},CheckTeamControlsVisibility:function(){var e=l(n.destination).find(n.controls.hdnSportsId).val();if(e&&e!=""&&e!=0){var t=n.getTeamType(e);if(!t)l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionIndividual).show();else{var r=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),i=new Date;r!=null&&i>=r?l(n.destination).find(n.controls.sectionScore).show():(l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.txtScore).val("")),l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controlsbtnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).show(),l(n.destination).find(n.controls.sectionMainLocation).show()}}else l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionMainLocation).hide();e=l(n.destination).find(n.controls.txtTeam).attr(n.attributes.teamId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnTeamDone).show():l(n.destination).find(n.controls.btnTeamDone).hide()},getTeamType:function(e){if(e&&e!=""&&e!=0){var t=!0;console.log("getteamtype",e);for(var r in n.sports)n.sports[r].payload.id==e&&(console.log("payload",n.sports[r].payload),n.sports[r].payload.team_type=="Individual"&&(t=!1));return t}return!1},showLocation:function(e){l(n.destination).find(n.controls.sectionMainLocation).show();var t=0,r=e?l(e.target).val():"away";if(r=="home")t=l(e.target).attr(n.attributes.teamId);else{var i=l(n.destination).find(n.controls.rdoLocation+":checked");i.each(function(){r=l(this).val(),r=="home"&&(t=l(this).attr(n.attributes.teamId))})}if(t){var s=new g;s.id=t,s.fetchSuccess=function(e,t){var r=s.parseAsRequired(t);n.setLocation(r)},s.fetch()}else l(n.destination).find(n.controls.txtLocationId).val("").fadeIn(),n.clearLocation()},setLocation:function(e){e.location_id?(n.location_id=e.location_id||0,l(n.destination).find(n.controls.txtLocationId).val("").fadeOut(),l(".address-h").val(e.location_name),l(".txt-game-location-id_h").val(e.location_id),l(".verify-address-h").trigger("click")):l(n.destination).find(n.controls.txtLocationId).val("").fadeIn()},clearLocation:function(){l(".address-h").val(""),l(".txt-game-location-id_h").val("")},finishGame:function(){l(n.destination).find(n.controls.fieldMessage).html("").hide();var e=!0,t=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),r=l(n.destination).find(n.controls.txtGameTime).val(),i=l(n.destination).find(n.controls.hdnTimePeriod).val(),s=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).attr(n.attributes.teamId),o=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtScore).val(),u=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtTeam).attr(n.attributes.teamId),a=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtScore).val(),f=l(n.destination).find(n.controls.hdnSportsId).val(),c=n.location_id||l(n.controls.txtLocationId).val()||0;f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),e=!1);if(!t||!r)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),e=!1;else{var h=r.match(n.tags.rgxTime)||r.match(n.tags.rgxTimeWhole);console.log("orginal date",t),console.log("orginal time",r),console.log("timeZone",i);if(!h)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),e=!1;else{l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut();try{var p=r.split(":");p&&(console.log(p),console.log(p[0]),i!="PM"&&p[0]!="12"&&t.setHours(p[0]),p.length>1&&t.setMinutes(p[1]),i=="PM"&&t.addHours(12))}catch(d){}}}console.log("new date",t),c||(l(n.destination).find(n.controls.sectionMainLocation).find(n.controls.fieldMessage).html(n.messages.selectLocation).fadeIn(),e=!1),s>0||(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1);var v=n.getTeamType();if(v){var m=new Date;u>0||(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1)}if(e){var g=t,w={game_datetime:g,locations_id:c,teamOneId:s,teamTwoId:u,sports_id:f,users_id:n.user_id},E=new b(w);E.save({}),l.when(E.request).done(function(e){if(e!=null&&e.payload!=null){n.game_id=e.payload.id;var t=l(n.destination).find(n.controls.rdoTeamOne).is(":checked"),r={game_datetime:g,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:o},i=new y(r);i.teams_id=s,i.save();var c={game_datetime:g,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:a};t=l(n.destination).find(n.controls.rdoTeamTwo).is(":checked");var h=new y(c);h.teams_id=u,h.save(),n.gameData={type:n.tags.team,game_datetime:g,games_id:n.game_id,team_id_one:s,team_id_two:u,sports_id:f},routing.trigger(n.channel,n.gameData)}})}}})}),define("usercontrols/addevent/addevent",["require","text!usercontrols/addevent/templates/layout.html","facade","controller","models","views","user/models/basic_info","usercontrols/addevent/views/main"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("user/models/basic_info"),d=e("usercontrols/addevent/views/main"),v=i.extend({cssArr:["/usercontrols/addevent/addevent.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.sports_id&&(this.sports_id=e.sports_id),e.users_id&&(this.users_id=e.users_id),this.callback=e.callback,e.popup&&(this.popup=!0,this.modelHTML='<div id="modalPopup" class="modal hide fade model-popup-h add-game-modal"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h3>Add Event</h3></div><div class="modal-body page-content-h"></div></div>'),this.init(),this},init:function(){this.popup?this.setupPopupLayout().render():this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setupPopupLayout:function(){var e;this.scheme=[];var e=new h({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e,this.modelBoxId="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);var t={};return t.height="500px",t.width="90%",t.title="Add Event",t.id=this.modelBoxId,routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;routing.off("add-event-success"),routing.on("add-event-success",function(t){e.addTeamFunction(t)});var n=this;this.addGameView=new d({model:new p,template:t,name:"add-event-main",destination:this.popup?"#"+this.modelBoxId+" #modalBody":"#main",user_id:n.users_id,channel:"add-event-success",sports_id:this.sports_id,teams_id:this.teams_id}),this.scheme.push(this.addGameView),this.layout.render(),a("#modalPopup .modal-body").slimScroll({height:"430px",railVisible:!0,allowPageScroll:!0,disableFadeOut:!0})},addTeamFunction:function(e){this.callback&&this.callback(e)}});return v}),define("text!usercontrols/detection/templates/browser.html",[],function(){return'{{#old_ie}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/ie.png" /></div>\r\n	<div class="notify-text">It appears you\'re using an old version of IE ({{current_version}}).  Unfortunately our site is still in beta and we are not yet supporting versions older than IE 10.<br/><br/>If you\'re on Windows XP and are unable to upgrade to this version, please consider using Google Chrome, which is an outstanding browser that I recommend not just for this website, but for all websites.</div>\r\n	<div id="recommendations">\r\n		<span class="largeText">Here are the browsers we recommend (in order of preference)</span>\r\n		<div class="r-item"><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank"><img src="http://cdn.athletez.com/resources/img/chrome.png" /><br/>Chrome 30+</a></div>\r\n		<div class="r-item"><a href="http://support.apple.com/downloads/#safari" target="_blank"><img src="http://cdn.athletez.com/resources/img/safari.png" /><br/>Safari 5+</a> </div>\r\n		<div><a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="http://cdn.athletez.com/resources/img/ff.png" /><br/>Firefox 25+</a></div>\r\n	</div>\r\n{{/old_ie}}\r\n{{#old_ff}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/ff.png" /></div>\r\n	<div class="notify-text">It appears you\'re using an old version of Firefox ({{current_version}}).  Unfortunately our site is still in beta and we are not yet supporting versions older than Firefox 25.  Please consider using Google Chrome, which is an outstanding browser that I recommend not just for this website, but for all websites.<br/><br/>You can disregard this message and try to use the site, but annoying stuff is going to happen and it will make you angry and us embarrassed.</div>\r\n	<div id="recommendations">\r\n		<span class="largeText">Here are the browsers we recommend (in order of preference)</span>\r\n		<div class="r-item"><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank"><img src="http://cdn.athletez.com/resources/img/chrome.png" /><br/>Chrome 30+</a></div>\r\n		<div class="r-item"><a href="http://support.apple.com/downloads/#safari" target="_blank"><img src="http://cdn.athletez.com/resources/img/safari.png" /><br/>Safari 5+</a> </div>\r\n		<div><a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="http://cdn.athletez.com/resources/img/ff.png" /><br/>Firefox 25+</a></div>\r\n	</div>\r\n{{/old_ff}}\r\n{{#mobile}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/mobile.png" /></div>\r\n	<div>Looks like you\'re on a mobile browser.  Though it\'s high up on our priority list, Athletez is still in beta and we don\'t yet have support for mobile devices.  So trying to navigate on your phone will drive you insane.  If you don\'t want to go insane, maybe hold off on trying out Athletez until you get home.</div>\r\n{{/mobile}}\r\n\r\n<div style="float: left; margin: 10px;">Sorry for the inconvenience,<br/>Mike &amp; Max</div>'}),define("text!usercontrols/detection/browser.css",[],function(){return".curr-browser{\r\n    float:left;\r\n    width: 15%;\r\n}\r\n.curr-browser img{\r\n    width:100%;\r\n}\r\n.notify-text{\r\n    float: right;\r\n    width: 75%;\r\n    height: 120px;\r\n    padding: 10px;\r\n}\r\n#recommendations{\r\n    text-align: center;\r\n    display: block;\r\n    width: 100%;\r\n    float: left;\r\n    margin-top: 35px;\r\n}\r\n#recommendations span{\r\n    display: block;\r\n    font-size: 1.2em;\r\n    font-weight: bold;\r\n}\r\n#recommendations div{\r\n    display: inline-block;\r\n    width: 100px;\r\n    margin:9px;\r\n}\r\n#recommendations div img{\r\n}"}),function(e,t,n){var r,i;e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0",platform:n[0]||""}},r=e.uaMatch(t.navigator.userAgent),i={},r.browser&&(i[r.browser]=!0,i.version=r.version),r.platform&&(i[r.platform]=!0),i.chrome||i.opr?i.webkit=!0:i.webkit&&(i.safari=!0),i.rv&&(i.msie=!0),i.opr&&(i.opera=!0),e.browser=i}(jQuery,window),define("browser",function(){}),define("browserpop/views/browser",["require","text!usercontrols/detection/templates/browser.html","text!usercontrols/detection/browser.css","facade","views","utils","vendor","browser"],function(e){var t,n=e("facade"),r=e("views"),i=r.SectionView,s=e("utils"),o=s.lib.Channel,u=e("vendor"),a=u.Mustache,f=n.$,l=r.BaseView,c=n.Backbone,h,p=e("text!usercontrols/detection/templates/browser.html");return c.View.extend({template:p,events:{"click .close":"closePopup"},cssArr:["usercontrols/detection/browser.css"],initialize:function(e){o("load:css").publish(this.cssArr),h=this,h.data={},h.selectedOptions=[],h.setOptions(e),h.populateData()},populateData:function(){var e=this,t=setInterval(function(){try{f.browser.android,clearInterval(t);if(f.browser.ipad||f.browser.iphone||f.browser.android)e.data.mobile=!0;f.browser.msie&&(e.data.old_ie=!0),f.browser.mozilla&&(e.data.old_ff=!0),e.data.current_version=f.browser.version,e.render()}catch(n){}},500)},render:function(){var e=this,t=a.to_html(e.template,e.data),n={};return n.width="90%",n.height="500px",n.title="Your Browser Might be an Issue",n.html=t,n.id="Browser-detect",console.error(n),routing.trigger("common-popup-open",n),this},setOptions:function(e){for(var t in e)this[t]=e[t]},closePopup:function(){}})}),define("application",["facade","utils","collections","chrome","controller","profile","imageup","home","videopreview","game","team","registration","profilesetting","userresume","packages/site/collections/phrases","usercontrols/tag/tag","usercontrols/addgame/addgame","signup","login","usercontrols/photo-player/photo-player","usercontrols/add-club/add-club","utils/storage","usercontrols/location/views/view-location","signup/views/facebooksignup","usercontrols/addevent/addevent","chrome/views/header","browserpop/views/browser"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){var C,k=n.ApplicationStates,L=e.$,A=e._,O=e.Backbone,M=t.lib.Channel,_=require("browserpop/views/browser");return debug=t.debug,C=O.Router.extend({routes:{"":"defaultRoute",home:"showHome","home/":"showHome","home/:action":"initApp",profile:"showProfile","profile/":"showProfile","profile/:userid":"showProfile",usersettings:"showProfileSetting","usersettings/":"showProfileSetting",resume:"ShowUserResume","resume/":"ShowUserResume",game:"showGame","game/":"showGame","game/:id":"showGame",team:"showTeam","team/":"showTeam","team/:id":"showTeam",registration:"showRegistration","registration/":"showRegistration","registration/:action":"showRegistration",tag:"showTag","user/login":"showLogin",addgame:"showAddGame",fbconnect:"showFbreg",logout:"callLogout"},initialize:function(e){A.bindAll(this),this.addSubscribers(),i.prototype.appStates=new k,this.getPhrases()},detectBrowser:function(){var e=this,t=setInterval(function(){try{L.browser.android,clearInterval(t);var n=showMobileWindow=!1;if(L.browser.ipad||L.browser.iphone||L.browser.android)showMobileWindow=!0;!A.isUndefined(L.browser.msie)&&L.browser.msie&&parseInt(L.browser.version)<10&&(n=!0),!A.isUndefined(L.browser.version)&&L.browser.mozilla&&parseInt(L.browser.version)<25&&(n=!0),(n||showMobileWindow)&&e.showBrowserWindow()}catch(r){}},1e3)},showBrowserWindow:function(){var e=new _},getUserName:function(e){var t=new E("user","localStorage"),n;if(t.data)for(var r in t.data)if(r==e){n=t.data[r].user_name;break}return n?n:!1},intializeImageAndVideo:function(){this.imageUpListeners(),this.videoPreview(),this.showUsercreate(),this.showHomeRefresh(),this.showLogin(),this.triggerSignup()},cancelAjaxRequests:function(){if(typeof routing!="undefined"&&typeof routing.ajaxRequests!="undefined"&&routing.ajaxRequests.length)for(var e in routing.ajaxRequests)routing.ajaxRequests[e].abort()},initTriggers:function(){routing.off("photo-player-init"),routing.on("photo-player-init",function(e,t,n,r){var i=new b({index:e,userId:n,_collection:t,array:r})}),routing.off("add-school-init"),routing.on("add-school-init",function(e,t,n,r){var i=new w({type:n,callback:r})});var e=undefined;routing.off("show_location"),routing.on("show_location",function(t,n,r,i){e=i;var s={latitude:t,longitude:n},o=new S(s);L(r).html(o.$el)}),routing.off("popup-close"),routing.on("popup-close",function(){L("#modalPopup").modal("hide"),L(".model-popup-h").remove(),e&&e()})},initialiRoutesInit:function(e,t){var n=this,r=function(){L(".modal:not(#Browser-detect)").remove(),routing.trigger("common-popup-close")};this.hideSignup(),L("body").removeClass("homePage"),routing.off("app-inited"),routing.on("app-inited",function(t){r(),e(t)}),routing.off("popup-close"),routing.on("popup-close",function(e){e?(L(e.currentTarget).modal("hide"),L(e.currentTarget).unbind().remove()):(L("#modalPopup").modal("hide"),L("#modalPopup").unbind().remove()),routing.trigger("common-popup-close")}),routing.off("common-popup-open"),routing.on("common-popup-open",function(e){if(!e.id)var t="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);else var t=e.id;var n='<div id="'+t+'" class="modal common-modal hide fade model-popup-h in">'+'<div class="modal-header"><a href="javascript: void(0);" title="close" data-id="'+t+'" class="close"'+'>&times;</a><h3 class="modal-header-h">Header</h3></div>'+'<div class="modal-body page-content-h" id="modalBody"></div>'+"</div>";L("body").append(n),e.title?(L("#"+t).find(".modal-header-h").html(e.title),L("#"+t).find(".modal-header").show()):L("#"+t).find(".modal-header").hide(),e.width&&L("#"+t).css({width:e.width}),e.height&&L("#"+t).css({height:e.height}),e.html&&L("#"+t).find("#modalBody").html(e.html),L("#"+t).modal("show"),L("#"+t).find("#modalBody").slimScroll({height:e.height?e.height:"400px",railVisible:!0,allowPageScroll:!0,disableFadeOut:!0})}),routing.off("common-popup-close"),routing.on("common-popup-close",function(e){L(".common-modal:not(#Browser-detect)").remove(),L(".common-modal").length||L(".modal-backdrop").remove()}),L(document).off("hidden.bs.modal","#modalPopup, #photoPlayerModal"),L(document).on("hidden.bs.modal","#modalPopup, #photoPlayerModal",function(e){routing.trigger("popup-close",e)}),L(document).off(".common-modal .close"),L(document).on("click",".common-modal .close",function(e){var t=L(e.currentTarget).data("id");L("#"+t).remove(),L(".common-modal").length||L(".modal-backdrop").remove()}),routing.off("add-game"),routing.on("add-game",function(e,t,n,r,i){var s=new m({teams_id:t,sports_id:n,users_id:r,id:e,popup:!0,callback:i})}),routing.off("add-event"),routing.on("add-event",function(e,t,n,r){var i=new T({sports_id:t,users_id:n,popup:!0,callback:r})}),this.detectBrowser()},checkForUser:function(){return!A.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},defaultRoute:function(){this.initApp()},initApp:function(e){ga("send","event","app","initialized","Browser Reload"),this.showHome(null)},getPhrases:function(){var e=new d;e.fetch()},showFbreg:function(){ga("send","event","popup","open","FB Reg"),fbregistration=new x,fbregistration.signupFacebook()},gaPageView:function(e,t){ga("send","pageview",{page:e,title:t})},showHome:function(e){function n(e){L("body").addClass("homePage");var n="Athletez - We Are Athletez";t.currentController=new u({route:"",title:n,userId:e}),!e&&L("div.register-wrapper").length==0&&L("body header").after('<div class="register-wrapper"></div><div class="register-wrapper-h"></div>'),t.gaPageView("Home Page",n)}var t=this;this.cancelAjaxRequests(),this.loadStyles(),r(),this.initialiRoutesInit(n)},removeCurrent:function(){this.currentController&&console.log(this.currentController.layout)},showProfile:function(e){function n(n){M("refresh-profilepage").empty();var r=t.getUserName(n);t.currentController=new s({userId:typeof e!="undefined"?e:n,title:r}),t.gaPageView("Profile Page",r)}var t=this;this.cancelAjaxRequests(),t.loadStyles(),r(),this.initialiRoutesInit(n)},hideSignup:function(){L("div.register-wrapper").remove(),L("div.register-wrapper-h").remove()},notFound:function(e){alert("Page not found")},showTeam:function(e){function n(n){t.currentController=new l({teamId:e,title:"Team Page",userId:n}),t.gaPageView("Team Page","NA")}var t=this;this.cancelAjaxRequests(),this.loadStyles(),r();if(!e){this.notFound("team");return}t.removeCurrent(),this.initialiRoutesInit(n)},imageUpListeners:function(){function e(e,t,n){var r=new o({route:"",url:e,attr:t,data:n})}this.addImageTrigger(e)},addImageTrigger:function(e){routing.off("add-image"),routing.on("add-image",function(t,n,r){console.log(t,n,r);if(!this.checkForUser()){routing.trigger("showSignup");return}e(t,n,r)})},showProfileSetting:function(e){function n(n){self.currentController=new h({id:e==undefined?n:e,title:"Profile Settings"}),t.gaPageView("Profile Settings","NA")}this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent();var t=this;this.initialiRoutesInit(n)},ShowUserResume:function(e){function t(t){self.currentController=new p({id:e==undefined?t:e}),self.gaPageView("User Resume Page","NA")}this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(t)},imageUp:function(){function e(e){var t=new o({route:"",url:this.posturl,attr:this.attribute})}this.cancelAjaxRequests(),this.loadStyles(),this.initialiRoutesInit(e)},triggerSignup:function(){this.signup=new N,routing.off("showSignup"),routing.on("showSignup",function(){try{this.signup.signupUser()}catch(e){try{console.log(e)}catch(e){console={},console.log=function(e){}}}})},videoPreview:function(){function t(t,n){if(!e.checkForUser()){routing.trigger("showSignup");return}var r=new a({url:t,attr:n})}this.cancelAjaxRequests(),this.loadStyles();var e=this;M("add-video").subscribe(t)},showGame:function(e){function n(n){self.currentController=new f({route:"",gameId:e,title:"Game Page",userId:n}),t.gaPageView("Game Page","NA")}this.cancelAjaxRequests(),this.loadStyles(),r();if(!e){this.notFound("team");return}this.removeCurrent();var t=this;this.initialiRoutesInit(n)},showRegistration:function(){function e(){self.currentController=new c({route:"",title:"Register"}),self.gaPageView("Registration Page","NA")}ga("send","event","popup","Registration"),this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(e)},showTag:function(e){function t(t){self.currentController=new v({id:e==undefined?t:e})}this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(t)},showAddGame:function(e){function t(t){self.currentController=new m({id:e==undefined?t:e})}ga("send","event","popup","Add Game","",e),this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(t)},RefreshHome:function(){r()},showHomeRefresh:function(){this.addHomeTrigger(this.initApp)},addHomeTrigger:function(e){routing.off("reload-home"),routing.on("reload-home",function(){e()})},showLogin:function(){},showUsercreate:function(){function e(){var e=new g({route:""})}this.addUserTrigger(e)},addUserTrigger:function(e){routing.off("add-user"),routing.on("add-user",function(){e()})},showRegistration:function(){function e(){var e=new c({route:"",title:"Register"})}this.cancelAjaxRequests(),this.loadStyles(),r(),this.initialiRoutesInit(e)},loadStyles:function(){M("load:css").publish([base_url+"css/bootstrap.css",base_url+"css/bootstrap-responsive.css",base_url+"css/app.css",base_url+"css/common.css",base_url+"css/jquery-ui-1.10.2.custom.css"])},addSubscribers:function(){M("load:css").subscribe(this.loadCss)},removeSubscribers:function(){M("load:css").unsubscribe(this.loadCss)},callLogout:function(){ga("send","event","menu","Log Out","Action-Triggered",routing.userLoggedIn),this.logout=new y,routing.trigger("Logout")},getStoredState:function(e,t){var n,r;return n=this.states.findByNameInStorage(e),A.isString(t)&&n&&n.data&&(r=n.data[t]),r||n},show:function(e){e=e||"body",L(e).removeClass("hide")},hide:function(e){e=e||"body",L(e).addClass("hide")},cssLoaded:[],loadCss:function(e){var n,r;if(!A.isArray(e))throw new Error("App method addCss expects an array");for(n=0;n<e.length;n++)r=e[n],A.isString(r)&&L.inArray(r,this.cssLoaded)<0&&(t.lib.loadCss(r),this.cssLoaded.push(r))}}),C}),define("votes/views/vote-section",["require","text!votes/templates/vote.html","views","vendor","facade","utils","jqueryui","controller","votes/models/vote","votes/models/follow"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("votes/models/vote"),d=e("votes/models/follow");return n=o.extend({template:t,events:{"click .team-action-h":"vote","click .follow-action-h":"follow"},vote:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.voteModelOb.save(),u.when(this.voteModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")})},follow:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.followModelOb.save(),u.when(this.followModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")}),h("new-fan").publish()},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){var t=this;a.bindAll(this),o.prototype.initialize.call(this,e)},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=this.model.get("payload");r.has_voted?this.$el.find(".team-action-h").addClass("link-disabled"):(this.voteModelOb=new p,this.voteModelOb.subject_id=r.id,this.voteModelOb.entity_id=r.enttypes_id,this.voteModelOb.setData()),r.is_following?this.$el.find(".follow-action-h").addClass("link-disabled"):(this.followModelOb=new d,this.followModelOb.subject_id=r.id,this.followModelOb.entity_id=r.enttypes_id)}}),n}),define("profile/models/basics",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("profile/collections/orgs",["facade","sportorg/collections/orgs","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/orgs/"+this.id+"/"+this.sport_id:"/api/user/orgs/"+this.id+"?sport_id="+this.sport_id}}),r}),define("user/models/related",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{user_id:0,user_name:null,user_picture:null,teams:[{sport:null,position:null,org:null,season:null,year:null}],num_votes:0,num_followers:0},desc:"Related user information about the user",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("user/collections/relateds",["facade","collections","user/models/related","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("profile/collections/relateds",["facade","user/collections/relateds","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?"/test/user/related/"+this.id+"/"+this.sport_id:"/api/user/related/"+this.id+"?sport_id="+this.sport_id}}),r}),define("user/models/fitnessbasic",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,val:null,units:null},desc:"Fitness Basic information about the user",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("user/collections/fitnessbasics",["facade","collections","user/models/fitnessbasic","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5);var o=[];for(var u in r[i].data)o.push(r[i].data[u]);o={data:o},s.set("payload",o),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profile/collections/fitnessbasics",["facade","user/collections/fitnessbasics","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/rdtree/"+this.id+"/?overview=1&sports_id="+this.sport_id:"/api/user/rdtree/"+this.id+"?overview=1&sports_id="+this.sport_id}}),r}),define("profile/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/videos/"+this.id+"/"+this.sport_id:"/api/user/videos/"+this.id+"?sport_id="+this.sport_id}}),r}),define("profile/collections/image-videos",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/media/"+this.id+"/"+this.sport_id:"/api/user/media/"+this.id+"?sport_id="+this.sport_id}}),r}),define("profile/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/comment/getall/"+this.id:"/api/comment/getall/?subject_enttypes_id="+this.subject_entity_type+"&subject_id="+this.id}}),r}),define("schedules/collections/user-games",["facade","collections","sportorg/models/team","utils"],function(e,t,n,r){var i=t.BaseCollection,s=e._,o=r.lib.Channel;return i.extend({userId:undefined,sports_id:undefined,model:e.Backbone.Model.extend({}),url:function(){return"/api/user/games/"+this.userId+"?sports_id="+this.sports_id},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}console.log("Updtaed Collection",e),e.deferred.resolve(t)}})}),define("profile/collections/fans",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/followers/"+this.id+"/"+this.sport_id:"/api/user/followers/"+this.id+"?sport_id="+this.sport_id}}),r}),define("text!profile/templates/header.html",[],function(){return'{{#payload}}\r\n<div class="row-fluid">\r\n	\r\n	<div class="profile-heading">\r\n		<div class="sports-h"></div>\r\n            <h3 class="username">{{name}} {{#grad_year}}\'{{grad_year}}{{/grad_year}}</h3>\r\n			<h3>&nbsp;</h3>\r\n    </div>\r\n	\r\n	<div class="row-fluid profile-pic-outer">\r\n		<div class="span7 border-right">\r\n			<ul class="span6 textcenter image-outer-h">\r\n			</ul>\r\n		    <!--div class="span6 textcenter">\r\n		        {{#user_picture_obj}}\r\n		        <img src="{{base_url}}{{image_path}}" alt="{{name}}" />\r\n			    <div id="votes-area-h"></div>\r\n		        {{/user_picture_obj}}\r\n		    </div-->\r\n		    \r\n		    <div class="span6">\r\n			    	<!--<div class="school-name">ORG NAME</div>\r\n			    	<div class="city">LOCATION</div>-->\r\n			    	<div class="teams">\r\n			    		 <div id="sports-info"></div>\r\n			    	</div>\r\n			    	<div class="height">{{#height_ft}}{{height_ft}}{{/height_ft}}</div>\r\n			    	<div class="weight">{{#weight_lb}}{{weight_lb}} lbs{{/weight_lb}}</div>\r\n	       </div>\r\n	    </div>\r\n	    \r\n	    <div class="stats-panel span5" style="width:35%;">\r\n	    	<div class="stats-header"><span id="profileName"></span>Stats</div>\r\n	    	<div id="fitnessbasic-wrap"></div>\r\n	    </div>\r\n	</div>    \r\n    \r\n   </div>\r\n    \r\n</div>\r\n{{/payload}}\r\n'}),define("text!profile/templates/sports.html",[],function(){return'{{#payload}}\r\n    <img src="{{large_icon}}" class="sports-icon-h" data-name="{{sport_name}}" data-id="{{id}}" />\r\n{{/payload}}\r\n'}),define("profile/collections/sports",["facade","sportorg/collections/sports","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/sports/"+this.id:"/api/user/sports/"+this.id}}),r}),define("text!profile/templates/sport-team.html",[],function(){return'{{#records}}\r\n	<div class="teamlist-header">{{payload.name}}</div>\r\n	{{#payload.sports}}\r\n	{{#teams}}\r\n	    <span class="team-item"><a href="/#team/{{id}}">{{complevel}} {{season}} {{year}}</a></span>\r\n    {{/teams}}\r\n    {{/payload.sports}}\r\n    <br/>\r\n{{/records}}'}),define("profile/collections/teams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return"/api/user/teamlist/"+this.id+"?sports_id="+this.sports_id}}),r}),define("text!sportorg/templates/team-item.html",[],function(){return'\r\n	<!--<a href="/#game/{{id}}" class="background-blue team-info-h" tooltip="test">\r\n	<div class="game-info hide">\r\n		{{summary}}\r\n	</div> </a>\r\n-->'}),define("sportorg/views/team-item",["vendor","views","utils","text!sportorg/templates/team-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"team",events:{"mouseover .team-info-h":"showinfo","mouseout .team-info-h":"showinfo"},showinfo:function(e){e.preventDefault(),s(e.target).parents(".game-info").length||(s(e.target).find(".game-info").hasClass("hide")?s(e.target).find(".game-info").removeClass("hide"):s(".game-info").addClass("hide"))},initialize:function(e){this.teams_id=e.teams_id||null,console.log("Teams_id:",e),this.mpay=this.model.get("payload"),console.log("Team Item View",this.mpay),this.template=r},render:function(){var e=this.createOpponentString(),t=u.to_html(this.template,{id:this.mpay.id,summary:e});return this.$el.html(t),this},createOpponentString:function(){var e=this.mpay.game_day+" | ";return console.log("Game info",this.mpay),s.each(this.mpay.teams,function(){this.id>0&&this.id!=this.teams_id&&(e+=" VS. "+this.org_name)}),e}}),i}),define("text!sportorg/templates/team-list.html",[],function(){return'{{#data}}\r\n<div class="select-team">\r\n	<div class="game-box-outer">\r\n		<ul class="team-list-h">\r\n			\r\n		</ul>\r\n	</div>\r\n</div>\r\n</div>\r\n{{/data}}\r\n{{^data}}\r\n<div class="info">	\r\n	No games on the docket.  <a href="javascript: void(0);" title="add game" class="add-game-h">Click here to Add Game.</a>\r\n</div>\r\n{{/data}}\r\n'}),define("sportorg/views/team-list",["vendor","facade","views","utils","sportorg/views/team-item","text!sportorg/templates/team-list.html","utils/storage"],function(e,t,n,r,i,s,o){var u,a,f=t.$,l=t._,c=r.lib.Channel,h=n.CollectionView,p=e.Mustache;return SectionView=n.SectionView,a=h.extend(SectionView.prototype),u=a.extend({__super__:h.prototype,name:"Team List",events:{"click .add-game-h":"addGame"},_tagName:"li",_className:"team",template:s,_view:i,listView:".team-list-h",initialize:function(e){this.renderTemplate(),h.prototype.initialize.call(this,e);if(!this.collection)throw new Error("TeamListView expected options.collection.");l.bindAll(this),this.addSubscribers()},addGame:function(){var e=new o("user","localStorage");console.log(e.data);var t=0;if(e.data)for(var n in e.data){t=n;break}t&&routing.trigger("add-game",t)},renderTemplate:function(){var e={};e.data=this.collection.toJSON(),console.log("Schedule Data",e.data);var t=p.to_html(this.template,e);return this.$el.html(t),this}}),u}),define("profile/views/sport-item",["vendor","views","utils","text!profile/templates/sport-team.html","profile/collections/teams","sportorg/views/team-list"],function(e,t,n,r){var i,s=e.$,o=t.SectionView,u=e.Mustache,a=n.lib.Channel,f=require("sportorg/views/team-list"),l=require("profile/collections/teams");return i=o.extend({tagName:"li",className:"sport",initialize:function(e){function i(e){t.initTeamList(),console.log("CALLED REFRESH PROFILE CHANNEL"),a("refresh-profilepage").publish(e)}console.log("CALLED SPORT ITEM VIEW",e),this.template=r;var t=this;this.id=e.model.collection.id;var n=this.model.get("payload").sport_id;routing.off("showTwmList"),routing.on("showTwmList",function(e){i(e)})},initTeamList:function(){var e=this,t=s(".sports-h img.selected-sport-h").data("id");this.teams=new l,this.teams.id=this.id,this.teams.sports_id=t,this.teams.fetch(),s.when(this.teams.request).done(function(){console.log("TEAMS:",e.teams),e.setupTeamListView()})},setupTeamListView:function(){console.error(this.teams.toJSON());var e={};e.records=this.teams.toJSON();var t=u.to_html(this.template,e);this.$el.html(t)},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("profile/views/sport-list",["facade","views","utils","profile/views/sport-item"],function(e,t,n,r){var i,s,o=e._,u=t.CollectionView,a=t.SectionView;return s=u.extend(a.prototype),i=s.extend({__super__:u.prototype,id:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){u.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");o.bindAll(this),this.addSubscribers()}}),i}),define("profile/views/header",["require","text!profile/templates/header.html","text!profile/templates/sports.html","profile/models/basics","facade","views","utils","vendor","profile/collections/sports","profile/views/sport-list","utils/storage","media/views/image-item"],function(e,t,n){var r,s=e("facade"),o=e("views"),u=e("profile/models/basics"),a=o.SectionView,f=e("profile/views/sport-list"),l=e("profile/collections/sports"),c=e("utils"),h=c.lib.Channel,p=e("vendor"),d=p.Mustache,v=e("utils/storage"),m=e("media/views/image-item"),g=s.$;return r=a.extend({id:"main-header",template:t,selectSportTemplate:n,events:{"click .sports-icon-h":"selectSport"},initialize:function(e){a.prototype.initialize.call(this,e),this.sports_id=e.sports_id,this.initSportList()},initSportList:function(){var e=this;this.sports=new l,this.sports.id=this.model.id,this.sports.fetch(),g.when(this.sports.request).done(function(){e.setupSportListView(),console.log(e.sports),e.sports_id||e.selectSport()})},setupSportListView:function(){console.log(this.sports);var e=this,t=new f({collection:this.sports}),n=this.addChildView(t);console.log("SPORTS LIST VIEW",t.el),this.childViews.sportListView=t,this.callbacks.add(function(){n()}),e.$el.find("#sports-info").html(t.el);var r={payload:[]},s=t.collection;if(s.length){for(i=0;i<s.length;i++)r.payload[i]=s.at(i).get("payload");var o=d.to_html(e.selectSportTemplate,r);e.$el.find(".sports-h").html(o)}else e.$el.find("#sports-info").html("");t.render()},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},childViews:{},render:function(e,t,n){a.prototype.render.call(this,e,t,n),this.renderImage()},renderImage:function(){this.headerImage=new m({model:this.model}),this.headerImage.render(),this.$el.find(".image-outer-h").html(this.headerImage.$el)},getUserName:function(){return this.model.get("payload").label},selectSport:function(e){var t=e?g(e.target).data("id"):g(".sports-h img:first-child").data("id"),n=e?g(e.target).data("name"):g(".sports-h img:first-child").data("name");ga("send","event","Profile-Action","Sport-Change",n,t),g(".sports-icon-h.selected-sport-h").each(function(){console.log(this);var e=String(g(this).attr("src")).split("_selected.png")[0];e=e.split(".png")[0]+".png",g(this).attr("src",e).removeClass("selected-sport-h")}),g(".sports-icon-h[data-id="+t+"]").addClass("selected-sport-h");var r=String(g(".sports-icon-h[data-id="+t+"]").attr("src")).split(".png")[0]+"_selected.png";g(".sports-icon-h[data-id="+t+"]").attr("src",r);var i=this.getUserName();t&&(i+=" | "+n,this.$(".sport-info").stop().slideUp(),this.$(".sport-info-"+t).stop().slideDown(),routing.trigger("showTwmList",t)),document.title=i}}),r}),define("profile/views/add-media",["require","text!media/templates/add-media.html","application","profile/models/addmedia","facade","views"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=i._;return r=o.extend({id:"add-media",template:t,events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup","click #addGame":"openAddGamePopup"},setOptions:function(e){if(!this.model)throw new Error("ProfileAddMediaView expects option with model property.");this.model.userid=e.userid},openAddGamePopup:function(){ga("send","event","Open-Add-Popup","Game","User opened game adder",this.model.userid),routing.trigger("add-game",this.model.userid)},openAddImagePopup:function(e){ga("send","event","Open-Add-Popup","Image","User opened image uploader",this.model.userid);var t=$(".selected-sport-h").data("id"),n="/api/user/addimage/"+this.model.userid,n="/api/user/addimage/"+this.model.userid,r={sports_id:t};routing.trigger("add-image",n,r)},openAddvideoPopup:function(e){ga("send","event","Open-Add-Popup","Video","User opened video uploader",this.model.userid);var t="/api/user/addvideo/"+this.model.userid;Channel("add-video").publish(t)}}),r}),define("text!user/templates/related-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid">\r\n    <div class="span6">\r\n        <img src="{{base_url}}{{user_picture}}" alt="{{user_name}}"/>\r\n    </div>\r\n    <div class="span6">\r\n        <div class="username">{{user_name}}</div>\r\n        <div class="votes">Votes: {{num_votes}}</div>\r\n        <div class="fans">Followers: {{num_followers}}</div>\r\n    </div>\r\n</div>\r\n<table class="table">\r\n{{#teams}}\r\n    <tr>\r\n        <td>{{sport}}</td>\r\n        <td>{{position}}</td>\r\n        <td>{{org}}</td>\r\n        <td>{{season}}</td>\r\n        <td>{{year}}</td>\r\n    </tr>\r\n{{/teams}}\r\n</table>\r\n{{/payload}}\r\n\r\n'}),define("user/views/related-item",["vendor","views","utils","text!user/templates/related-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"related",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("user/views/related-list",["facade","views","utils","user/views/related-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"related-list",name:"Related List",tagName:"ul",_tagName:"li",_className:"related",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("RelatedListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("text!user/templates/fitnessbasic-item.html",[],function(){return'{{#payload}}\r\n	{{#data}}\r\n		<div class="fitness-overview-data-piece" style="">\r\n			<img title="{{name}}" src="{{icon}}" style=""/>\r\n			<span style="">{{#val}}{{val}}{{/val}}{{^val}}--{{/val}}</span>\r\n		</div>\r\n	{{/data}}\r\n{{/payload}}\r\n\r\n'}),define("user/views/fitnessbasic-item",["vendor","views","utils","text!user/templates/fitnessbasic-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"fitnessbasic",initialize:function(e){this.template=r},calculate:function(){if(this.unit_type=="time")var e="00:"+this.user_value+":00";else var e=this.user_value;return console.log(e),e},render:function(){var e={};e=this.model.toJSON(),e.view=this,console.log("Fitness Data getting passed to template",e);var t=u.to_html(this.template,e);return this.$el.html(t),this}}),i}),define("user/views/fitnessbasic-list",["facade","views","utils","user/views/fitnessbasic-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"fitnessbasic-list",name:"Fitness Basic List",tagName:"ul",_tagName:"li",_className:"fitnessbasic",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("FitnessBasicListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("profile/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/addvideo/"+this.id+"/"+this.sport_id:"/api/user/addvideo?team_id="+this.id+"&sport_id="+this.sport_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gameaddvideo:fetch").publish(e)}}),r}),define("profile/views/add-video",["require","profile/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("ProfileAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id}))}}),r}),define("profile/views/video-list",["facade","utils","media/views/video-list","profile/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gameaddvideo:fetch").subscribe(i)}}),i}),define("profile/views/commentof-list",["facade","utils","site/views/comment-list"],function(e,t,n){var r;return r=n.extend({setupFormView:function(){}}),r}),define("profile/views/commenton-list",["facade","utils","site/views/comment-list","profile/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}console.log("called");var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){s(e)})}}),s}),define("profile",["require","text!profile/templates/layout.html","application","votes/views/vote-section","facade","controller","models","views","utils","profile/models/basics","profile/models/addmedia","profile/collections/orgs","profile/collections/relateds","profile/collections/fitnessbasics","profile/collections/videos","profile/collections/image-videos","profile/collections/commentsof","profile/collections/commentson","schedules/collections/user-games","profile/collections/fans","profile/views/header","profile/views/add-media","schedules/views/schedule-list","user/views/related-list","user/views/fitnessbasic-list","profile/views/video-list","profile/views/image-video-list","profile/views/commentof-list","profile/views/commenton-list","profile/views/fans-image-list","application"],function(e,t,n,r){var i,s=e("facade"),o=e("controller"),u=e("models"),a=e("views"),f=e("utils"),l=e("profile/models/basics"),c=e("profile/models/addmedia"),h=e("profile/collections/orgs"),p=e("profile/collections/relateds"),d=e("profile/collections/fitnessbasics"),v=e("profile/collections/image-videos"),m=e("profile/collections/commentsof"),g=e("profile/collections/commentson"),y=e("schedules/collections/user-games"),b=e("profile/collections/fans"),w=e("profile/views/header"),E=e("profile/views/add-media"),S=e("schedules/views/schedule-list"),x=e("user/views/related-list"),T=e("user/views/fitnessbasic-list"),N=e("profile/views/image-video-list"),C=e("profile/views/commentof-list"),k=e("profile/views/commenton-list"),L=e("profile/views/fans-image-list"),A=e("media/models/image");return LayoutView=a.LayoutView,$=s.$,_=s._,debug=f.debug,Channel=f.lib.Channel,cssArr=["/pages/profile/profile.css"],i=o.extend({initialize:function(e){this.callbackcount=1;var t=this;return debug.log("start initialize"),Channel("load:css").publish(cssArr),_.bindAll(t),t.handleOptions(e),t.scheme=[],e.userId?(debug.log(e.userId),t.id=e.userId,t.init()):t.init(),t},init:function(){console.log("LAYOUT RENDER"),this.setupLayout().render(),console.log("CREATE DATA"),this.createData(),console.log("HANDLE DEFERREDS"),this.handleDeferreds()},createData:function(){function t(t){delete e.orgViewname,e.refreshPage(),e.sports_id=t,e.orgs=new h,e.orgs.id=e.id,e.orgs.sport_id=t,e.orgs.targetElement="#games_div",e.orgs.fetch(),e.relateds=new p,e.relateds.id=e.id,e.relateds.sport_id=t,e.relateds.fetch(),e.fitnessbasics=new d,e.fitnessbasics.id=e.id,e.fitnessbasics.sport_id=t,e.fitnessbasics.fetch(),e.images=new v,e.images.id=e.id,e.images.sport_id=t,e.images.targetElement="#image-wrap",e.images.fetch(),e.handleDeferredsDynamic()}function n(){e.fans=new b,e.fans.id=e.id,e.fans.fetch(),$.when(e.fans.request).done(function(t){e.fansListView&&($(e.fansListView.destination).html(""),position=$.inArray(e.fansListView,e.scheme),~position&&e.scheme.splice(position,1)),e.setupFansListView()})}this.basics=new l({id:this.id}),this.basics.id=this.id,this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new c,this.addmedia.id=this.id,this.fans=new b,this.fans.id=this.id,this.fans.targetElement="#fans-div",this.fans.fetch();var e=this;console.log(e),Channel("new-fan","nomemory unique").subscribe(n),Channel("refresh-profilepage","unique").subscribe(t)},handleDeferreds:function(){var e=this;$.when(this.basics.request).done(function(){e.setupHeaderView(),e.initVoteView(),e.setupAddMediaView();var t=e.basics.get("payload").enttypes_id;e.commentson=new g,e.commentson.subject_entity_type=t,e.commentson.id=e.id,e.commentson.targetElement="#commenton-wrap",e.commentson.fetch(),$.when(e.commentson.request).done(function(){e.setupCommentOnListView()})})},initVoteView:function(){var e=new r({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},handleDeferredsDynamic:function(){var e=this;$.when(this.orgs.request).done(function(){e.setupOrgListView()}),$.when(this.relateds.request).done(function(){e.setupRelatedListView()}),$.when(this.fitnessbasics.request).done(function(){e.setupFitnessBasicListView()}),$.when(this.fans.request).done(function(t){e.setupFansListView()}),$.when(this.images.request).done(function(t){console.log("Images Ready (called in profile.js handleDeferredDynamic)",t),e.setupImageListView()})},refreshPage:function(){var e;this.orgListView&&($(this.orgListView.destination).html(""),e=$.inArray(this.orgListView,this.scheme),~e&&this.scheme.splice(e,1)),this.relatedListView&&($(this.relatedListView.destination).html(""),e=$.inArray(this.relatedListView,this.scheme),~e&&this.scheme.splice(e,1)),this.fitnessBasicListView&&($(this.fitnessBasicListView.destination).html(""),e=$.inArray(this.fitnessBasicListView,this.scheme),~e&&this.scheme.splice(e,1)),this.imageListView&&($(this.imageListView.destination).html(""),e=$.inArray(this.imageListView,this.scheme),~e&&this.scheme.splice(e,1)),this.fansListView&&($(this.fansListView.destination).html(""),e=$.inArray(this.fansListView,this.scheme),~e&&this.scheme.splice(e,1))},setupHeaderView:function(){var e;e=new w({model:this.basics,sports_id:this.sports_id>0?this.sports_id:null,name:"Header",destination:"#main-header"}),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(){var e;e=new E({model:this.addmedia,name:"Add Media",destination:"#add-media",userid:this.id});for(var t in this.scheme)this.scheme[t].id=="add-media"&&delete this.scheme[t];this.scheme.push(e),this.layout.render()},getOrgData:function(){var e;this.orgListView&&($(this.orgListView.destination).html(""),e=$.inArray(this.orgListView,this.scheme),~e&&this.scheme.splice(e,1));var t=this;t.orgs.fetch(),$.when(t.orgs.request).done(function(){t.setupOrgListView()})},setupOrgListView:function(){console.log("Called setup org list view which is where the game list type is decided upon",this.orgs,this.orgViewname);var e;this.orgs.length&&(!this.orgViewname||this.orgViewname&&this.orgViewname=="org")?this.setUpOrgView():this.setUpUserSportView()},setUpUserSportView:function(){console.log("Called event-based user-sport list view");var e=this;this.orgViewname="sport",this.orgs=new y,this.orgs.userId=e.id,this.orgs.sports_id=$(".selected-sport-h").data("id"),this.orgs.fetch(),$.when(this.orgs.request).done(function(){e.orgListView=new S({collection:e.orgs,controller:e,destination:"#games_div",eventPage:$(".selected-sport-h").data("name")}),e.scheme.push(e.orgListView),e.layout.render()})},setUpOrgView:function(){console.log("Called normal org list view"),this.orgViewname="org",this.orgListView=new S({collection:this.orgs,controller:this,destination:"#games_div"}),this.scheme.push(this.orgListView),this.layout.render()},setupRelatedListView:function(){var e;this.relatedListView=new x({collection:this.relateds,destination:"#related-wrap"}),this.scheme.push(this.relatedListView),this.layout.render()},setupFitnessBasicListView:function(){var e;this.fitnessBasicListView=new T({collection:this.fitnessbasics,destination:"#fitnessbasic-wrap"}),this.scheme.push(this.fitnessBasicListView),this.layout.render()},setupVideoListView:function(){var e;this.videoListView=new ProfileVideoListView({collection:this.videos,destination:"#video-wrap"}),this.scheme.push(this.videoListView),this.layout.render()},setupImageListView:function(){var e=this;routing.off("image-upload-success"),routing.on("image-upload-success",function(t){e.updateImages(t)}),console.log("CURRENT IMAGE LIST VIEW:",this.imageListView),this.imageListView=new N({collection:this.images,destination:"#image-wrap",target_id:this.id,target_url:"/api/user/addimage/",sport_id:$(".selected-sport-h").data("id"),name:"images View 2"}),this.scheme.push(this.imageListView),this.layout.render()},setupFansListView:function(){this.fansListView=new L({collection:this.fans,destination:"#fans-div",name:"fansView"}),this.scheme.push(this.fansListView),this.layout.render()},updateImages:function(e){var t=new A;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON())},setupCommentOfListView:function(){var e;e=new C({collection:this.commentsof,destination:"#commentof-wrap"})},setupCommentOnListView:function(){var e;this.commentOnListView=new k({collection:this.commentson,destination:"#commenton-wrap"}),this.scheme.push(this.commentOnListView),this.layout.render()},setupLayout:function(){var e;return e=new LayoutView({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),i});