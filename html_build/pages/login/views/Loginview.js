define(["require","text!login/templates/logintemplate.html","backbone","underscore","signup","views","facade","utils","login/models/Forgotmodel","signup/views/facebooksignup"],function(e,t,n,r,i){var s,o=e("facade"),u=e("views"),a=e("utils"),f=a.lib.Channel,l=e("login/models/Forgotmodel"),c=e("signup/views/facebooksignup"),h=n.View;return SigninBasicView=h.extend({initialize:function(e){this.callback=e.callback,this.signcontroller=new i,this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),$("#errormsg, #preview").html(""),debug.log("Image upload basic view"),$("#Loginview").modal("show"),$("#Loginview").on("hide",function(){$("div#LoginPopup").empty()})},events:{"click button#signup":"signupUser","click .loginUser":"userLogin","click .forgot-password-h":"forgotPassword","submit .forgot-password-form-h":"forgotPasswordForm","click .log-in-link-h":"loginPageView","click #fbpane":"signupFacebook"},forgotPasswordForm:function(e){e.preventDefault();var t=this,n=new l;n.email=$(e.target).find(".forgot-password-email-h").val(),n.save({email:n.email}),$.when(n.request).done(function(){t.$el.find(".success-message").removeClass("hide"),t.$el.find(".error-message").addClass("hide"),setTimeout(function(){t.loginPageView()},3e3)}),$.when(n.request).fail(function(){t.$el.find(".error-message").removeClass("hide"),t.$el.find(".success-message").addClass("hide")})},signupFacebook:function(e){e.preventDefault(),$("#RegModal").modal("hide"),headView=new c({callback:this.callback}),headView.signupFacebook()},userLogin:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=[],i=this;$.each(t,function(e,t){n[t.name]=t.value});var s=$.extend({},n);this.model.save(s,{success:function(e){$("#Loginview").modal("hide"),i.callback&&r.isFunction(i.callback)?(routing.trigger("common-popup-close"),App.header&&App.header.render(!0),i.callback(function(){})):window.location.href="#profile"},error:function(e){$(".errormsg").empty();var t=jQuery.parseJSON(e.request.responseText);$(".errormsg").html(t.exec_data.error_array[0].error)}})},forgotPassword:function(e){e.preventDefault(),this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Forgot Password"),$("#loginmain").addClass("hide"),$(".forgot-password-container").removeClass("hide")},loginPageView:function(){this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Login"),$("#loginmain").removeClass("hide"),$(".forgot-password-container").addClass("hide")},signupUser:function(e){e.preventDefault(),routing.trigger("common-popup-close"),routing.trigger("register-basic",this.callback)}}),SigninBasicView});