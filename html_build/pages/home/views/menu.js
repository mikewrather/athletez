define(["require","text!pages/home/templates/menu.html","facade","views","jquery.slimscroll","common/models/get-city","vendor/plugins/qtip/qtip-wrapper","text!vendor/plugins/qtip/qtip.css"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("common/models/get-city");return n=s.extend({id:"menu1",events:{"blur #search":"updateSearch","focus #search":"hideDropdown","click .restype":"changeBaseUrl","click .dropdown-menu-alias > li > a":"select","click .dd":"doNothing","click .menu-link-h":"showMenuDropdown","click .views-reset-btn-h":"resetView","click .sport-reset-btn-h":"resetSport","click .location-reset-btn-h":"resetLocation","click .reset-all-btn-h":"resetAll","click .reset-option-btn-h":"resetIndividual"},demoSelect:function(){},resetIndividual:function(e){var t=$(e.currentTarget).data("type");$(e.currentTarget).addClass("hide"),t&&_.isFunction(this[t])&&this[t]()},restype:function(){Channel("resetIndividual").publish("restype")},sport:function(){Channel("resetIndividual").publish("sports")},city:function(){Channel("resetIndividual").publish("location")},views:function(){Channel("resetIndividual").publish("view")},resetAll:function(){this.resetView(),this.resetLocation(),this.resetSport()},resetView:function(){var e="view";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-view-area-h ul li a.select, .reset-view-area-h ul li.select").removeClass("select")},resetSport:function(){var e="sports";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-sport-area-h ul li a.select, .reset-sport-area-h ul li.select").removeClass("select")},resetLocation:function(){var e="location";Channel("resetFilter").publish(e),this.$el.find("#city").val(""),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-location-area-h ul li a.select, .reset-location-area-h ul li.select").removeClass("select")},template:t,initialize:function(e){s.prototype.initialize.call(this,e),this.options=e.options?e.options:{}},bindToolTips:function(){this.$el.find("a.restype").each(function(){var e=$(this);$(this).qtip2({position:{my:"left center",at:"right center"},style:{classes:e.data("tip-style")}},!0)}),this.$el.find("a.menu-link-h").each(function(){var e=$(this);$(this).qtip2({position:{my:"bottom center",at:"top center"},style:{classes:"header-dropdown"}})})},updateSearch:function(e){Channel("textChanged").publish($(e.target).val())},changeBaseUrl:function(e){var t=$(e.currentTarget);this.$el.find(".icons").each(function(){$(this).removeClass($(this).data("selected-class"))}),t.addClass(t.data("selected-class"));var n=t.data("number");Channel("baseUrlChanged").publish(n)},stateListChange:function(e){var t=$(e.currentTarget).val();console.log(t);var n=t.data("id");routing.trigger("stateChanged",n)},doNothing:function(e){e.preventDefault(),e.stopPropagation()},hideDropdown:function(){this.$el.find(".menu-detail-h").hide()},hideAllDropdowns:function(){var e=this;$("html, #search").click(function(t){$(t.target).parents(".menu").length||e.hideDropdown()})},showMenuDropdown:function(e){var t=$(e.currentTarget).next();t.css("display")=="none"?(this.$el.find(".menu-detail-h").hide(),t.show()):t.hide()},select:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),n=t.attr("class");$(".dropdown-menu > li > a."+n).removeClass("select"),n=t.attr("class").split(" ")[0],$(t).addClass("select"),$(".menu-detail-h").hide(),this.$el.find(".reset-option-btn-h[data-type="+$(t).parents(".menu").attr("id")+"]").removeClass("hide");var r={submenu:n,value:$(t).data("id")||$(t).text()};Channel("viewFilterChanged").publish(r)},toggle:function(e){e.preventDefault();var t=$(e.currentTarget),n=$(t).offset(),r=n.top+40,i=n.left+10,s=t.attr("id");s="#"+s+" .dd",$(s).attr("class")==="dd open"?$(s).hide().removeClass("open"):($(".open").hide().removeClass("open"),$(s).css("top",r).css("left",i),$(s).show(),$(s).addClass("open"))},afterRender:function(){this.hideAllDropdowns();var e=this,t=setInterval(function(){try{$(e.el).find(".sport-list").slimScroll(),clearInterval(t)}catch(n){}},1e3);this.bindToolTips();var n=this.model.toJSON();this.options.searchtext&&this.$el.find("#search").val(this.options.searchtext),this.options.cities_id||this.options.states_id||this.options.country_id;if(this.options.base){var r=this.$el.find(".restype[data-number="+this.options.base+"]");r.addClass(r.data("selected-class"))}this.options.sports_id&&this.options.sports_id!="0"&&e.$el.find(".reset-option-btn-h[data-type=sport]").removeClass("hide"),this.options.orderby!="random"&&e.$el.find(".reset-option-btn-h[data-type=views]").removeClass("hide");if(this.options.orderby){var i=this.$el.find("a.browse[data-id="+this.options.orderby+"]");i.parents("ul").find("a").removeClass("select"),i.addClass("select");var s=setInterval(function(){$("#views .view-link-h .option-heading-h").length&&(clearInterval(s),i.text()&&$("#views .view-link-h .option-heading-h").html(i.text()))},500)}}}),n});