define(["require","text!userresume/templates/rdtree.html","facade","views","utils","vendor","userresume/collections/rdtree","userresume/models/rdtree"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/rdtree"),h=e("userresume/models/rdtree"),p=s.extend({template:t,events:{"click .btn-edit-rdtree_h":"MarkEdit","click .btn-Finish-RdTree_h":"FinishEdit","blur .txtRdTrees_h":"SaveResumeData"},controls:{btnEditRdTree:".btn-edit-rdtree_h",btnFinishRdTree:".btn-Finish-RdTree_h",sectionRdTreeItems:".section-rdtree-items_h",txtRdTree:".txtRdTrees_h"},messages:{dataNotExist:"Data Not Exists For RD Trees."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},setupView:function(){var e=this,t={user_id:e.user_id},n=new c(t);n.user_id=e.user_id,n.fetch(),l.when(n.request).done(function(){if(n.isError())return;e.Tree=n.parseAsRequired(),console.log("d",e.Tree);var t=f.to_html(e.template,{rdtrees:e.Tree});l(e.el).html(t)})},MarkEdit:function(e){l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).removeAttr("disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnFinishRdTree).fadeIn()},FinishEdit:function(e){l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).attr("disabled","disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnEditRdTree).fadeIn()},SaveResumeData:function(e){var t=l(e.target).attr("treeId"),r=l(e.target).attr("resumeDataId"),i=l(e.target).val(),s={treeId:t,user_id:n.user_id,resume_data_id:r,user_value:i},o=new h(s);o.treeId=t,o.user_id=n.user_id,o.target=l(e.target),t>0?(o.action="update",o.save({id1:t})):(o.action="save",o.save()),l.when(o.request).done(function(t){console.log("response",t),t.payload!=null&&t.payload.id>0&&(console.log(t.payload),l(e.target).attr("treeId",t.payload.id)),l('.txtRdTrees_h[resumedataid="'+t.payload.resume_data_id+'"]').val(t.payload.user_value),l(e.target).parent().find(".error_h").html("").fadeOut(),l(e.target).parent().find(".success_h").html("").fadeOut()})}});return p});