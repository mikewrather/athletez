define(["require","text!profilesetting/templates/individualsports.html","text!profilesetting/templates/sportscheckbox.html","text!profilesetting/templates/sportitem.html","facade","views","utils","vendor","profilesetting/collections/individualsports","profilesetting/collections/sports","profilesetting/models/sport"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/individualsports"),v=e("profilesetting/models/sport"),m=e("profilesetting/collections/sports"),s=a.extend({template:t,events:{"change .select-all":"CheckAll","change .chk-single":"CheckSingle","click .delete-individualsport":"DeleteSport"},controls:{content:"#section-individual-prof-setting",sportslist:".sports-list-individial-sports",btnSave:".btn-Save-Individual-Sports",chkAll:".select-all",chkSingle:".chk-single",userSportsList:".sports-list-user-individual-sports"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property."},initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},init:function(){i.setupSportsView()},render:function(){a.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender,this.destination=e.destination},setUpUsersSports:function(){console.log("setUpSportsView Individual View");var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(r,{sports:i.sports});console.log("Users Own Sports",i.sports),i.$(i.controls.userSportsList).html(s)})},setUpUsersSportsCheck:function(){var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1),p.each(i.sports,function(e,t){i.$el.find("#chk-ind-"+t.sport_id).attr("checked","checked")})})},setupSportsView:function(){console.log("setUpSportsView Individual View");var e=new m;e.user_id=i.user_id,e.sport_type_id=2,e.male=1,e.female=0,i.gender=="male"?e.male=1:i.gender=="famale"&&(e.female=0),e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var r in t)i.sports.push(t[r].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(n,{sports:i.sports});i.$(i.controls.sportslist).html(s),i.setUpUsersSportsCheck()})},SaveSport:function(e){console.log("Save Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n=new v;n.user_id=i.user_id,n.sports_id=t,n.type="save",console.log("Save Model Request Abort Request Function"),i.sportsModelFetchRequest=i.abortRequest(i.sportsModelFetchRequest),i.compLevelFetchRequest=n.save({sports_id:t}),p.when(n.request).done(function(){var t=p(e.currentTarget).parent().find(".success_h");t.removeClass("displayNone").html("Sport Added Successfully."),setTimeout(function(){t.addClass("displayNone").html("")},3e3),i.setUpUsersSportsCheck()})}},DeleteSport:function(e){console.log("Delete Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n={user_id:i.user_id,sports_id:t},r=new v(n);r.user_id=i.user_id,r.type="delete",r.destroy({data:n,processData:!0,success:function(){var t=p(e.currentTarget).parent().find(".success_h");t.removeClass("displayNone").html("Sport Removed Successfully."),setTimeout(function(){t.addClass("displayNone").html("")},3e3),i.setUpUsersSportsCheck()}})}},CheckAll:function(e){p(e.target).is(":checked")?i.$(i.controls.chkSingle).attr("checked","checked"):i.$(i.controls.chkSingle).removeAttr("checked","checked")},CheckSingle:function(e){p(e.target).is(":checked")?i.SaveSport(e):i.DeleteSport(e)}});return s});