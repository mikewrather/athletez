define(["vendor","views","text!chrome/templates/header.html","chrome/models/header","registration","login","signup","signup/views/shopopup","utils/storage","signup/views/facebooksignup"],function(e,t,n,r,i,s,o,u,a){var f,l=require("signup/views/facebooksignup"),c=t.BaseView,h=e.$,p=e._,d=e.Mustache;return f=c.extend({tagName:"header",className:"container-fluid clearfix",initialize:function(e){this.template=n},model:new r,events:{"click .signup-facebook":"signupFacebook","click .signup-email":"signupUser","click .account clearfix a":"login","click #userlogin":"userLogin","click #logoutId":"LogoutUser","click .link-to-fb-h":"linkToFacebook"},linkToFacebook:function(){routing.trigger("link-to-facebook")},render:function(e){var t=this;return this.model.fetchSuccess=this.model.fetchError=function(n,r){var i=d.to_html(t.template,n.toJSON());t.$el.html(i);if(typeof n.get("user_photo")=="object"&&typeof n.get("user_photo").types=="object")if(typeof n.get("user_photo").types.small_thumb=="object")var s=n.get("user_photo").types.small_thumb.url;else if(typeof n.get("user_photo").types.large_thumb=="object")var s=n.get("user_photo").types.large_thumb.url;else if(typeof n.get("user_photo").types.original=="object")var s=n.get("user_photo").types.original.url;else var s="";t.$(".photo img").attr("src",s);var o=n.get("authorized");if(o){var u=n.get("id");t.model.saveCookie(),routing.userLoggedIn=!0,routing.loggedInUserId=u,e||routing.trigger("app-inited",u)}else routing.userLoggedIn=!1,e||routing.trigger("app-inited");h("#main").removeClass("region-loader"),h(document).off("click","a[href*='#fbinvite']"),h(document).on("click","a[href*='#fbinvite']",function(e){e.preventDefault(),routing.trigger("fbInvite")})},this.model.fetch(),this},userLogin:function(e){e.preventDefault(),this.logincontroller=new LoginController,routing.trigger("Login")},signupFBTest:function(e){},signupFacebook:function(e){e.preventDefault(),headView=new l,headView.signupFacebook()},signupUser:function(e){this.signupc=new o({route:""}),routing.trigger("register-basic",e),this.pop=new u},LogoutUser:function(e){e.preventDefault(),this.logincontroller||(this.logincontroller=new LoginController),routing.trigger("Logout",this.model)}}),f});