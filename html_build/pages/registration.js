/**
 * @license RequireJS text 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/* jQuery Resize And Crop (jrac)
 * A jQuery 1.4+ and jQueryUi 1.8+ plugin under GNU GENERAL PUBLIC LICENSE version 2 lisense.
 * Copyright (c) 2011 Cedric Gampert - cgampert@gmail.com
 */

define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.4",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("ï»¿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!registration/templates/layout.html",[],function(){return'\r\n<div id="main-header">\r\n\r\n</div>\r\n\r\n<div id="main-content">\r\n    \r\n    \r\n    \r\n</div>\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n'}),define("controller",["facade","collections","models","utils"],function(e,t,n,r){var i,s=t.ApplicationStates,o=n.EventModel,u=e._,a=e.$,f=r.lib.Channel,l=e.Backbone.Model.extend;return i=function(e){e=e||{},this.route=e.route,i.prototype.appStates?e.appStates&&(i.prototype.appStates=e.appStates):i.prototype.appStates=new s,this.route&&i.prototype.appStates&&this.getStoredState(),this.initialize(e)},i.extend=l,i.prototype={initialize:function(e){return this.triggerPublishers(),u.bindAll(this),this.handleOptions(e),this.addSubscribers(),this.handleDeferreds(),this},generateRandomNumber:function(){var e=(new Date).getTime();return e+=Math.floor(Math.random()*200+1),e},setupSections:function(){},setupScheme:function(){},setupLayout:function(){var e;return this.layout=e,this.layout},handleDeferreds:function(){var e=this;a.when(null).then(function(){})},addSubscribers:function(){},removeSubscribers:function(){},triggerPublishers:function(){},meta:{activeViews:[],viewNames:[]},handleOptions:function(e){i.prototype.handleOptions(e)},routeChange:function(e){i.prototype.routeChange(options)},addStateChangeSubscriber:null},i.prototype.data=null,i.prototype.layout=null,i.prototype.scheme=[],i.prototype.sections={},i.prototype.route=null,i.prototype.handleOptions=function(e){e&&e.useFixtures&&this.useFixturesForWebServices()},i.prototype.transitionActiveViews=function(e){var t,n=this.layout,r=this.meta.sectionName,i=this.meta.activeViews=[];e=e||this.meta.presentation,t=function(t,s){s===e&&(t.state()==="not-rendered"&&t.render(),n.transition(r,t),i.push(s))},this.iterateOverLayoutViews(t)},i.prototype.renderInActiveViews=function(){var e;e=function(e){e.state()==="not-rendered"&&(e.callbacks.add(function(){e.state("not-displayed")}),e.render())},this.iterateOverLayoutViews(e)},i.prototype.iterateOverLayoutViews=function(e){var t=this.meta.activeViews,n=this.sections,r=this.meta.viewNames,i,s,o;for(o=0;o<r.length;o++)i=r[o],u.contains(t,i)||(s=n[i],e&&u.isFunction(e)&&e(s,i))},i.prototype.routeChange=function(e,t,n){var r={data:{}},s;if(e&&!u.isString(e))throw s="Controller routeChange expects string as 1st argument.",new Error(s);this.route=e,this.layout&&(this.layout.state({route:e}),r.data=this.layout.state(),u.extend(r,t||{}),i.prototype.appStates.add(r),this.data=r.data,debug.log(r),i.prototype.appStates.save(e)),n&&u.isFunction(n)&&n(this.data),debug.log("Controller routeChange method called with: "+e)},i.prototype.getStoredState=function(){var e;if(!this.route)throw new Error("Controller does not have route property.");return e=i.prototype.appStates.findInCollectionOrStorage(this.route),this.data=e&&e.data?e.data:e,this.data},i.prototype.addStateChangeSubscriber=function(e,t){function s(r,s){var o=e,a=t,f=n,l;f.layout&&(l=f.layout.state(),l&&i.prototype.appStates.add({name:f.route,data:l,expires:new Date(Date.now()+4032e4),storage:"localStorage"})),a&&u.isFunction(a)&&a(r,s)}var n=this,r;if(!e||!u.isString(e))throw r="controller method addStateChangeSubscriber expected string as 1st argument.",new Error(r);f(e+":stateChanged").subscribe(s)},i.prototype.remove=function(){var e;this.layout&&this.layout.remove();for(e in this)delete this[e]},i.prototype.webServices={},i.prototype.useFixturesForWebServices=function(){},i}),define("user/models/basics",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"undefined"==typeof this.id?testpath?testpath+"/user/basics/425983":"/api/user/basics/":testpath?testpath+"/user/basics/"+this.id:"/api/user/basics/"+this.id},initialize:function(){n.__super__.initialize.apply(this,arguments)},user_pic_small:function(){return this.payload.user_picture.types.small_thumb.url}}),n}),define("registration/models/select_type",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return"/api/user/basics/"+this.id},fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n)}}),t}),define("user/models/fbreg",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,birth_day:null,high_school:null,email:null,user_picture:null},desc:"Facebook Registration Information",exec_data:{exec_time:0,exec_error:!1},id:1})}),n}),define("registration/models/register_facebook",["facade","user/models/fbreg","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbreg":"/api/user/fbreg"}}),r}),define("registration/models/register_email",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+this.id}}),t}),define("registration/models/upload_image",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/uploadimage":"/api/user/uploadimage"}}),t}),define("registration/models/select_org",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!registration/templates/select_type.html",[],function(){return'\r\n<h1>Register with AthletesUp</h1>\r\n<a href="#" class="register_facebook">Sign up through Facebook</a>\r\n<br/><br/> OR <br/><br/>\r\n<a href="#" class="register_email">Register With Email Address</a>\r\n\r\n<a href="#" class="go_club">go club directly</a>\r\n<div id="fb-root"></div>'}),define("registration/views/select_type",["require","registration/models/select_type","text!registration/templates/select_type.html","facade","views","utils"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView;return r=a.extend({id:"main-content",events:{"click .register_facebook":"registerWithFacebook","click .register_email":"registerWithEmail","click .go_club":"selectOrg"},template:n,initialize:function(e){a.prototype.initialize.call(this,e),this.initModel()},registerWithFacebook:function(e){function t(){FB.login(function(e){e.authResponse?u("registration-with-facebook").publish():alert("Cancelled")},{scope:"email, user_birthday, user_photos"})}function n(){var e,n="facebook-jssdk",r=document.getElementsByTagName("script")[0];if(document.getElementById(n)){t();return}e=document.createElement("script"),e.id=n,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(e,r)}e.preventDefault(),window.fbAsyncInit=function(){FB.init({appId:"239430712864961",status:!0,cookie:!0,xfbml:!0,oauth:!0}),FB.getLoginStatus(function(e){e.status==="connected"?FB.api("/me",function(e){u("registration-with-facebook").publish()}):e.status==="not_authorized"?t():t()},{scope:"email, user_birthday, user_photos"})},n()},registerWithEmail:function(e){e.preventDefault(),u("registration-with-email").publish()},initModel:function(){function n(n){e.select_type=new t,e.select_type.id=n,e.select_type.fetch(),$.when(e.select_type.request).done(function(){e.model=e.select_type})}var e=this;u("app-inited").subscribe(n)},selectOrg:function(e){e.preventDefault();var t=this,n=t.model.get("payload");u("registration-select-org").publish(n)}}),r}),define("text!registration/templates/register_facebook.html",[],function(){return'{{#payload}}\r\n<h1>Register with Facebook</h1>\r\n<div class="row-fluid">\r\n	<div class="span4">\r\n		<img class="picture" src="{{profile_picture}}" alt="{{name}}"/><br/>\r\n		<a href="#" class="diff_fb_pic">Different Facebook Pic</a><br/>\r\n		<a href="#" class="upload_new_image">Upload a New Image</a><br/>\r\n	</div>\r\n	<div class="span8">\r\n		<h3>{{name}}</h3>\r\n\r\n		<div class="field">\r\n			Born:\r\n			<span class="value" data-name="birthday" data-value="{{birthday}}">\r\n				<input type="hidden" name="birthday" value="{{birthday}}"/>\r\n				{{birthday}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			High School:\r\n			<span class="value" data-name="high_school" data-value="{{high_school}}">\r\n				{{#hs_exists}}\r\n					<input type="hidden" name="high_school" value="{{high_school}}"/>\r\n					{{high_school}} <a href="#" class="change-field">change</a>\r\n				{{/hs_exists}}\r\n				{{^hs_exists}}\r\n					<input type="text" id="high_school" name="high_school" value=""/>\r\n				{{/hs_exists}}\r\n\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			Email:\r\n			<span class="value" data-name="email" data-value="{{email}}">\r\n				<input type="hidden" name="email" value="{{email}}"/>\r\n				{{email}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			Password: <input type="password" class="password" name="password"/>\r\n		</div>\r\n		<div class="field">\r\n			Again: <input type="password" name="password-again"/>\r\n		</div>\r\n		<div class="password-error"></div>\r\n	</div>\r\n</div>\r\n<div class="row-fluid">\r\n	<label for="agree"><input type="checkbox" id="agree" name="agree"/>I have read and agree to the <a href="#">Terms of Service</a></label>\r\n	<a href="#" class="next">What\'s Next</a>\r\n</div>\r\n{{/payload}}'}),function(e){e.extend(e.fn,{pstrength:function(t){var t=e.extend({verdects:["Very weak","Weak","Medium","Strong","Very strong"],colors:["#f00","#c06","#f60","#3c0","#3f0"],scores:[10,15,30,40],common:["password","sex","god","123456","123","liverpool","letmein","qwerty","monkey"],minchar:6},t);return this.each(function(){var n=e(this).attr("id");e(this).after('<div class="pstrength-minchar" id="'+n+'_minchar">Minimum number of characters is '+t.minchar+"</div>"),e(this).after('<div class="pstrength-info" id="'+n+'_text"></div>'),e(this).after('<div class="pstrength-bar" id="'+n+'_bar" style="border: 1px solid white; font-size: 1px; height: 5px; width: 0px;"></div>'),e(this).keyup(function(){e.fn.runPassword(e(this).val(),n,t)})})},runPassword:function(t,n,r){nPerc=e.fn.checkPassword(t,r);var i="#"+n+"_bar",s="#"+n+"_text";nPerc==-200?(strColor="#f00",strText="Unsafe password word!",e(i).css({width:"0%"})):nPerc<0&&nPerc>-199?(strColor="#ccc",strText="Too short",e(i).css({width:"5%"})):nPerc<=r.scores[0]?(strColor=r.colors[0],strText=r.verdects[0],e(i).css({width:"10%"})):nPerc>r.scores[0]&&nPerc<=r.scores[1]?(strColor=r.colors[1],strText=r.verdects[1],e(i).css({width:"25%"})):nPerc>r.scores[1]&&nPerc<=r.scores[2]?(strColor=r.colors[2],strText=r.verdects[2],e(i).css({width:"50%"})):nPerc>r.scores[2]&&nPerc<=r.scores[3]?(strColor=r.colors[3],strText=r.verdects[3],e(i).css({width:"75%"})):(strColor=r.colors[4],strText=r.verdects[4],e(i).css({width:"92%"})),e(i).css({backgroundColor:strColor}),e(s).html("<span style='color: "+strColor+";'>"+strText+"</span>")},checkPassword:function(e,t){var n=0,r=t.verdects[0];e.length<t.minchar?n-=100:e.length>=t.minchar&&e.length<=t.minchar+2?n+=6:e.length>=t.minchar+3&&e.length<=t.minchar+4?n+=12:e.length>=t.minchar+5&&(n+=18),e.match(/[a-z]/)&&(n+=1),e.match(/[A-Z]/)&&(n+=5),e.match(/\d+/)&&(n+=5),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(n+=7),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(n+=5),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(n+=7),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(n+=2),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(n+=3),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(n+=3);for(var i=0;i<t.common.length;i++)e.toLowerCase()==t.common[i]&&(n=-200);return n}})}(jQuery),define("jquery.pstrength",function(){}),define("media/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),t!=undefined?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this},selectImageType:function(e){return r.each(this.get("payload").types,function(t,n){n==e&&(this.get("payload").image_path=t.url)},this),this}}),n}),define("media/collections/images",["facade","collections","media/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.processItemFromPayload(t,i),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("registration/collections/fbimages",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbpics":"/api/user/fbpics"}}),r}),define("text!registration/templates/fbimage-item.html",[],function(){return'\r\n{{#payload}}\r\n<img src="{{thumbnail}}" alt="Thumb"/>\r\n{{#num_votes}}{{num_votes}} Votes{{/num_votes}}\r\n{{/payload}}\r\n\r\n'}),define("registration/views/fbimage-item",["vendor","views","utils","text!registration/templates/fbimage-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"image",events:{click:"changeImage"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeImage:function(){Channel("changeimage"+this.model.collection.id).publish(this.model)}}),i}),define("text!media/templates/image-item.html",[],function(){return'<a href="{{_link}}" data-index="{{index}}" class="image-outer-h">\r\n	<div class="image-item-container">\r\n	<img class="list-thumbnail" src="{{_thumbnail}}" alt=""/>\r\n		<div class="action-section">\r\n			{{#show_edit}}\r\n				<div class="action-block left-block edit edit-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>E</span></div>\r\n				<div class="action-block right-block delete delete-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>D</span></div>\r\n			{{/show_edit}}\r\n			{{^show_edit}}\r\n				<div class="action-block left-block vote vote-h {{#_has_voted}} link-disabled {{/_has_voted}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}">\r\n					<span>V</span>\r\n				</div>\r\n				{{#_can_follow}}\r\n				<div class="action-block right-block follow follow-h {{#_is_following}} link-disabled {{/_is_following}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>F</span></div>\r\n				{{/_can_follow}}\r\n			{{/show_edit}}\r\n		</div>\r\n		<div class="detail-view {{#_detailclass}}{{_detailclass}}{{/_detailclass}}">\r\n			<h6>{{_label}}</h6>\r\n			<span>{{& _sublabel}}</span>\r\n		</div>\r\n	</div>\r\n</a>'}),define("votes/models/vote",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/vote/add?subject_type_id="+this.entity_id+"&subject_id="+this.userId},setData:function(){this.set({subject_type_id:this.entity_id,subject_id:this.userId})}}),n}),define("votes/models/follow",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/ent/follow/"+this.entity_id+"/"+this.userId}}),n}),define("media/views/image-item",["vendor","views","utils","text!media/templates/image-item.html","votes/models/vote","votes/models/follow"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=require("votes/models/vote"),f=require("votes/models/follow");return i=o.extend({tagName:"li",className:"image",events:{"click .vote-h":"vote","click .follow-h":"follow","click .edit-h":"edit","click .delete-h":"delete"},initialize:function(e){this.template=r},render:function(){var e=this,t=this.model.attributes.payload,n={_enttypes_id:t.enttypes_id,_id:t.id,_has_voted:t.has_voted,_is_following:t.is_following,_can_follow:t.can_follow},r=!1,i=null,o=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};switch(t.enttypes_id){case"23":typeof t.standard_thumb=="object"?(i=t.standard_thumb,n._thumbnail=i.url):n._thumbnail=t.thumbs,n._label=t.media.name,n._link="javascript: void(0);",t.media.hasOwnProperty("is_owner")&&(r=t.media.is_owner);break;case"21":typeof t.types=="object"&&(typeof t.types.standard_thumb=="object"?(i=t.types.standard_thumb,n._thumbnail=i.url):typeof t.types.large_thumb=="object"?(i=t.types.large_thumb,n._thumbnail=i.url):typeof t.types.original=="object"&&(i=t.types.original,n._thumbnail=i.url)),n._label=t.media_obj.users_obj.label,typeof t.media_obj.sports_obj=="object"&&(n._sublabel=o(t.media_obj.sports_obj.sport_name)),n._link="javascript: void(0);",t.media_obj.hasOwnProperty("is_owner")&&(r=t.media_obj.is_owner);break;case"1":typeof t.user_picture_obj=="object"&&typeof t.user_picture_obj.types=="object"&&(typeof t.user_picture_obj.types.standard_thumb=="object"?(i=t.user_picture_obj.types.standard_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.large_thumb=="object"?(i=t.user_picture_obj.types.large_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.original=="object"&&(i=t.user_picture_obj.types.original,n._thumbnail=i.url)),n._label=t.label,n._sublabel="Votes: "+t.num_votes+", Followers: "+t.num_followers,n._link="/#profile/"+t.id,t.hasOwnProperty("is_owner")&&(r=t.is_owner);break;case"8":n._detailclass="game",i=t.game_picture!==null?t.game_picture.types.standard_thumb:{height:440,width:440,url:"http://cdn.athletez.com/resources/icons/game/square_game.png"},n._thumbnail=i.url,n._label=t.game_day,n._link="/#game/"+t.id;var a="",f=t.teams;if(f!=null)var l=f.length;for(var c=0;c<l;c++)a+="<span>",a+=o(t.teams[c].team_name),a+="</span>",c+1<t.teams.length&&(a+=" VS. ");t.hasOwnProperty("is_owner")&&(r=t.is_owner),n._sublabel=a}n.show_edit=r==1?!0:undefined;var h=u.to_html(this.template,n);this.$el.html(h);var p="120px",d="92px";this.$el.find(".image-outer-h").mouseout(function(){s(this).find(".action-block").css({opacity:0}),s(this).find(".detail-view").css({bottom:"-"+d}),s(this).find(".detail-view.game").css({bottom:"-"+p})});if(i!="undefined"&&i!=null){var v=i.width/220,m=i.height/220;i.width=parseInt(i.width),i.height=parseInt(i.height);var g=i.width>i.height?-(i.width/m-220)/2:-(i.height/v-220)/2;g>0&&(g=0),i.width>i.height?this.$el.find("img.list-thumbnail").css({"max-width":i.width/m,left:g}):this.$el.find("img.list-thumbnail").css({"max-height":i.height/v,top:g})}return this.$el.find(".image-outer-h").mouseover(function(){s(this).find(".detail-view").css({bottom:"0px"}),s(this).find(".action-block").css({opacity:90})}),this.$el.find(".vote-h").click(function(t){e.vote(t)}),this.$el.find(".follow-h").click(function(t){e.follow(t)}),this.$el.find(".edit-h").click(function(t){e.edit(t)}),this.$el.find(".delete-h").click(function(t){e["delete"](t)}),this},vote:function(e){e.preventDefault(),console.log(this.model),e.stopPropagation();var t=new a;t.userId=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,t.setData(),t.save(),s.when(t.request).done(function(){s(e.currentTarget).addClass("link-disabled")})},follow:function(e){e.preventDefault(),console.log(e.target),e.stopPropagation();var t=new f;t.userId=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,t.save(),s.when(t.request).done(function(){console.log(t.get("payload")),typeof t.get("payload").follower=="object"&&typeof t.get("payload").subject=="object"&&t.get("payload").id>0?s(e.currentTarget).addClass("link-disabled"):console.log("FAIL")})},edit:function(e){e.stopPropagation(),e.preventDefault();var t=this,n=this.model.get("payload");switch(n.enttypes_id){case"23":break;case"21":break;case"1":window.location.hash="profile/"+n.id;break;case"8":window.location.hash="game/"+n.id}console.log(this.model)},"delete":function(e){e.stopPropagation(),e.preventDefault(),console.log("delete")}}),i}),define("text!media/templates/image-board.html",[],function(){return'<!--{{#payload}}\r\n    <div class="textcenter"><img src="{{base_url}}{{image_path}}" alt="{{image_title}}"/></div>\r\n    {{#image_title}}<h3>{{image_title}}</h3>{{/image_title}}\r\n    {{#num_votes}}Votes: {{num_votes}} <br/>{{/num_votes}}\r\n{{/payload}}-->'}),define("media/views/image-board",["require","text!media/templates/image-board.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.BaseView,o=r._;return n=s.extend({tagName:"li",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){s.prototype.render.call(this)}}),n}),define("text!media/templates/add-image.html",[],function(){return'\r\n{{#payload}}\r\n<form>\r\n<div class="row-fluid">\r\n    <input type="text" name="title" id="title" placeholder="Image Title"/><br/>\r\n    ...<br/>\r\n    <input type="button" id="addimage" value="Add Image"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("media/views/add-image",["require","text!media/templates/add-image.html","facade","views","media/models/image"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("media/models/image"),o=i.BaseView;return n=o.extend({tagName:"li",template:t,events:{"click #addimage":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("AddImageView expected options.collection.");!this.model},render:function(){o.prototype.render.call(this),this.input=this.$("#title")},submitHandler:function(e){e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();if(t!=""){var n=this.model.get("payload");n.image_title=this.input.val(),this.model.save();var r=this.model.clone();r.id=Math.ceil(Math.random()*1e5),this.collection.push(r),this.input.val("")}}}),n}),define("text!media/templates/image-list.html",[],function(){return'<ul class="image-list"></ul>\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">See more</a></div>\r\n'}),define("media/views/image-list",["facade","views","utils","media/views/image-item","media/views/image-board","media/views/add-image","text!media/templates/image-list.html"],function(e,t,n,r,i,s,o){var u,a,f=e.$,l=e._,c=require("vendor"),h=n.lib.Channel,p=t.CollectionView,d=t.SectionView,v=c.Mustache;return a=p.extend(d.prototype),u=a.extend({__super__:p.prototype,template:o,_tagName:"li",_className:"image",page:0,page_limit:8,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore","click .image-outer-h":"initPhotoPlayer"},renderTemplate:function(){var e=v.to_html(this.template);return this.$el.html(e),this},initialize:function(e){e.name?this.name=e.name:this.name="image list",e.collecton&&(this.collection=e.collection),this.renderTemplate();var t=this;t.allData=this.collection.toArray(),t.seeMore(),p.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");l.bindAll(this),this.addSubscribers(),this.setupBoardView(),this.setupAddView()},initPhotoPlayer:function(e){console.log(this.collection);var t=f(e.target).parents("li").index()-1;t<0&&(t=0),routing.trigger("photo-player-init",t,this.allData,this.collection.id,!0)},seeMore:function(e){var t=this.allData.length,n=this.page*this.page_limit,r=n+this.page_limit;t<=r&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(n,r)):this.collection.reset(this.allData.slice(n,r)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},childViews:{},setupAddView:function(){function r(e){t.model=e,t.render(),f(this.listView).append(t.el)}var e,t=new s({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),h("addimage:fetch").subscribe(r)},filterWithImageType:function(e){var t=this.collection;return f.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t},setupBoardView:function(){function s(e){n.model=e,n.render()}if(this.collection.size()==0)return;var e=this.filterWithImageType(this.imagetype),t,n=new i({collection:e,model:e.at(0)}),r=this.addChildView(n);this.childViews.board=n,this.callbacks.add(function(){r(),n.render(),f(this.listView).prepend(n.el)}),h("changeimage"+this.collection.id).subscribe(s)}}),u}),define("text!registration/templates/fbimage-board.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter fbimagecontainer pane">\r\n        <img id="image-select" src="{{original}}" alt="{{image_title}}"/>\r\n        <div class="coords" style="display:none;">\r\n            <div>crop x <input name="crop-x" type="hidden" /></div>\r\n            <div>crop y <input name="crop-y" type="hidden" /></div>\r\n            <div>crop width <input name="crop-width" type="hidden" /></div>\r\n            <div>crop height <input name="crop-height" type="hidden" /></div>\r\n            <div>image width <input name="image-width" type="hidden" /></div>\r\n            <div>image height <input name="image-height" type="hidden" /></div>            \r\n        </div>\r\n    </div>\r\n{{/payload}}\r\n'}),function(e){e.fn.jrac=function(t){var n={crop_width:200,crop_height:100,crop_x:0,crop_y:0,crop_resize:!0,crop_aspect_ratio:null,image_width:null,image_height:null,zoom_min:100,zoom_max:3e3,viewport_image_surrounding:!1,viewport_width:null,viewport_height:null,viewport_resize:!0,viewport_content_left:0,viewport_content_top:0,viewport_onload:null};return this.each(function(){if(!e(this).is("img"))return;var r=!1;typeof t=="object"?e.extend(n,t):t=="destroy"&&(r=!0);var i=e(this),s=!1;i.parent().hasClass("jrac_viewport")&&(s=!0),s&&r?(i.draggable("destroy"),i.parent().find(".jrac_crop").remove(),i.parent().parent().find(".jrac_zoom_slider").remove(),i.parent().append(i.data("original")),i.parent().unwrap(),i.unwrap(),i.remove()):i.data("original",i.clone());if(r)return;s||i.hide().css("position","absolute").wrap('<div class="jrac_container"><div class="jrac_viewport"></div></div>');var o=i.parent(),u=o.parent(),a=e('<div class="jrac_loading" />');o.append(a);var f=function(){e.extend(i,{scale_proportion_locked:!0,originalWidth:i.width(),originalHeight:i.height()}),i.width(n.image_width).height(n.image_height),n.viewport_image_surrounding?o.width(i.width()).height(i.height()):o.width(n.viewport_width).height(n.viewport_height),i.css({left:n.viewport_content_left,top:n.viewport_content_top});if(!s){var t=e('<div class="jrac_zoom_slider"><div class="ui-slider-handle"></div></div>').width(o.width()).slider({value:i.width(),min:n.zoom_min,max:n.zoom_max,start:function(n,r){e.extend(t,{on_start_width_value:r.value,on_start_height_value:i.height()})},slide:function(e,n){var r=Math.round(t.on_start_height_value*n.value/t.on_start_width_value);i.height(r),i.width(n.value),o.observator.notify("jrac_image_height",r),o.observator.notify("jrac_image_width",n.value)}});u.append(t),n.viewport_resize&&o.resizable({resize:function(e,n){t.width(n.size.width)}}),i.draggable({drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});var r=e('<div class="jrac_crop"><div class="jrac_crop_drag_handler"></div></div>').css({width:n.crop_width,height:n.crop_height,left:n.crop_x+n.viewport_content_left,top:n.crop_y+n.viewport_content_top}).draggable({containment:o,handle:"div.jrac_crop_drag_handler",drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});n.crop_resize&&r.resizable({containment:o,aspectRatio:n.crop_aspect_ratio,resize:function(e,t){t.size.width!=t.originalSize.width&&o.observator.notify("jrac_crop_width",r.width()),t.size.height!=t.originalSize.height&&o.observator.notify("jrac_crop_height",r.height())}}),o.append(r)}e.extend(o,{$container:u,$image:i,$crop:r,$zoom_widget:t,observator:{items:{},register:function(e,t,n){e&&t&&(this.items[e]={element:t,callback:n})},unregister:function(e){delete this.items[e]},notify:function(t,n){if(this.items[t]){var r=this.items[t].element,s=this.items[t].callback;r.trigger(t,[o,n]),e.isFunction(s)&&s.call(o,t,r,n)}i.trigger("jrac_events",[o])},notify_all:function(){this.notify("jrac_crop_x",this.crop_position_x()),this.notify("jrac_crop_y",this.crop_position_y()),this.notify("jrac_crop_width",r.width()),this.notify("jrac_crop_height",r.height()),this.notify("jrac_image_width",i.width()),this.notify("jrac_image_height",i.height())},crop_position_x:function(){return r.position().left-i.position().left},crop_position_y:function(){return r.position().top-i.position().top},crop_consistent:function(){return this.crop_position_x()>=0&&this.crop_position_y()>=0&&this.crop_position_x()+r.width()<=i.width()&&this.crop_position_y()+r.height()<=i.height()},set_property:function(e,n){n=parseInt(n);if(isNaN(n))return;switch(e){case"jrac_crop_x":r.css("left",n+i.position().left);break;case"jrac_crop_y":r.css("top",n+i.position().top);break;case"jrac_crop_width":r.width(n);break;case"jrac_crop_height":r.height(n);break;case"jrac_image_width":if(i.scale_proportion_locked){var s=Math.round(i.height()*n/i.width());i.height(s),this.notify("jrac_image_height",s)}i.width(n),t.slider("value",n);break;case"jrac_image_height":if(i.scale_proportion_locked){var o=Math.round(i.width()*n/i.height());i.width(o),this.notify("jrac_image_width",o),t.slider("value",o)}i.height(n)}this.notify(e,n)}}}),a.hide(),a.remove(),i.show(),e.isFunction(n.viewport_onload)&&(n.viewport_onload.call(o),o.observator.notify_all())},l=i.attr("src");/^data:image/.test(l)?f():(l=l+(l.search(/\?/)<0?"?":"&")+"jracrandom="+(new Date).getTime(),e("<img>").attr("src",l).load(f()))})}}(jQuery),define("jquery.jrac",function(){}),define("registration/views/fbimage-board",["require","text!registration/templates/fbimage-board.html","facade","views","utils","jquery.jrac"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=r._,a=r.$,f=s.lib.Channel;return n=o.extend({tagName:"div",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){console.log("fb image board render"),console.log("fb image board collection"),console.log(this.collection);var e=this;o.prototype.render.call(this)},selectArea:function(e,t){a("#x1").val(t.x1),a("#y1").val(t.y1),a("#x2").val(t.x2),a("#y2").val(t.y2),a("#w").val(t.width),a("#h").val(t.height)},initCropView:function(){a("#image-select").jrac({crop_width:150,crop_height:150,crop_aspect_ratio:"1:1",crop_x:100,crop_y:100,image_width:400,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){a(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,a(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=a(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},removeCropView:function(){a("#image-select").jrac("destroy"),a("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=this.$(".coords :input").serializeArray(),t=this.model.get("payload");a.each(e,function(e,n){t[n.name]=n.value}),this.model.set("payload",t)}}),n}),define("text!registration/templates/picture_buttons.html",[],function(){return'\r\n<div id="picture-buttons">\r\n    <a href="#" class="use_image">Use This Image</a>\r\n    <a href="#" class="upload_image">Upload a New Image</a>\r\n</div>\r\n'}),define("registration/views/picture_buttons",["require","text!registration/templates/picture_buttons.html","vendor","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=s.lib.Channel,a=e("vendor"),f=a.Mustache;return n=o.extend({tagName:"div",className:"picture-buttons clearfix",template:t,events:{"click .use_image":"clickUseImage","click .upload_image":"clickUploadImage"},render:function(){var e=f.to_html(this.template);return this.$el.html(e),this},clickUseImage:function(e){e.preventDefault(),u("registration-use-image").publish()},clickUploadImage:function(e){e.preventDefault(),u("registration-upload-image").publish()}}),n}),define("registration/views/fbimage-list",["facade","utils","registration/views/fbimage-item","media/views/image-list","registration/views/fbimage-board","registration/views/picture_buttons","models/base"],function(e,t,n,r,i,s,o){var u,a=e._;return u=r.extend({id:"fbimage-list",name:"Facebook Image List",tagName:"div",_tagName:"div",_className:"fbimage",_view:n,setupAddView:function(){console.log("setup Addview");var e=this,t=new s,n=this.addChildView(t);this.childViews.buttons=t,this.callbacks.add(function(){n(),t.render(),e.$el.append(t.el)})},setupBoardView:function(){function r(){var t=e.childViews.board;t.getImageInfo();var n=t.model.get("payload"),r=new o(n);r.url=function(){return testpath?testpath+"/user/savecrop":"/api/user/savecrop"},r.saveSuccess=function(t,n){o.prototype.saveSuccess.call(this,t,n);var r=t.get("exec_data"),i=t.get("payload");!r.exec_error&&i&&Channel("registration-change-picture").publish(i.image_path),$("#"+e.id).dialog("close")},r.saveError=function(t,n){o.prototype.saveError.call(this,t,n),$("#"+e.id).dialog("close")},r.save()}function s(){$("#"+e.id).dialog("close")}console.log("setup Board View"),console.log(this.collection),console.log(this.collection.at(0));var e=this,t=new i({collection:this.collection,model:this.collection.at(0)}),n=this.addChildView(t);this.childViews.board=t,this.callbacks.add(function(){t.render(),e.$el.prepend(t.el),a.delay(t.initCropView,400)}),Channel("changeimage"+this.collection.id).subscribe(this.changeBoard),Channel("registration-use-image").subscribe(r),Channel("registration-upload-image").subscribe(s)},changeBoard:function(e){console.log("changeBoard"),console.log(e),this.removeCropView(),this.childViews.board.model=e,this.childViews.board.render(),this.childViews.board.initCropView()},initCropView:function(){this.childViews.board.initCropView()},removeCropView:function(){this.childViews.board.removeCropView()}}),u}),define("registration/views/register_facebook",["require","text!registration/templates/register_facebook.html","facade","views","utils","jquery.pstrength","registration/collections/fbimages","registration/views/fbimage-list"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView,a=e("registration/collections/fbimages"),f=e("registration/views/fbimage-list");return n=u.extend({id:"main-content",events:{keypress:"stopSubmit","click .change-field":"changeField","click .diff_fb_pic":"diffFBPicture","click .upload_new_image":"uploadNewImage","click .next":"nextStep"},template:t,initialize:function(e){function n(e){t.$(".picture").attr("src",e)}function r(){t.initFBPictures()}function i(){t.initUploadImage()}var t=this;if(!this.model)throw new Error("RegistrationFacebookView expected options.model.");t.parseFBData(this.model.get("payload")),u.prototype.initialize.call(this,e),o("registration-change-picture").subscribe(n),o("registration-diff-fbpicture").subscribe(r),o("registration-upload-image").subscribe(i)},childViews:{},render:function(e,t,n){u.prototype.render.call(this,e,t,n),this.$(".password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},diffFBPicture:function(e){e.preventDefault(),this.initFBPictures()},uploadNewImage:function(e){e.preventDefault(),this.initUploadImage()},parseFBData:function(e){e.hs_exists=e.high_school?!0:!1,e.dob_exists=e.birthday?!0:!1,e.email_exists=e.email?!0:!1,this.model.set("payload",e)},initFBPictures:function(){var e=this;this.fbimages?($("#"+this.fbImageListView.id).dialog({width:"80%",close:e.removeListView}),this.fbImageListView.initCropView()):(this.fbimages=new a,this.fbimages.fetch(),$.when(this.fbimages.request).done(function(){debug.log("this.fbimages are as follows"),debug.log(e.fbimages.toJSON()),e.setupFBPictures()}))},setupFBPictures:function(){var e=this;this.fbImageListView=new f({collection:this.fbimages});var t=this.addChildView(this.fbImageListView);this.childViews.fbImageListView=this.fbImageListView,this.callbacks.add(function(){t()}),this.fbImageListView.render(),this.$el.append(e.fbImageListView.el),$("#"+this.fbImageListView.id).dialog({width:"80%",close:e.removeListView})},removeListView:function(){this.childViews.fbImageListView.removeCropView()},initUploadImage:function(){alert("Upload Image")},changeField:function(e){e.preventDefault(),$parent=this.$(e.target).parent(),id=$parent.attr("data-name"),value=$parent.attr("data-value"),$parent.html('<input type="text" id="'+id+'" name="'+id+'" value="'+value+'"/>')},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=this.model.get("payload");$.each(t,function(e,t){n[t.name]=t.value});if(n["password"]==""||n["password-again"]==""){alert("Please input a password");return}if(n["password"]!=n["password-again"]){alert("Please input a password correctly");return}if(n["agree"]==null){alert("Please agree to the Terms of Service");return}this.model.attributes.id=!1,this.model.set({payload:n,id:1}),this.model.url=function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+n.users_id},this.model.save(),o("registration-select-org").publish()}}),n}),define("text!registration/templates/register_email.html",[],function(){return'\r\n<h1>The Basics</h1>\r\n<div class="row-fluid">\r\n    <form class="form-horizontal">\r\n        <div class="control-group">\r\n            <label class="control-label" for="first_name">First Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="firstname" id="first_name" placeholder="First Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="last_name">Last Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="lastname" id="last_name" placeholder="Last Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="dob">DOB: </label>\r\n            <div class="controls">\r\n                <input type="text" name="dob" id="dob" placeholder="Birthday">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="email">Email: </label>\r\n            <div class="controls">\r\n                <input type="text" name="email" id="email" placeholder="Email">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label">Gender: </label>\r\n            <div class="controls" id="gender">\r\n                <label for="male"><input type="radio" id="male" name="gender" value="M"> Male</label>\r\n                <label for="female"><input type="radio" id="female" name="gender" value="F"> Female</label>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="password">Password: </label>\r\n            <div class="controls">\r\n                <input type="password" id="password" name="password" placeholder="Password"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="re_password">Again: </label>\r\n            <div class="controls">\r\n                <input type="password" id="re_password" name="re_password" placeholder="Password Again"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <p class="agree-error text-error"></p>\r\n            <label for="accept_terms">\r\n                <input type="checkbox" id="accept_terms" name="accept_terms"/>I have read and agree to the <a href="#">Terms of Service</a>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </label>            \r\n            <a href="#" class="next">What\'s Next</a>\r\n        </div>\r\n    </form>\r\n</div>'}),define("registration/views/register_email",["require","text!registration/templates/register_email.html","facade","views","utils","jquery.pstrength","models/base"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView,a=e("models/base");return n=u.extend({id:"main-content",events:{keypress:"stopSubmit","click .next":"nextStep"},template:t,initialize:function(e){if(!this.model)throw new Error("RegistrationEmailView expected options.model.");u.prototype.initialize.call(this,e)},render:function(e,t,n){u.prototype.render.call(this,e,t,n),this.$("#password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n={};$.each(t,function(e,t){n[t.name]=t.value});var r=new a(n);r.url=function(){return"/api/user/register"},r.saveSuccess=function(e,t){a.prototype.saveSuccess.call(this,e,t);var n=t.exec_data,r=t.payload;n.exec_error||o("registration-select-org").publish(r)},r.save()}}),n}),define("text!registration/templates/upload_image.html",[],function(){return'\r\nUpload Image\r\n\r\n<a href="#" class="next">What\'s Next</a>'}),define("registration/views/upload_image",["require","text!registration/templates/upload_image.html","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView;return n=u.extend({id:"main-content",events:{"click .next":"nextStep"},template:t,initialize:function(e){u.prototype.initialize.call(this,e)},nextStep:function(e){e.preventDefault(),o("registration-select-org").publish()}}),n}),define("text!registration/templates/select_org.html",[],function(){return'\r\n<h1>Athletic Organizations</h1>\r\n<div class="step-club">\r\n<div>Link Up With Your Teams</div>\r\n<a href="#" class="find_club">\r\n    <h3>Find My Club</h3>\r\n    <p>Use our club locator to find your sports club and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{#show_highschool}}\r\n<div class="step-highschool" style="display:none;">\r\n<div class="text-error">Only display high school chooser if age <= 18</div>\r\n<a href="#" class="high_school">\r\n    <h3>High School Locator</h3>\r\n    <p>If you play for your high school, click here to find your school and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{/show_highschool}}\r\n<div class="step-sport" style="display:none;">\r\n<a href="#" class="indiv_sports">\r\n    <h3>Individual Sports</h3>\r\n    <p>If you are an athlete who competes without a team, this is where you\'ll find your sport.</p>\r\n</a>\r\n</div>\r\n<div class="step-next" style="display:none;">\r\n<a href="#" class="next">What\'s Next</a>\r\n</div>\r\n'}),define("registration/models/my_club",["models/base"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/myclub":"/api/user/basics/"+this.id}}),t}),define("text!registration/templates/find_my_club.html",[],function(){return'\r\n<h2>Find My Sports Club</h2>\r\n<form id="findClubFrm" class="form-horizontal">\r\n    <div class="control-group">\r\n        <label class="control-label" for="states_id">What State?</label>\r\n        <div class="controls">\r\n            <input id="states_id" name="state_name" placeholder="Just Start Typing" value="{{state}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="sports_id">What Sport?</label>\r\n        <div class="controls">\r\n            <input id="sports_id" name="sport_name" placeholder="Just Start Typing" value="{{sport}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="orgs_id">Club Name</label>\r\n        <div class="controls">\r\n            <input id="orgs_id" name="org_name" placeholder="Just Start Typing" value="{{club}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="complevels"></div>\r\n    <div class="seasons"></div>\r\n    <a href="#" class="back">Go Back</a>    \r\n    <a href="#" class="not_find">Can\'t Find Your Club?</a>\r\n    <a href="#" class="continue">Continue</a>\r\n</form>\r\n'}),define("location/models/state",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{location_id:0,location_name:null,location_country:null},desc:"State Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("location/collections/states",["facade","collections","location/models/state","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){return testpath?testpath+"/state_search":this.state_name==undefined?"/api/state/search":"/api/state/search/?state_name="+this.state_name},fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("registration/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports",["facade","collections","sportorg/models/sport","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){return testpath?testpath+"/sport_search":(this.state_name==undefined,"/api/sport/search/?sport_name="+this.sport_name+"&gender="+this.gender)},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){}}),i}),define("registration/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/club",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/clubs",["facade","collections","sportorg/models/club","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){var e=this;return testpath?testpath+"/club_search":(e.states_id==undefined||e.sports_id==undefined||e.club_name==undefined,"/api/org/search/?sports_club=1&states_id="+e.states_id+"&sports_id="+e.sports_id+"&org_name="+e.club_name)},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var r in n){var i=new SportorgSportModel;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t)}}),i}),define("registration/collections/clubs",["facade","collections","sportorg/collections/clubs","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("registration/views/find_my_club",["require","text!registration/templates/find_my_club.html","facade","views","utils","models/base","jqueryui","registration/collections/states","registration/collections/sports","registration/collections/clubs"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=e("models/base");return BaseView=i.BaseView,_=r._,$=r.$,Channel=s.lib.Channel,RegistrationStatesCollection=e("registration/collections/states"),RegistrationSportsCollection=e("registration/collections/sports"),RegistrationClubsCollection=e("registration/collections/clubs"),n=BaseView.extend({id:"find-my-club",tagName:"div",className:"find-my-club",template:t,events:{"click .back":"closeView","click .not-find":"notFind","click .continue":"highSchoolView","keyup #states_id":"keyupState","keyup #sports_id":"keyupSport","keyup #orgs_id":"keyupClub","blur #states_id":"changeState","blur #sports_id":"changeSport","change #orgs_id":"changeClub"},states:[],states_id:"",sports:[],sports_id:"",clubs:[],clubs_id:"",setOptions:function(e){if(!this.model)throw new Error("RegistrationFindMyClubView expected options.model.")},initialize:function(e){BaseView.prototype.initialize.call(this,e)},render:function(){var e=this;BaseView.prototype.render.call(this)},closeView:function(e){e.preventDefault(),Channel("registration-close-clubview").publish()},notFind:function(e){e.preventDefault()},highSchoolView:function(e){e.preventDefault()},keyUp:function(e){switch(this.$(e.target).attr("id")){case"state":this.keyupState(e);break;case"sport":this.keyupSport(e);break;case"club":this.keyupClub(e)}},keyupState:function(e){var t=this,n=this.$("#states_id").val(),r=[];if(n!=""){var i=new RegistrationStatesCollection;i.state_name=n,i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();(e==null||e.length<1)&&t.$("#states_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.states=[];for(var n in e)t.states.push(e[n].payload);debug.log("self.states",t.states),t.states.forEach(function(e,t){r.push(e.name)}),debug.log("stateArr",r),t.$("#states_id").autocomplete({source:r})})}},changeState:function(e){var t=this.$("#states_id").val(),n=this;n.states_id="",n.states.forEach(function(e,r){e["name"]==t&&(n.states_id=e.id)}),this.keyupClub()},keyupSport:function(e){var t=this,n=t.model,r="all";n.get("payload").gender&&(r=n.get("payload").gender);var i=this.$("#sports_id").val(),s=[];if(i!=""){var o=new RegistrationSportsCollection;o.sport_name=i,o.gender=r,o.fetch(),$.when(o.request).done(function(){if(o.isError())return;var e=o.toJSON();console.log("Sports Model",e),(e==null||e.length<1)&&t.$("#sports_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.sports=[];for(var n in e)t.sports.push(e[n].payload);console.log("sports",t.sports),t.sports.forEach(function(e,t){s.push(e.sport_name)}),console.log("sportArr",s),t.$("#sports_id").autocomplete({source:s})})}},changeSport:function(e){var t=this.$("#sports_id").val(),n=this;n.sports_id="",n.sports.forEach(function(e,r){e["sport_name"]==t&&(n.sports_id=e.sport_id)}),this.keyupClub()},keyupClub:function(e){var t=this,n=this.$("#orgs_id").val(),r=[];if(n!=""){var i=new RegistrationClubsCollection;console.log(t.states_id,t.sports_id,n),i.states_id=t.states_id,i.sports_id=t.sports_id,i.club_name=n,i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();console.log("models",e),(e==null||e.length<1)&&t.$("#orgs_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.clubs=[];for(var n in e)t.clubs.push(e[n].payload);t.clubs.forEach(function(e,t){r.push(e.org_name)}),console.log("clubArr",r),t.$("#orgs_id").autocomplete({source:r})})}},changeClub:function(e){var t=this.$("#orgs_id").val(),n=this;n.clubs_id=0,n.clubs.forEach(function(e,r){e["name"]==t&&(n.clubs_id=e.id)})}}),n}),define("registration/views/select_org",["require","text!registration/templates/select_org.html","facade","views","utils","registration/models/my_club","registration/views/find_my_club"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=r.$,u=s.lib.Channel,a=i.SectionView,f=e("registration/models/my_club"),l=e("registration/views/find_my_club");return n=a.extend({id:"main-content",step:1,events:{"click .find_club":"findMyClub","click .high_school":"highSchoolLocator","click .indiv_sports":"individualSports","click .next":"nextStep"},template:t,initialize:function(e){a.prototype.initialize.call(this,e)},childViews:[],findMyClub:function(e){e.preventDefault();if(this.step!=1)return;var t=this;this.myclub?(this.myclub.fetch(),this.findMyClubView.render(),o("#"+this.findMyClubView.id).dialog({width:"80%",close:t.removeMyClubView})):(this.myclub=new f,this.myclub.id=t.model.get("payload").id,this.myclub.fetch(),o.when(this.myclub.request).done(function(){t.setupFindMyClub()}))},setupFindMyClub:function(){function n(){o("#"+e.findMyClubView.id).dialog("close")}var e=this;this.findMyClubView=new l({model:this.myclub});var t=this.addChildView(this.findMyClubView);this.childViews.findMyClubView=this.findMyClubView,this.callbacks.add(function(){t()}),this.findMyClubView.render(),this.$el.append(e.findMyClubView.el),o("#"+e.findMyClubView.id).dialog({width:"80%",close:e.removeMyClubView}),u("registration-close-clubview").subscribe(n)},removeMyClubView:function(){},highSchoolLocator:function(e){e.preventDefault();if(this.step!=2)return},individualSports:function(e){e.preventDefault();if(this.step!=3)return},nextStep:function(e){e.preventDefault();if(this.step!=4)return}}),n}),define("registration",["require","text!registration/templates/layout.html","facade","controller","models","views","utils","registration/models/select_type","registration/models/register_facebook","registration/models/register_email","registration/models/upload_image","registration/models/select_org","registration/views/select_type","registration/views/register_facebook","registration/views/register_email","registration/views/upload_image","registration/views/select_org"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("registration/models/select_type"),f=e("registration/models/register_facebook"),l=e("registration/models/register_email"),c=e("registration/models/upload_image"),h=e("registration/models/select_org"),p=e("registration/views/select_type"),d=e("registration/views/register_facebook"),v=e("registration/views/register_email"),m=e("registration/views/upload_image"),g=e("registration/views/select_org"),y=o.LayoutView,b=r.$,w=r._,E=u.debug,S=u.lib.Channel,x=["/pages/registration/registration.css","/css/style.jrac.css"];return n=i.extend({initialize:function(e){return S("load:css").publish(x),w.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.setupLayout().render(),this.refreshPage(),this.createData(),this.handleDeferreds()},createData:function(){this.select_type=new a},handleDeferreds:function(){function t(){e.initRegisterFacebook()}function n(){e.initRegisterEmail()}function r(){e.uploadImage()}function i(t){e.selectOrg(t)}var e=this;e.setupSelectTypeView(),S("registration-with-facebook").subscribe(t),S("registration-with-email").subscribe(n),S("registration-uploadimage-email").subscribe(r),S("registration-select-org").subscribe(i)},refreshPage:function(){var e;this.selectTypeView&&(b(this.selectTypeView.destination).html(""),e=b.inArray(this.selectTypeView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerFacebookView&&(b(this.registerFacebookView.destination).html(""),e=b.inArray(this.registerFacebookView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerEmailView&&(b(this.registerEmailView.destination).html(""),e=b.inArray(this.registerEmailView,this.scheme),~e&&this.scheme.splice(e,1)),this.selectOrgView&&(b(this.selectOrgView.destination).html(""),e=b.inArray(this.selectOrgView,this.scheme),~e&&this.scheme.splice(e,1))},setupSelectTypeView:function(){this.selectTypeView=new p({model:this.select_type,name:"Select Registration Type",destination:"#main-content"}),this.scheme.push(this.selectTypeView),this.layout.render()},initRegisterFacebook:function(){var e=this;this.refreshPage(),this.register_facebook=new f,this.register_facebook.fetch(),b.when(this.register_facebook.request).done(function(){e.setupRegisterFacebookView()})},setupRegisterFacebookView:function(){this.registerFacebookView=new d({model:this.register_facebook,name:"Registration with Facebook",destination:"#main-content"}),this.scheme.push(this.registerFacebookView),this.layout.render()},initRegisterEmail:function(){var e=this;this.refreshPage(),this.register_email=new l,e.setupRegisterEmailView()},setupRegisterEmailView:function(){this.registerEmailView=new v({model:this.register_email,name:"Registration with Email Address",destination:"#main-content"}),this.scheme.push(this.registerEmailView),this.layout.render()},uploadImage:function(){var e=this;this.refreshPage(),this.upload_image=new c,this.setupUploadImageView()},setupUploadImageView:function(){this.uploadImageView=new m({model:this.upload_image,name:"Registration Upload Image",destination:"#main-content"}),this.scheme.push(this.uploadImageView),this.layout.render()},selectOrg:function(e){var t=this;this.refreshPage(),this.select_org=new h,this.select_org.id=e.id,this.select_org.fetch(),b.when(this.select_org.request).done(function(){t.setupSelectOrgView()})},setupSelectOrgView:function(){this.selectOrgView=new g({model:this.select_org,name:"Registration Select Org",destination:"#main-content"}),this.scheme.push(this.selectOrgView),this.layout.render()},setupLayout:function(){var e;return this.layout?this.layout:(e=new y({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout)}}),n});