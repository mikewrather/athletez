define(["require","text!videopreview/templates/basic.html","facade","controller","models","views","utils","videopreview/models/base","videopreview/models/videoup","videopreview/views/uploader","videopreview/views/preview"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=s.LayoutView,p=n.$,d=n._,v=o.debug,m=o.lib.Channel,g=[base_url+"pages/imageup/imageup.css"];return c=r.extend({defaults:{uploader:{}},initialize:function(e){return m("load:css").publish(g),d.bindAll(this),this.handleOptions(e),this.init(e),this},init:function(e){v.log("VideoPreview Init"),this.setupLayout(),this.showVideoPreview()},setupLayout:function(){return this.scheme=[],p("div#modalPopup").remove(),p("body").append('<div id="modalPopup"></div>'),pageLayout=new h({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,console.log(this.layout),this.layout},showVideoPreview:function(){alert("show video preview22");var e=new a,t=new f({name:"Video Upload View",model:e,destination:"#main-content-img"},this.attr);alert("before Channel33 "),alert("after Channel33 "),this.scheme.push(t),alert("after Channel34443 "),this.layout.render()},testupload:function(e){},afterRender:function(e){alert("before afterrender controller");var t=e.doUpload();alert("after afterender controller"),t.bind("Init",function(e,t){p("#filelist").html("<div></div>")});try{t.init(),alert("uploader inited")}catch(n){alert(n+"psb error")}t.bind("FilesAdded",function(e,n){maxCountError=!1,p.each(n,function(n,r){t.settings.max_file_count&&n>=t.settings.max_file_count?(maxCountError=!0,setTimeout(function(){e.removeFile(r)},50)):p("#filelist").append('<div id="'+r.id+'">'+r.name+" ("+plupload.formatSize(r.size)+") <b></b>"+"</div>"),maxCountError&&p("#resultdiv").html("You can only select one video at a time.").show()}),e.refresh()}),t.bind("UploadProgress",function(e,t){p("#"+t.id+" b").html(t.percent+"%")}),t.bind("Error",function(e,t){p("#filelist").append("<div>Error: "+t.code+", Message: "+t.message+(t.file?", File: "+t.file.name:"")+"</div>"),e.refresh()})},uploadVideo:function(e){alert("inside uploadvideo"),console.log("Called",e);var t=new a({file:e})}}),c});