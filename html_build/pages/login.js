/**
 * @license RequireJS text 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/* jQuery Resize And Crop (jrac)
 * A jQuery 1.4+ and jQueryUi 1.8+ plugin under GNU GENERAL PUBLIC LICENSE version 2 lisense.
 * Copyright (c) 2011 Cedric Gampert - cgampert@gmail.com
 */

/**
 * Copyright Facebook Inc.
 *
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
		 * @providesModule JSON3
		 * @preserve-header
		 *
		 *! JSON v3.2.3 | http://bestiejs.github.com/json3 | Copyright 2012, Kit Cambridge | http://kit.mit-license.org
		 */

/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.1
 *
 */

/*
 * Date Format 1.2.3
 * (c) 2007-2009 Steven Levithan <stevenlevithan.com>
 * MIT license
 *
 * Includes enhancements by Scott Trenda <scott.trenda.net>
 * and Kris Kowal <cixar.com/~kris.kowal/>
 *
 * Accepts a date, a mask, or a date and a mask.
 * Returns a formatted version of the given date.
 * The date defaults to the current date/time.
 * The mask defaults to dateFormat.masks.default.
 */

/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.6.5
 *
 */

define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.4",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!login/templates/layout.html",[],function(){return'<style type="text/css">\r\n	#logincontainer{\r\n		padding-left: 15px;\r\n		font-weight: bold;\r\n	}\r\n</style>\r\n<!--div id="Loginview" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n	<div id="">\r\n		<div class="modal-header">\r\n			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n			<h3 id="label">Login</h3>\r\n		</div>\r\n		<div id="main-content-reg"></div>\r\n	</div>	\r\n</div-->\r\n'}),define("text!chrome/templates/header.html",[],function(){return'\r\n<div class="row-fluid">\r\n    <div class="logo" itemscope itemtype="http://schema.org/Organization">\r\n    <% if(branding){ %>\r\n    <a class="brand" itemprop="url" title="Athletez Home Page"  href="http://www.athletez.com/#!home">\r\n	    <meta itemprop="name" content="Athletez.com - We\'re Athletez" />\r\n	    <meta itemprop="description" content="Athletez.com is an online community for athletes of all skill levels.  When you link up with your teams and sports organizations, upload and share photos and highlights, and follow the athletes you want to track, your athletic profile will automatically be created so others can see what\'s going on with you!" />\r\n		<meta itemprop="image" content="<%= branding.src %>"/>\r\n	    <div style="display:none;" itemprop="founder" itemscope itemtype="http://schema.org/Person">\r\n			<meta itemprop="name" content="Mike Wrather" />\r\n		    <meta itemprop="email" content="mike@athletez.com" />\r\n		    <meta itemprop="jobTitle" content="Co-Founder" />\r\n	    </div>\r\n	    <div style="display:none;" itemprop="founder" itemscope itemtype="http://schema.org/Person">\r\n		    <meta itemprop="name" content="Maxwell Doyle" />\r\n		    <meta itemprop="email" content="max@athletez.com" />\r\n		    <meta itemprop="jobTitle" content="Co-Founder" />\r\n	    </div>\r\n        <img itemprop="logo" src="<%= branding.src %>" id="header_logo" alt="<%= branding.alt %>" />\r\n    </a>\r\n	<% } %>\r\n    </div>\r\n\r\n    <div class="searchform">\r\n\r\n    </div>\r\n\r\n    <div class="account clearfix">\r\n        <% if(authorized){ %>\r\n            <div class="photo"><img src="" alt="<%= user_name %>"/></div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                    <% _.each(nav,function(element,index){\r\n\r\n	                console.log(element);\r\n	                console.log(element instanceof Array);\r\n\r\n	                if(element instanceof Array){\r\n	                  %>\r\n	                   <a class="nav nav_dropdown"><%= index %></a>\r\n	                    <ul class="header_menu hide" role="menu">\r\n	                         <% _.each(element,function(e2,index){ %>\r\n	                            <li><a <% if(e2.id){ %>id="<%= e2.id %>"<% } if(e2.className){ %>class="<%= e2.className %>" <% } %>href="<%= e2.link %>" ><%= e2.page %></a></li>\r\n	                        <% }); %>\r\n	                    </ul><%\r\n	                } else {\r\n	                    %><a class="nav"  href="<%= element.link %>" ><%= element.page %></a><%\r\n	                }\r\n	                %>\r\n\r\n                    <% }); %>\r\n\r\n\r\n\r\n\r\n\r\n\r\n	    <% }  else { %>\r\n            <a class="nav" href="<%=login_url %>" id="userlogin"><%=login_label %></a>\r\n	    <% } %>\r\n    </div>\r\n</div>\r\n\r\n'}),define("chrome/models/header",["models/base","utils/storage"],function(e,t){var n;return n=e.extend({defaults:{authorized:!1,branding:{alt:"Athletez Logo",src:"http://cdn.athletez.com/resources/img/athletez_logo_small.png"},search:{placeholder:"Search"},login_url:"#user/login",login_label:"SIGN IN",logout_url:"#logout",logout_label:"Log Out",signup_social_label:"Sign up for Free",signup_facebook_label:"Facebook",signup_email_label:"Email",signup_facebook_link:"/",signup_email_link:"/"},url:function(){return testpath?testpath+"/authcheck?time="+(new Date).getTime():"/authcheck?time="+(new Date).getTime()},saveCookie:function(){var e=new t("user","localStorage");e.create(this)}}),n}),define("text!signup/templates/layout.html",[],function(){return'<!--<div id="main-header">\r\n</div>\r\n\r\n<div id="main-content">\r\n</div>\r\n\r\n<div id="main-footer">\r\n</div>-->\r\n\r\n<div id="RegModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n	</div>\r\n	<div id="main-contentreg"></div>\r\n	<div class="modal-body">\r\n		<div class="inner-content-h"></div>\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n</div>\r\n'}),define("text!registration/templates/layout.html",[],function(){return'\r\n<div id="main-header">\r\n\r\n</div>\r\n\r\n<div id="main-content">\r\n    \r\n    \r\n    \r\n</div>\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n'}),define("controller",["facade","collections","models","utils"],function(e,t,n,r){var i,s=t.ApplicationStates,o=n.EventModel,u=e._,a=e.$,f=r.lib.Channel,l=e.Backbone.Model.extend;return i=function(e){e=e||{},e.title?document.title=e.title:document.title="Athletez",this.route=e.route,i.prototype.appStates?e.appStates&&(i.prototype.appStates=e.appStates):i.prototype.appStates=new s,this.route&&i.prototype.appStates&&this.getStoredState(),this.initialize(e)},i.extend=l,i.prototype={initialize:function(e){return this.triggerPublishers(),u.bindAll(this),this.handleOptions(e),this.addSubscribers(),this.handleDeferreds(),this},setParamsArray:function(e){if(e)for(var t in e)this[e[t].key]=e[t].value},generateRandomNumber:function(){var e=(new Date).getTime();return e+=Math.floor(Math.random()*200+1),e},setupSections:function(){},setupScheme:function(){},setupLayout:function(){var e;return this.layout=e,this.layout},handleDeferreds:function(){var e=this;a.when(null).then(function(){})},addSubscribers:function(){},removeSubscribers:function(){},triggerPublishers:function(){},meta:{activeViews:[],viewNames:[]},handleOptions:function(e){i.prototype.handleOptions(e)},routeChange:function(e){i.prototype.routeChange(options)},addStateChangeSubscriber:null},i.prototype.data=null,i.prototype.layout=null,i.prototype.scheme=[],i.prototype.sections={},i.prototype.route=null,i.prototype.handleOptions=function(e){e&&e.useFixtures&&this.useFixturesForWebServices()},i.prototype.transitionActiveViews=function(e){var t,n=this.layout,r=this.meta.sectionName,i=this.meta.activeViews=[];e=e||this.meta.presentation,t=function(t,s){s===e&&(t.state()==="not-rendered"&&t.render(),n.transition(r,t),i.push(s))},this.iterateOverLayoutViews(t)},i.prototype.renderInActiveViews=function(){var e;e=function(e){e.state()==="not-rendered"&&(e.callbacks.add(function(){e.state("not-displayed")}),e.render())},this.iterateOverLayoutViews(e)},i.prototype.iterateOverLayoutViews=function(e){var t=this.meta.activeViews,n=this.sections,r=this.meta.viewNames,i,s,o;for(o=0;o<r.length;o++)i=r[o],u.contains(t,i)||(s=n[i],e&&u.isFunction(e)&&e(s,i))},i.prototype.routeChange=function(e,t,n){var r={data:{}},s;if(e&&!u.isString(e))throw s="Controller routeChange expects string as 1st argument.",new Error(s);this.route=e,this.layout&&(this.layout.state({route:e}),r.data=this.layout.state(),u.extend(r,t||{}),i.prototype.appStates.add(r),this.data=r.data,debug.log(r),i.prototype.appStates.save(e)),n&&u.isFunction(n)&&n(this.data),debug.log("Controller routeChange method called with: "+e)},i.prototype.getStoredState=function(){var e;if(!this.route)throw new Error("Controller does not have route property.");return e=i.prototype.appStates.findInCollectionOrStorage(this.route),this.data=e&&e.data?e.data:e,this.data},i.prototype.addStateChangeSubscriber=function(e,t){function s(r,s){var o=e,a=t,f=n,l;f.layout&&(l=f.layout.state(),l&&i.prototype.appStates.add({name:f.route,data:l,expires:new Date(Date.now()+4032e4),storage:"localStorage"})),a&&u.isFunction(a)&&a(r,s)}var n=this,r;if(!e||!u.isString(e))throw r="controller method addStateChangeSubscriber expected string as 1st argument.",new Error(r);f(e+":stateChanged").subscribe(s)},i.prototype.remove=function(){var e;this.layout&&this.layout.remove();for(e in this)delete this[e]},i.prototype.webServices={},i.prototype.useFixturesForWebServices=function(){},i}),define("user/models/basics",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"undefined"==typeof this.id?testpath?testpath+"/user/basics/":"/api/user/basics/":testpath?testpath+"/user/basics/"+this.id:"/api/user/basics/"+this.id},initialize:function(){n.__super__.initialize.apply(this,arguments)},user_pic_small:function(){return this.payload.user_picture.types.small_thumb.url}}),n}),define("registration/models/select_type",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return"/api/user/basics/"+this.id},fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n)}}),t}),define("user/models/fbreg",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,birth_day:null,high_school:null,email:null,user_picture:null},desc:"Facebook Registration Information",exec_data:{exec_time:0,exec_error:!1},id:1})}),n}),define("registration/models/register_facebook",["facade","user/models/fbreg","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbreg":"/api/user/fbreg"}}),r}),define("registration/models/register_email",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+this.id}}),t}),define("registration/models/upload_image",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/uploadimage":"/api/user/uploadimage"}}),t}),define("registration/models/select_org",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!registration/templates/select_type.html",[],function(){return'\r\n<h1>Register with AthletesUp</h1>\r\n<a href="#" class="register_facebook">Sign up through Facebook</a>\r\n<br/><br/> OR <br/><br/>\r\n<a href="#" class="register_email">Register With Email Address</a>\r\n\r\n<a href="#" class="go_club">go club directly</a>\r\n<div id="fb-root"></div>'}),define("registration/views/select_type",["require","registration/models/select_type","text!registration/templates/select_type.html","facade","views","utils"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView;return r=a.extend({id:"main-content",events:{"click .register_facebook":"registerWithFacebook","click .register_email":"registerWithEmail","click .go_club":"selectOrg"},template:n,initialize:function(e){a.prototype.initialize.call(this,e),this.initModel()},registerWithFacebook:function(e){function t(){FB.login(function(e){e.authResponse?u("registration-with-facebook").publish():alert("Cancelled")},{scope:"email, user_birthday, user_photos"})}function n(){var e,n="facebook-jssdk",r=document.getElementsByTagName("script")[0];if(document.getElementById(n)){t();return}e=document.createElement("script"),e.id=n,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(e,r)}e.preventDefault(),window.fbAsyncInit=function(){FB.init({appId:App.Settings.appId,status:!0,cookie:!0,xfbml:!0,oauth:!0}),FB.getLoginStatus(function(e){e.status==="connected"?FB.api("/me",function(e){u("registration-with-facebook").publish()}):e.status==="not_authorized"?t():t()},{scope:"email, user_birthday, user_photos"})},n()},registerWithEmail:function(e){e.preventDefault(),u("registration-with-email").publish()},initModel:function(){function n(n){e.select_type=new t,e.select_type.id=n,e.select_type.fetch(),$.when(e.select_type.request).done(function(){e.model=e.select_type})}var e=this;u("app-inited").subscribe(n)},selectOrg:function(e){e.preventDefault();var t=this,n=t.model.get("payload");u("registration-select-org").publish(n)}}),r}),define("text!registration/templates/register_facebook.html",[],function(){return'{{#errorDisplay}}\r\n<div class="span8" style="color:red;"> Error: {{errorValue}}</div>\r\n{{/errorDisplay}}\r\n\r\n{{^errorDisplay}}\r\n{{#payload}}\r\n\r\n<div class="row-fluid">\r\n	<div class="span5">\r\n		<ul id="fb-userpic-prev">\r\n			<li><img style="width:100%;" class="picture" src="{{profile_picture}}" alt="{{name}} Facebook Avatar"/></li>\r\n		</ul>\r\n	</div>\r\n	<div class="span7 fbreg-fields">\r\n\r\n		<div class="field">\r\n			<div class="label">Birthday</div>\r\n			<span class="value" data-name="birthday" data-value="{{birthday}}">\r\n				<input type="text" name="birthday" value="{{birthday}}" disabled="disabled"/><div class="edit">&nbsp;</div>\r\n\r\n			</span>\r\n		</div>\r\n\r\n		<div class="field">\r\n			<div class="label">Email Address</div>\r\n			<span class="value" data-name="email" data-value="{{email}}">\r\n				<input type="text" name="email" value="{{email}}" disabled="disabled"/><div class="edit">&nbsp;</div>\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			<div class="label">Password</div>\r\n			<input type="password" class="password" name="password" placeholder="Password"/>\r\n		</div>\r\n		<div class="field">\r\n			<div class="label">Again</div>\r\n			<input type="password" name="password-again" placeholder="Password Again"/>\r\n		</div>\r\n		<div class="password-error"></div>\r\n\r\n		<div class="row-fluid">\r\n			<label for="agree"><input type="checkbox" id="agree" name="agree"/>I have read and agree to the <a href="tos.html" target="_blank" style="text-decoration:underline;;">Terms of Service</a></label>\r\n		</div>\r\n\r\n	</div>\r\n	<div class="row-fluid"><a href="javascript:void(0);" class="next btn-common btn-green">What\'s Next</a></div>\r\n</div>\r\n\r\n{{/payload}}\r\n\r\n{{/errorDisplay}}'}),function(e){e.extend(e.fn,{pstrength:function(t){var t=e.extend({verdects:["Very weak","Weak","Medium","Strong","Very strong"],colors:["#f00","#c06","#f60","#3c0","#3f0"],scores:[10,15,30,40],common:["password","sex","god","123456","123","liverpool","letmein","qwerty","monkey"],minchar:6},t);return this.each(function(){var n=e(this).attr("id");e(this).after('<div class="pstrength-minchar" id="'+n+'_minchar">Minimum number of characters is '+t.minchar+"</div>"),e(this).after('<div class="pstrength-info" id="'+n+'_text"></div>'),e(this).after('<div class="pstrength-bar" id="'+n+'_bar" style="border: 1px solid white; font-size: 1px; height: 5px; width: 0px;"></div>'),e(this).keyup(function(){e.fn.runPassword(e(this).val(),n,t)})})},runPassword:function(t,n,r){nPerc=e.fn.checkPassword(t,r);var i="#"+n+"_bar",s="#"+n+"_text";nPerc==-200?(strColor="#f00",strText="Unsafe password word!",e(i).css({width:"0%"})):nPerc<0&&nPerc>-199?(strColor="#ccc",strText="Too short",e(i).css({width:"5%"})):nPerc<=r.scores[0]?(strColor=r.colors[0],strText=r.verdects[0],e(i).css({width:"10%"})):nPerc>r.scores[0]&&nPerc<=r.scores[1]?(strColor=r.colors[1],strText=r.verdects[1],e(i).css({width:"25%"})):nPerc>r.scores[1]&&nPerc<=r.scores[2]?(strColor=r.colors[2],strText=r.verdects[2],e(i).css({width:"50%"})):nPerc>r.scores[2]&&nPerc<=r.scores[3]?(strColor=r.colors[3],strText=r.verdects[3],e(i).css({width:"75%"})):(strColor=r.colors[4],strText=r.verdects[4],e(i).css({width:"92%"})),e(i).css({backgroundColor:strColor}),e(s).html("<span style='color: "+strColor+";'>"+strText+"</span>")},checkPassword:function(e,t){var n=0,r=t.verdects[0];e.length<t.minchar?n-=100:e.length>=t.minchar&&e.length<=t.minchar+2?n+=6:e.length>=t.minchar+3&&e.length<=t.minchar+4?n+=12:e.length>=t.minchar+5&&(n+=18),e.match(/[a-z]/)&&(n+=1),e.match(/[A-Z]/)&&(n+=5),e.match(/\d+/)&&(n+=5),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(n+=7),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(n+=5),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(n+=7),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(n+=2),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(n+=3),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(n+=3);for(var i=0;i<t.common.length;i++)e.toLowerCase()==t.common[i]&&(n=-200);return n}})}(jQuery),define("jquery.pstrength",function(){}),define("media/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),t!=undefined?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this},selectImageType:function(e){return r.each(this.get("payload").types,function(t,n){n==e&&(this.get("payload").image_path=t.url)},this),this}}),n}),define("media/collections/images",["facade","collections","media/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.processItemFromPayload(t,i),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("registration/collections/fbimages",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbpics":"/api/user/fbpics"}}),r}),define("text!registration/templates/fbimage-item.html",[],function(){return'\r\n{{#payload}}\r\n<img src="{{thumbnail}}" alt="Thumb"/>\r\n{{#num_votes}}{{num_votes}} Votes{{/num_votes}}\r\n{{/payload}}\r\n\r\n'}),define("registration/views/fbimage-item",["vendor","views","utils","text!registration/templates/fbimage-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"image",events:{click:"changeImage"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeImage:function(){Channel("changeimage"+this.model.collection.id).publish(this.model)}}),i}),define("text!registration/templates/fbimage-board.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter fbimagecontainer pane">\r\n        <img id="image-select" src="{{original}}" alt="{{image_title}}"/>\r\n        <div class="coords" style="display:none;">\r\n            <div>crop x <input name="crop-x" type="hidden" /></div>\r\n            <div>crop y <input name="crop-y" type="hidden" /></div>\r\n            <div>crop width <input name="crop-width" type="hidden" /></div>\r\n            <div>crop height <input name="crop-height" type="hidden" /></div>\r\n            <div>image width <input name="image-width" type="hidden" /></div>\r\n            <div>image height <input name="image-height" type="hidden" /></div>            \r\n        </div>\r\n    </div>\r\n{{/payload}}\r\n'}),function(e){e.fn.jrac=function(t){var n={crop_width:200,crop_height:100,crop_x:0,crop_y:0,crop_resize:!0,crop_aspect_ratio:null,image_width:null,image_height:null,zoom_min:100,zoom_max:3e3,viewport_image_surrounding:!1,viewport_width:null,viewport_height:null,viewport_resize:!0,viewport_content_left:0,viewport_content_top:0,viewport_onload:null};return this.each(function(){if(!e(this).is("img"))return;var r=!1;typeof t=="object"?e.extend(n,t):t=="destroy"&&(r=!0);var i=e(this),s=!1;i.parent().hasClass("jrac_viewport")&&(s=!0),s&&r?(i.draggable("destroy"),i.parent().find(".jrac_crop").remove(),i.parent().parent().find(".jrac_zoom_slider").remove(),i.parent().append(i.data("original")),i.parent().unwrap(),i.unwrap(),i.remove()):i.data("original",i.clone());if(r)return;s||i.hide().css("position","absolute").wrap('<div class="jrac_container"><div class="jrac_viewport"></div></div>');var o=i.parent(),u=o.parent(),a=e('<div class="jrac_loading" />');o.append(a);var f=function(){e.extend(i,{scale_proportion_locked:!0,originalWidth:i.width(),originalHeight:i.height()}),i.width(n.image_width).height(n.image_height),n.viewport_image_surrounding?o.width(i.width()).height(i.height()):o.width(n.viewport_width).height(n.viewport_height),i.css({left:n.viewport_content_left,top:n.viewport_content_top});if(!s){var t=e('<div class="jrac_zoom_slider"><div class="ui-slider-handle"></div></div>').width(o.width()).slider({value:i.width(),min:n.zoom_min,max:n.zoom_max,start:function(n,r){e.extend(t,{on_start_width_value:r.value,on_start_height_value:i.height()})},slide:function(e,n){var r=Math.round(t.on_start_height_value*n.value/t.on_start_width_value);i.height(r),i.width(n.value),o.observator.notify("jrac_image_height",r),o.observator.notify("jrac_image_width",n.value)}});u.append(t),n.viewport_resize&&o.resizable({resize:function(e,n){t.width(n.size.width)}}),i.draggable({drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});var r=e('<div class="jrac_crop"><div class="jrac_crop_drag_handler"></div></div>').css({width:n.crop_width,height:n.crop_height,left:n.crop_x+n.viewport_content_left,top:n.crop_y+n.viewport_content_top}).draggable({containment:o,handle:"div.jrac_crop_drag_handler",drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});n.crop_resize&&r.resizable({containment:o,aspectRatio:n.crop_aspect_ratio,resize:function(e,t){t.size.width!=t.originalSize.width&&o.observator.notify("jrac_crop_width",r.width()),t.size.height!=t.originalSize.height&&o.observator.notify("jrac_crop_height",r.height())}}),o.append(r)}e.extend(o,{$container:u,$image:i,$crop:r,$zoom_widget:t,observator:{items:{},register:function(e,t,n){e&&t&&(this.items[e]={element:t,callback:n})},unregister:function(e){delete this.items[e]},notify:function(t,n){if(this.items[t]){var r=this.items[t].element,s=this.items[t].callback;r.trigger(t,[o,n]),e.isFunction(s)&&s.call(o,t,r,n)}i.trigger("jrac_events",[o])},notify_all:function(){this.notify("jrac_crop_x",this.crop_position_x()),this.notify("jrac_crop_y",this.crop_position_y()),this.notify("jrac_crop_width",r.width()),this.notify("jrac_crop_height",r.height()),this.notify("jrac_image_width",i.width()),this.notify("jrac_image_height",i.height())},crop_position_x:function(){return r.position().left-i.position().left},crop_position_y:function(){return r.position().top-i.position().top},crop_consistent:function(){return this.crop_position_x()>=0&&this.crop_position_y()>=0&&this.crop_position_x()+r.width()<=i.width()&&this.crop_position_y()+r.height()<=i.height()},set_property:function(e,n){n=parseInt(n);if(isNaN(n))return;switch(e){case"jrac_crop_x":r.css("left",n+i.position().left);break;case"jrac_crop_y":r.css("top",n+i.position().top);break;case"jrac_crop_width":r.width(n);break;case"jrac_crop_height":r.height(n);break;case"jrac_image_width":if(i.scale_proportion_locked){var s=Math.round(i.height()*n/i.width());i.height(s),this.notify("jrac_image_height",s)}i.width(n),t.slider("value",n);break;case"jrac_image_height":if(i.scale_proportion_locked){var o=Math.round(i.width()*n/i.height());i.width(o),this.notify("jrac_image_width",o),t.slider("value",o)}i.height(n)}this.notify(e,n)}}}),a.hide(),a.remove(),i.show(),e.isFunction(n.viewport_onload)&&(n.viewport_onload.call(o),o.observator.notify_all())},l=i.attr("src");/^data:image/.test(l)?f():(l=l+(l.search(/\?/)<0?"?":"&")+"jracrandom="+(new Date).getTime(),e("<img>").attr("src",l).load(f()))})}}(jQuery),define("jquery.jrac",function(){}),define("registration/views/fbimage-board",["require","text!registration/templates/fbimage-board.html","facade","views","utils","jquery.jrac"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=r._,a=r.$,f=s.lib.Channel;return n=o.extend({tagName:"div",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){console.log("fb image board render"),console.log("fb image board collection"),console.log(this.collection);var e=this;o.prototype.render.call(this)},selectArea:function(e,t){a("#x1").val(t.x1),a("#y1").val(t.y1),a("#x2").val(t.x2),a("#y2").val(t.y2),a("#w").val(t.width),a("#h").val(t.height)},initCropView:function(){a("#image-select").jrac({crop_width:150,crop_height:150,crop_aspect_ratio:"1:1",crop_x:100,crop_y:100,image_width:400,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){a(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,a(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=a(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},removeCropView:function(){a("#image-select").jrac("destroy"),a("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=this.$(".coords :input").serializeArray(),t=this.model.get("payload");a.each(e,function(e,n){t[n.name]=n.value}),this.model.set("payload",t)}}),n}),define("text!registration/templates/picture_buttons.html",[],function(){return'\r\n<div id="picture-buttons">\r\n    <a href="#" class="use_image">Use This Image</a>\r\n    <a href="#" class="upload_image">Upload a New Image</a>\r\n</div>\r\n'}),define("registration/views/picture_buttons",["require","text!registration/templates/picture_buttons.html","vendor","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=s.lib.Channel,a=e("vendor"),f=a.Mustache;return n=o.extend({tagName:"div",className:"picture-buttons clearfix",template:t,events:{"click .use_image":"clickUseImage","click .upload_image":"clickUploadImage"},render:function(){var e=f.to_html(this.template);return this.$el.html(e),this},clickUseImage:function(e){e.preventDefault(),u("registration-use-image").publish()},clickUploadImage:function(e){e.preventDefault(),u("registration-upload-image").publish()}}),n}),define("registration/views/fbimage-list",["facade","utils","views","registration/views/fbimage-item","registration/views/fbimage-board","registration/views/picture_buttons","models/base"],function(e,t,n,r,i,s,o){var u,a=n.BaseView;return _=e._,u=a.extend({initialize:function(e){console.log(this.options,"options.collection"),_.map(this.collection,function(e,t){console.log(e.payload,"value.attributes")})},createElement:function(){}}),u}),define("registration/views/register_facebook",["require","text!registration/templates/register_facebook.html","backbone","facade","views","utils","vendor","jquery.pstrength","registration/collections/fbimages","registration/views/fbimage-list"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("vendor"),o=s.Mustache,u=e("utils"),a=u.lib.Channel,f=i.SectionView,l=e("registration/collections/fbimages"),c=e("registration/views/fbimage-list");return n=f.extend({id:"main-content",events:{keypress:"stopSubmit"},template:t,initialize:function(e){function s(e){i.$(".picture").attr("src",e)}function o(){i.initFBPictures()}function u(){i.initUploadImage()}this.callback=e.callback;var t=$.parseJSON(this.model.request.responseText);if(t.exec_data.exec_error){var n=!0,r=t.exec_data.error_array[0].error;this.model.set("errorDisplay",!0),this.model.set("errorValue",r)}var i=this;if(!this.model)throw new Error("RegistrationFacebookView expected options.model.");i.parseFBData(this.model.get("payload")),f.prototype.initialize.call(this,e),a("registration-change-picture").subscribe(s),a("registration-diff-fbpicture").subscribe(o),a("registration-upload-image").subscribe(u)},childViews:{},render:function(e,t,n){var r={};r.height="500px",r.width="650px",r.title="Register With Facebook - "+this.model.get("payload").name,r.id="fb-reg-pop",r.html=o.to_html(this.template,this.model.toJSON()),routing.trigger("common-popup-open",r),$("#fb-reg-pop .next").bind("click",this.nextStep),$("#fb-reg-pop div.edit").bind("click",this.changeField),$("#fb-reg-pop .diff_fb_pic").bind("click",this.diffFBPicture),$("#fb-reg-pop .upload_new_image").bind("click",this.uploadNewImage)},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},diffFBPicture:function(e){e.preventDefault(),this.initFBPictures()},uploadNewImage:function(e){e.preventDefault(),this.initUploadImage()},parseFBData:function(e){e.hs_exists=e.high_school?!0:!1,e.dob_exists=e.birthday?!0:!1,e.email_exists=e.email?!0:!1,this.model.set("payload",e)},initFBPictures:function(){var e=this;this.fbimages?(debug.log(e.fbimages.toJSON(),"else"),this.fbImageListView=new c({collection:e.fbimages.toJSON()})):(this.fbimages=new l,this.fbimages.fetch(),$.when(this.fbimages.request).done(function(){debug.log("this.fbimages are as follows"),debug.log(e.fbimages.toJSON()),this.fbImageListView=new c({collection:e.fbimages.toJSON()})}))},setupFBPictures:function(){var e=this;this.fbImageListView=new c({collection:this.fbimages});var t=this.addChildView(this.fbImageListView);this.childViews.fbImageListView=this.fbImageListView,this.callbacks.add(function(){t()}),this.fbImageListView.render(),this.$el.append(e.fbImageListView.el),$("#"+this.fbImageListView.id).dialog({width:"80%",close:e.removeListView})},removeListView:function(){this.childViews.fbImageListView.removeCropView()},initUploadImage:function(){alert("Upload Image")},changeField:function(e){e.preventDefault(),$(e.target).fadeOut();var t=$(e.target).parent().find("input");t.removeAttr("disabled").focus()},nextStep:function(e){e.preventDefault();var t=this,n=$("#fb-reg-pop :input").serializeArray(),r=this.model.get("payload");$.each(n,function(e,t){r[t.name]=t.value});if(r["password"]==""||r["password-again"]==""){alert("Please input a password");return}if(r["password"]!=r["password-again"]){alert("Please input a password correctly");return}if(r["agree"]==null){alert("Please agree to the Terms of Service");return}this.model.attributes.id=!1,this.model.set({payload:r,id:1}),this.model.url=function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+r.users_id},this.model.save({callback:"true"},{success:function(e){$("#RegModal").modal("hide"),t.callback&&_.isFunction(t.callback)?(routing.trigger("popup-close"),t.callback(function(){window.location.reload()})):window.location.href="#usersettings"}})}}),n}),define("text!registration/templates/register_email.html",[],function(){return'\r\n<h1>The Basics</h1>\r\n<div class="row-fluid">\r\n    <form class="form-horizontal">\r\n        <div class="control-group">\r\n            <label class="control-label" for="first_name">First Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="firstname" id="first_name" placeholder="First Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="last_name">Last Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="lastname" id="last_name" placeholder="Last Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="dob">DOB: </label>\r\n            <div class="controls">\r\n                <input type="text" name="dob" id="dob" placeholder="Birthday">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="email">Email: </label>\r\n            <div class="controls">\r\n                <input type="text" name="email" id="email" placeholder="Email">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label">Gender: </label>\r\n            <div class="controls" id="gender">\r\n                <label for="male"><input type="radio" id="male" name="gender" value="M"> Male</label>\r\n                <label for="female"><input type="radio" id="female" name="gender" value="F"> Female</label>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="password">Password: </label>\r\n            <div class="controls">\r\n                <input type="password" id="password" name="password" placeholder="Password"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="re_password">Again: </label>\r\n            <div class="controls">\r\n                <input type="password" id="re_password" name="re_password" placeholder="Password Again"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <p class="agree-error text-error"></p>\r\n            <label for="accept_terms">\r\n                <input type="checkbox" id="accept_terms" name="accept_terms"/>I have read and agree to the <a href="#">Terms of Service</a>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </label>            \r\n            <a href="#" class="next">What\'s Next</a>\r\n        </div>\r\n    </form>\r\n</div>'}),define("registration/views/register_email",["require","text!registration/templates/register_email.html","facade","views","utils","jquery.pstrength","models/base"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView,a=e("models/base");return n=u.extend({id:"main-content",events:{keypress:"stopSubmit","click .next":"nextStep"},template:t,initialize:function(e){if(!this.model)throw new Error("RegistrationEmailView expected options.model.");u.prototype.initialize.call(this,e)},render:function(e,t,n){u.prototype.render.call(this,e,t,n),this.$("#password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n={};$.each(t,function(e,t){n[t.name]=t.value});var r=new a(n);r.url=function(){return"/api/user/register"},r.saveSuccess=function(e,t){a.prototype.saveSuccess.call(this,e,t);var n=t.exec_data,r=t.payload;n.exec_error||o("registration-select-org").publish(r)},r.save()}}),n}),define("text!registration/templates/upload_image.html",[],function(){return'\r\nUpload Image\r\n\r\n<a href="#" class="next">What\'s Next</a>'}),define("registration/views/upload_image",["require","text!registration/templates/upload_image.html","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView;return n=u.extend({id:"main-content",events:{"click .next":"nextStep"},template:t,initialize:function(e){u.prototype.initialize.call(this,e)},nextStep:function(e){e.preventDefault(),o("registration-select-org").publish()}}),n}),define("text!registration/templates/select_org.html",[],function(){return'\r\n<h1>Athletic Organizations</h1>\r\n<div class="step-club">\r\n<div>Link Up With Your Teams</div>\r\n<a href="#" class="find_club">\r\n    <h3>Find My Club</h3>\r\n    <p>Use our club locator to find your sports club and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{#show_highschool}}\r\n<div class="step-highschool" style="display:none;">\r\n<div class="text-error">Only display high school chooser if age <= 18</div>\r\n<a href="#" class="high_school">\r\n    <h3>High School Locator</h3>\r\n    <p>If you play for your high school, click here to find your school and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{/show_highschool}}\r\n<div class="step-sport" style="display:none;">\r\n<a href="#" class="indiv_sports">\r\n    <h3>Individual Sports</h3>\r\n    <p>If you are an athlete who competes without a team, this is where you\'ll find your sport.</p>\r\n</a>\r\n</div>\r\n<div class="step-next" style="display:none;">\r\n<a href="#" class="next">What\'s Next</a>\r\n</div>\r\n'}),define("registration/models/my_club",["models/base"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/myclub":"/api/user/basics/"+this.id}}),t}),define("text!registration/templates/find_my_club.html",[],function(){return'\r\n<h2>Find My Sports Club</h2>\r\n<form id="findClubFrm" class="form-horizontal">\r\n    <div class="control-group">\r\n        <label class="control-label" for="states_id">What State?</label>\r\n        <div class="controls">\r\n            <input id="states_id" name="state_name" placeholder="Just Start Typing" value="{{state}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="sports_id">What Sport?</label>\r\n        <div class="controls">\r\n            <input id="sports_id" name="sport_name" placeholder="Just Start Typing" value="{{sport}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="orgs_id">Club Name</label>\r\n        <div class="controls">\r\n            <input id="orgs_id" name="org_name" placeholder="Just Start Typing" value="{{club}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="complevels"></div>\r\n    <div class="seasons"></div>\r\n    <a href="#" class="back">Go Back</a>    \r\n    <a href="#" class="not_find">Can\'t Find Your Club?</a>\r\n    <a href="#" class="continue">Continue</a>\r\n</form>\r\n'}),define("location/models/state",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{location_id:0,location_name:null,location_country:null},desc:"State Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("location/collections/states",["facade","collections","location/models/state","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){return testpath?testpath+"/state_search":this.state_name==undefined?"/api/state/search":"/api/state/search/?state_name="+this.state_name},fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("registration/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports",["facade","collections","sportorg/models/sport","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){return this.state_name==undefined,"/api/sport/search/?sport_name="+this.sport_name+"&gender="+this.gender},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){}}),i}),define("registration/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/club",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/clubs",["facade","collections","sportorg/models/club","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){var e=this;return testpath?testpath+"/club_search":(e.states_id==undefined||e.sports_id==undefined||e.club_name==undefined,"/api/org/search/?sports_club=1&states_id="+e.states_id+"&sports_id="+e.sports_id+"&org_name="+e.club_name)},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var r in n){var i=new SportorgSportModel;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t)}}),i}),define("registration/collections/clubs",["facade","collections","sportorg/collections/clubs","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("registration/views/find_my_club",["require","text!registration/templates/find_my_club.html","facade","views","utils","models/base","jqueryui","registration/collections/states","registration/collections/sports","registration/collections/clubs"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=e("models/base");return BaseView=i.BaseView,_=r._,$=r.$,Channel=s.lib.Channel,RegistrationStatesCollection=e("registration/collections/states"),RegistrationSportsCollection=e("registration/collections/sports"),RegistrationClubsCollection=e("registration/collections/clubs"),n=BaseView.extend({id:"find-my-club",tagName:"div",className:"find-my-club",template:t,events:{"click .back":"closeView","click .not-find":"notFind","click .continue":"highSchoolView","keyup #states_id":"keyupState","keyup #sports_id":"keyupSport","keyup #orgs_id":"keyupClub","blur #states_id":"changeState","blur #sports_id":"changeSport","change #orgs_id":"changeClub"},states:[],states_id:"",sports:[],sports_id:"",clubs:[],clubs_id:"",setOptions:function(e){if(!this.model)throw new Error("RegistrationFindMyClubView expected options.model.")},initialize:function(e){BaseView.prototype.initialize.call(this,e)},render:function(){var e=this;BaseView.prototype.render.call(this)},closeView:function(e){e.preventDefault(),Channel("registration-close-clubview").publish()},notFind:function(e){e.preventDefault()},highSchoolView:function(e){e.preventDefault()},keyUp:function(e){switch(this.$(e.target).attr("id")){case"state":this.keyupState(e);break;case"sport":this.keyupSport(e);break;case"club":this.keyupClub(e)}},keyupState:function(e){var t=this,n=this.$("#states_id").val(),r=[];if(n!=""){var i=new RegistrationStatesCollection;i.state_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();(e==null||e.length<1)&&t.$("#states_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.states=[];for(var n in e)t.states.push(e[n].payload);debug.log("self.states",t.states),t.states.forEach(function(e,t){r.push(e.name)}),debug.log("stateArr",r),t.$("#states_id").autocomplete({source:r})})}},changeState:function(e){var t=this.$("#states_id").val(),n=this;n.states_id="",n.states.forEach(function(e,r){e["name"]==t&&(n.states_id=e.id)}),this.keyupClub()},keyupSport:function(e){var t=this,n=t.model,r="all";n.get("payload").gender&&(r=n.get("payload").gender);var i=this.$("#sports_id").val(),s=[];if(i!=""){var o=new RegistrationSportsCollection;o.sport_name=i,o.gender=r,$(e.target).addClass("ui-autocomplete-loading"),o.fetch(),$.when(o.request).done(function(){if(o.isError())return;var e=o.toJSON();console.log("Sports Model",e),(e==null||e.length<1)&&t.$("#sports_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.sports=[];for(var n in e)t.sports.push(e[n].payload);console.log("sports",t.sports),t.sports.forEach(function(e,t){s.push(e.sport_name)}),console.log("sportArr",s),t.$("#sports_id").autocomplete({source:s})})}},changeSport:function(e){var t=this.$("#sports_id").val(),n=this;n.sports_id="",n.sports.forEach(function(e,r){e["sport_name"]==t&&(n.sports_id=e.sport_id)}),this.keyupClub()},keyupClub:function(e){var t=this,n=this.$("#orgs_id").val(),r=[];if(n!=""){var i=new RegistrationClubsCollection;console.log(t.states_id,t.sports_id,n),i.states_id=t.states_id,i.sports_id=t.sports_id,i.club_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();console.log("models",e),(e==null||e.length<1)&&t.$("#orgs_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.clubs=[];for(var n in e)t.clubs.push(e[n].payload);t.clubs.forEach(function(e,t){r.push(e.org_name)}),console.log("clubArr",r),t.$("#orgs_id").autocomplete({source:r})})}},changeClub:function(e){var t=this.$("#orgs_id").val(),n=this;n.clubs_id=0,n.clubs.forEach(function(e,r){e["name"]==t&&(n.clubs_id=e.id)})}}),n}),define("registration/views/select_org",["require","text!registration/templates/select_org.html","facade","views","utils","registration/models/my_club","registration/views/find_my_club"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=r.$,u=s.lib.Channel,a=i.SectionView,f=e("registration/models/my_club"),l=e("registration/views/find_my_club");return n=a.extend({id:"main-content",step:1,events:{"click .find_club":"findMyClub","click .high_school":"highSchoolLocator","click .indiv_sports":"individualSports","click .next":"nextStep"},template:t,initialize:function(e){a.prototype.initialize.call(this,e)},childViews:[],findMyClub:function(e){e.preventDefault();if(this.step!=1)return;var t=this;this.myclub?(this.myclub.fetch(),this.findMyClubView.render(),o("#"+this.findMyClubView.id).dialog({width:"80%",close:t.removeMyClubView})):(this.myclub=new f,this.myclub.id=t.model.get("payload").id,this.myclub.fetch(),o.when(this.myclub.request).done(function(){t.setupFindMyClub()}))},setupFindMyClub:function(){function n(){o("#"+e.findMyClubView.id).dialog("close")}var e=this;this.findMyClubView=new l({model:this.myclub});var t=this.addChildView(this.findMyClubView);this.childViews.findMyClubView=this.findMyClubView,this.callbacks.add(function(){t()}),this.findMyClubView.render(),this.$el.append(e.findMyClubView.el),o("#"+e.findMyClubView.id).dialog({width:"80%",close:e.removeMyClubView}),u("registration-close-clubview").subscribe(n)},removeMyClubView:function(){},highSchoolLocator:function(e){e.preventDefault();if(this.step!=2)return},individualSports:function(e){e.preventDefault();if(this.step!=3)return},nextStep:function(e){e.preventDefault();if(this.step!=4)return}}),n}),define("signup/views/shopopup",["require","backbone","underscore","registration","views","facade","utils"],function(e,t,n,r){var i,s=t.View;return i=s.extend({initialize:function(e){$("#errormsg, #preview").html(""),$("#RegModal").modal("show"),console.log($("#RegModal .modal-body")),$("#RegModal").on("hide",function(){$("div#modalPopup").remove()})}}),i}),define("registration",["require","text!signup/templates/layout.html","text!registration/templates/layout.html","facade","controller","models","views","utils","registration/models/select_type","registration/models/register_facebook","registration/models/register_email","registration/models/upload_image","registration/models/select_org","registration/views/select_type","registration/views/register_facebook","registration/views/register_email","registration/views/upload_image","registration/views/select_org","signup/views/shopopup"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("registration/models/select_type"),f=e("registration/models/register_facebook"),l=e("registration/models/register_email"),c=e("registration/models/upload_image"),h=e("registration/models/select_org"),p=e("registration/views/select_type"),d=e("registration/views/register_facebook"),v=e("registration/views/register_email"),m=e("registration/views/upload_image"),g=e("registration/views/select_org"),y=e("signup/views/shopopup"),b=o.LayoutView,w=r.$,E=r._,S=u.debug,x=u.lib.Channel,T=["/pages/registration/registration.css","/pages/signup/css/signupstyle.css","/css/style.jrac.css"];return n=i.extend({initialize:function(e){return x("load:css").publish(T),this.callback=e.callback,E.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){ga("send","event","Signup","Header","Loading reg header"),this.setupLayout().render(),this.refreshPage(),this.createData(),this.handleDeferreds()},createData:function(){this.select_type=new a},handleDeferreds:function(){function t(){e.initRegisterFacebook()}function n(){e.initRegisterEmail()}function r(){e.uploadImage()}function i(t){e.selectOrg(t)}var e=this;routing.off("registration-with-facebook"),routing.on("registration-with-facebook",function(t){e.initRegisterFacebook(t)}),x("registration-select-org").subscribe(i)},refreshPage:function(){var e;this.selectTypeView&&(w(this.selectTypeView.destination).html(""),e=w.inArray(this.selectTypeView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerFacebookView&&(w(this.registerFacebookView.destination).html(""),e=w.inArray(this.registerFacebookView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerEmailView&&(w(this.registerEmailView.destination).html(""),e=w.inArray(this.registerEmailView,this.scheme),~e&&this.scheme.splice(e,1)),this.selectOrgView&&(w(this.selectOrgView.destination).html(""),e=w.inArray(this.selectOrgView,this.scheme),~e&&this.scheme.splice(e,1))},setupSelectTypeView:function(){this.selectTypeView=new p({model:this.select_type,name:"Select Registration Type",destination:"#main-content"}),this.scheme.push(this.selectTypeView),this.layout.render()},initRegisterFacebook:function(e){var t=this;this.refreshPage(),this.register_facebook=new f,this.register_facebook.bind("request",t.handleProgress,this),this.register_facebook.fetch(),w.when(this.register_facebook.request).done(function(n){console.log(n.payload.identity_exists,"payload"),n.payload.identity_exists==1?routing.trigger("reload-home"):(this.pop=new y,t.setupRegisterFacebookView(e))}).fail(function(e){this.pop=new y,t.setupRegisterFacebookView()})},handleProgress:function(e){},setupRegisterFacebookView:function(e){this.registerFacebookView=new d({model:this.register_facebook,name:"Registration with Facebook",destination:"#main-contentreg",callback:e}),this.scheme.push(this.registerFacebookView),this.layout.render()},initRegisterEmail:function(){var e=this;this.refreshPage(),this.register_email=new l,e.setupRegisterEmailView()},setupRegisterEmailView:function(){this.registerEmailView=new v({model:this.register_email,name:"Registration with Email Address",destination:"#main-content"}),this.scheme.push(this.registerEmailView),this.layout.render()},uploadImage:function(){var e=this;this.refreshPage(),this.upload_image=new c,this.setupUploadImageView()},setupUploadImageView:function(){this.uploadImageView=new m({model:this.upload_image,name:"Registration Upload Image",destination:"#main-content"}),this.scheme.push(this.uploadImageView),this.layout.render()},selectOrg:function(e){var t=this;this.refreshPage(),this.select_org=new h,this.select_org.id=e.id,this.select_org.fetch(),w.when(this.select_org.request).done(function(){t.setupSelectOrgView()})},setupSelectOrgView:function(){this.selectOrgView=new g({model:this.select_org,name:"Registration Select Org",destination:"#main-content"}),this.scheme.push(this.selectOrgView),this.layout.render()},setupLayout:function(){return this.scheme=[],w("#regModelPopup").length||w("body").append('<div id="regModelPopup"></div>'),pageLayout=new b({scheme:this.scheme,destination:"#setupLayout",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout}}),n}),define("signup/models/registerbasic",["models/base"],function(e){var t;return t=e.extend({defaults:{},validate:function(e,t){if(e.priority<0)return"Priority cannot be negative."},validation:{email:{required:!0,pattern:"email",msg:"Please enter a valid email"}}}),t}),define("signup/models/registration-basics-final",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"api/user/register"}),t}),define("text!signup/templates/registration.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n<style>\r\n\r\n</style>\r\n<div id="regcontainer">\r\n	<div id="mainreg">\r\n		<div id="header">\r\n			<span class="regheader"> Show us what you got</span>\r\n		</div>\r\n\r\n		<div id="fbpane">\r\n			<div id="label">\r\n				Connect with Facebook\r\n			</div>\r\n		</div>\r\n		<div class ="regor">\r\n			or\r\n		</div>\r\n		<div id="regpanemain">\r\n			<form action="#/user/create" method="post" class="signupform" accept-charset="utf-8">\r\n				<div id="firstregbase">\r\n					<input type="text" name="firstname" placeholder="First name" />\r\n					<div class="error">\r\n					</div>\r\n					<input type="text" name="lastname" placeholder="Last name" />\r\n					<input type="text" name="email" placeholder="Email" />\r\n					<div class="error">\r\n					</div>\r\n				</div><% if(fb_invite){ %><input type="hidden" name="fb_invite_id" value="<%= fb_invite %>" /><% } %>\r\n\r\n				<div class = "signupsubmit">\r\n					<input type="submit" name="create" value="Sign Up" class="regsubmit" />\r\n				</div>\r\n			</form>\r\n			<%  if(!onlyRegister) { %>\r\n\r\n				<div id="reglogin">\r\n				<span>Been here before <a href="javascript:void(0);">sign in</a></span>\r\n				</div>\r\n\r\n			<% } %>\r\n			\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("text!signup/templates/registration_landing.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n<style>\r\n\r\n</style>\r\n<div id="regcontainer">\r\n	<div id="mainreg">\r\n\r\n\r\n		<div id="fbpane">\r\n			<a href="#" style="display: block; width: 100%; height: 100%;">\r\n			<div id="label">\r\n				Connect with Facebook\r\n			</div>\r\n			<div id="fblogo"><span></span></div></a>\r\n		</div>\r\n		<div class ="regor">or</div>\r\n		<div id="regpanemain">\r\n			<form action="#/user/create" method="post" class="signupform" accept-charset="utf-8">\r\n				<div id="firstregbase">\r\n					<input type="text" name="firstname" placeholder="First name" />\r\n					<div class="error">\r\n					</div>\r\n					<input type="text" name="lastname" placeholder="Last name" />\r\n					<input type="text" name="email" placeholder="Email" />\r\n					<% if(fb_invite != undefined){ %><input type="hidden" name="fb_invite_id" value="<%= fb_invite %>" /><% } %>\r\n					<div class = "signupsubmit">\r\n\r\n						<input type="submit" name="create" value="Sign Up" class="regsubmit" />\r\n						<input type="button" name="login" value="Log In" class="login" />\r\n					</div>\r\n					<div class="error">\r\n					</div>\r\n				</div>\r\n\r\n			</form>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'});try{window.FB||function(e){function o(){}var t=e,n=e.document,r=e.setTimeout,i=e.setInterval,s=0,u,a;a=function(e){return e[0]},u=function(e){return e};var f,l;(function(e){var t={},n={},r=["global","require","requireDynamic","requireLazy","module","exports"];f=function(r,i){if(n.hasOwnProperty(r))return n[r];if(!t.hasOwnProperty(r)){if(i)return null;throw new Error("Module "+r+" has not been defined")}var s=t[r],o=s.deps,u=o.length,a,l=[];for(var c=0;c<u;c++){switch(o[c]){case"module":a=s;break;case"exports":a=s.exports;break;case"global":a=e;break;case"require":a=f;break;case"requireDynamic":a=f;break;case"requireLazy":a=null;break;default:a=f.call(null,o[c])}l.push(a)}return s.factory.apply(e,l),n[r]=s.exports,s.exports},l=function(e,i,s,o){typeof s=="function"?(t[e]={factory:s,deps:r.concat(i),exports:{}},o===3&&f.call(null,e)):n[e]=s}})(this);var c=function(){return l("ES5ArrayPrototype",[],function(e,t,n,r,i,s){var o={};o.map=function(e,t){if(typeof e!="function")throw new TypeError;var n,r=this.length,i=new Array(r);for(n=0;n<r;++n)n in this&&(i[n]=e.call(t,this[n],n,this));return i},o.forEach=function(e,t){o.map.call(this,e,t)},o.filter=function(e,t){if(typeof e!="function")throw new TypeError;var n,r,i=this.length,s=[];for(n=0;n<i;++n)n in this&&(r=this[n],e.call(t,r,n,this)&&s.push(r));return s},o.every=function(e,t){if(typeof e!="function")throw new TypeError;var n=new Object(this),r=n.length;for(var i=0;i<r;i++)if(i in n&&!e.call(t,n[i],i,n))return!1;return!0},o.some=function(e,t){if(typeof e!="function")throw new TypeError;var n=new Object(this),r=n.length;for(var i=0;i<r;i++)if(i in n&&e.call(t,n[i],i,n))return!0;return!1},o.indexOf=function(e,t){var n=this.length;t|=0,t<0&&(t+=n);for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},i.exports=o}),l("ES5FunctionPrototype",[],function(e,t,n,r,i,s){var o={};o.bind=function(e){function r(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}if(typeof this!="function")throw new TypeError("Bind must be called on a function");var t=this,n=Array.prototype.slice.call(arguments,1);return r.displayName="bound:"+(t.displayName||t.name||"(?)"),r.toString=function(){return"bound: "+t},r},i.exports=o}),l("ES5StringPrototype",[],function(e,t,n,r,i,s){var o={};o.trim=function(){if(this==null)throw new TypeError("String.prototype.trim called on null or undefined");return String.prototype.replace.call(this,/^\s+|\s+$/g,"")},i.exports=o}),l("ES5Array",[],function(e,t,n,r,i,s){var o={};o.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"},i.exports=o}),l("ES5Object",[],function(e,t,n,r,i,s){var o={};o.create=function(e){var t=typeof e;if(t!="object"&&t!="function")throw new TypeError("Object prototype may only be a Object or null");var n=new Function;return n.prototype=e,new n},o.keys=function(e){var t=typeof e;if(t!="object"&&t!="function"||e===null)throw new TypeError("Object.keys called on non-object");var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(r);var i=!{toString:!0}.propertyIsEnumerable("toString"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","prototypeIsEnumerable","constructor"];if(i)for(var o=0;o<s.length;o++){var u=s[o];Object.prototype.hasOwnProperty.call(e,u)&&n.push(u)}return n},i.exports=o}),l("ES5Date",[],function(e,t,n,r,i,s){var o={};o.now=function(){return(new Date).getTime()},i.exports=o}),l("JSON3",[],function(e,t,n,r,i,s){(function(){var e={}.toString,t,n,r,s=i.exports={},o='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S=new Date(-0xc782b5b800cec),x,T,N;try{S=S.getUTCFullYear()==-109252&&S.getUTCMonth()===0&&S.getUTCDate()==1&&S.getUTCHours()==10&&S.getUTCMinutes()==37&&S.getUTCSeconds()==6&&S.getUTCMilliseconds()==708}catch(C){}S||(x=Math.floor,T=[0,31,59,90,120,151,181,212,243,273,304,334],N=function(e,t){return T[t]+365*(e-1970)+x((e-1969+(t=+(t>1)))/4)-x((e-1901+t)/100)+x((e-1601+t)/400)}),typeof JSON=="object"&&JSON&&(s.stringify=JSON.stringify,s.parse=JSON.parse);if(u=typeof s.stringify=="function"&&!N){(S=function(){return 1}).toJSON=S;try{u=s.stringify(0)==="0"&&s.stringify(new Number)==="0"&&s.stringify(new String)=='""'&&s.stringify(e)===r&&s.stringify(r)===r&&s.stringify()===r&&s.stringify(S)==="1"&&s.stringify([S])=="[1]"&&s.stringify([r])=="[null]"&&s.stringify(null)=="null"&&s.stringify([r,e,null])=="[null,null,null]"&&s.stringify({result:[S,true,false,null,"\0\b\n\f\r	"]})==o&&s.stringify(null,S)==="1"&&s.stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&s.stringify(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&s.stringify(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&s.stringify(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&s.stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(C){u=!1}}if(typeof s.parse=="function")try{if(s.parse("0")===0&&!s.parse(!1)){S=s.parse(o);if(h=S.A.length==5&&S.A[0]==1){try{h=!s.parse('"	"')}catch(C){}if(h)try{h=s.parse("01")!=1}catch(C){}}}}catch(C){h=!1}S=o=null;if(!u||!h)(t={}.hasOwnProperty)||(t=function(n){var r={},i;return(r.__proto__=null,r.__proto__={toString:1},r).toString!=e?t=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(i=r.constructor,t=function(e){var t=(this.constructor||i).prototype;return e in this&&!(e in t&&this[e]===t[e])}),r=null,t.call(this,n)}),n=function(n,r){var i=0,s,o,u,a;(s=function(){this.valueOf=0}).prototype.valueOf=0,o=new s;for(u in o)t.call(o,u)&&i++;return s=o=null,i?i==2?a=function(n,r){var i={},s=e.call(n)=="[object Function]",o;for(o in n)(!s||o!="prototype")&&!t.call(i,o)&&(i[o]=1)&&t.call(n,o)&&r(o)}:a=function(n,r){var i=e.call(n)=="[object Function]",s,o;for(s in n)(!i||s!="prototype")&&t.call(n,s)&&!(o=s==="constructor")&&r(s);(o||t.call(n,s="constructor"))&&r(s)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],a=function(n,r){var i=e.call(n)=="[object Function]",s,u;for(s in n)(!i||s!="prototype")&&t.call(n,s)&&r(s);for(u=o.length;s=o[--u];t.call(n,s)&&r(s));}),a(n,r)},u||(a={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},f=function(e,t){return("000000"+(t||0)).slice(-e)},l=function(e){var t='"',n=0,r;for(;r=e.charAt(n);n++)t+='\\"\b\f\n\r	'.indexOf(r)>-1?a[r]:r<" "?"\\u00"+f(2,r.charCodeAt(0).toString(16)):r;return t+'"'},c=function(i,s,o,u,a,h,p){var d=s[i],v,m,g,y,b,w,E,S,T,C,k,L,A,O,M;if(typeof d=="object"&&d){v=e.call(d);if(v=="[object Date]"&&!t.call(d,"toJSON"))if(d>-1/0&&d<1/0){if(N){y=x(d/864e5);for(m=x(y/365.2425)+1970-1;N(m+1,0)<=y;m++);for(g=x((y-N(m,0))/30.42);N(m,g+1)<=y;g++);y=1+y-N(m,g),b=(d%864e5+864e5)%864e5,w=x(b/36e5)%24,E=x(b/6e4)%60,S=x(b/1e3)%60,T=b%1e3}else m=d.getUTCFullYear(),g=d.getUTCMonth(),y=d.getUTCDate(),w=d.getUTCHours(),E=d.getUTCMinutes(),S=d.getUTCSeconds(),T=d.getUTCMilliseconds();d=(m<=0||m>=1e4?(m<0?"-":"+")+f(6,m<0?-m:m):f(4,m))+"-"+f(2,g+1)+"-"+f(2,y)+"T"+f(2,w)+":"+f(2,E)+":"+f(2,S)+"."+f(3,T)+"Z"}else d=null;else typeof d.toJSON=="function"&&(v!="[object Number]"&&v!="[object String]"&&v!="[object Array]"||t.call(d,"toJSON"))&&(d=d.toJSON(i))}o&&(d=o.call(s,i,d));if(d===null)return"null";v=e.call(d);if(v=="[object Boolean]")return""+d;if(v=="[object Number]")return d>-1/0&&d<1/0?""+d:"null";if(v=="[object String]")return l(d);if(typeof d=="object"){for(A=p.length;A--;)if(p[A]===d)throw TypeError();p.push(d),C=[],O=h,h+=a;if(v=="[object Array]"){for(L=0,A=d.length;L<A;M||(M=!0),L++)k=c(L,d,o,u,a,h,p),C.push(k===r?"null":k);return M?a?"[\n"+h+C.join(",\n"+h)+"\n"+O+"]":"["+C.join(",")+"]":"[]"}return n(u||d,function(e){var t=c(e,d,o,u,a,h,p);t!==r&&C.push(l(e)+":"+(a?" ":"")+t),M||(M=!0)}),M?a?"{\n"+h+C.join(",\n"+h)+"\n"+O+"}":"{"+C.join(",")+"}":"{}"}},s.stringify=function(t,n,r){var i,s,o,u,a,f;if(typeof n=="function"||typeof n=="object"&&n)if(e.call(n)=="[object Function]")s=n;else if(e.call(n)=="[object Array]"){o={};for(u=0,a=n.length;u<a;f=n[u++],(e.call(f)=="[object String]"||e.call(f)=="[object Number]")&&(o[f]=1));}if(r)if(e.call(r)=="[object Number]"){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else e.call(r)=="[object String]"&&(i=r.length<=10?r:r.slice(0,10));return c("",(f={},f[""]=t,f),s,o,i,"",[])}),h||(p=String.fromCharCode,d={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},v=function(){throw w=E=null,SyntaxError()},m=function(){var e=E,t=e.length,n,r,i,s,o;while(w<t){n=e.charAt(w);if("	\r\n ".indexOf(n)>-1)w++;else{if("{}[]:,".indexOf(n)>-1)return w++,n;if(n=='"'){for(r="@",w++;w<t;){n=e.charAt(w);if(n<" ")v();else if(n=="\\"){n=e.charAt(++w);if('\\"/btnfr'.indexOf(n)>-1)r+=d[n],w++;else if(n=="u"){i=++w;for(s=w+4;w<s;w++)n=e.charAt(w),n>="0"&&n<="9"||n>="a"&&n<="f"||n>="A"&&n<="F"||v();r+=p("0x"+e.slice(i,w))}else v()}else{if(n=='"')break;r+=n,w++}}if(e.charAt(w)=='"')return w++,r;v()}else{i=w,n=="-"&&(o=!0,n=e.charAt(++w));if(n>="0"&&n<="9"){n=="0"&&(n=e.charAt(w+1),n>="0"&&n<="9")&&v(),o=!1;for(;w<t&&(n=e.charAt(w),n>="0"&&n<="9");w++);if(e.charAt(w)=="."){s=++w;for(;s<t&&(n=e.charAt(s),n>="0"&&n<="9");s++);s==w&&v(),w=s}n=e.charAt(w);if(n=="e"||n=="E"){n=e.charAt(++w),(n=="+"||n=="-")&&w++;for(s=w;s<t&&(n=e.charAt(s),n>="0"&&n<="9");s++);s==w&&v(),w=s}return+e.slice(i,w)}o&&v();if(e.slice(w,w+4)=="true")return w+=4,!0;if(e.slice(w,w+5)=="false")return w+=5,!1;if(e.slice(w,w+4)=="null")return w+=4,null;v()}}}return"$"},g=function(e){var t,n,r;e=="$"&&v();if(typeof e=="string"){if(e.charAt(0)=="@")return e.slice(1);if(e=="["){t=[];for(;;n||(n=!0)){e=m();if(e=="]")break;n&&(e==","?(e=m(),e=="]"&&v()):v()),e==","&&v(),t.push(g(e))}return t}if(e=="{"){t={};for(;;n||(n=!0)){e=m();if(e=="}")break;n&&(e==","?(e=m(),e=="}"&&v()):v()),(e==","||typeof e!="string"||e.charAt(0)!="@"||m()!=":")&&v(),t[e.slice(1)]=g(m())}return t}v()}return e},b=function(e,t,n){var i=y(e,t,n);i===r?delete e[t]:e[t]=i},y=function(t,r,i){var s=t[r],o;if(typeof s=="object"&&s)if(e.call(s)=="[object Array]")for(o=s.length;o--;)b(s,o,i);else n(s,function(e){b(s,e,i)});return i.call(t,r,s)},s.parse=function(t,n){w=0,E=t;var r=g(m());return m()!="$"&&v(),w=E=null,n&&e.call(n)=="[object Function]"?y((S={},S[""]=r,S),"",n):r})}).call(this)}),l("ES5",["ES5ArrayPrototype","ES5FunctionPrototype","ES5StringPrototype","ES5Array","ES5Object","ES5Date","JSON3"],function(t,n,r,i,s,o){function x(e,t,n){var r=d.call(arguments,3),i=n?/\s(.*)\]/.exec(v.call(e).toLowerCase())[1]:e,s=m[i+"."+t]||e[t];if(typeof s=="function")return s.apply(e,r)}var u=n("ES5ArrayPrototype"),a=n("ES5FunctionPrototype"),f=n("ES5StringPrototype"),l=n("ES5Array"),c=n("ES5Object"),h=n("ES5Date"),p=n("JSON3"),d=Array.prototype.slice,v=Object.prototype.toString,m={"JSON.stringify":p.stringify,"JSON.parse":p.parse},g={array:u,"function":a,string:f,Object:c,Array:l,Date:h};for(var y in g){if(!g.hasOwnProperty(y))continue;var b=g[y],w=y===y.toLowerCase()?e[y.replace(/^\w/,function(e){return e.toUpperCase()})].prototype:e[y];for(var E in b){if(!b.hasOwnProperty(E))continue;var S=w[E];m[y+"."+E]=S&&/\{\s+\[native code\]\s\}/.test(S)?S:b[E]}}s.exports=x}),c=f("ES5"),c.apply(null,arguments)};l("sdk.RuntimeConfig",[],{locale:"en_US",rtl:!1}),l("SDKConfig",[],{bustCache:!0,tagCountLogRate:.01,errorHandling:{rate:4},usePluginPipe:!0,features:{kill_fragment:!0,xfbml_profile_pic_server:!0,error_handling:{rate:4},e2e_ping_tracking:{rate:1e-6}},api:{mode:"warn",whitelist:["Canvas","Canvas.Prefetcher","Canvas.Prefetcher.addStaticResource","Canvas.Prefetcher.setCollectionMode","Canvas.getPageInfo","Canvas.hideFlashElement","Canvas.scrollTo","Canvas.setAutoGrow","Canvas.setDoneLoading","Canvas.setSize","Canvas.setUrlHandler","Canvas.showFlashElement","Canvas.startTimer","Canvas.stopTimer","Data","Data.process","Data.query","Data.query:wait","Data.waitOn","Data.waitOn:wait","Event","Event.subscribe","Event.unsubscribe","Music.flashCallback","Music.init","Music.send","Payment","Payment.cancelFlow","Payment.continueFlow","Payment.init","Payment.lockForProcessing","Payment.unlockForProcessing","Payment.parse","Payment.setSize","ThirdPartyProvider","ThirdPartyProvider.init","ThirdPartyProvider.sendData","UA","UA.nativeApp","XFBML","XFBML.RecommendationsBar","XFBML.RecommendationsBar.markRead","XFBML.parse","addFriend","api","getAccessToken","getAuthResponse","getLoginStatus","getUserID","init","login","logout","publish","share","ui","ui:subscribe"]},initSitevars:{enableMobileComments:1,iframePermissions:{read_stream:!1,manage_mailbox:!1,manage_friendlists:!1,read_mailbox:!1,publish_checkins:!0,status_update:!0,photo_upload:!0,video_upload:!0,sms:!1,create_event:!0,rsvp_event:!0,offline_access:!0,email:!0,xmpp_login:!1,create_note:!0,share_item:!0,export_stream:!1,publish_stream:!0,publish_likes:!0,ads_management:!1,contact_email:!0,access_private_data:!1,read_insights:!1,read_requests:!1,read_friendlists:!0,manage_pages:!1,physical_login:!1,manage_groups:!1,read_deals:!1}}}),l("UrlMapConfig",[],{www:"www.facebook.com",m:"m.facebook.com",connect:"connect.facebook.net",business:"business.facebook.com",api_https:"api.facebook.com",api_read_https:"api-read.facebook.com",graph_https:"graph.facebook.com",fbcdn_http:"static.ak.fbcdn.net",fbcdn_https:"fbstatic-a.akamaihd.net",cdn_http:"static.ak.facebook.com",cdn_https:"s-static.ak.facebook.com"}),l("XDConfig",[],{XdUrl:"connect/xd_arbiter.php?version=40",Flash:{path:"https://connect.facebook.net/rsrc.php/v1/yR/r/ks_9ZXiQ0GL.swf"},useCdn:!0}),l("CssConfig",[],{rules:'.fb_hidden{position:absolute;top:-10000px;z-index:10001}\n.fb_invisible{display:none}\n.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}\n.fb_reset > div{overflow:hidden}\n.fb_link img{border:none}\n.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}\n.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}\n.fb_dialog_content{background:#fff;color:#333}\n.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px;top:8px\\9;right:7px\\9}\n.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}\n.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}\n.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}\n.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}\n.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}\n.fb_dialog_top_left,\n.fb_dialog_top_right,\n.fb_dialog_bottom_left,\n.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}\n.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}\n.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}\n.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}\n.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}\n.fb_dialog_vert_left,\n.fb_dialog_vert_right,\n.fb_dialog_horiz_top,\n.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}\n.fb_dialog_vert_left,\n.fb_dialog_vert_right{width:10px;height:100%}\n.fb_dialog_vert_left{margin-left:-10px}\n.fb_dialog_vert_right{right:0;margin-right:-10px}\n.fb_dialog_horiz_top,\n.fb_dialog_horiz_bottom{width:100%;height:10px}\n.fb_dialog_horiz_top{margin-top:-10px}\n.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}\n.fb_dialog_iframe{line-height:0}\n.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}\n.fb_dialog_content .dialog_title > span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif)\nno-repeat 5px 50%;float:left;padding:5px 0 7px 26px}\nbody.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}\n.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif)\nwhite no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}\n.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}\n#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}\n#fb-root #fb_dialog_ipad_overlay.hidden{display:none}\n.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}\n.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}\n.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%\n}\n.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px\n}\n.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px\n}\n.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6),\ncolor-stop(0.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset,\nrgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}\n.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}\n.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}\n.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}\n.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}\n#fb_dialog_loader_close{float:left}\n.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}\n.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}\n.fb_iframe_widget{display:inline-block;position:relative}\n.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}\n.fb_iframe_widget iframe{position:absolute}\n.fb_iframe_widget_lift{z-index:1}\n.fb_hide_iframes iframe{position:relative;left:-10000px}\n.fb_iframe_widget_loader{position:relative;display:inline-block}\n.fb_iframe_widget_fluid{display:inline}\n.fb_iframe_widget_fluid span{width:100%}\n.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}\n.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}\n.fb_connect_bar_container div,\n.fb_connect_bar_container span,\n.fb_connect_bar_container a,\n.fb_connect_bar_container img,\n.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}\n.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}\n.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}\n.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size:13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}\n.fb_connect_bar a:hover{color:#fff}\n.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}\n.fb_connect_bar div a,\n.fb_connect_bar span,\n.fb_connect_bar span a{color:#bac6da;font-size:11px;text-decoration:none}\n.fb_connect_bar .fb_buttons{float:right;margin-top:7px}\n.fbpluginrecommendationsbarleft,\n.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}\n.fbpluginrecommendationsbarleft{left:10px}\n.fbpluginrecommendationsbarright{right:10px}',components:["css:fb.css.base","css:fb.css.dialog","css:fb.css.iframewidget","css:fb.css.connectbarwidget","css:fb.css.plugin.recommendationsbar"]}),l("CanvasPrefetcherConfig",[],{blacklist:[0x83d70a64a992],sampleRate:500}),l("PluginPipeConfig",[],{threshold:0,enabledApps:{0xbec51e4718e7:1,0xaa568c1d5c06:1}}),l("ConnectBarConfig",[],{imgs:{buttonUrl:"rsrc.php/v2/yY/r/h_Y6u1wrZPW.png",missingProfileUrl:"rsrc.php/v2/yo/r/UlIqmHJn-SK.gif"}}),l("ApiClientConfig",[],{FlashRequest:{swfUrl:"https://connect.facebook.net/rsrc.php/v1/yW/r/PvklbuW2Ycn.swf"}}),l("QueryString",[],function(e,t,n,r,i,s){function o(e){var t=[];return c(c("Object","keys",!1,e).sort(),"forEach",!0,function(n){var r=e[n];if(typeof r=="undefined")return;if(r===null){t.push(n);return}t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}),t.join("&")}function u(e,t){var n={};if(e==="")return n;var r=e.split("&");for(var i=0;i<r.length;i++){var s=r[i].split("=",2),o=decodeURIComponent(s[0]);if(t&&n.hasOwnProperty(o))throw new URIError("Duplicate key: "+o);n[o]=s.length===2?decodeURIComponent(s[1]):null}return n}function a(e,t){return e+(~c(e,"indexOf",!0,"?")?"&":"?")+(typeof t=="string"?t:f.encode(t))}var f={encode:o,decode:u,appendToUrl:a};i.exports=f}),l("copyProperties",[],function(e,t,n,r,i,s){function o(e,t,n,r,i,s,o){e=e||{};var u=[t,n,r,i,s],a=0,f;while(u[a]){f=u[a++];for(var l in f)e[l]=f[l];f.hasOwnProperty&&f.hasOwnProperty("toString")&&typeof f.toString!="undefined"&&e.toString!==f.toString&&(e.toString=f.toString)}return e}i.exports=o}),l("ManagedError",[],function(e,t,n,r,i,s){function o(e,t){Error.prototype.constructor.call(this,e),this.message=e,this.innerError=t}o.prototype=new Error,o.prototype.constructor=o,i.exports=o}),l("AssertionError",["ManagedError"],function(e,t,n,r,i,s){function u(e){o.prototype.constructor.apply(this,arguments)}var o=t("ManagedError");u.prototype=new o,u.prototype.constructor=u,i.exports=u}),l("sprintf",[],function(e,t,n,r,i,s){function o(e){var t=Array.prototype.slice.call(arguments,1),n=0;return e.replace(/%s/g,function(e){return t[n++]})}i.exports=o}),l("Assert",["AssertionError","sprintf"],function(e,t,n,r,i,s){function a(e,t){if(typeof e!="boolean"||!e)throw new o(t);return e}function f(e,t,n){var r;if(t===undefined)r="undefined";else if(t===null)r="null";else{var i=Object.prototype.toString.call(t);r=/\s(\w*)/.exec(i)[1].toLowerCase()}return a(c(e,"indexOf",!0,r)!==-1,n||u("Expression is of type %s, not %s",r,e)),t}function l(e,t,n){return a(t instanceof e,n||"Expression not instance of type"),t}function h(e,t){p["is"+e]=t,p["maybe"+e]=function(e,n){e!=null&&t(e,n)}}var o=t("AssertionError"),u=t("sprintf"),p={isInstanceOf:l,isTrue:a,isTruthy:function(e,t){return a(!!e,t)},type:f,define:function(e,t){e=e.substring(0,1).toUpperCase()+e.substring(1).toLowerCase(),h(e,function(e,n){a(t(e),n)})}};c(["Array","Boolean","Date","Function","Null","Number","Object","Regexp","String","Undefined"],"forEach",!0,function(e){h(e,c(f,"bind",!0,null,e.toLowerCase()))}),i.exports=p}),l("Type",["copyProperties","Assert"],function(e,t,n,r,i,s){function a(){var e=this.__mixins;if(e)for(var t=0;t<e.length;t++)e[t].apply(this,arguments)}function f(e,t){if(t instanceof e)return!0;if(t instanceof a)for(var n=0;n<t.__mixins.length;n++)if(t.__mixins[n]==e)return!0;return!1}function l(e,t){var n=e.prototype;c("Array","isArray",!1,t)||(t=[t]);for(var r=0;r<t.length;r++){var i=t[r];typeof i=="function"&&(n.__mixins.push(i),i=i.prototype),c(c("Object","keys",!1,i),"forEach",!0,function(e){n[e]=i[e]})}}function h(e,t,n){var r=t&&t.hasOwnProperty("constructor")?t.constructor:function(){this.parent.apply(this,arguments)};u.isFunction(r);if(e&&e.prototype instanceof a==0)throw new Error("parent type does not inherit from Type");e=e||a;var i=new Function;return i.prototype=e.prototype,r.prototype=new i,o(r.prototype,t),r.prototype.constructor=r,r.parent=e,r.prototype.__mixins=e.prototype.__mixins?Array.prototype.slice.call(e.prototype.__mixins):[],n&&l(r,n),r.prototype.parent=function(){this.parent=e.prototype.parent,e.apply(this,arguments)},r.prototype.parentCall=function(t){return e.prototype[t].apply(this,Array.prototype.slice.call(arguments,1))},r.extend=function(e,t){return h(this,e,t)},r}var o=t("copyProperties"),u=t("Assert");o(a.prototype,{instanceOf:function(e){return f(e,this)}}),o(a,{extend:function(e,t){return typeof e=="function"?h.apply(null,arguments):h(null,e,t)},instanceOf:f}),i.exports=a}),l("ObservableMixin",[],function(e,t,n,i,s,o){function u(){this.__observableEvents={}}u.prototype={inform:function(e){var t=Array.prototype.slice.call(arguments,1),n=Array.prototype.slice.call(this.getSubscribers(e));for(var i=0;i<n.length;i++){if(n[i]===null)continue;try{n[i].apply(this,t)}catch(s){r(function(){throw s},0)}}return this},getSubscribers:function(e){return this.__observableEvents[e]||(this.__observableEvents[e]=[])},clearSubscribers:function(e){return e&&(this.__observableEvents[e]=[]),this},clearAllSubscribers:function(){return this.__observableEvents={},this},subscribe:function(e,t){var n=this.getSubscribers(e);return n.push(t),this},unsubscribe:function(e,t){var n=this.getSubscribers(e);for(var r=0;r<n.length;r++)if(n[r]===t){n.splice(r,1);break}return this},monitor:function(e,t){if(!t()){var n=c(function(r){t.apply(t,arguments)&&this.unsubscribe(e,n)},"bind",!0,this);this.subscribe(e,n)}return this}},s.exports=u}),l("sdk.Model",["Type","ObservableMixin"],function(e,t,n,r,i,s){var o=t("Type"),u=t("ObservableMixin"),a=o.extend({constructor:function(e){this.parent();var t={},n=this;c(c("Object","keys",!1,e),"forEach",!0,function(r){t[r]=e[r],n["set"+r]=function(e){return e===t[r]?this:(t[r]=e,n.inform(r+".change",e),n)},n["get"+r]=function(){return t[r]}})}},u);i.exports=a}),l("sdk.Runtime",["sdk.Model","copyProperties","sdk.RuntimeConfig"],function(t,n,r,i,s,o){var u=n("sdk.Model"),a=r("sdk.RuntimeConfig"),f=n("copyProperties"),l={UNKNOWN:0,PAGETAB:1,CANVAS:2,PLATFORM:4},c=new u({AccessToken:"",ClientID:"",Environment:l.UNKNOWN,Initialized:!1,KidDirectedSite:undefined,Locale:a.locale,LoginStatus:undefined,Rtl:a.rtl,Scope:undefined,Secure:undefined,UseCookie:!1,UserID:"",CookieUserID:""});f(c,{ENVIRONMENTS:l,isEnvironment:function(e){var t=this.getEnvironment();return(e|t)===t}}),function(){var t=/app_runner/.test(e.name)?l.PAGETAB:/iframe_canvas/.test(e.name)?l.CANVAS:l.UNKNOWN;(t|l.PAGETAB)===t&&(t|=l.CANVAS),c.setEnvironment(t)}(),s.exports=c}),l("sdk.Cookie",["QueryString","sdk.Runtime"],function(e,t,r,i,s,o){function l(e,t,r){e+=a.getClientID();var i=f&&f!==".";i&&(n.cookie=e+"=; expires=Wed, 04 Feb 2004 08:00:00 GMT;",n.cookie=e+"=; expires=Wed, 04 Feb 2004 08:00:00 GMT;"+"domain="+location.hostname+";");var s=(new Date(r)).toGMTString();n.cookie=e+"="+t+(t&&r===0?"":"; expires="+s)+"; path=/"+(i?"; domain="+f:"")}function c(e){e+=a.getClientID();var t=new RegExp("\\b"+e+"=([^;]*)\\b");return t.test(n.cookie)?RegExp.$1:null}var u=t("QueryString"),a=t("sdk.Runtime"),f=null,h={setDomain:function(e){f=e;var t=u.encode({base_domain:f&&f!=="."?f:""}),n=new Date;n.setFullYear(n.getFullYear()+1),l("fbm_",t,n.getTime())},getDomain:function(){return f},loadMeta:function(){var e=c("fbm_");if(e){var t=u.decode(e);return f||(f=t.base_domain),t}},loadSignedRequest:function(){return c("fbsr_")},setSignedRequestCookie:function(e,t){if(!e)throw new Error("Value passed to Cookie.setSignedRequestCookie was empty.");l("fbsr_",e,t)},clearSignedRequestCookie:function(){l("fbsr_","",0)},setRaw:l};s.exports=h}),l("guid",[],function(e,t,n,r,i,s){function o(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")}i.exports=o}),l("hasNamePropertyBug",["guid"],function(e,t,r,i,s,o){function f(){var e=n.createElement("form"),t=e.appendChild(n.createElement("input"));return t.name=u(),a=t!==e.elements[t.name],e=t=null,a}function l(){return typeof a=="undefined"?f():a}var u=t("guid"),a;s.exports=l}),l("wrapFunction",[],function(e,t,n,r,i,s){function u(e,t,n){return t=t||"default",function(){var r=t in o?o[t](e,n):e;return r.apply(this,arguments)}}var o={};u.setWrapper=function(e,t){t=t||"default",o[t]=e},i.exports=u}),l("DOMEventListener",["wrapFunction"],function(t,n,r,i,s,o){var u=n("wrapFunction"),a,f;e.addEventListener?(a=function(e,t,n){n.wrapper=u(n,"entry","DOMEventListener.add "+t),e.addEventListener(t,n.wrapper,!1)},f=function(e,t,n){e.removeEventListener(t,n.wrapper,!1)}):e.attachEvent?(a=function(e,t,n){n.wrapper=u(n,"entry","DOMEventListener.add "+t),e.attachEvent("on"+t,n.wrapper)},f=function(e,t,n){e.detachEvent("on"+t,n.wrapper)}):f=a=function(){};var l={add:function(e,t,n){return a(e,t,n),{remove:function(){f(e,t,n),e=null}}},remove:f};s.exports=l}),l("sdk.createIframe",["copyProperties","guid","hasNamePropertyBug","DOMEventListener"],function(e,t,r,i,s,o){function c(e){e=u({},e);var t,r=e.name||a(),i=e.root,s=e.style||{border:"none"},o=e.url,c=e.onload;f()?t=n.createElement('<iframe name="'+r+'"/>'):(t=n.createElement("iframe"),t.name=r),delete e.style,delete e.name,delete e.url,delete e.root,delete e.onload;var p=u({frameBorder:0,allowTransparency:!0,scrolling:"no"},e);p.width&&(t.width=p.width+"px"),p.height&&(t.height=p.height+"px"),delete p.height,delete p.width;for(var d in p)p.hasOwnProperty(d)&&t.setAttribute(d,p[d]);u(t.style,s),t.src="javascript:false",i.appendChild(t);if(c)var v=l.add(t,"load",function(){v.remove(),c()});return t.src=o,t}var u=t("copyProperties"),a=t("guid"),f=t("hasNamePropertyBug"),l=t("DOMEventListener");s.exports=c}),l("DOMWrapper",[],function(e,r,i,s,o,u){var a,f,l={setRoot:function(e){a=e},getRoot:function(){return a||n.body},setWindow:function(e){f=e},getWindow:function(){return f||t}};o.exports=l}),l("sdk.feature",["SDKConfig"],function(e,t,n,r,i,s){function u(e,t){if(o.features&&e in o.features){var n=o.features[e];return typeof n=="object"&&typeof n.rate=="number"?n.rate&&Math.random()*100<=n.rate?n.value||!0:n.value?null:!1:n}return typeof t!="undefined"?t:null}var o=n("SDKConfig");i.exports=u}),l("UserAgent",[],function(e,t,r,i,s,o){function x(){if(u)return;u=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),r=/(Mac OS X)|(Windows)|(Linux)/.exec(e);b=/\b(iPhone|iP[ao]d)/.exec(e),w=/\b(iP[ao]d)/.exec(e),g=/Android/i.exec(e),E=/FBAN\/\w+;/i.exec(e),S=/Mobile/i.exec(e),y=!!/Win64/.exec(e);if(t){a=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,a&&n&&n.documentMode&&(a=n.documentMode);var i=/(?:Trident\/(\d+.\d+))/.exec(e);p=i?parseFloat(i[1])+4:a,f=t[2]?parseFloat(t[2]):NaN,l=t[3]?parseFloat(t[3]):NaN,c=t[4]?parseFloat(t[4]):NaN,c?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),h=t&&t[1]?parseFloat(t[1]):NaN):h=NaN}else a=f=l=h=c=NaN;if(r){if(r[1]){var s=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);d=s?parseFloat(s[1].replace("_",".")):!0}else d=!1;v=!!r[2],m=!!r[3]}else d=v=m=!1}var u=!1,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,T={ie:function(){return x()||a},ieCompatibilityMode:function(){return x()||p>a},ie64:function(){return T.ie()&&y},firefox:function(){return x()||f},opera:function(){return x()||l},webkit:function(){return x()||c},safari:function(){return T.webkit()},chrome:function(){return x()||h},windows:function(){return x()||v},osx:function(){return x()||d},linux:function(){return x()||m},iphone:function(){return x()||b},mobile:function(){return x()||b||w||g||S},nativeApp:function(){return x()||E},android:function(){return x()||g},ipad:function(){return x()||w}};s.exports=T}),l("sdk.getContextType",["UserAgent","sdk.Runtime"],function(e,t,n,r,i,s){function a(){return o.nativeApp()?3:o.mobile()?2:u.isEnvironment(u.ENVIRONMENTS.CANVAS)?5:1}var o=t("UserAgent"),u=t("sdk.Runtime");i.exports=a}),l("UrlMap",["UrlMapConfig"],function(e,t,n,r,i,s){var o=t("UrlMapConfig"),u={resolve:function(e,t){var n=typeof t=="undefined"?location.protocol.replace(":",""):t?"https":"http";if(e in o)return n+"://"+o[e];if(typeof t=="undefined"&&e+"_"+n in o)return n+"://"+o[e+"_"+n];if(t!==!0&&e+"_http"in o)return"http://"+o[e+"_http"];if(t!==!1&&e+"_https"in o)return"https://"+o[e+"_https"]}};i.exports=u}),l("sdk.Impressions",["guid","QueryString","sdk.Runtime","UrlMap"],function(e,t,n,r,i,s){function l(e){var t=a.getClientID();!e.api_key&&t&&(e.api_key=t),e.kid_directed_site=a.getKidDirectedSite();var n=new Image;n.src=u.appendToUrl(f.resolve("www",!0)+"/impression.php/"+o()+"/",e)}var o=t("guid"),u=t("QueryString"),a=t("sdk.Runtime"),f=t("UrlMap"),h={log:function(e,t){t.source||(t.source="jssdk"),l({lid:e,payload:c("JSON","stringify",!1,t)})},impression:l};i.exports=h}),l("Log",["sprintf"],function(t,n,r,i,s,o){function f(t,n){var r=Array.prototype.slice.call(arguments,2),i=u.apply(null,r),s=e.console;s&&l.level>=n&&s[t in s?t:"log"](i)}var u=n("sprintf"),a={DEBUG:3,INFO:2,WARNING:1,ERROR:0},l={level:-1,Level:a,debug:c(f,"bind",!0,null,"debug",a.DEBUG),info:c(f,"bind",!0,null,"info",a.INFO),warn:c(f,"bind",!0,null,"warn",a.WARNING),error:c(f,"bind",!0,null,"error",a.ERROR)};s.exports=l}),l("Base64",[],function(e,t,n,r,i,s){function u(e){return e=e.charCodeAt(0)<<16|e.charCodeAt(1)<<8|e.charCodeAt(2),String.fromCharCode(o.charCodeAt(e>>>18),o.charCodeAt(e>>>12&63),o.charCodeAt(e>>>6&63),o.charCodeAt(e&63))}function f(e){return e=a.charCodeAt(e.charCodeAt(0)-43)<<18|a.charCodeAt(e.charCodeAt(1)-43)<<12|a.charCodeAt(e.charCodeAt(2)-43)<<6|a.charCodeAt(e.charCodeAt(3)-43),String.fromCharCode(e>>>16,e>>>8&255,e&255)}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=">___?456789:;<=_______\0\b	\n\f\r______ !\"#$%&'()*+,-./0123",l={encode:function(e){e=unescape(encodeURI(e));var t=(e.length+2)%3;return e=(e+"\0\0".slice(t)).replace(/[\s\S]{3}/g,u),e.slice(0,e.length+t-2)+"==".slice(t)},decode:function(e){e=e.replace(/[^A-Za-z0-9+\/]/g,"");var t=e.length+3&3;e=(e+"AAA".slice(t)).replace(/..../g,f),e=e.slice(0,e.length+t-3);try{return decodeURIComponent(escape(e))}catch(n){throw new Error("Not valid UTF-8")}},encodeObject:function(e){return l.encode(c("JSON","stringify",!1,e))},decodeObject:function(e){return c("JSON","parse",!1,l.decode(e))},encodeNums:function(e){return String.fromCharCode.apply(String,c(e,"map",!0,function(e){return o.charCodeAt((e|-(e>63))&-(e>0)&63)}))}};i.exports=l}),l("sdk.SignedRequest",["Base64"],function(e,t,n,r,i,s){function u(e){if(!e)return null;var t=e.split(".",2)[1].replace(/\-/g,"+").replace(/\_/g,"/");return o.decodeObject(t)}var o=t("Base64"),a={parse:u};i.exports=a}),l("URL",["Assert","copyProperties","QueryString","Log"],function(e,t,r,i,s,o){function m(e){u.isString(e,"The passed argument was of invalid type.");if(h.test(e))throw new URIError("The passed argument could not be parsed as a url.");if(this instanceof m==0)return new m(e);var t=e.replace(p,function(t){return l.warn('Escaping unescaped character \\x%s from "%s"',t.charCodeAt(0).toString(16),e),encodeURIComponent(t)}).match(c);if(!e||!t)throw new URIError("The passed argument could not be parsed as a url.");var n=!!location.hostname;this.setProtocol(t[4]||(n?location.protocol.replace(/:/,""):"")),this.setDomain(t[6]||location.hostname),this.setPort(t[8]||(n&&!t[6]?location.port:"")),this.setPath(t[9]||""),this.setSearch(t[11]||""),this.setFragment(t[13]||""),this._path.substring(0,1)!="/"&&(this._path="/"+this._path);if(this._domain&&!d.test(decodeURIComponent(this._domain.toLowerCase())))throw l.error("Invalid characters found in domain name: %s",this._domain),new URIError("Domain contained invalid characters.")}var u=t("Assert"),a=t("copyProperties"),f=t("QueryString"),l=t("Log"),c=new RegExp("((((\\w+):)?//)(.*?@)?([^~/?#:]+)(:(\\d+))?)?([^\\?$#]+)?(\\?([^$#]+))?(#([^$]+))?"),h=/[\0\\]/,p=/[^\w\-\.,;\/?:@=&%#$~+!*'\[\]()]+/g,d=/^[a-z0-9.][a-z0-9\-\.]+[a-z0-9.]$/,v=/\.facebook\.com$/;a(m.prototype,{constructor:m,getProtocol:function(){return this._protocol},setProtocol:function(e){return this._protocol=e,this},getDomain:function(){return this._domain},setDomain:function(e){return this._domain=e,this},getPort:function(){return this._port},setPort:function(e){return this._port=e,this},getPath:function(){return this._path},setPath:function(e){return this._path=e,this},getSearch:function(){return this._search},setSearch:function(e){return this._search=e,this},getFragment:function(){return this._fragment},setFragment:function(e){return this._fragment=e,this},getParsedSearch:function(){return f.decode(this._search)},getParsedFragment:function(){return f.decode(this._fragment)},isFacebookURL:function(){return v.test(this._domain)},toString:function(){return(this._protocol?this._protocol+":":"")+(this._domain?"//"+this._domain:"")+(this._port?":"+this._port:"")+this._path+(this._search?"?"+this._search:"")+(this._fragment?"#"+this._fragment:"")},valueOf:function(){return this.toString()}}),a(m,{getCurrent:function(){return new m(location.href)},getReferrer:function(){return n.referrer?new m(n.referrer):null}}),s.exports=m}),l("sdk.domReady",[],function(t,i,s,o,u,a){function c(){if(!f)return;var e;while(e=f.shift())e();f=null}function h(e){if(f){f.push(e);return}e()}var f,l="readyState"in n?/loaded|complete/.test(n.readyState):!!n.body;if(!l){f=[],n.addEventListener?(n.addEventListener("DOMContentLoaded",c,!1),e.addEventListener("load",c,!1)):n.attachEvent&&(n.attachEvent("onreadystatechange",c),e.attachEvent("onload",c));if(n.documentElement.doScroll&&e==e.top){var p=function(){try{n.documentElement.doScroll("left")}catch(e){r(p,0);return}c()};p()}}u.exports=h},3),l("sdk.Content",["sdk.domReady","Log","UserAgent"],function(e,t,r,i,s,o){var u=t("sdk.domReady"),a=t("Log"),f=t("UserAgent"),l,c,h={append:function(e,t){t||(l?t=l:(l=t=n.getElementById("fb-root"),t||(a.warn('The "fb-root" div has not been created, auto-creating'),l=t=n.createElement("div"),t.id="fb-root",f.ie()||!n.body?u(function(){n.body.appendChild(t)}):n.body.appendChild(t)),t.className+=" fb_reset"));if(typeof e=="string"){var r=n.createElement("div");return t.appendChild(r).innerHTML=e,r}return t.appendChild(e)},appendHidden:function(e){if(!t){var t=n.createElement("div"),r=t.style;r.position="absolute",r.top="-10000px",r.width=r.height=0,t=h.append(t)}return h.append(e,t)},submitToTarget:function(e,t){var r=n.createElement("form");r.action=e.url,r.target=e.target,r.method=t?"GET":"POST",h.appendHidden(r);for(var i in e.params)if(e.params.hasOwnProperty(i)){var s=e.params[i];if(s!==null&&s!==undefined){var o=n.createElement("input");o.name=i,o.value=s,r.appendChild(o)}}r.submit(),r.parentNode.removeChild(r)}};s.exports=h}),l("sdk.Event",[],function(e,t,n,r,i,s){var o={subscribers:function(){return this._subscribersMap||(this._subscribersMap={}),this._subscribersMap},subscribe:function(e,t){var n=this.subscribers();n[e]?n[e].push(t):n[e]=[t]},unsubscribe:function(e,t){var n=this.subscribers()[e];n&&c(n,"forEach",!0,function(e,r){e==t&&(n[r]=null)})},monitor:function(e,t){if(!t()){var n=this,r=function(){t.apply(t,arguments)&&n.unsubscribe(e,r)};this.subscribe(e,r)}},clear:function(e){delete this.subscribers()[e]},fire:function(e){var t=Array.prototype.slice.call(arguments,1),n=this.subscribers()[e];n&&c(n,"forEach",!0,function(e){e&&e.apply(this,t)})}};i.exports=o}),l("Queue",["copyProperties"],function(e,t,n,i,s,o){function f(e){this._opts=u({interval:0,processor:null},e),this._queue=[],this._stopped=!0}var u=t("copyProperties"),a={};f.prototype._dispatch=function(e){if(this._stopped||this._queue.length===0)return;if(!this._opts.processor)throw this._stopped=!0,new Error("No processor available");if(this._opts.interval)this._opts.processor.call(this,this._queue.shift()),this._timeout=r(c(this._dispatch,"bind",!0,this),this._opts.interval);else while(this._queue.length)this._opts.processor.call(this,this._queue.shift())},f.prototype.enqueue=function(e){return this._opts.processor&&!this._stopped?this._opts.processor.call(this,e):this._queue.push(e),this},f.prototype.start=function(e){return e&&(this._opts.processor=e),this._stopped=!1,this._dispatch(),this},f.prototype.dispatch=function(){this._dispatch(!0)},f.prototype.stop=function(e){return this._stopped=!0,e&&clearTimeout(this._timeout),this},f.prototype.merge=function(e,t){return this._queue[t?"unshift":"push"].apply(this._queue,e._queue),e._queue=[],this._dispatch(),this},f.prototype.getLength=function(){return this._queue.length},f.get=function(e,t){var n;return e in a?n=a[e]:n=a[e]=new f(t),n},f.exists=function(e){return e in a},f.remove=function(e){return delete a[e]},s.exports=f}),l("JSONRPC",["copyProperties","Log"],function(e,t,n,i,s,o){function f(e){this._counter=0,this._callbacks={},this.remote=c(function(e){return this._context=e,this.remote},"bind",!0,this),this.local={},this._write=e}var u=t("copyProperties"),a=t("Log");u(f.prototype,{stub:function(e){this.remote[e]=c(function(){var t=Array.prototype.slice.call(arguments),n={jsonrpc:"2.0",method:e};typeof t[t.length-1]=="function"&&(n.id=++this._counter,this._callbacks[n.id]=t.pop()),n.params=t,this._write(c("JSON","stringify",!1,n),this._context||{method:e})},"bind",!0,this)},read:function(e,t){var n=c("JSON","parse",!1,e),i=n.id;if(!n.method){if(!this._callbacks[i]){a.warn("Could not find callback %s",i);return}var s=this._callbacks[i];delete this._callbacks[i],delete n.id,delete n.jsonrpc,s(n);return}var o=this,u=this.local[n.method],f;i?f=function(e,n){var s={jsonrpc:"2.0",id:i};s[e]=n,r(function(){o._write(c("JSON","stringify",!1,s),t)},0)}:f=function(){};if(!u){a.error('Method "%s" has not been defined',n.method),f("error",{code:-32601,message:"Method not found",data:n.method});return}n.params.push(c(f,"bind",!0,null,"result")),n.params.push(c(f,"bind",!0,null,"error"));try{var l=u.apply(t||null,n.params);typeof l!="undefined"&&f("result",l)}catch(p){a.error("Invokation of RPC method %s resulted in the error: %s",n.method,p.message),f("error",{code:-32603,message:"Internal error",data:p.message})}}}),s.exports=f}),l("sdk.RPC",["Assert","JSONRPC","Queue"],function(e,t,n,r,i,s){var o=t("Assert"),u=t("JSONRPC"),a=t("Queue"),f=new a,l=new u(function(e){f.enqueue(e)}),h={local:l.local,remote:l.remote,stub:c(l.stub,"bind",!0,l),setInQueue:function(e){o.isInstanceOf(a,e),e.start(function(e){l.read(e)})},getOutQueue:function(){return f}};i.exports=h}),l("emptyFunction",["copyProperties"],function(e,t,n,r,i,s){function u(e){return function(){return e}}function a(){}var o=t("copyProperties");o(a,{thatReturns:u,thatReturnsFalse:u(!1),thatReturnsTrue:u(!0),thatReturnsNull:u(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),i.exports=a}),l("htmlSpecialChars",[],function(e,t,n,r,i,s){function c(e){return typeof e=="undefined"||e===null||!e.toString?"":e===!1?"0":e===!0?"1":e.toString().replace(o,"&amp;").replace(f,"&quot;").replace(l,"&#039;").replace(u,"&lt;").replace(a,"&gt;")}var o=/&/g,u=/</g,a=/>/g,f=/"/g,l=/'/g;i.exports=c}),l("Flash",["DOMEventListener","DOMWrapper","QueryString","UserAgent","copyProperties","guid","htmlSpecialChars"],function(t,n,r,i,s,o){function g(e){var t=m.getElementById(e);t&&t.parentNode.removeChild(t),delete d[e]}function y(){for(var e in d)d.hasOwnProperty(e)&&g(e)}function b(e){return e.replace(/\d+/g,function(e){return"000".substring(e.length)+e})}function w(t){v||(l.ie()>=9&&u.add(e,"unload",y),v=!0),d[t]=t}var u=n("DOMEventListener"),a=n("DOMWrapper"),f=n("QueryString"),l=n("UserAgent"),c=n("copyProperties"),h=n("guid"),p=n("htmlSpecialChars"),d={},v,m=a.getWindow().document,E={embed:function(e,t,n,r){var i=h();e=p(e).replace(/&amp;/g,"&"),n=c({allowscriptaccess:"always",flashvars:r,movie:e},n||{}),typeof n.flashvars=="object"&&(n.flashvars=f.encode(n.flashvars));var s=[];for(var o in n)n.hasOwnProperty(o)&&n[o]&&s.push('<param name="'+p(o)+'" value="'+p(n[o])+'">');var u=t.appendChild(m.createElement("span")),a="<object "+(l.ie()?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ':'type="application/x-shockwave-flash"')+'data="'+e+'" '+(n.height?'height="'+n.height+'" ':"")+(n.width?'width="'+n.width+'" ':"")+'id="'+i+'">'+s.join("")+"</object>";u.innerHTML=a;var d=u.firstChild;return w(i),d},remove:g,getVersion:function(){var e="Shockwave Flash",t="application/x-shockwave-flash",n="ShockwaveFlash.ShockwaveFlash",r;if(navigator.plugins&&typeof navigator.plugins[e]=="object"){var i=navigator.plugins[e].description;i&&navigator.mimeTypes&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(r=i.match(/\d+/g))}if(!r)try{r=(new ActiveXObject(n)).GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),r=Array.prototype.slice.call(r,1)}catch(s){}return r},checkMinVersion:function(e){var t=E.getVersion();return t?b(t.join("."))>=b(e):!1},isAvailable:function(){return!!E.getVersion()}};s.exports=E}),l("dotAccess",[],function(e,t,n,r,i,s){function o(e,t,n){var r=t.split(".");do{var i=r.shift();e=e[i]||n&&(e[i]={})}while(r.length&&e);return e}i.exports=o}),l("GlobalCallback",["DOMWrapper","dotAccess","guid","wrapFunction"],function(e,t,n,r,i,s){var o=t("DOMWrapper"),u=t("dotAccess"),a=t("guid"),f=t("wrapFunction"),l,c,h={setPrefix:function(e){l=u(o.getWindow(),e,!0),c=e},create:function(e,t){l||this.setPrefix("__globalCallbacks");var n=a();return l[n]=f(e,"entry",t||"GlobalCallback"),c+"."+n},remove:function(e){var t=e.substring(c.length+1);delete l[t]}};i.exports=h}),l("XDM",["DOMEventListener","DOMWrapper","emptyFunction","Flash","GlobalCallback","guid","Log","UserAgent","wrapFunction"],function(e,t,n,i,s,o){function b(e){var t={},n=e.length,r=g.transports;while(n--)t[e[n]]=1;n=r.length;while(n--){var i=r[n],s=m[i];if(!t[i]&&s.isAvailable())return i}}var u=t("DOMEventListener"),a=t("DOMWrapper"),f=t("emptyFunction"),l=t("Flash"),c=t("GlobalCallback"),h=t("guid"),p=t("Log"),d=t("UserAgent"),v=t("wrapFunction"),m={},g={transports:[]},y=a.getWindow(),w={register:function(e,t){p.debug("Registering %s as XDM provider",e),g.transports.push(e),m[e]=t},create:function(e){if(!e.whenReady&&!e.onMessage)throw p.error("An instance without whenReady or onMessage makes no sense"),new Error("An instance without whenReady or onMessage makes no sense");e.channel||(p.warn("Missing channel name, selecting at random"),e.channel=h()),e.whenReady||(e.whenReady=f),e.onMessage||(e.onMessage=f);var t=e.transport||b(e.blacklist||[]),n=m[t];if(n&&n.isAvailable())return p.debug("%s is available",t),n.init(e),t}};w.register("flash",function(){var e=!1,t,n=!1,i=15e3,s;return{isAvailable:function(){return l.checkMinVersion("8.0.24")},init:function(o){p.debug("init flash: "+o.channel);var u={send:function(e,n,r,i){p.debug("sending to: %s (%s)",n,i),t.postMessage(e,n,i)}};if(e){o.whenReady(u);return}var a=o.root.appendChild(y.document.createElement("div")),f=c.create(function(){c.remove(f),clearTimeout(s),p.info("xdm.swf called the callback");var e=c.create(function(e,t){e=decodeURIComponent(e),t=decodeURIComponent(t),p.debug("received message %s from %s",e,t),o.onMessage(e,t)},"xdm.swf:onMessage");t.init(o.channel,e),o.whenReady(u)},"xdm.swf:load");t=l.embed(o.flashUrl,a,null,{protocol:location.protocol.replace(":",""),host:location.host,callback:f,log:n}),s=r(function(){p.warn("The Flash component did not load within %s ms - verify that the container is not set to hidden or invisible using CSS as this will cause some browsers to not load the components",i)},i),e=!0}}}()),w.register("postmessage",function(){var e=!1;return{isAvailable:function(){return!!y.postMessage},init:function(t){p.debug("init postMessage: "+t.channel);var n="_FB_"+t.channel,i={send:function(e,t,n,i){if(y===n)throw p.error("Invalid windowref, equal to window (self)"),new Error;p.debug("sending to: %s (%s)",t,i);var s=function(){n.postMessage("_FB_"+i+e,t)};d.ie()==8||d.ieCompatibilityMode()?r(s,0):s()}};if(e){t.whenReady(i);return}u.add(y,"message",v(function(e){var r=e.data,i=e.origin||"native";if(typeof r!="string"){p.warn("Received message of type %s from %s, expected a string",typeof r,i);return}p.debug("received message %s from %s",r,i),r.substring(0,n.length)==n&&(r=r.substring(n.length)),t.onMessage(r,i)},"entry","onMessage")),t.whenReady(i),e=!0}}}()),s.exports=w}),l("sdk.XD",["sdk.Content","sdk.createIframe","sdk.Event","guid","Log","QueryString","Queue","sdk.RPC","sdk.Runtime","UrlMap","URL","XDM","XDConfig"],function(e,t,r,i,s,o){function P(e){h.info("Remote XD can talk to facebook.com (%s)",e),m.setEnvironment(e==="canvas"?m.ENVIRONMENTS.CANVAS:m.ENVIRONMENTS.PAGETAB)}function H(e,t){if(!t)throw h.error("No senderOrigin"),new Error;var n=/^https?/.exec(t)[0];switch(e.xd_action){case"proxy_ready":var r,i;n=="https"?(r=x,i=N):(r=S,i=T),e.registered&&(P(e.registered),E=r.merge(E)),h.info("Proxy ready, starting queue %s containing %s messages",n+"ProxyQueue",r.getLength()),r.start(function(e){A.send(typeof e=="string"?e:p.encode(e),t,i.contentWindow,k+"_"+n)});break;case"plugin_ready":h.info("Plugin %s ready, protocol: %s",e.name,n),_[e.name]={protocol:n};if(d.exists(e.name)){var s=d.get(e.name);h.debug("Enqueuing %s messages for %s in %s",s.getLength(),e.name,n+"ProxyQueue"),(n=="https"?x:S).merge(s)}}e.data&&B(e.data,t)}function B(e,t){if(t&&t!=="native"&&!y(t).isFacebookURL())return;if(typeof e=="string"){if(/^FB_RPC:/.test(e)){D.enqueue(e.substring(7));return}if(e.substring(0,1)=="{")try{e=c("JSON","parse",!1,e)}catch(n){h.warn("Failed to decode %s as JSON",e);return}else e=p.decode(e)}t||e.xd_sig==C&&(t=e.xd_origin);if(e.xd_action){H(e,t);return}e.access_token&&m.setSecure(/^https/.test(L));if(e.cb){var r=I._callbacks[e.cb];I._forever[e.cb]||delete I._callbacks[e.cb],r&&r(e)}}function j(e,t){if(e=="facebook")t.relation="parent.parent",E.enqueue(t);else{t.relation='parent.frames["'+e+'"]';var n=_[e];n?(h.debug("Enqueuing message for plugin %s in %s",e,n.protocol+"ProxyQueue"),(n.protocol=="https"?x:S).enqueue(t)):(h.debug("Buffering message for plugin %s",e),d.get(e).enqueue(t))}}function F(e){if(O)return;var t=u.appendHidden(n.createElement("div")),r=w.create({blacklist:null,root:t,channel:k,flashUrl:b.Flash.path,whenReady:function(n){A=n;var i={channel:k,origin:location.protocol+"//"+location.host,transport:r,xd_name:e},s="/"+b.XdUrl+"#"+p.encode(i),o=b.useCdn?g.resolve("cdn",!1):"http://www.facebook.com",u=b.useCdn?g.resolve("cdn",!0):"https://www.facebook.com";m.getSecure()!==!0&&(T=a({url:o+s,name:"fb_xdm_frame_http",id:"fb_xdm_frame_http",root:t,"aria-hidden":!0,title:M,"tab-index":-1})),N=a({url:u+s,name:"fb_xdm_frame_https",id:"fb_xdm_frame_https",root:t,"aria-hidden":!0,title:M,"tab-index":-1})},onMessage:B});O=!0}var u=t("sdk.Content"),a=t("sdk.createIframe"),f=t("sdk.Event"),l=t("guid"),h=t("Log"),p=t("QueryString"),d=t("Queue"),v=t("sdk.RPC"),m=t("sdk.Runtime"),g=t("UrlMap"),y=t("URL"),b=r("XDConfig"),w=t("XDM"),E=new d,S=new d,x=new d,T,N,C=l(),k=l(),L=location.protocol+"//"+location.host,A,O=!1,M="Facebook Cross Domain Communication Frame",_={},D=new d;v.setInQueue(D),v.getOutQueue().start(function(e){j("facebook","FB_RPC:"+e)});var I={rpc:v,_callbacks:{},_forever:{},_channel:k,_origin:L,onMessage:B,recv:B,init:F,sendToFacebook:j,inform:function(e,t,n,r){j("facebook",{method:e,params:c("JSON","stringify",!1,t||{}),behavior:r||"p",relation:n})},handler:function(e,t,n,r){var i=b.useCdn?g.resolve("cdn",location.protocol=="https:"):location.protocol+"//www.facebook.com";return i+"/"+b.XdUrl+"#"+p.encode({cb:this.registerCallback(e,n,r),origin:L+"/"+k,domain:location.hostname,relation:t||"opener"})},registerCallback:function(e,t,n){return n=n||l(),t&&(I._forever[n]=!0),I._callbacks[n]=e,n}};f.subscribe("init:post",function(e){F(e.xdProxyName)}),s.exports=I}),l("sdk.Auth",["sdk.Cookie","copyProperties","sdk.createIframe","DOMWrapper","sdk.feature","sdk.getContextType","guid","sdk.Impressions","Log","ObservableMixin","QueryString","sdk.Runtime","sdk.SignedRequest","UrlMap","URL","sdk.XD"],function(e,t,n,i,s,o){function k(e,t){var n=b.getUserID(),r="";if(e)if(e.userID)r=e.userID;else if(e.signedRequest){var i=w.parse(e.signedRequest);i&&i.user_id&&(r=i.user_id)}var s=b.getLoginStatus(),o=s==="unknown"&&e||b.getUseCookie()&&b.getCookieUserID()!==r,u=n&&!e,a=e&&n&&n!=r,f=e!=T,l=t!=(s||"unknown");b.setLoginStatus(t),b.setAccessToken(e&&e.accessToken||null),b.setUserID(r),T=e;var c={authResponse:e,status:t};return(u||a)&&C.inform("logout",c),(o||a)&&C.inform("login",c),f&&C.inform("authresponse.change",c),l&&C.inform("status.change",c),c}function L(){return T}function A(e,t,n){return function(r){var i;if(r&&r.access_token){var s=w.parse(r.signed_request);t={accessToken:r.access_token,userID:s.user_id,expiresIn:parseInt(r.expires_in,10),signedRequest:r.signed_request},r.granted_scopes&&(t.grantedScopes=r.granted_scopes);if(b.getUseCookie()){var o=t.expiresIn===0?0:c("Date","now",!1)+t.expiresIn*1e3,a=u.getDomain();!a&&r.base_domain&&u.setDomain("."+r.base_domain),u.setSignedRequestCookie(r.signed_request,o)}i="connected",k(t,i)}else if(n==="logout"||n==="login_status")r.error&&r.error==="not_authorized"?i="not_authorized":i="unknown",k(null,i),b.getUseCookie()&&u.clearSignedRequestCookie();return r&&r.https==1&&b.setSecure(!0),e&&e({authResponse:t,status:b.getLoginStatus()}),t}}function O(e){var t,n=c("Date","now",!1);N&&(clearTimeout(N),N=null);var i=A(e,T,"login_status"),s=S(E.resolve("www",!0)+"/connect/ping").setSearch(y.encode({client_id:b.getClientID(),response_type:"token,signed_request,code",domain:location.hostname,origin:p(),redirect_uri:x.handler(function(e){if(h("e2e_ping_tracking",!0)){var s={init:n,close:c("Date","now",!1),method:"ping"};m.debug("e2e: %s",c("JSON","stringify",!1,s)),v.log(114,{payload:s})}t.parentNode.removeChild(t),i(e)&&(N=r(function(){O(function(){})},12e5))},"parent"),sdk:"joey",kid_directed_site:b.getKidDirectedSite()}));t=f({root:l.getRoot(),name:d(),url:s.toString(),style:{display:"none"}})}function _(e,t){if(!b.getClientID()){m.warn("FB.getLoginStatus() called before calling FB.init().");return}if(e){if(!t&&M=="loaded"){e({status:b.getLoginStatus(),authResponse:L()});return}C.subscribe("FB.loginStatus",e)}if(!t&&M=="loading")return;M="loading";var n=function(e){M="loaded",C.inform("FB.loginStatus",e),C.clearSubscribers("FB.loginStatus")};O(n)}var u=t("sdk.Cookie"),a=t("copyProperties"),f=t("sdk.createIframe"),l=t("DOMWrapper"),h=t("sdk.feature"),p=t("sdk.getContextType"),d=t("guid"),v=t("sdk.Impressions"),m=t("Log"),g=t("ObservableMixin"),y=t("QueryString"),b=t("sdk.Runtime"),w=t("sdk.SignedRequest"),E=t("UrlMap"),S=t("URL"),x=t("sdk.XD"),T,N,C=new g,M;a(C,{getLoginStatus:_,fetchLoginStatus:O,setAuthResponse:k,getAuthResponse:L,parseSignedRequest:w.parse,xdResponseWrapper:A}),s.exports=C}),l("invariant",[],function(e,t,n,r,i,s){function o(e){if(!e){var t=new Error("Minified exception occured, use the non-minified dev environment for the full error message and additional helpful warnings.");throw t.framesToPop=1,t}}i.exports=o}),l("toArray",["invariant"],function(e,t,n,r,i,s){function u(e){var t=e.length;o(!c("Array","isArray",!1,e)&&(typeof e=="object"||typeof e=="function")),o(typeof t=="number"),o(t===0||t-1 in e);if(e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}var r=Array(t);for(var i=0;i<t;i++)r[i]=e[i];return r}var o=t("invariant");i.exports=u}),l("createArrayFrom",["toArray"],function(e,t,n,r,i,s){function u(e){return!!e&&(typeof e=="object"||typeof e=="function")&&"length"in e&&!("setInterval"in e)&&typeof e.nodeType!="number"&&(c("Array","isArray",!1,e)||"callee"in e||"item"in e)}function a(e){return u(e)?c("Array","isArray",!1,e)?e.slice():o(e):[e]}var o=t("toArray");i.exports=a}),l("sdk.DOM",["Assert","createArrayFrom","sdk.domReady","UserAgent"],function(t,r,i,s,o,u){function d(e,t){var n=e.getAttribute(t)||e.getAttribute(t.replace(/_/g,"-"))||e.getAttribute(t.replace(/-/g,"_"))||e.getAttribute(t.replace(/-/g,""))||e.getAttribute(t.replace(/_/g,""))||e.getAttribute("data-"+t)||e.getAttribute("data-"+t.replace(/_/g,"-"))||e.getAttribute("data-"+t.replace(/-/g,"_"))||e.getAttribute("data-"+t.replace(/-/g,""))||e.getAttribute("data-"+t.replace(/_/g,""));return n?String(n):null}function v(e,t){var n=d(e,t);return n?/^(true|1|yes|on)$/.test(n):null}function m(e,t){a.isTruthy(e,"element not specified"),a.isString(t);try{return String(e[t])}catch(n){throw new Error("Could not read property "+t+" : "+n.message)}}function g(e,t){a.isTruthy(e,"element not specified"),a.isString(t);try{e.innerHTML=t}catch(n){throw new Error("Could not set innerHTML : "+n.message)}}function y(e,t){a.isTruthy(e,"element not specified"),a.isString(t);var n=" "+m(e,"className")+" ";return c(n,"indexOf",!0," "+t+" ")>=0}function b(e,t){a.isTruthy(e,"element not specified"),a.isString(t),y(e,t)||(e.className=m(e,"className")+" "+t)}function w(e,t){a.isTruthy(e,"element not specified"),a.isString(t);var n=new RegExp("\\s*"+t,"g");e.className=c(m(e,"className").replace(n,""),"trim",!0)}function E(e,t,r){a.isString(e),t=t||n.body,r=r||"*";if(t.querySelectorAll)return f(t.querySelectorAll(r+"."+e));var i=t.getElementsByTagName(r),s=[];for(var o=0,u=i.length;o<u;o++)y(i[o],e)&&(s[s.length]=i[o]);return s}function S(e,t){a.isTruthy(e,"element not specified"),a.isString(t),t=t.replace(/-(\w)/g,function(e,t){return t.toUpperCase()});var r=e.currentStyle||n.defaultView.getComputedStyle(e,null),i=r[t];return/backgroundPosition?/.test(t)&&/top|left/.test(i)&&(i="0%"),i}function x(e,t,n){a.isTruthy(e,"element not specified"),a.isString(t),t=t.replace(/-(\w)/g,function(e,t){return t.toUpperCase()}),e.style[t]=n}function T(e,t){var r=!0;for(var i=0,s;s=t[i++];)s in p||(r=!1,p[s]=!0);if(r)return;if(!h.ie()){var o=n.createElement("style");o.type="text/css",o.textContent=e,n.getElementsByTagName("head")[0].appendChild(o)}else try{n.createStyleSheet().cssText=e}catch(u){n.styleSheets[0]&&(n.styleSheets[0].cssText+=e)}}function N(){var t=n.documentElement&&n.compatMode=="CSS1Compat"?n.documentElement:n.body;return{scrollTop:t.scrollTop||n.body.scrollTop,scrollLeft:t.scrollLeft||n.body.scrollLeft,width:e.innerWidth?e.innerWidth:t.clientWidth,height:e.innerHeight?e.innerHeight:t.clientHeight}}function C(e){a.isTruthy(e,"element not specified");var t=0,n=0;do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:n}}var a=r("Assert"),f=r("createArrayFrom"),l=r("sdk.domReady"),h=r("UserAgent"),p={},k={containsCss:y,addCss:b,removeCss:w,getByClass:E,getStyle:S,setStyle:x,getAttr:d,getBoolAttr:v,getProp:m,html:g,addCssRules:T,getViewportInfo:N,getPosition:C,ready:l};o.exports=k}),l("sdk.Scribe",["UrlMap","QueryString"],function(e,t,n,r,i,s){function a(e,t){(new Image).src=u.appendToUrl(o.resolve("www",!0)+"/common/scribe_endpoint.php",{c:e,m:c("JSON","stringify",!1,t)})}var o=t("UrlMap"),u=t("QueryString"),f={log:a};i.exports=f}),l("sdk.ErrorHandling",["sdk.feature","ManagedError","sdk.Runtime","sdk.Scribe","UserAgent","wrapFunction"],function(t,n,s,o,u,a){function y(e){var t=e._originalError;throw delete e._originalError,p.log("jssdk_error",{appId:h.getClientID(),error:e.name||e.message,extra:e}),t}function b(e){var t={line:e.lineNumber||e.line,message:e.message,name:e.name,script:e.fileName||e.sourceURL||e.script,stack:e.stackTrace||e.stack};t._originalError=e,d.chrome()&&/([\w:\.\/]+\.js):(\d+)/.test(e.stack)&&(t.script=RegExp.$1,t.line=parseInt(RegExp.$2,10));for(var n in t)t[n]==null&&delete t[n];return t}function w(e,t){return function(){if(!m)return e.apply(this,arguments);try{return g=t,e.apply(this,arguments)}catch(n){if(n instanceof l)throw n;var r=b(n);r.entry=t;var i=c(Array.prototype.slice.call(arguments),"map",!0,function(e){var t=Object.prototype.toString.call(e);return/^\[object (String|Number|Boolean|Object|Date)\]$/.test(t)?e:e.toString()});r.args=c("JSON","stringify",!1,i).substring(0,200),y(r)}finally{g=""}}}function E(t){return t.__wrapper||(t.__wrapper=function(){try{return t.apply(this,arguments)}catch(n){return e.setTimeout(function(){throw n},0),!1}}),t.__wrapper}function S(e,t){return function(n,r){var i=t+":"+(g||"[global]")+":"+(n.name||"[anonymous]"+(arguments.callee.caller.name?"("+arguments.callee.caller.name+")":""));return e(v(n,"entry",i),r)}}var f=n("sdk.feature"),l=n("ManagedError"),h=n("sdk.Runtime"),p=n("sdk.Scribe"),d=n("UserAgent"),v=n("wrapFunction"),m=f("error_handling",!1),g="";m&&(r=S(r,"setTimeout"),i=S(i,"setInterval"),v.setWrapper(w,"entry"));var x={guard:w,unguard:E};u.exports=x}),l("sdk.Insights",["sdk.Impressions"],function(e,t,n,r,i,s){var o=t("sdk.Impressions"),u={TYPE:{NOTICE:"notice",WARNING:"warn",ERROR:"error"},CATEGORY:{DEPRECATED:"deprecated",APIERROR:"apierror"},log:function(e,t,n){var r={source:"jssdk",type:e,category:t,payload:n};o.log(113,r)},impression:o.impression};i.exports=u}),l("FB",["sdk.Auth","copyProperties","dotAccess","sdk.domReady","sdk.DOM","sdk.ErrorHandling","sdk.Content","DOMWrapper","GlobalCallback","sdk.Insights","Log","sdk.Runtime","sdk.Scribe","CssConfig","SDKConfig"],function(t,r,i,s,o,u){function O(e,t,n,r){var i;/^_/.test(n)?i="hide":N&&!N[t]&&(i=C);switch(i){case"hide":return;case"stub":return function(){w.warn("The method FB.%s has been removed from the JS SDK.",t)};default:return v.guard(function(){function n(e){return c("Array","isArray",!1,e)?c(e,"map",!0,n):e&&typeof e=="object"&&e.__wrapped?e.__wrapped:typeof e=="function"&&/^function/.test(e.toString())?v.unguard(e):e}i==="warn"&&(w.warn("The method FB.%s is not officially supported by Facebook and access to it will soon be removed.",t),k.hasOwnProperty(t)||(b.log(b.TYPE.WARNING,b.CATEGORY.DEPRECATED,"FB."+t),S.log("jssdk_error",{appId:E.getClientID(),error:"Private method used",extra:{args:t}}),k[t]=!0));var s=c(Array.prototype.slice.call(arguments),"map",!0,n),o=e.apply(r,s),u,a=!0;if(o&&typeof o=="object"){var f=Function();f.prototype=o,u=new f,u.__wrapped=o;for(var l in o){var h=o[l];if(typeof h!="function"||l==="constructor")continue;a=!1,u[l]=O(h,t+":"+l,l,o)}}return a?a?o:u:u},t)}}function M(e,t){var n=e?h(T,e,!0):T;c(c("Object","keys",!1,t),"forEach",!0,function(r){var i=t[r];if(typeof i=="function"){var s=(e?e+".":"")+r,o=O(i,s,r,t);o&&(n[r]=o)}})}var a=r("sdk.Auth"),f=r("copyProperties"),l=i("CssConfig"),h=r("dotAccess"),p=r("sdk.domReady"),d=r("sdk.DOM"),v=r("sdk.ErrorHandling"),m=r("sdk.Content"),g=r("DOMWrapper"),y=r("GlobalCallback"),b=r("sdk.Insights"),w=r("Log"),E=r("sdk.Runtime"),S=r("sdk.Scribe"),x=i("SDKConfig"),T,N,C=h(x,"api.mode"),k={};T=e.FB={};var L={};w.level=1,y.setPrefix("FB.__globalCallbacks");var A=n.createElement("div");g.setRoot(A),p(function(){w.info("domReady"),m.appendHidden(A),l.rules&&d.addCssRules(l.rules,l.components)}),E.subscribe("AccessToken.change",function(e){!e&&E.getLoginStatus()==="connected"&&a.getLoginStatus(null,!0)}),h(x,"api.whitelist.length")&&(N={},c(x.api.whitelist,"forEach",!0,function(e){N[e]=1})),E.setSecure(function(){var t=/iframe_canvas|app_runner/.test(e.name),n=/dialog/.test(e.name);if(location.protocol=="https:"&&(e==top||!t&&!n))return!0;if(/_fb_https?/.test(e.name))return c(e.name,"indexOf",true,"_fb_https")!=-1}()),f(L,{provide:M}),o.exports=L}),l("ArgumentError",["ManagedError"],function(e,t,n,r,i,s){function u(e,t){o.prototype.constructor.apply(this,arguments)}var o=t("ManagedError");u.prototype=new o,u.prototype.constructor=u,i.exports=u}),l("CORSRequest",["wrapFunction","QueryString"],function(e,n,r,i,s,o){function f(e,n){if(!t.XMLHttpRequest)return null;var r=new XMLHttpRequest,i=function(){};if("withCredentials"in r)r.open(e,n,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded");else{if(!t.XDomainRequest)return null;r=new XDomainRequest;try{r.open(e,n),r.onprogress=r.ontimeout=i}catch(s){return null}}var o={send:function(e){r.send(e)}},a=u(function(){a=i,"onload"in o&&o.onload(r)},"entry","XMLHttpRequest:load"),f=u(function(){f=i,"onerror"in o&&o.onerror(r)},"entry","XMLHttpRequest:error");return r.onload=function(){a()},r.onerror=function(){f()},r.onreadystatechange=function(){r.readyState==4&&(r.status==200?a():f())},o}function l(e,t,n,r){n.suppress_http_code=1;var i=a.encode(n);t!="post"&&(e=a.appendToUrl(e,i),i="");var s=f(t,e);return s?(s.onload=function(e){r(c("JSON","parse",!1,e.responseText))},s.onerror=function(e){e.responseText?r(c("JSON","parse",!1,e.responseText)):r({error:{type:"http",message:"unknown error",status:e.status}})},s.send(i),!0):!1}var u=n("wrapFunction"),a=n("QueryString"),h={execute:l};s.exports=h}),l("FlashRequest",["DOMWrapper","Flash","GlobalCallback","QueryString","Queue"],function(e,t,n,r,i,s){function m(){if(!d)throw new Error("swfUrl has not been set");var e=a.create(function(){h.start(function(e){var t=v.execute(e.method,e.url,e.body);if(!t)throw new Error("Could create request");p[t]=e.callback})}),t=a.create(function(e,t,n){var r;try{r=c("JSON","parse",!1,decodeURIComponent(n))}catch(i){r={error:{type:"SyntaxError",message:i.message,status:t,raw:n}}}p[e](r),delete p[e]});v=u.embed(d,o.getRoot(),null,{log:!1,initCallback:e,requestCallback:t})}function g(e,t,n,r){n.suppress_http_code=1,n.method||(n.method=t);var i=f.encode(n);t==="get"&&e.length+i.length<2e3?(e=f.appendToUrl(e,i),i=""):t="post";if(!h){if(!u.isAvailable())return!1;h=new l,m()}return h.enqueue({method:t,url:e,body:i,callback:r}),!0}var o=t("DOMWrapper"),u=t("Flash"),a=t("GlobalCallback"),f=t("QueryString"),l=t("Queue"),h,p={},d,v,y={setSwfUrl:function(e){d=e},execute:g};i.exports=y}),l("flattenObject",[],function(e,t,n,r,i,s){function o(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(null===r||undefined===r)continue;typeof r=="string"?t[n]=r:t[n]=c("JSON","stringify",!1,r)}return t}i.exports=o}),l("JSONPRequest",["DOMWrapper","GlobalCallback","QueryString"],function(e,t,i,s,o,u){function c(e,t,i,s){var o=n.createElement("script"),u=function(e){u=function(){},f.remove(i.callback),s(e),o.parentNode.removeChild(o)};i.callback=f.create(u),i.method||(i.method=t),e=l.appendToUrl(e,i);if(e.length>2e3)return f.remove(i.callback),!1;o.onerror=function(){u({error:{type:"http",message:"unknown error"}})};var c=function(){r(function(){u({error:{type:"http",message:"unknown error"}})},0)};return o.addEventListener?o.addEventListener("load",c,!1):o.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&c()},o.src=e,a.getRoot().appendChild(o),!0}var a=t("DOMWrapper"),f=t("GlobalCallback"),l=t("QueryString"),h={execute:c};o.exports=h}),l("keyMirror",["invariant"],function(e,t,n,r,i,s){var o=t("invariant"),u=function(e){var t={},n;o(e instanceof Object&&!c("Array","isArray",!1,e));for(n in e){if(!e.hasOwnProperty(n))continue;t[n]=n}return t};i.exports=u}),l("mergeHelpers",["invariant","keyMirror"],function(e,t,n,r,i,s){var o=t("invariant"),u=t("keyMirror"),a=36,f=function(e){return typeof e!="object"||e===null},l={MAX_MERGE_DEPTH:a,isTerminal:f,normalizeMergeArg:function(e){return e===undefined||e===null?{}:e},checkMergeArrayArgs:function(e,t){o(c("Array","isArray",!1,e)&&c("Array","isArray",!1,t))},checkMergeObjectArgs:function(e,t){l.checkMergeObjectArg(e),l.checkMergeObjectArg(t)},checkMergeObjectArg:function(e){o(!f(e)&&!c("Array","isArray",!1,e))},checkMergeLevel:function(e){o(e<a)},checkArrayStrategy:function(e){o(e===undefined||e in l.ArrayStrategies)},ArrayStrategies:u({Clobber:!0,IndexByIndex:!0})};i.exports=l}),l("mergeInto",["mergeHelpers"],function(e,t,n,r,i,s){function a(e,t){u(e);if(t!=null){u(t);for(var n in t){if(!t.hasOwnProperty(n))continue;e[n]=t[n]}}}var o=t("mergeHelpers"),u=o.checkMergeObjectArg;i.exports=a}),l("merge",["mergeInto"],function(e,t,n,r,i,s){var o=t("mergeInto"),u=function(e,t){var n={};return o(n,e),o(n,t),n};i.exports=u}),l("ApiClient",["ArgumentError","Assert","copyProperties","CORSRequest","FlashRequest","flattenObject","JSONPRequest","Log","merge","ObservableMixin","sprintf","URL","UrlMap","ApiClientConfig"],function(e,t,n,r,i,s){function C(e,t,n,r){x&&(n=a({},x,n)),n.access_token=n.access_token||E,n.pretty=n.pretty||0,n=h(n);var i={jsonp:p,cors:f,flash:l},s;n.transport?(s=[n.transport],delete n.transport):s=["jsonp","cors","flash"];for(var o=0;o<s.length;o++){var u=i[s[o]],c=a({},n);if(u.execute(e,t,c,r))return}r({error:{type:"no-transport",message:"Could not find a usable transport for request"}})}function k(e,t,n,r,i){O.inform("request.complete",t,n,r,i),e&&e(i)}function L(e){u.isString(e,"Invalid path");var t,n={};try{t=new y(e)}catch(r){throw new o(r.message,r)}c(Array.prototype.slice.call(arguments,1),"forEach",!0,function(e){n[typeof e]=e});var i=(n.string||"get").toLowerCase(),s=v(n.object||{},t.getParsedSearch()),a=n["function"];a||d.warn("No callback passed to the ApiClient");var f=c(k,"bind",!0,null,a,t.getPath(),i,s);u.isTrue(i in T,g("Invalid method passed to ApiClient: %s",i)),s.method=i,t=b.resolve("graph")+t.getPath(),C(t,i=="get"?"get":"post",s,f)}function A(e,t){u.isObject(e),u.isString(e.method,"method missing"),t||d.warn("No callback passed to the ApiClient");var n=e.method.toLowerCase().replace(".","_");e.format="json-strings",e.api_key=S;var r=n in N?"api_read":"api",i=b.resolve(r)+"/restserver.php",s=c(k,"bind",!0,null,t,"/restserver.php","get",e);C(i,"get",e,s)}var o=t("ArgumentError"),u=t("Assert"),a=t("copyProperties"),f=t("CORSRequest"),l=t("FlashRequest"),h=t("flattenObject"),p=t("JSONPRequest"),d=t("Log"),v=t("merge"),m=t("ObservableMixin"),g=t("sprintf"),y=t("URL"),b=t("UrlMap"),w=t("ApiClientConfig"),E,S,x,T={get:!0,post:!0,"delete":!0,put:!0},N={fql_query:!0,fql_multiquery:!0,friends_get:!0,notifications_get:!0,stream_get:!0,users_getinfo:!0},O=a(new m,{setAccessToken:function(e){E=e},setClientID:function(e){S=e},setDefaultParams:function(e){x=e},rest:A,graph:L});l.setSwfUrl(w.FlashRequest.swfUrl),i.exports=O}),l("sdk.api",["ApiClient","sdk.Runtime"],function(e,t,n,r,i,s){function f(){typeof arguments[0]=="string"?o.graph.apply(o,arguments):o.rest.apply(o,arguments)}var o=t("ApiClient"),u=t("sdk.Runtime"),a;u.subscribe("ClientID.change",function(e){o.setClientID(e)}),u.subscribe("AccessToken.change",function(e){a=e,o.setAccessToken(e)}),o.setDefaultParams({sdk:"joey"}),o.subscribe("request.complete",function(e,t,n,r){var i=!1;if(r&&typeof r=="object")if(r.error){if(r.error=="invalid_token"||r.error.type=="OAuthException"&&r.error.code==190)i=!0}else r.error_code&&r.error_code=="190"&&(i=!0);i&&a===u.getAccessToken()&&u.setAccessToken(null)}),o.subscribe("request.complete",function(e,t,n,r){(e=="/me/permissions"&&t==="delete"||e=="/restserver.php"&&n.method=="Auth.revokeAuthorization")&&r===!0&&u.setAccessToken(null)}),i.exports=f}),l("legacy:fb.api",["FB","sdk.api"],function(e,t,n,r){var i=t("FB"),s=t("sdk.api");i.provide("",{api:s})},3),l("sdk.Canvas.Environment",["sdk.RPC"],function(e,t,n,r,i,s){function u(e){o.remote.getPageInfo(function(t){e(t.result)})}function a(e,t){o.remote.scrollTo({x:e||0,y:t||0})}var o=t("sdk.RPC");o.stub("getPageInfo"),o.stub("scrollTo");var f={getPageInfo:u,scrollTo:a};i.exports=f}),l("sdk.Intl",["Log"],function(e,t,n,r,i,s){function a(e){return typeof e!="string"?!1:!!e.match(new RegExp(u+"["+')"'+"'"+"»"+"༻"+"༽"+"’"+"”"+"›"+"〉"+"》"+"」"+"』"+"】"+"〕"+"〗"+"〙"+"〛"+"〞"+"〟"+"﴿"+"＇"+"）"+"］"+"\\s"+"]*$"))}function f(e,t){if(t!==undefined)if(typeof t!="object")o.error("The second arg to FB.Intl.tx() must be an Object for FB.Intl.tx("+e+", ...)");else{var n;for(var r in t)t.hasOwnProperty(r)&&(a(t[r])?n=new RegExp("\\{"+r+"\\}"+u+"*","g"):n=new RegExp("\\{"+r+"\\}","g"),e=e.replace(n,t[r]))}return e}function l(){throw new Error("Placeholder function")}var o=t("Log"),u="[.!?。！？।…ຯ᠁ฯ．]";l._=f,i.exports={tx:l}}),l("sdk.Dialog",["sdk.Canvas.Environment","sdk.Content","sdk.DOM","DOMEventListener","sdk.Intl","ObservableMixin","sdk.Runtime","Type","UserAgent","sdk.feature"],function(t,i,s,o,u,a){function N(){if(b("dialog_resize_refactor")){var e=h.getViewportInfo();if(e.height&&e.width)return{width:Math.min(e.width,w),height:Math.min(e.height,E)}}return null}var f=i("sdk.Canvas.Environment"),l=i("sdk.Content"),h=i("sdk.DOM"),p=i("DOMEventListener"),d=i("sdk.Intl"),v=i("ObservableMixin"),m=i("sdk.Runtime"),g=i("Type"),y=i("UserAgent"),b=i("sdk.feature"),w=590,E=500,S=240,x=575,T=function(){var e;if(b("dialog_resize_refactor")){var t=N();e=t&&(t.height>=w||t.width>=E)}else e=y.ipad();return T=function(){return e},e},C=g.extend({constructor:function(t,n){this.parent(),this.id=t,this.display=n,this._e2e={},k._dialogs||(k._dialogs={},k._addOrientationHandler()),k._dialogs[t]=this,this.trackEvent("init")},trackEvent:function(e,t){return this._e2e[e]?this:(this._e2e[e]=t||c("Date","now",!1),e=="close"&&this.inform("e2e:end",this._e2e),this)},trackEvents:function(e){typeof e=="string"&&(e=c("JSON","parse",!1,e));for(var t in e)e.hasOwnProperty(t)&&this.trackEvent(t,e[t]);return this}},v),k={newInstance:function(e,t){return new C(e,t)},_dialogs:null,_lastYOffset:0,_loaderEl:null,_overlayEl:null,_stack:[],_active:null,get:function(e){return k._dialogs[e]},_findRoot:function(e){while(e){if(h.containsCss(e,"fb_dialog"))return e;e=e.parentNode}},_createWWWLoader:function(e){return e=e?e:460,k.create({content:'<div class="dialog_title">  <a id="fb_dialog_loader_close">    <div class="fb_dialog_close_icon"></div>  </a>  <span>Facebook</span>  <div style="clear:both;"></div></div><div class="dialog_content"></div><div class="dialog_footer"></div>',width:e})},_createMobileLoader:function(){var e=y.nativeApp()?"":'<table>  <tbody>    <tr>      <td class="header_left">        <label class="touchable_button">          <input type="submit" value="'+d.tx._("Cancel")+'"'+'            id="fb_dialog_loader_close"/>'+"        </label>"+"      </td>"+'      <td class="header_center">'+"        <div>"+d.tx._("Loading...")+"</div>"+"      </td>"+'      <td class="header_right">'+"      </td>"+"    </tr>"+"  </tbody>"+"</table>";return k.create({classes:"loading"+(T()?" centered":""),content:'<div class="dialog_header">'+e+"</div>"})},_restoreBodyPosition:function(){if(!T()){var e=n.getElementsByTagName("body")[0];h.removeCss(e,"fb_hidden")}},_showTabletOverlay:function(){if(!T())return;k._overlayEl||(k._overlayEl=n.createElement("div"),k._overlayEl.setAttribute("id","fb_dialog_ipad_overlay"),l.append(k._overlayEl,null)),k._overlayEl.className=""},_hideTabletOverlay:function(){T()&&(k._overlayEl.className="hidden")},showLoader:function(e,t){k._showTabletOverlay(),k._loaderEl||(k._loaderEl=k._findRoot(y.mobile()?k._createMobileLoader():k._createWWWLoader(t))),e||(e=function(){});var r=n.getElementById("fb_dialog_loader_close");h.removeCss(r,"fb_hidden"),r.onclick=function(){k._hideLoader(),k._restoreBodyPosition(),k._hideTabletOverlay(),e()};var i=n.getElementById("fb_dialog_ipad_overlay");i&&(i.ontouchstart=r.onclick),k._makeActive(k._loaderEl)},_hideLoader:function(){k._loaderEl&&k._loaderEl==k._active&&(k._loaderEl.style.top="-10000px")},_makeActive:function(e){k._setDialogSizes(),k._lowerActive(),k._active=e,m.isEnvironment(m.ENVIRONMENTS.CANVAS)&&f.getPageInfo(function(e){k._centerActive(e)}),k._centerActive()},_lowerActive:function(){if(!k._active)return;k._active.style.top="-10000px",k._active=null},_removeStacked:function(e){k._stack=c(k._stack,"filter",!0,function(t){return t!=e})},_centerActive:function(e){var t=k._active;if(!t)return;var r=h.getViewportInfo(),i=parseInt(t.offsetWidth,10),s=parseInt(t.offsetHeight,10),o=r.scrollLeft+(r.width-i)/2,u=(r.height-s)/2.5;o<u&&(u=o);var a=r.height-s-u,f=(r.height-s)/2;e&&(f=e.scrollTop-e.offsetTop+(e.clientHeight-s)/2),f<u?f=u:f>a&&(f=a),f+=r.scrollTop;if(y.mobile()){var l=100;if(T())l+=(r.height-s)/2;else{var c=n.getElementsByTagName("body")[0];h.addCss(c,"fb_hidden"),b("dialog_resize_refactor")&&(c.style.width="auto"),f=1e4}var p=h.getByClass("fb_dialog_padding",t);p.length&&(p[0].style.height=l+"px")}t.style.left=(o>0?o:0)+"px",t.style.top=(f>0?f:0)+"px"},_setDialogSizes:function(){if(!y.mobile()||T())return;for(var e in k._dialogs)if(k._dialogs.hasOwnProperty(e)){var t=n.getElementById(e);t&&(t.style.width=k.getDefaultSize().width+"px",t.style.height=k.getDefaultSize().height+"px")}},getDefaultSize:function(){if(y.mobile()){var t=N();if(t)return t;if(y.ipad())return{width:E,height:w};if(y.android())return{width:screen.availWidth,height:screen.availHeight};var n=e.innerWidth,r=e.innerHeight,i=n/r>1.2;return{width:n,height:Math.max(r,i?screen.width:screen.height)}}return{width:x,height:S}},_handleOrientationChange:function(e){var t=b("dialog_resize_refactor",!1)?h.getViewportInfo().width:screen.availWidth;if(y.android()&&t==k._availScreenWidth){r(k._handleOrientationChange,50);return}k._availScreenWidth=t;if(T())k._centerActive();else{var i=k.getDefaultSize().width;for(var s in k._dialogs)if(k._dialogs.hasOwnProperty(s)){var o=n.getElementById(s);o&&(o.style.width=i+"px")}}},_addOrientationHandler:function(){if(!y.mobile())return;var t="onorientationchange"in e?"orientationchange":"resize";k._availScreenWidth=b("dialog_resize_refactor",!1)?h.getViewportInfo().width:screen.availWidth,p.add(e,t,k._handleOrientationChange)},create:function(e){e=e||{};var t=n.createElement("div"),r=n.createElement("div"),i="fb_dialog";if(e.closeIcon&&e.onClose){var s=n.createElement("a");s.className="fb_dialog_close_icon",s.onclick=e.onClose,t.appendChild(s)}i+=" "+(e.classes||""),y.ie()?(i+=" fb_dialog_legacy",c(["vert_left","vert_right","horiz_top","horiz_bottom","top_left","top_right","bottom_left","bottom_right"],"forEach",!0,function(e){var r=n.createElement("span");r.className="fb_dialog_"+e,t.appendChild(r)})):i+=y.mobile()?" fb_dialog_mobile":" fb_dialog_advanced",e.content&&l.append(e.content,r),t.className=i;var o=parseInt(e.width,10);isNaN(o)||(t.style.width=o+"px"),r.className="fb_dialog_content",t.appendChild(r);if(y.mobile()){var u=n.createElement("div");u.className="fb_dialog_padding",t.appendChild(u)}return l.append(t),e.visible&&k.show(t),r},show:function(e){var t=k._findRoot(e);t&&(k._removeStacked(t),k._hideLoader(),k._makeActive(t),k._stack.push(t),"fbCallID"in e&&k.get(e.fbCallID).inform("iframe_show").trackEvent("show"))},hide:function(e){var t=k._findRoot(e);k._hideLoader(),t==k._active&&(k._lowerActive(),k._restoreBodyPosition(),k._hideTabletOverlay(),"fbCallID"in e&&k.get(e.fbCallID).inform("iframe_hide").trackEvent("hide"))},remove:function(e){e=k._findRoot(e);if(e){var t=k._active==e;k._removeStacked(e),t?(k._hideLoader(),k._stack.length>0?k.show(k._stack.pop()):(k._lowerActive(),k._restoreBodyPosition(),k._hideTabletOverlay())):k._active===null&&k._stack.length>0&&k.show(k._stack.pop()),r(function(){e.parentNode.removeChild(e)},3e3)}},isActive:function(e){var t=k._findRoot(e);return t&&t===k._active}};u.exports=k}),l("sdk.Frictionless",["sdk.Auth","sdk.api","sdk.Event","sdk.Dialog"],function(e,t,n,r,i,s){var o=t("sdk.Auth"),u=t("sdk.api"),a=t("sdk.Event"),f=t("sdk.Dialog"),l={_allowedRecipients:{},_useFrictionless:!1,_updateRecipients:function(){l._allowedRecipients={},u("/me/apprequestformerrecipients",function(e){if(!e||e.error)return;c(e.data,"forEach",!0,function(e){l._allowedRecipients[e.recipient_id]=!0})})},init:function(){l._useFrictionless=!0,o.getLoginStatus(function(e){e.status=="connected"&&l._updateRecipients()}),a.subscribe("auth.login",function(e){e.authResponse&&l._updateRecipients()})},_processRequestResponse:function(e,t){return function(n){var r=n&&n.updated_frictionless;l._useFrictionless&&r&&l._updateRecipients(),n&&(!t&&n.frictionless&&(f._hideLoader(),f._restoreBodyPosition(),f._hideIPadOverlay()),delete n.frictionless,delete n.updated_frictionless),e&&e(n)}},isAllowed:function(e){if(!e)return!1;if(typeof e=="number")return e in l._allowedRecipients;typeof e=="string"&&(e=e.split(",")),e=c(e,"map",!0,function(e){return c(String(e),"trim",!0)});var t=!0,n=!1;return c(e,"forEach",!0,function(e){t=t&&e in l._allowedRecipients,n=!0}),t&&n}};a.subscribe("init:post",function(e){e.frictionlessRequests&&l.init()}),i.exports=l}),l("insertIframe",["guid","GlobalCallback"],function(e,t,i,s,o,u){function l(e){e.id=e.id||a(),e.name=e.name||a();var t=!1,i=!1,s=function(){t&&!i&&(i=!0,e.onload&&e.onload(e.root.firstChild))},o=f.create(s);if(n.attachEvent){var u='<iframe id="'+e.id+'"'+' name="'+e.name+'"'+(e.title?' title="'+e.title+'"':"")+(e.className?' class="'+e.className+'"':"")+' style="border:none;'+(e.width?"width:"+e.width+"px;":"")+(e.height?"height:"+e.height+"px;":"")+'"'+' src="javascript:false;"'+' frameborder="0"'+' scrolling="no"'+' allowtransparency="true"'+' onload="'+o+'()"'+"></iframe>";e.root.innerHTML='<iframe src="javascript:false" frameborder="0" scrolling="no" style="height:1px"></iframe>',t=!0,r(function(){e.root.innerHTML=u,e.root.firstChild.src=e.url,e.onInsert&&e.onInsert(e.root.firstChild)},0)}else{var l=n.createElement("iframe");l.id=e.id,l.name=e.name,l.onload=s,l.scrolling="no",l.style.border="none",l.style.overflow="hidden",e.title&&(l.title=e.title),e.className&&(l.className=e.className),e.height!==undefined&&(l.style.height=e.height+"px"),e.width!==undefined&&(e.width=="100%"?l.style.width=e.width:l.style.width=e.width+"px"),e.root.appendChild(l),t=!0,l.src=e.url,e.onInsert&&e.onInsert(l)}}var a=t("guid"),f=t("GlobalCallback");o.exports=l}),l("sdk.Native",["copyProperties","Log","UserAgent"],function(t,n,r,i,s,o){var u=n("copyProperties"),a=n("Log"),f=n("UserAgent"),l="fbNativeReady",c={onready:function(t){if(!f.nativeApp()){a.error("FB.Native.onready only works when the page is rendered in a WebView of the native Facebook app. Test if this is the case calling FB.UA.nativeApp()");return}e.__fbNative&&!this.nativeReady&&u(this,e.__fbNative);if(this.nativeReady)t();else{var n=function(r){e.removeEventListener(l,n),this.onready(t)};e.addEventListener(l,n,!1)}}};s.exports=c}),l("resolveURI",[],function(t,r,i,s,o,u){function a(t){if(!t)return e.location.href;t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;");var r=n.createElement("div");return r.innerHTML='<a href="'+t+'"></a>',r.firstChild.href}o.exports=a}),l("sdk.UIServer",["sdk.Auth","sdk.Content","copyProperties","sdk.Dialog","sdk.DOM","sdk.Event","flattenObject","sdk.Frictionless","sdk.getContextType","guid","insertIframe","Log","sdk.Native","QueryString","resolveURI","sdk.RPC","sdk.Runtime","UrlMap","UserAgent","sdk.XD","SDKConfig"],function(t,s,o,u,a,f){var l=s("sdk.Auth"),h=s("sdk.Content"),p=s("copyProperties"),d=s("sdk.Dialog"),v=s("sdk.DOM"),m=s("sdk.Event"),g=s("flattenObject"),y=s("sdk.Frictionless"),b=s("sdk.getContextType"),w=s("guid"),E=s("insertIframe"),S=s("Log"),x=s("sdk.Native"),T=s("QueryString"),N=s("resolveURI"),C=s("sdk.RPC"),k=s("sdk.Runtime"),L=o("SDKConfig"),A=s("UrlMap"),O=s("UserAgent"),M=s("sdk.XD"),_={transform:function(t){return t.params.display==="touch"&&t.params.access_token&&e.postMessage?(t.params.channel=P._xdChannelHandler(t.id,"parent"),O.nativeApp()||(t.params.in_iframe=1),t):P.genericTransform(t)},getXdRelation:function(t){var n=t.display;return n==="touch"&&e.postMessage&&t.in_iframe?"parent":P.getXdRelation(t)}},D={"stream.share":{size:{width:670,height:340},url:"sharer.php",transform:function(t){return t.params.u||(t.params.u=e.location.toString()),t.params.display="popup",t}},apprequests:{transform:function(e){return e=_.transform(e),e.params.frictionless=y&&y._useFrictionless,e.params.frictionless&&(y.isAllowed(e.params.to)&&(e.params.display="iframe",e.params.in_iframe=!0,e.hideLoader=!0),e.cb=y._processRequestResponse(e.cb,e.hideLoader)),e.closeIcon=!1,e},getXdRelation:_.getXdRelation},feed:_,"permissions.oauth":{url:"dialog/oauth",size:{width:O.mobile()?null:475,height:O.mobile()?null:183},transform:function(e){if(!k.getClientID()){S.error("FB.login() called before FB.init().");return}if(l.getAuthResponse()&&!e.params.scope&&!e.params.auth_type){S.error("FB.login() called when user is already connected."),e.cb&&e.cb({status:k.getLoginStatus(),authResponse:l.getAuthResponse()});return}var t=e.cb,n=e.id;return delete e.cb,e.params.display==="async"?(p(e.params,{client_id:k.getClientID(),origin:b(),response_type:"token,signed_request",domain:location.hostname}),e.cb=l.xdResponseWrapper(t,l.getAuthResponse(),"permissions.oauth")):p(e.params,{client_id:k.getClientID(),redirect_uri:N(P.xdHandler(t,n,"opener",l.getAuthResponse(),"permissions.oauth")),origin:b(),response_type:"token,signed_request",domain:location.hostname}),e}},"auth.logout":{url:"logout.php",transform:function(e){if(!k.getClientID())S.error("FB.logout() called before calling FB.init().");else{if(!!l.getAuthResponse())return e.params.next=P.xdHandler(e.cb,e.id,"parent",l.getAuthResponse(),"logout"),e;S.error("FB.logout() called without an access token.")}}},"login.status":{url:"dialog/oauth",transform:function(e){var t=e.cb,n=e.id;return delete e.cb,p(e.params,{client_id:k.getClientID(),redirect_uri:P.xdHandler(t,n,"parent",l.getAuthResponse(),"login_status"),origin:b(),response_type:"token,signed_request,code",domain:location.hostname}),e}}},P={Methods:D,_loadedNodes:{},_defaultCb:{},_resultToken:'"xxRESULTTOKENxx"',genericTransform:function(e){return(e.params.display=="dialog"||e.params.display=="iframe")&&p(e.params,{display:"iframe",channel:P._xdChannelHandler(e.id,"parent.parent")},!0),e},checkOauthDisplay:function(e){var t=e.scope||e.perms||k.getScope();if(!t)return e.display;var n=t.split(/\s|,/g);for(var r=0;r<n.length;r++)if(!L.initSitevars.iframePermissions[c(n[r],"trim",!0)])return"popup";return e.display},prepareCall:function(e,t){var n=e.method.toLowerCase(),r=p({},P.Methods[n]),i=w(),s=k.getSecure()||n!=="auth.status"&&n!="login.status";p(e,{app_id:k.getClientID(),locale:k.getLocale(),sdk:"joey",access_token:s&&k.getAccessToken()||undefined}),e.display=P.getDisplayMode(r,e),r.url||(r.url="dialog/"+n),(r.url=="dialog/oauth"||r.url=="dialog/permissions.request")&&(e.display=="iframe"||e.display=="touch"&&e.in_iframe)&&(e.display=P.checkOauthDisplay(e));var o={cb:t,id:i,size:r.size||P.getDefaultSize(),url:A.resolve(e.display=="touch"?"m":"www",s)+"/"+r.url,params:e,name:n,dialog:d.newInstance(i,e.display)},u=r.transform?r.transform:P.genericTransform;if(u){o=u(o);if(!o)return}var a=r.getXdRelation||P.getXdRelation,f=a(o.params);return!(o.id in P._defaultCb)&&!("next"in o.params)&&!("redirect_uri"in o.params)&&(o.params.next=P._xdResult(o.cb,o.id,f,!0)),f==="parent"&&p(o.params,{channel_url:P._xdChannelHandler(i,"parent.parent")},!0),o=P.prepareParams(o),o},prepareParams:function(e){var t=e.params.method;e.params.display!=="async"&&delete e.params.method,e.params=g(e.params);var n=T.encode(e.params);return!O.nativeApp()&&P.urlTooLongForIE(e.url+"?"+n)?e.post=!0:n&&(e.url+="?"+n),e},urlTooLongForIE:function(e){return e.length>2e3},getDisplayMode:function(e,t){if(t.display==="hidden"||t.display==="none")return t.display;var n=k.isEnvironment(k.ENVIRONMENTS.CANVAS)||k.isEnvironment(k.ENVIRONMENTS.PAGETAB);return n&&!t.display?"async":O.mobile()||t.display==="touch"?"touch":!k.getAccessToken()&&t.display=="dialog"&&!e.loggedOutIframe?(S.error('"dialog" mode can only be used when the user is connected.'),"popup"):e.connectDisplay&&!n?e.connectDisplay:t.display||(k.getAccessToken()?"dialog":"popup")},getXdRelation:function(t){var n=t.display;if(n==="popup"||n==="touch")return"opener";if(n==="dialog"||n==="iframe"||n==="hidden"||n==="none")return"parent";if(n==="async")return"parent.frames["+e.name+"]"},popup:function(t){var r=typeof e.screenX!="undefined"?e.screenX:e.screenLeft,i=typeof e.screenY!="undefined"?e.screenY:e.screenTop,s=typeof e.outerWidth!="undefined"?e.outerWidth:n.documentElement.clientWidth,o=typeof e.outerHeight!="undefined"?e.outerHeight:n.documentElement.clientHeight-22,u=O.mobile()?null:t.size.width,a=O.mobile()?null:t.size.height,f=r<0?e.screen.width+r:r,l=parseInt(f+(s-u)/2,10),c=parseInt(i+(o-a)/2.5,10),p=[];u!==null&&p.push("width="+u),a!==null&&p.push("height="+a),p.push("left="+l),p.push("top="+c),p.push("scrollbars=1"),(t.name=="permissions.request"||t.name=="permissions.oauth")&&p.push("location=1,toolbar=0"),p=p.join(",");var d;t.post?(d=e.open("about:blank",t.id,p),d&&(P.setLoadedNode(t,d,"popup"),h.submitToTarget({url:t.url,target:t.id,params:t.params}))):(d=e.open(t.url,t.id,p),d&&P.setLoadedNode(t,d,"popup"));if(!d)return;t.id in P._defaultCb&&P._popupMonitor()},setLoadedNode:function(e,t,n){e.params&&e.params.display!="popup"&&(t.fbCallID=e.id),t={node:t,type:n,fbCallID:e.id},P._loadedNodes[e.id]=t},getLoadedNode:function(e){var t=typeof e=="object"?e.id:e,n=P._loadedNodes[t];return n?n.node:null},hidden:function(e){e.className="FB_UI_Hidden",e.root=h.appendHidden(""),P._insertIframe(e)},iframe:function(e){e.className="FB_UI_Dialog";var t=function(){P._triggerDefault(e.id)};e.root=d.create({onClose:t,closeIcon:e.closeIcon===undefined?!0:e.closeIcon,classes:O.ipad()?"centered":""}),e.hideLoader||d.showLoader(t,e.size.width),v.addCss(e.root,"fb_dialog_iframe"),P._insertIframe(e)},touch:function(e){e.params&&e.params.in_iframe?e.ui_created?d.showLoader(function(){P._triggerDefault(e.id)},0):P.iframe(e):O.nativeApp()&&!e.ui_created?(e.frame=e.id,x.onready(function(){P.setLoadedNode(e,x.open(e.url+"#cb="+e.frameName),"native")}),P._popupMonitor()):e.ui_created||P.popup(e)},async:function(e){e.params.redirect_uri=location.protocol+"//"+location.host+location.pathname,delete e.params.access_token,C.remote.showDialog(e.params,function(t){var n=t.result;if(n&&n.e2e){var r=d.get(e.id);r.trackEvents(n.e2e),r.trackEvent("close"),delete n.e2e}e.cb(n)})},getDefaultSize:function(){return d.getDefaultSize()},_insertIframe:function(e){P._loadedNodes[e.id]=!1;var t=function(t){e.id in P._loadedNodes&&P.setLoadedNode(e,t,"iframe")};e.post?E({url:"about:blank",root:e.root,className:e.className,width:e.size.width,height:e.size.height,id:e.id,onInsert:t,onload:function(t){h.submitToTarget({url:e.url,target:t.name,params:e.params})}}):E({url:e.url,root:e.root,className:e.className,width:e.size.width,height:e.size.height,id:e.id,name:e.frameName,onInsert:t})},_handleResizeMessage:function(e,t){var n=P.getLoadedNode(e);if(!n)return;t.height&&(n.style.height=t.height+"px"),t.width&&(n.style.width=t.width+"px"),M.inform("resize.ack",t||{},"parent.frames["+n.name+"]"),d.isActive(n)||d.show(n)},_triggerDefault:function(e){P._xdRecv({frame:e},P._defaultCb[e]||function(){})},_popupMonitor:function(){var e;for(var t in P._loadedNodes)if(P._loadedNodes.hasOwnProperty(t)&&t in P._defaultCb){var n=P._loadedNodes[t];if(n.type!="popup"&&n.type!="native")continue;var r=n.node;try{r.closed?P._triggerDefault(t):e=!0}catch(s){}}e&&!P._popupInterval?P._popupInterval=i(P._popupMonitor,100):!e&&P._popupInterval&&(clearInterval(P._popupInterval),P._popupInterval=null)},_xdChannelHandler:function(e,t){return M.handler(function(t){var n=P.getLoadedNode(e);if(!n)return;if(t.type=="resize")P._handleResizeMessage(e,t);else if(t.type=="hide")d.hide(n);else if(t.type=="rendered"){var r=d._findRoot(n);d.show(r)}else t.type=="fireevent"&&m.fire(t.event)},t,!0,null)},_xdNextHandler:function(e,t,n,r){return r&&(P._defaultCb[t]=e),M.handler(function(t){P._xdRecv(t,e)},n)+"&frame="+t},_xdRecv:function(t,n){var i=P.getLoadedNode(t.frame);if(i)if(i.close)try{i.close(),/iPhone.*Version\/(5|6)/.test(navigator.userAgent)&&RegExp.$1!=="5"&&e.focus(),P._popupCount--}catch(s){}else v.containsCss(i,"FB_UI_Hidden")?r(function(){i.parentNode.parentNode.removeChild(i.parentNode)},3e3):v.containsCss(i,"FB_UI_Dialog")&&d.remove(i);delete P._loadedNodes[t.frame],delete P._defaultCb[t.frame];if(t.e2e){var o=d.get(t.frame);o.trackEvents(t.e2e),o.trackEvent("close"),delete t.e2e}n(t)},_xdResult:function(e,t,n,r){return P._xdNextHandler(function(t){e&&e(t.result&&t.result!=P._resultToken&&c("JSON","parse",!1,t.result))},t,n,r)+"&result="+encodeURIComponent(P._resultToken)},xdHandler:function(e,t,n,r,i){return P._xdNextHandler(l.xdResponseWrapper(e,r,i),t,n,!0)}};C.stub("showDialog"),a.exports=P}),l("sdk.ui",["Assert","copyProperties","sdk.feature","sdk.Impressions","Log","sdk.UIServer"],function(e,t,n,r,i,s){function p(e,t){o.isObject(e),o.maybeFunction(t),e=u({},e);if(!e.method)return l.error('"method" is a required parameter for FB.ui().'),null;var n=e.method;e.redirect_uri&&(l.warn("When using FB.ui, you should not specify a redirect_uri."),delete e.redirect_uri),(n=="permissions.request"||n=="permissions.oauth")&&(e.display=="iframe"||e.display=="dialog")&&(e.display=h.checkOauthDisplay(e));var r=a("e2e_tracking",!0);r&&(e.e2e={});var i=h.prepareCall(e,t||function(){});if(!i)return null;var s=i.params.display;s==="dialog"?s="iframe":s==="none"&&(s="hidden");var p=h[s];return p?(r&&i.dialog.subscribe("e2e:end",function(e){e.method=n,e.display=s,l.debug("e2e: %s",c("JSON","stringify",!1,e)),f.log(114,{payload:e})}),p(i),i.dialog):(l.error('"display" must be one of "popup", "dialog", "iframe", "touch", "async", "hidden", or "none"'),null)}var o=t("Assert"),u=t("copyProperties"),a=t("sdk.feature"),f=t("sdk.Impressions"),l=t("Log"),h=t("sdk.UIServer");i.exports=p}),l("legacy:fb.auth",["sdk.Auth","sdk.Cookie","copyProperties","sdk.Event","FB","Log","sdk.Runtime","sdk.SignedRequest","sdk.ui"],function(e,t,n,r){var i=t("sdk.Auth"),s=t("sdk.Cookie"),o=t("copyProperties"),u=t("sdk.Event"),a=t("FB"),f=t("Log"),l=t("sdk.Runtime"),h=t("sdk.SignedRequest"),p=t("sdk.ui");a.provide("",{getLoginStatus:function(){return i.getLoginStatus.apply(i,arguments)},getAuthResponse:function(){return i.getAuthResponse()},getAccessToken:function(){return l.getAccessToken()||null},getUserID:function(){return l.getUserID()||l.getCookieUserID()},login:function(e,t){t&&t.perms&&!t.scope&&(t.scope=t.perms,delete t.perms,f.warn("OAuth2 specification states that 'perms' should now be called 'scope'.  Please update."));var n=l.isEnvironment(l.ENVIRONMENTS.CANVAS)||l.isEnvironment(l.ENVIRONMENTS.PAGETAB);p(o({method:"permissions.oauth",display:n?"async":"popup",domain:location.hostname},t||{}),e)},logout:function(e){p({method:"auth.logout",display:"hidden"},e)}}),i.subscribe("logout",c(u.fire,"bind",!0,u,"auth.logout")),i.subscribe("login",c(u.fire,"bind",!0,u,"auth.login")),i.subscribe("authresponse.change",c(u.fire,"bind",!0,u,"auth.authResponseChange")),i.subscribe("status.change",c(u.fire,"bind",!0,u,"auth.statusChange")),u.subscribe("init:post",function(e){e.status&&i.getLoginStatus();if(l.getClientID())if(e.authResponse)i.setAuthResponse(e.authResponse,"connected");else if(l.getUseCookie()){var t=s.loadSignedRequest(),n;if(t){try{n=h.parse(t)}catch(r){s.clearSignedRequestCookie()}n&&n.user_id&&l.setCookieUserID(n.user_id)}s.loadMeta()}})},3),l("sdk.Canvas.Plugin",["sdk.api","sdk.RPC","Log","UserAgent","sdk.Runtime","createArrayFrom"],function(t,n,i,s,o,u){function b(e){e._hideunity_savedstyle={},e._hideunity_savedstyle.left=e.style.left,e._hideunity_savedstyle.position=e.style.position,e._hideunity_savedstyle.width=e.style.width,e._hideunity_savedstyle.height=e.style.height,e.style.left="-10000px",e.style.position="absolute",e.style.width="1px",e.style.height="1px"}function w(e){e._hideunity_savedstyle&&(e.style.left=e._hideunity_savedstyle.left,e.style.position=e._hideunity_savedstyle.position,e.style.width=e._hideunity_savedstyle.width,e.style.height=e._hideunity_savedstyle.height)}function E(e){e._old_visibility=e.style.visibility,e.style.visibility="hidden"}function S(e){e.style.visibility=e._old_visibility||"",delete e._old_visibility}function x(e){var t=e.type?e.type.toLowerCase():null,n=t==="application/x-shockwave-flash"||e.classid&&e.classid.toUpperCase()==v;if(!n)return!1;var r=/opaque|transparent/i;if(r.test(e.getAttribute("wmode")))return!1;for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes[i];if(/param/i.test(s.nodeName)&&/wmode/i.test(s.name)&&r.test(s.value))return!1}return!0}function T(e){var t=e.type?e.type.toLowerCase():null;return t==="application/vnd.unity"||e.classid&&e.classid.toUpperCase()==m}function N(t){var n=d(e.document.getElementsByTagName("object"));n=n.concat(d(e.document.getElementsByTagName("embed")));var i=!1,s=!1;c(n,"forEach",!0,function(e){var n=x(e),o=y&&T(e);if(!n&&!o)return;i=i||n,s=s||o;var u=function(){t.state==="opened"?n?E(e):b(e):n?S(e):w(e)};if(g){l.info("Calling developer specified callback");var a={state:t.state,elem:e};g(a),r(u,200)}else u()});if(Math.random()<=.001){var o={unity:s,flash:i};a(p.getClientID()+"/occludespopups","post",o)}}function C(){E(),b()}function k(){S(),w()}var a=n("sdk.api"),f=n("sdk.RPC"),l=n("Log"),h=n("UserAgent"),p=n("sdk.Runtime"),d=n("createArrayFrom"),v="CLSID:D27CDB6E-AE6D-11CF-96B8-444553540000",m="CLSID:444785F1-DE89-4295-863A-D46C3A781394",g=null,y=!(h.osx()>=10.9&&(h.chrome()>=31||h.webkit()>=537.71||h.firefox()>=25));f.local.hidePluginObjects=function(){l.info("hidePluginObjects called"),N({state:"opened"})},f.local.showPluginObjects=function(){l.info("showPluginObjects called"),N({state:"closed"})},f.local.showFlashObjects=f.local.showPluginObjects,f.local.hideFlashObjects=f.local.hidePluginObjects;var L={_setHidePluginCallback:function(e){g=e},hidePluginElement:C,showPluginElement:k};o.exports=L}),l("sdk.Canvas.IframeHandling",["DOMWrapper","sdk.RPC"],function(t,n,r,s,o,u){function h(){var e=a.getWindow().document,t=e.body,n=e.documentElement,r=Math.max(t.offsetTop,0),i=Math.max(n.offsetTop,0),s=t.scrollHeight+r,o=t.offsetHeight+r,u=n.scrollHeight+i,f=n.offsetHeight+i;return Math.max(s,o,u,f)}function p(t){typeof t!="object"&&(t={});var n=0,r=0;t.height||(t.height=h(),n=16,r=4),t.frame||(t.frame=e.name||"iframe_canvas");if(c){var i=c.height,s=t.height-i;if(s<=r&&s>=-n)return!1}return c=t,f.remote.setSize(t),!0}function d(e,t){t===undefined&&typeof e=="number"&&(t=e,e=!0),e||e===undefined?(l===null&&(l=i(function(){p()},t||100)),p()):l!==null&&(clearInterval(l),l=null)}var a=n("DOMWrapper"),f=n("sdk.RPC"),l=null,c;f.stub("setSize");var v={setSize:p,setAutoGrow:d};o.exports=v}),l("sdk.Canvas.Navigation",["sdk.RPC"],function(e,t,n,r,i,s){function u(e){o.local.navigate=function(t){e({path:t})},o.remote.setNavigationEnabled(!0)}var o=t("sdk.RPC");o.stub("setNavigationEnabled");var a={setUrlHandler:u};i.exports=a}),l("sdk.Canvas.Tti",["sdk.RPC","sdk.Runtime"],function(e,t,n,r,i,s){function a(e,t){var n={appId:u.getClientID(),time:c("Date","now",!1),name:t},r=[n];e&&r.push(function(t){e(t.result)}),o.remote.logTtiMessage.apply(null,r)}function f(){a(null,"StartIframeAppTtiTimer")}function l(e){a(e,"StopIframeAppTtiTimer")}function h(e){a(e,"RecordIframeAppTti")}var o=t("sdk.RPC"),u=t("sdk.Runtime");o.stub("logTtiMessage");var p={setDoneLoading:h,startTimer:f,stopTimer:l};i.exports=p}),l("legacy:fb.canvas",["Assert","sdk.Canvas.Environment","sdk.Event","FB","sdk.Canvas.Plugin","sdk.Canvas.IframeHandling","Log","sdk.Canvas.Navigation","sdk.Runtime","sdk.Canvas.Tti"],function(e,t,n,r){var i=t("Assert"),s=t("sdk.Canvas.Environment"),o=t("sdk.Event"),u=t("FB"),a=t("sdk.Canvas.Plugin"),f=t("sdk.Canvas.IframeHandling"),l=t("Log"),c=t("sdk.Canvas.Navigation"),h=t("sdk.Runtime"),p=t("sdk.Canvas.Tti");u.provide("Canvas",{setSize:function(e){return i.maybeObject(e,"Invalid argument"),f.setSize.apply(null,arguments)},setAutoGrow:function(){return f.setAutoGrow.apply(null,arguments)},getPageInfo:function(e){return i.isFunction(e,"Invalid argument"),s.getPageInfo.apply(null,arguments)},scrollTo:function(e,t){return i.maybeNumber(e,"Invalid argument"),i.maybeNumber(t,"Invalid argument"),s.scrollTo.apply(null,arguments)},setDoneLoading:function(e){return i.maybeFunction(e,"Invalid argument"),p.setDoneLoading.apply(null,arguments)},startTimer:function(){return p.startTimer.apply(null,arguments)},stopTimer:function(e){return i.maybeFunction(e,"Invalid argument"),p.stopTimer.apply(null,arguments)},getHash:function(e){return i.isFunction(e,"Invalid argument"),c.getHash.apply(null,arguments)},setHash:function(e){return i.isString(e,"Invalid argument"),c.setHash.apply(null,arguments)},setUrlHandler:function(e){return i.isFunction(e,"Invalid argument"),c.setUrlHandler.apply(null,arguments)}}),u.provide("CanvasInsights",{setDoneLoading:function(e){return l.warn("Deprecated: use FB.Canvas.setDoneLoading"),i.maybeFunction(e,"Invalid argument"),p.setDoneLoading.apply(null,arguments)}}),o.subscribe("init:post",function(e){h.isEnvironment(h.ENVIRONMENTS.CANVAS)&&(i.isTrue(!e.hideFlashCallback||!e.hidePluginCallback,"cannot specify deprecated hideFlashCallback and new hidePluginCallback"),a._setHidePluginCallback(e.hidePluginCallback||e.hideFlashCallback))})},3),l("sdk.Canvas.Prefetcher",["sdk.api","createArrayFrom","sdk.Runtime","CanvasPrefetcherConfig"],function(e,t,i,s,o,u){function y(){var e={object:"data",link:"href",script:"src"};m==p.AUTOMATIC&&c(c("Object","keys",!1,e),"forEach",!0,function(t){var r=e[t];c(f(n.getElementsByTagName(t)),"forEach",!0,function(e){e[r]&&g.push(e[r])})});if(g.length===0)return;a(h.getClientID()+"/staticresources","post",{urls:c("JSON","stringify",!1,g),is_https:location.protocol==="https:"}),g=[]}function b(){if(!h.isEnvironment(h.ENVIRONMENTS.CANVAS)||!h.getClientID()||!d)return;if(Math.random()>1/d||v=="*"||~c(v,"indexOf",!0,h.getClientID()))return;r(y,3e4)}function w(e){m=e}function E(e){g.push(e)}var a=t("sdk.api"),f=t("createArrayFrom"),l=i("CanvasPrefetcherConfig"),h=t("sdk.Runtime"),p={AUTOMATIC:0,MANUAL:1},d=l.sampleRate,v=l.blacklist,m=p.AUTOMATIC,g=[],S={COLLECT_AUTOMATIC:p.AUTOMATIC,COLLECT_MANUAL:p.MANUAL,addStaticResource:E,setCollectionMode:w,_maybeSample:b};o.exports=S}),l("legacy:fb.canvas.prefetcher",["FB","sdk.Canvas.Prefetcher","sdk.Event","sdk.Runtime"],function(e,t,n,r){var i=t("FB"),s=t("sdk.Canvas.Prefetcher"),o=t("sdk.Event"),u=t("sdk.Runtime");i.provide("Canvas.Prefetcher",s),o.subscribe("init:post",function(e){u.isEnvironment(u.ENVIRONMENTS.CANVAS)&&s._maybeSample()})},3),l("legacy:fb.compat.ui",["copyProperties","FB","Log","sdk.ui","sdk.UIServer"],function(e,t,n,r){var i=t("copyProperties"),s=t("FB"),o=t("Log"),u=t("sdk.ui"),a=t("sdk.UIServer");s.provide("",{share:function(e){o.error("share() has been deprecated. Please use FB.ui() instead."),u({display:"popup",method:"stream.share",u:e})},publish:function(e,t){o.error("publish() has been deprecated. Please use FB.ui() instead."),e=e||{},u(i({display:"popup",method:"stream.publish",preview:1},e||{}),t)},addFriend:function(e,t){o.error("addFriend() has been deprecated. Please use FB.ui() instead."),u({display:"popup",id:e,method:"friend.add"},t)}}),a.Methods["auth.login"]=a.Methods["permissions.request"]},3),l("mergeArrays",[],function(e,t,n,r,i,s){function o(e,t){for(var n=0;n<t.length;n++)c(e,"indexOf",!0,t[n])<0&&e.push(t[n]);return e}i.exports=o}),l("format",[],function(e,t,n,r,i,s){function o(e,t){return t=Array.prototype.slice.call(arguments,1),e.replace(/\{(\d+)\}/g,function(e,n){var r=t[Number(n)];return r===null||r===undefined?"":r.toString()})}i.exports=o}),l("safeEval",[],function(t,n,r,i,s,o){function u(t,n){if(t===null||typeof t=="undefined")return;return typeof t!="string"?t:/^\w+$/.test(t)&&typeof e[t]=="function"?e[t].apply(null,n||[]):Function('return eval("'+t.replace(/"/g,'\\"')+'");').apply(null,n||[])}s.exports=u}),l("sdk.Waitable",["sdk.Model"],function(e,t,n,r,i,s){var o=t("sdk.Model"),u=o.extend({constructor:function(){this.parent({Value:undefined})},error:function(e){this.inform("error",e)},wait:function(e,t){t&&this.subscribe("error",t),this.monitor("Value.change",c(function(){var t=this.getValue();if(t!==undefined)return this.value=t,e(t),!0},"bind",!0,this))}});i.exports=u}),l("sdk.Query",["format","safeEval","Type","sdk.Waitable"],function(e,t,n,r,i,s){function l(e){return c(e.split(","),"map",!0,function(e){return c(e,"trim",!0)})}function h(e){var t=/^\s*(\w+)\s*=\s*(.*)\s*$/i.exec(e),n,r,i="unknown";return t&&(r=t[2],/^(["'])(?:\\?.)*?\1$/.test(r)?(r=u(r),i="index"):/^\d+\.?\d*$/.test(r)&&(i="index")),i=="index"?n={type:"index",key:t[1],value:r}:n={type:"unknown",value:e},n}function p(e){return typeof e=="string"?c("JSON","stringify",!1,e):e}var o=t("format"),u=t("safeEval"),a=t("Type"),f=t("sdk.Waitable"),d=1,v=f.extend({constructor:function(){this.parent(),this.name="v_"+d++},hasDependency:function(e){return arguments.length&&(this._hasDependency=e),!!this._hasDependency},parse:function(e){var t=o.apply(null,e),n=/^select (.*?) from (\w+)\s+where (.*)$/i.exec(t);this.fields=l(n[1]),this.table=n[2],this.where=h(n[3]);for(var r=1;r<e.length;r++)a.instanceOf(v,e[r])&&e[r].hasDependency(!0);return this},toFql:function(){var e="select "+this.fields.join(",")+" from "+this.table+" where ";switch(this.where.type){case"unknown":e+=this.where.value;break;case"index":e+=this.where.key+"="+p(this.where.value);break;case"in":this.where.value.length==1?e+=this.where.key+"="+p(this.where.value[0]):e+=this.where.key+" in ("+c(this.where.value,"map",!0,p).join(",")+")"}return e},toString:function(){return"#"+this.name}});i.exports=v}),l("sdk.Data",["sdk.api","sdk.ErrorHandling","mergeArrays","sdk.Query","safeEval","sdk.Waitable"],function(e,t,n,i,s,o){var u=t("sdk.api"),a=t("sdk.ErrorHandling"),f=t("mergeArrays"),l=t("sdk.Query"),h=t("safeEval"),p=t("sdk.Waitable"),d={query:function(e,t){var n=(new l).parse(Array.prototype.slice.call(arguments));return d.queue.push(n),d._waitToProcess(),n},waitOn:function(e,t){var n=new p,r=e.length;if(typeof t=="string"){var i=t;t=a.unguard(function(){return h(i)})}return c(e,"forEach",!0,function(i){i.monitor("Value.change",function(){var s=!1;d._getValue(i)!==undefined&&(i.value=i.getValue(),r--,s=!0);if(r===0){var o=t(c(e,"map",!0,d._getValue));n.setValue(o!==undefined?o:!0)}return s})}),n},process:function(e){d._process(e)},_getValue:function(e){return e instanceof p?e.getValue():e},_selectByIndex:function(e,t,n,r){var i=new l;return i.fields=e,i.table=t,i.where={type:"index",key:n,value:r},d.queue.push(i),d._waitToProcess(),i},_waitToProcess:function(){d.timer<0&&(d.timer=r(function(){d._process()},10))},_process:function(e){d.timer=-1;var t={},n=d.queue;if(!n.length)return;d.queue=[];for(var r=0;r<n.length;r++){var i=n[r];i.where.type=="index"&&!i.hasDependency()?d._mergeIndexQuery(i,t):t[i.name]=i}var s={q:{}};for(var o in t)t.hasOwnProperty(o)&&(s.q[o]=t[o].toFql());e&&(s.access_token=e),u("/fql","GET",s,function(e){e.error?c(c("Object","keys",!1,t),"forEach",!0,function(n){t[n].error(new Error(e.error.message))}):c(e.data,"forEach",!0,function(e){t[e.name].setValue(e.fql_result_set)})})},_mergeIndexQuery:function(e,t){var n=e.where.key,r=e.where.value,i="index_"+e.table+"_"+n,s=t[i];s||(s=t[i]=new l,s.fields=[n],s.table=e.table,s.where={type:"in",key:n,value:[]}),f(s.fields,e.fields),f(s.where.value,[r]),s.wait(function(t){e.setValue(c(t,"filter",!0,function(e){return e[n]==r}))})},timer:-1,queue:[]};s.exports=d}),l("legacy:fb.data",["FB","sdk.Data"],function(e,t,n,r){var i=t("FB"),s=t("sdk.Data");i.provide("Data",s)},3),l("legacy:fb.event",["FB","sdk.Event"],function(e,t,n,r){var i=t("FB"),s=t("sdk.Event");i.provide("Event",s),i.provide("EventProvider",s)},3),l("legacy:fb.frictionless",["FB","sdk.Frictionless"],function(e,t,n,r){var i=t("FB"),s=t("sdk.Frictionless");i.provide("Frictionless",s)},3),l("sdk.init",["sdk.Cookie","copyProperties","createArrayFrom","sdk.ErrorHandling","sdk.Event","Log","QueryString","sdk.Runtime"],function(t,i,s,o,u,a){function y(e){var t=typeof e=="number"&&e>0||typeof e=="string"&&/^[0-9a-f]{21,}$|^[0-9]{1,21}$/.test(e);return t?e.toString():(v.warn("Invalid App Id: Must be a number or numeric string representing the application id."),null)}function b(e){g.getInitialized()&&v.warn("FB.init has already been called - this could indicate a problem"),/number|string/.test(typeof e)&&(v.warn("FB.init called with invalid parameters"),e={apiKey:e}),e=l({logging:!0,status:!0},e||{});var t=y(e.appId||e.apiKey);t!==null&&g.setClientID(t),"scope"in e&&g.setScope(e.scope),e.cookie&&(g.setUseCookie(!0),typeof e.cookie=="string"&&f.setDomain(e.cookie)),e.kidDirectedSite&&g.setKidDirectedSite(!0),g.setInitialized(!0),d.fire("init:post",e)}var f=i("sdk.Cookie"),l=i("copyProperties"),h=i("createArrayFrom"),p=i("sdk.ErrorHandling"),d=i("sdk.Event"),v=i("Log"),m=i("QueryString"),g=i("sdk.Runtime");r(function(){var t=/(connect\.facebook\.net|\.facebook\.com\/assets.php).*?#(.*)/;c(h(n.getElementsByTagName("script")),"forEach",!0,function(e){if(e.src){var n=t.exec(e.src);if(n){var r=m.decode(n[2]);for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s=="0"&&(r[i]=0)}b(r)}}}),e.fbAsyncInit&&!e.fbAsyncInit.hasRun&&(e.fbAsyncInit.hasRun=!0,p.unguard(e.fbAsyncInit)())},0),u.exports=b}),l("legacy:fb.init",["FB","sdk.init"],function(e,t,n,r){var i=t("FB"),s=t("sdk.init");i.provide("",{init:s})},3),l("legacy:fb.json",["FB","ManagedError"],function(e,t,n,r){var i=t("FB"),s=t("ManagedError");i.provide("JSON",{stringify:function(e){try{return c("JSON","stringify",!1,e)}catch(t){throw new s(t.message,t)}},parse:function(e){try{return c("JSON","parse",!1,e)}catch(t){throw new s(t.message,t)}}})},3),l("legacy:fb.pay",["FB","copyProperties","sdk.Runtime","sdk.UIServer","sdk.XD"],function(t,n,r,i){n("FB");var s=n("copyProperties"),o=n("sdk.Runtime"),u=n("sdk.UIServer"),a=n("sdk.XD"),f={error_code:1383001,error_message:"An unknown error caused the dialog to be closed"},l=function(e){return function(t){e(t&&t.response?c("JSON","parse",!1,t.response):f)}};s(u.Methods,{"pay.prompt":{transform:function(t){var n=a.handler(l(t.cb),"parent.frames["+(e.name||"iframe_canvas")+"]");t.params.channel=n,a.inform("Pay.Prompt",t.params)}},pay:{size:{width:555,height:120},connectDisplay:"popup",transform:function(t){t.cb=l(t.cb);if(!o.isEnvironment(o.ENVIRONMENTS.CANVAS))return t.params.order_info=c("JSON","stringify",!1,t.params.order_info),t;var n=a.handler(t.cb,"parent.frames["+(e.name||"iframe_canvas")+"]");t.params.channel=n,t.params.uiserver=!0,a.inform("Pay.Prompt",t.params)}}})},3),l("legacy:fb.ua",["FB","UserAgent"],function(e,t,n,r){var i=t("FB"),s=t("UserAgent");i.provide("UA",{nativeApp:s.nativeApp})},3),l("legacy:fb.ui",["FB","sdk.ui"],function(e,t,n,r){var i=t("FB"),s=t("sdk.ui");i.provide("",{ui:s})},3),l("Miny",[],function(e,t,n,r,i,s){function f(e){for(var t=u.encode.length;t<e;t++){var n=t.toString(32).split("");n[n.length-1]=a[parseInt(n[n.length-1],32)],n=n.join(""),u.encode[t]=n,u.decode[n]=t}return u}function l(e){var t=e.match(/\w+|\W+/g),n={};for(var r=0;r<t.length;r++)n[t[r]]=(n[t[r]]||0)+1;var i=c("Object","keys",!1,n);i.sort(function(e,t){return n[e]<n[t]?1:n[t]<n[e]?-1:0});var s=f(i.length).encode;for(r=0;r<i.length;r++)n[i[r]]=s[r];var u=[];for(r=0;r<t.length;r++)u[r]=n[t[r]];for(r=0;r<i.length;r++)i[r]=i[r].replace(/'~'/g,"\\~");return[o,i.length].concat(i).concat(u.join("")).join("~")}function h(e){var t=e.split("~");if(t.shift()!=o)throw new Error("Not a Miny stream");var n=parseInt(t.shift(),10),r=t.pop();r=r.match(/[0-9a-v]*[\-w-zA-Z_]/g);var i=t,s=f(n).decode,u=[];for(var a=0;a<r.length;a++)u[a]=i[s[r[a]]];return u.join("")}var o="Miny1",u={encode:[],decode:{}},a="wxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_".split(""),p={encode:l,decode:h};i.exports=p}),l("runOnce",[],function(e,t,n,r,i,s){function o(e){var t,n;return function(){return t||(t=!0,n=e()),n}}i.exports=o}),l("XFBML",["Assert","copyProperties","createArrayFrom","sdk.DOM","sdk.feature","sdk.Impressions","Log","ObservableMixin","runOnce","UserAgent"],function(e,t,i,s,o,u){function x(e,t){return e[t]+""}function T(e){return e.scopeName?e.scopeName+":"+e.nodeName:""}function N(e){return b[x(e,"nodeName").toLowerCase()]||b[T(e).toLowerCase()]}function C(e){var t=c(c(x(e,"className"),"trim",!0).split(/\s+/),"filter",!0,function(e){return w.hasOwnProperty(e)});if(t.length===0)return undefined;if(e.getAttribute("fb-xfbml-state")||!e.childNodes||e.childNodes.length===0||e.childNodes.length===1&&e.childNodes[0].nodeType===3||e.children.length===1&&x(e.children[0],"className")==="fb-xfbml-parse-ignore")return w[t[0]]}function k(e){var t={};return c(l(e.attributes),"forEach",!0,function(e){t[x(e,"name")]=x(e,"value")}),t}function L(e,t,r){var i=n.createElement("div");return h.addCss(e,t+"-"+r),c(l(e.childNodes),"forEach",!0,function(e){i.appendChild(e)}),c(l(e.attributes),"forEach",!0,function(e){i.setAttribute(e.name,e.value)}),e.parentNode.replaceChild(i,e),i}function A(e,t,n){a.isTrue(e&&e.nodeType&&e.nodeType===1&&!!e.getElementsByTagName,"Invalid DOM node passed to FB.XFBML.parse()"),a.isFunction(t,"Invalid callback passed to FB.XFBML.parse()");var i=++E;v.info("XFBML Parsing Start %s",i);var s=1,o=0,u=function(){s--,s===0&&(v.info("XFBML Parsing Finish %s, %s tags found",i,o),t(),S.inform("render",i,o)),a.isTrue(s>=0,"onrender() has been called too many times")};c(l(e.getElementsByTagName("*")),"forEach",!0,function(e){if(!n&&e.getAttribute("fb-xfbml-state"))return;if(e.nodeType!==1)return;var t=N(e)||C(e);if(!t)return;y.ie()<9&&e.scopeName&&(e=L(e,t.xmlns,t.localName)),s++,o++;var r=new t.ctor(e,t.xmlns,t.localName,k(e));r.subscribe("render",g(function(){e.setAttribute("fb-xfbml-state","rendered"),u()}));var i=function(){e.getAttribute("fb-xfbml-state")=="parsed"?S.subscribe("render.queue",i):(e.setAttribute("fb-xfbml-state","parsed"),r.process())};i()}),S.inform("parse",i,o);var f=3e4;r(function(){s>0&&v.warn("%s tags failed to render in %s ms",s,f)},f),u()}var a=t("Assert"),f=t("copyProperties"),l=t("createArrayFrom"),h=t("sdk.DOM"),p=t("sdk.feature"),d=t("sdk.Impressions"),v=t("Log"),m=t("ObservableMixin"),g=t("runOnce"),y=t("UserAgent"),b={},w={},E=0,S=new m;S.subscribe("render",function(){var e=S.getSubscribers("render.queue");S.clearSubscribers("render.queue"),c(e,"forEach",!0,function(e){e()})}),f(S,{registerTag:function(e){var t=e.xmlns+":"+e.localName;a.isUndefined(b[t],t+" already registered"),b[t]=e,w[e.xmlns+"-"+e.localName]=e},parse:function(e,t){A(e||n.body,t||function(){},!0)},parseNew:function(){A(n.body,function(){},!1)}});if(p("log_tag_count")){var O=function(e,t){S.unsubscribe("parse",O),r(c(d.log,"bind",!0,null,102,{tag_count:t}),5e3)};S.subscribe("parse",O)}o.exports=S}),l("PluginPipe",["sdk.Content","copyProperties","sdk.feature","guid","insertIframe","Miny","ObservableMixin","sdk.Runtime","UrlMap","UserAgent","XFBML","PluginPipeConfig"],function(e,t,r,i,s,o){function x(){return!(!f("plugin_pipe")||m.getSecure()===undefined||!y.chrome()&&!y.firefox()||!v.enabledApps[m.getClientID()])}function T(){function n(){t--,t===0&&N(e)}var e=S;S=[];if(e.length<=E){c(e,"forEach",!0,function(e){h(e.config)});return}var t=e.length+1;c(e,"forEach",!0,function(e){var t={};for(var r in e.config)t[r]=e.config[r];t.url=g.resolve("www",m.getSecure())+"/plugins/plugin_pipe_shell.php",t.onload=n,h(t)}),n()}function N(e){var t=n.createElement("span");u.appendHidden(t);var r={};c(e,"forEach",!0,function(e){r[e.config.name]={plugin:e.tag,params:e.params}});var i=c("JSON","stringify",!1,r),s=p.encode(i);c(e,"forEach",!0,function(e){var t=n.getElementsByName(e.config.name)[0];t.onload=e.config.onload});var o=g.resolve("www",m.getSecure())+"/plugins/pipe.php",a=l();h({url:"about:blank",root:t,name:a,className:"fb_hidden fb_invisible",onload:function(){u.submitToTarget({url:o,target:a,params:{plugins:s.length<i.length?s:i}})}})}var u=t("sdk.Content"),a=t("copyProperties"),f=t("sdk.feature"),l=t("guid"),h=t("insertIframe"),p=t("Miny"),d=t("ObservableMixin"),v=r("PluginPipeConfig"),m=t("sdk.Runtime"),g=t("UrlMap"),y=t("UserAgent"),b=t("XFBML"),w=new d,E=v.threshold,S=[];b.subscribe("parse",T),a(w,{add:function(e){var t=x();return t&&S.push({config:e._config,tag:e._tag,params:e._params}),t}}),s.exports=w}),l("IframePlugin",["sdk.Auth","sdk.createIframe","copyProperties","sdk.DOM","sdk.Event","guid","Log","ObservableMixin","PluginPipe","QueryString","resolveURI","sdk.Runtime","Type","UrlMap","UserAgent","sdk.XD"],function(t,i,s,o,u,a){function k(e,t,n){if(t||t===0)e.style.width=t+"px";if(n||n===0)e.style.height=n+"px"}function L(e){return function(t){var n={width:t.width,height:t.height,pluginID:e};d.fire("xfbml.resize",n)}}function O(e,t){var n=e[t]||e[t.replace(/_/g,"-")]||e[t.replace(/_/g,"")]||e["data-"+t]||e["data-"+t.replace(/_/g,"-")]||e["data-"+t.replace(/_/g,"")]||undefined;return n}function M(e,t,n,r){c(c("Object","keys",!1,e),"forEach",!0,function(i){e[i]=="text"&&!n[i]&&(n[i]=t.textContent||t.innerText||"",t.setAttribute(i,n[i])),r[i]=A[e[i]](O(n,i))})}function _(e){return e||e==="0"||e===0?parseInt(e,10):undefined}var f=i("sdk.Auth"),l=i("sdk.createIframe"),h=i("copyProperties"),p=i("sdk.DOM"),d=i("sdk.Event"),v=i("guid"),m=i("Log"),g=i("ObservableMixin"),y=i("PluginPipe"),b=i("QueryString"),w=i("resolveURI"),E=i("sdk.Runtime"),S=i("Type"),x=i("UrlMap"),T=i("UserAgent"),N=i("sdk.XD"),C={skin:"string",font:"string",width:"px",height:"px",ref:"string",color_scheme:"string"},A={string:function(e){return e},bool:function(e){return e?/^(?:true|1|yes|on)$/i.test(e):undefined},url:function(e){return w(e)},url_maybe:function(e){return e?w(e):e},hostname:function(t){return t||e.location.hostname},px:function(e){return/^(\d+)(?:px)?$/.test(e)?parseInt(RegExp.$1,10):undefined},text:function(e){return e}},D=S.extend({constructor:function(t,r,i,s){this.parent(),i=i.replace(/-/g,"_");var o=O(s,"plugin_id");this.subscribe("xd.resize",L(o)),this.subscribe("xd.resize.flow",L(o)),this.subscribe("xd.resize.flow",c(function(e){this._config.root.style.verticalAlign="bottom",k(this._config.root,_(e.width),_(e.height)),this.updateLift(),clearTimeout(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.resize",c(function(e){this._config.root.style.verticalAlign="bottom",k(this._config.root,_(e.width),_(e.height)),k(this._iframe,_(e.width),_(e.height)),this.updateLift(),clearTimeout(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.resize.iframe",c(function(e){k(this._iframe,_(e.width),_(e.height)),this.updateLift(),clearTimeout(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.sdk_event",function(e){var n=c("JSON","parse",!1,e.data);n.pluginID=o,d.fire(e.event,n,t)});var u=E.getSecure()||e.location.protocol=="https:",a=x.resolve("www",u)+"/plugins/"+i+".php?",l={};M(this.getParams(),t,s,l),M(C,t,s,l),l.app_id=E.getClientID(),l.locale=E.getLocale(),l.sdk="joey",l.kid_directed_site=E.getKidDirectedSite();var h=c(function(e){this.inform("xd."+e.type,e)},"bind",!0,this);l.channel=N.handler(h,"parent.parent",!0),p.addCss(t,"fb_iframe_widget");var m=v();this.subscribe("xd.verify",function(e){N.sendToFacebook(m,{method:"xd/verify",params:c("JSON","stringify",!1,e.token)})}),this.subscribe("xd.refreshLoginStatus",c(f.getLoginStatus,"bind",!0,f,c(this.inform,"bind",!0,this,"login.status"),!0));var g=n.createElement("span");g.style.verticalAlign="top",g.style.width="0px",g.style.height="0px",this._element=t,this._ns=r,this._tag=i,this._params=l,this._config={root:g,url:a+b.encode(l),name:m,width:T.mobile()?undefined:l.width||1e3,height:l.height||1e3,style:{border:"none",visibility:"hidden"},title:this._ns+":"+this._tag+" Facebook Social Plugin",onload:c(function(){this.inform("render")},"bind",!0,this)}},process:function(){var e=h({},this._params);delete e.channel;var t=b.encode(e);if(this._element.getAttribute("fb-iframe-plugin-query")==t){m.info("Skipping render: %s:%s %s",this._ns,this._tag,t),this.inform("render");return}this._element.setAttribute("fb-iframe-plugin-query",t),this.subscribe("render",function(){this._iframe.style.visibility="visible"});while(this._element.firstChild)this._element.removeChild(this._element.firstChild);this._element.appendChild(this._config.root);var n=T.mobile()?120:45;this._timeoutID=r(c(function(){this._iframe&&k(this._iframe,0,0),m.warn("%s:%s failed to resize in %ss",this._ns,this._tag,n)},"bind",!0,this),n*1e3),y.add(this)||(this._iframe=l(this._config)),T.mobile()&&(p.addCss(this._element,"fb_iframe_widget_fluid"),this._element.style.display="block",this._element.style.width="100%",this._element.style.height="auto",this._config.root.style.width="100%",this._config.root.style.height="auto",this._iframe.style.width="100%",this._iframe.style.height="auto",this._iframe.style.position="static")},updateLift:function(){var e=this._iframe.style.width===this._config.root.style.width&&this._iframe.style.height===this._config.root.style.height;p[e?"removeCss":"addCss"](this._iframe,"fb_iframe_widget_lift")}},g);D.getVal=O,D.withParams=function(e){return D.extend({getParams:function(){return e}})},u.exports=D}),l("PluginTags",[],function(e,t,n,r,i,s){var o={activity:{filter:"string",action:"string",max_age:"string",linktarget:"string",header:"bool",recommendations:"bool",site:"hostname"},composer:{action_type:"string",action_properties:"string"},create_event_button:{},degrees:{href:"url"},facepile:{href:"string",action:"string",size:"string",max_rows:"string",show_count:"bool"},follow:{href:"url",layout:"string",show_faces:"bool"},like:{href:"url",layout:"string",show_faces:"bool",share:"bool",action:"string",send:"bool"},like_box:{href:"string",show_faces:"bool",header:"bool",stream:"bool",force_wall:"bool",show_border:"bool",id:"string",connections:"string",profile_id:"string",name:"string"},open_graph:{href:"url",layout:"string",show_faces:"bool",action_type:"string",action_properties:"string"},open_graph_preview:{action_type:"string",action_properties:"string"},page_events:{href:"url"},post:{href:"url",show_border:"bool"},privacy_selector:{},profile_pic:{uid:"string",linked:"bool",href:"string",size:"string",facebook_logo:"bool"},recommendations:{filter:"string",action:"string",max_age:"string",linktarget:"string",header:"bool",site:"hostname"},share_button:{href:"url",type:"string"},shared_activity:{header:"bool"},send:{href:"url"},send_to_mobile:{max_rows:"string",show_faces:"bool",size:"string"},story:{href:"url",show_border:"bool"},topic:{topic_name:"string",topic_id:"string"},want:{href:"url",layout:"string",show_faces:"bool"}},u={subscribe:"follow",fan:"like_box",likebox:"like_box",friendpile:"facepile"};c(c("Object","keys",!1,u),"forEach",!0,function(e){o[e]=o[u[e]]}),i.exports=o}),l("sdk.Arbiter",[],function(e,t,n,r,i,s){var o={BEHAVIOR_EVENT:"e",BEHAVIOR_PERSISTENT:"p",BEHAVIOR_STATE:"s"};i.exports=o}),l("sdk.XFBML.Element",["sdk.DOM","Type","ObservableMixin"],function(e,t,r,i,s,o){var u=t("sdk.DOM"),a=t("Type"),f=t("ObservableMixin"),l=a.extend({constructor:function(e){this.parent(),this.dom=e},fire:function(){this.inform.apply(this,arguments)},getAttribute:function(e,t,n){var r=u.getAttr(this.dom,e);return r?n?n(r):r:t},_getBoolAttribute:function(e,t){var n=u.getBoolAttr(this.dom,e);return n===null?t:n},_getPxAttribute:function(e,t){return this.getAttribute(e,t,function(e){var n=parseInt(e.replace("px",""),10);return isNaN(n)?t:n})},_getAttributeFromList:function(e,t,n){return this.getAttribute(e,t,function(e){return e=e.toLowerCase(),c(n,"indexOf",!0,e)>-1?e:t})},isValid:function(){for(var e=this.dom;e;e=e.parentNode)if(e==n.body)return!0},clear:function(){u.html(this.dom,"")}},f);s.exports=l}),l("sdk.XFBML.IframeWidget",["sdk.Arbiter","sdk.Auth","sdk.Content","copyProperties","sdk.DOM","sdk.Event","sdk.XFBML.Element","guid","insertIframe","QueryString","sdk.Runtime","sdk.ui","UrlMap","sdk.XD"],function(e,t,r,i,s,o){function N(){var e={};for(var t in T){var n=T[t];e[t]={widget:n.getUrlBits().name,params:n._getQS()}}return e}var u=t("sdk.Arbiter"),a=t("sdk.Auth"),f=t("sdk.Content"),l=t("copyProperties"),h=t("sdk.DOM"),p=t("sdk.Event"),d=t("sdk.XFBML.Element"),v=t("guid"),m=t("insertIframe"),g=t("QueryString"),y=t("sdk.Runtime"),b=t("sdk.ui"),w=t("UrlMap"),E=t("sdk.XD"),S=d.extend({_iframeName:null,_showLoader:!0,_refreshOnAuthChange:!1,_allowReProcess:!1,_fetchPreCachedLoader:!1,_visibleAfter:"load",_widgetPipeEnabled:!1,_borderReset:!1,_repositioned:!1,getUrlBits:function(){throw new Error("Inheriting class needs to implement getUrlBits().")},setupAndValidate:function(){return!0},oneTimeSetup:function(){},getSize:function(){},getIframeName:function(){return this._iframeName},getIframeTitle:function(){return"Facebook Social Plugin"},getChannelUrl:function(){if(!this._channelUrl){var e=this;this._channelUrl=E.handler(function(t){e.fire("xd."+t.type,t)},"parent.parent",!0)}return this._channelUrl},getIframeNode:function(){return this.dom.getElementsByTagName("iframe")[0]},arbiterInform:function(e,t,n){E.sendToFacebook(this.getIframeName(),{method:e,params:c("JSON","stringify",!1,t||{}),behavior:n||u.BEHAVIOR_PERSISTENT})},_arbiterInform:function(e,t,n){var r='parent.frames["'+this.getIframeNode().name+'"]';E.inform(e,t,r,n)},getDefaultWebDomain:function(){return w.resolve("www")},process:function(e){if(this._done){if(!this._allowReProcess&&!e)return;this.clear()}else this._oneTimeSetup();this._done=!0,this._iframeName=this.getIframeName()||this._iframeName||v();if(!this.setupAndValidate()){this.fire("render");return}this._showLoader&&this._addLoader(),h.addCss(this.dom,"fb_iframe_widget"),this._visibleAfter!="immediate"?h.addCss(this.dom,"fb_hide_iframes"):this.subscribe("iframe.onload",c(this.fire,"bind",!0,this,"render"));var t=this.getSize()||{},r=this.getFullyQualifiedURL();t.width=="100%"&&h.addCss(this.dom,"fb_iframe_widget_fluid"),this.clear(),m({url:r,root:this.dom.appendChild(n.createElement("span")),name:this._iframeName,title:this.getIframeTitle(),className:y.getRtl()?"fb_rtl":"fb_ltr",height:t.height,width:t.width,onload:c(this.fire,"bind",!0,this,"iframe.onload")}),this._resizeFlow(t),this.loaded=!1,this.subscribe("iframe.onload",c(function(){this.loaded=!0},"bind",!0,this))},generateWidgetPipeIframeName:function(){return x++,"fb_iframe_"+x},getFullyQualifiedURL:function(){var e=this._getURL();e+="?"+g.encode(this._getQS());if(e.length>2e3){e="about:blank";var t=c(function(){this._postRequest(),this.unsubscribe("iframe.onload",t)},"bind",!0,this);this.subscribe("iframe.onload",t)}return e},_getWidgetPipeShell:function(){return w.resolve("www")+"/common/widget_pipe_shell.php"},_oneTimeSetup:function(){this.subscribe("xd.resize",c(this._handleResizeMsg,"bind",!0,this)),this.subscribe("xd.resize",c(this._bubbleResizeEvent,"bind",!0,this)),this.subscribe("xd.resize.iframe",c(this._resizeIframe,"bind",!0,this)),this.subscribe("xd.resize.flow",c(this._resizeFlow,"bind",!0,this)),this.subscribe("xd.resize.flow",c(this._bubbleResizeEvent,"bind",!0,this)),this.subscribe("xd.refreshLoginStatus",function(){a.getLoginStatus(function(){},!0)}),this.subscribe("xd.logout",function(){b({method:"auth.logout",display:"hidden"},function(){})}),this._refreshOnAuthChange&&this._setupAuthRefresh(),this._visibleAfter=="load"&&this.subscribe("iframe.onload",c(this._makeVisible,"bind",!0,this)),this.subscribe("xd.verify",c(function(e){this.arbiterInform("xd/verify",e.token)},"bind",!0,this)),this.oneTimeSetup()},_makeVisible:function(){this._removeLoader(),h.removeCss(this.dom,"fb_hide_iframes"),this.fire("render")},_setupAuthRefresh:function(){a.getLoginStatus(c(function(e){var t=e.status;p.subscribe("auth.statusChange",c(function(e){if(!this.isValid())return;(t=="unknown"||e.status=="unknown")&&this.process(!0),t=e.status},"bind",!0,this))},"bind",!0,this))},_handleResizeMsg:function(e){if(!this.isValid())return;this._resizeIframe(e),this._resizeFlow(e),this._borderReset||(this.getIframeNode().style.border="none",this._borderReset=!0),this._makeVisible()},_bubbleResizeEvent:function(e){var t={height:e.height,width:e.width,pluginID:this.getAttribute("plugin-id")};p.fire("xfbml.resize",t)},_resizeIframe:function(e){var t=this.getIframeNode();e.reposition==="true"&&this._repositionIframe(e),e.height&&(t.style.height=e.height+"px"),e.width&&(t.style.width=e.width+"px"),this._updateIframeZIndex()},_resizeFlow:function(e){var t=this.dom.getElementsByTagName("span")[0];e.height&&(t.style.height=e.height+"px"),e.width&&(t.style.width=e.width+"px"),this._updateIframeZIndex()},_updateIframeZIndex:function(){var e=this.dom.getElementsByTagName("span")[0],t=this.getIframeNode(),n=t.style.height===e.style.height&&t.style.width===e.style.width,r=n?"removeCss":"addCss";h[r](t,"fb_iframe_widget_lift")},_repositionIframe:function(e){var t=this.getIframeNode(),n=parseInt(h.getStyle(t,"width"),10),r=h.getPosition(t).x,i=h.getViewportInfo().width,s=parseInt(e.width,10);r+s>i&&r>s?(t.style.left=n-s+"px",this.arbiterInform("xd/reposition",{type:"horizontal"}),this._repositioned=!0):this._repositioned&&(t.style.left="0px",this.arbiterInform("xd/reposition",{type:"restore"}),this._repositioned=!1)},_addLoader:function(){this._loaderDiv||(h.addCss(this.dom,"fb_iframe_widget_loader"),this._loaderDiv=n.createElement("div"),this._loaderDiv.className="FB_Loader",this.dom.appendChild(this._loaderDiv))},_removeLoader:function(){this._loaderDiv&&(h.removeCss(this.dom,"fb_iframe_widget_loader"),this._loaderDiv.parentNode&&this._loaderDiv.parentNode.removeChild(this._loaderDiv),this._loaderDiv=null)},_getQS:function(){return l({api_key:y.getClientID(),locale:y.getLocale(),sdk:"joey",kid_directed_site:y.getKidDirectedSite(),ref:this.getAttribute("ref")},this.getUrlBits().params)},_getURL:function(){var e=this.getDefaultWebDomain(),t="";return e+"/plugins/"+t+this.getUrlBits().name+".php"},_postRequest:function(){f.submitToTarget({url:this._getURL(),target:this.getIframeNode().name,params:this._getQS()})}}),x=0,T={};s.exports=S}),l("sdk.XFBML.Comments",["sdk.Event","sdk.XFBML.IframeWidget","QueryString","sdk.Runtime","UrlMap","UserAgent","SDKConfig"],function(t,r,i,s,o,u){var a=r("sdk.Event"),f=r("sdk.XFBML.IframeWidget"),l=r("QueryString"),h=r("sdk.Runtime"),p=i("SDKConfig"),d=r("UrlMap"),v=r("UserAgent"),m=f.extend({_visibleAfter:"immediate",_refreshOnAuthChange:!0,setupAndValidate:function(){var t={channel_url:this.getChannelUrl(),colorscheme:this.getAttribute("colorscheme"),skin:this.getAttribute("skin"),numposts:this.getAttribute("num-posts",10),width:this._getPxAttribute("width",550),href:this.getAttribute("href"),permalink:this.getAttribute("permalink"),publish_feed:this.getAttribute("publish_feed"),order_by:this.getAttribute("order_by"),mobile:this._getBoolAttribute("mobile")};p.initSitevars.enableMobileComments&&v.mobile()&&t.mobile!==!1&&(t.mobile=!0,delete t.width),t.skin||(t.skin=t.colorscheme);if(!t.href){t.migrated=this.getAttribute("migrated"),t.xid=this.getAttribute("xid"),t.title=this.getAttribute("title",n.title),t.url=this.getAttribute("url",n.URL),t.quiet=this.getAttribute("quiet"),t.reverse=this.getAttribute("reverse"),t.simple=this.getAttribute("simple"),t.css=this.getAttribute("css"),t.notify=this.getAttribute("notify");if(!t.xid){var r=c(n.URL,"indexOf",!0,"#");r>0?t.xid=encodeURIComponent(n.URL.substring(0,r)):t.xid=encodeURIComponent(n.URL)}t.migrated&&(t.href=d.resolve("www")+"/plugins/comments_v1.php?"+"app_id="+h.getClientID()+"&xid="+encodeURIComponent(t.xid)+"&url="+encodeURIComponent(t.url))}else{var i=this.getAttribute("fb_comment_id");i||(i=l.decode(n.URL.substring(c(n.URL,"indexOf",!0,"?")+1)).fb_comment_id,i&&c(i,"indexOf",!0,"#")>0&&(i=i.substring(0,c(i,"indexOf",!0,"#")))),i&&(t.fb_comment_id=i,this.subscribe("render",c(function(){e.location.hash||(e.location.hash=this.getIframeNode().id)},"bind",!0,this)))}return this._attr=t,!0},oneTimeSetup:function(){this.subscribe("xd.addComment",c(this._handleCommentMsg,"bind",!0,this)),this.subscribe("xd.commentCreated",c(this._handleCommentCreatedMsg,"bind",!0,this)),this.subscribe("xd.commentRemoved",c(this._handleCommentRemovedMsg,"bind",!0,this))},getSize:function(){return this._attr.mobile?{width:"100%",height:160}:{width:this._attr.width,height:160}},getUrlBits:function(){return{name:"comments",params:this._attr}},getDefaultWebDomain:function(){return d.resolve(this._attr.mobile?"m":"www",!0)},_handleCommentMsg:function(e){if(!this.isValid())return;a.fire("comments.add",{post:e.post,user:e.user,widget:this})},_handleCommentCreatedMsg:function(e){if(!this.isValid())return;var t={href:e.href,commentID:e.commentID,parentCommentID:e.parentCommentID};a.fire("comment.create",t)},_handleCommentRemovedMsg:function(e){if(!this.isValid())return;var t={href:e.href,commentID:e.commentID};a.fire("comment.remove",t)}});o.exports=m}),l("sdk.XFBML.CommentsCount",["sdk.Data","sdk.DOM","sdk.XFBML.Element","sprintf"],function(t,n,r,i,s,o){var u=n("sdk.Data"),a=n("sdk.DOM"),f=n("sdk.XFBML.Element"),l=n("sprintf"),h=f.extend({process:function(){a.addCss(this.dom,"fb_comments_count_zero");var t=this.getAttribute("href",e.location.href);u._selectByIndex(["commentsbox_count"],"link_stat","url",t).wait(c(function(e){var t=e[0].commentsbox_count;a.html(this.dom,l('<span class="fb_comments_count">%s</span>',t)),t>0&&a.removeCss(this.dom,"fb_comments_count_zero"),this.fire("render")},"bind",!0,this))}});s.exports=h}),l("sdk.Anim",["sdk.DOM"],function(e,t,n,r,s,o){var u=t("sdk.DOM"),a={ate:function(e,t,n,r){n=!isNaN(parseFloat(n))&&n>=0?n:750;var s=40,o={},a={},f=null,l=i(c(function(){f||(f=c("Date","now",!1));var i=1;n!=0&&(i=Math.min((c("Date","now",!1)-f)/n,1));for(var s in t)if(t.hasOwnProperty(s)){var h=t[s];if(!o[s]){var d=u.getStyle(e,s);if(d===!1)return;o[s]=this._parseCSS(d+"")}a[s]||(a[s]=this._parseCSS(h.toString()));var v="";c(o[s],"forEach",!0,function(e,t){isNaN(a[s][t].numPart)&&a[s][t].textPart=="?"?v=e.numPart+e.textPart:isNaN(e.numPart)?v=e.textPart:v+=e.numPart+Math.ceil((a[s][t].numPart-e.numPart)*Math.sin(Math.PI/2*i))+a[s][t].textPart+" "}),u.setStyle(e,s,v)}i==1&&(clearInterval(l),r&&r(e))},"bind",!0,this),s)},_parseCSS:function(e){var t=[];return c(e.split(" "),"forEach",!0,function(e){var n=parseInt(e,10);t.push({numPart:n,textPart:e.replace(n,"")})}),t}};s.exports=a}),l("escapeHTML",[],function(e,t,n,r,i,s){function a(e){return e.replace(o,function(e){return u[e]})}var o=/[&<>"'\/]/g,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#x2F;"};i.exports=a}),l("sdk.Helper",["sdk.ErrorHandling","sdk.Event","UrlMap","safeEval","sprintf"],function(t,n,r,i,s,o){var u=n("sdk.ErrorHandling"),a=n("sdk.Event"),f=n("UrlMap"),l=n("safeEval"),c=n("sprintf"),h={isUser:function(e){return e<22e8||e>=1e14&&e<=0x5b0a58f100ef||e>=89e12&&e<=89999999999999},upperCaseFirstChar:function(e){return e.length>0?e.substr(0,1).toUpperCase()+e.substr(1):e},getProfileLink:function(e,t,n){return!n&&e&&(n=c("%s/profile.php?id=%s",f.resolve("www"),e.uid||e.id)),n&&(t=c('<a class="fb_link" href="%s">%s</a>',n,t)),t},invokeHandler:function(e,t,n){e&&(typeof e=="string"?u.unguard(l)(e,n):e.apply&&u.unguard(e).apply(t,n||[]))},fireEvent:function(e,t){var n=t._attr.href;t.fire(e,n),a.fire(e,n,t)},executeFunctionByName:function(t){var n=Array.prototype.slice.call(arguments,1),r=t.split("."),i=r.pop(),s=e;for(var o=0;o<r.length;o++)s=s[r[o]];return s[i].apply(this,n)}};s.exports=h}),l("sdk.XFBML.ConnectBar",["sdk.Anim","sdk.api","sdk.Auth","createArrayFrom","sdk.Data","sdk.DOM","sdk.XFBML.Element","escapeHTML","sdk.Event","format","sdk.Helper","sdk.Insights","sdk.Intl","sdk.Runtime","UrlMap","UserAgent","ConnectBarConfig"],function(t,r,i,s,o,u){var a=r("sdk.Anim"),f=r("sdk.api"),l=r("sdk.Auth"),h=r("createArrayFrom"),p=i("ConnectBarConfig"),d=r("sdk.Data"),v=r("sdk.DOM"),m=r("sdk.XFBML.Element"),g=r("escapeHTML"),y=r("sdk.Event"),b=r("format"),w=r("sdk.Helper"),E=r("sdk.Insights"),S=r("sdk.Intl"),x=r("sdk.Runtime"),T=r("UrlMap"),N=r("UserAgent"),C=m.extend({_initialHeight:null,_initTopMargin:0,_picFieldName:"pic_square",_page:null,_displayed:!1,_notDisplayed:!1,_container:null,_animationSpeed:0,process:function(){l.getLoginStatus(c(function(e){y.monitor("auth.statusChange",c(function(){return this.isValid()&&x.getLoginStatus()=="connected"?(this._uid=x.getUserID(),f({method:"Connect.shouldShowConnectBar"},c(function(e){e!=2?(this._animationSpeed=e==0?750:0,this._showBar()):this._noRender()},"bind",!0,this))):this._noRender(),!1},"bind",!0,this))},"bind",!0,this))},_showBar:function(){var e=d._selectByIndex(["first_name","profile_url",this._picFieldName],"user","uid",this._uid),t=d._selectByIndex(["display_name"],"application","api_key",x.getClientID());d.waitOn([e,t],c(function(e){e[0][0].site_name=e[1][0].display_name,this._displayed||(this._displayed=!0,this._notDisplayed=!1,this._renderConnectBar(e[0][0]),this.fire("render"),E.impression({lid:104,name:"widget_load"}),this.fire("connectbar.ondisplay"),y.fire("connectbar.ondisplay",this),w.invokeHandler(this.getAttribute("on-display"),this))},"bind",!0,this))},_noRender:function(){this._displayed&&(this._displayed=!1,this._closeConnectBar()),this._notDisplayed||(this._notDisplayed=!0,this.fire("render"),this.fire("connectbar.onnotdisplay"),y.fire("connectbar.onnotdisplay",this),w.invokeHandler(this.getAttribute("on-not-display"),this))},_renderConnectBar:function(t){var r=n.createElement("div"),i=n.createElement("div");r.className="fb_connect_bar",i.className="fb_reset fb_connect_bar_container",i.appendChild(r),n.body.appendChild(i),this._container=i,this._initialHeight=Math.round(parseFloat(v.getStyle(i,"height"))+parseFloat(v.getStyle(i,"borderBottomWidth"))),v.html(r,b('<div class="fb_buttons"><a href="#" class="fb_bar_close"><img src="{1}" alt="{2}" title="{2}"/></a></div><a href="{7}" class="fb_profile" target="_blank"><img src="{3}" alt="{4}" title="{4}"/></a>{5} <span><a href="{8}" class="fb_learn_more" target="_blank">{6}</a> &ndash; <a href="#" class="fb_no_thanks">{0}</a></span>',S.tx._("No Thanks"),T.resolve("fbcdn")+"/"+p.imgs.buttonUrl,S.tx._("Close"),t[this._picFieldName]||T.resolve("fbcdn")+"/"+p.imgs.missingProfileUrl,g(t.first_name),S.tx._("Hi {firstName}. <strong>{siteName}</strong> is using Facebook to personalize your experience.",{firstName:g(t.first_name),siteName:g(t.site_name)}),S.tx._("Learn More"),t.profile_url,T.resolve("www")+"/sitetour/connect.php")),c(h(r.getElementsByTagName("a")),"forEach",!0,function(e){e.onclick=c(this._clickHandler,"bind",!0,this)},this),this._page=n.body;var s=0;this._page.parentNode?s=Math.round((parseFloat(v.getStyle(this._page.parentNode,"height"))-parseFloat(v.getStyle(this._page,"height")))/2):s=parseInt(v.getStyle(this._page,"marginTop"),10),s=isNaN(s)?0:s,this._initTopMargin=s,e.XMLHttpRequest?(i.style.top=-1*this._initialHeight+"px",a.ate(i,{top:"0px"},this._animationSpeed)):i.className+=" fb_connect_bar_container_ie6";var o={marginTop:this._initTopMargin+this._initialHeight+"px"};N.ie()?o.backgroundPositionY=this._initialHeight+"px":o.backgroundPosition="? "+this._initialHeight+"px",a.ate(this._page,o,this._animationSpeed)},_clickHandler:function(t){t=t||e.event;var n=t.target||t.srcElement;while(n.nodeName!="A")n=n.parentNode;switch(n.className){case"fb_bar_close":f({method:"Connect.connectBarMarkAcknowledged"}),E.impression({lid:104,name:"widget_user_closed"}),this._closeConnectBar();break;case"fb_learn_more":case"fb_profile":e.open(n.href);break;case"fb_no_thanks":this._closeConnectBar(),f({method:"Connect.connectBarMarkAcknowledged"}),E.impression({lid:104,name:"widget_user_no_thanks"}),f({method:"auth.revokeAuthorization",block:!0},c(function(){this.fire("connectbar.ondeauth"),y.fire("connectbar.ondeauth",this),w.invokeHandler(this.getAttribute("on-deauth"),this),this._getBoolAttribute("auto-refresh",!0)&&e.location.reload()},"bind",!0,this))}return!1},_closeConnectBar:function(){this._notDisplayed=!0;var e={marginTop:this._initTopMargin+"px"};N.ie()?e.backgroundPositionY="0px":e.backgroundPosition="? 0px";var t=this._animationSpeed==0?0:300;a.ate(this._page,e,t),a.ate(this._container,{top:-1*this._initialHeight+"px"},t,function(e){e.parentNode.removeChild(e)}),this.fire("connectbar.onclose"),y.fire("connectbar.onclose",this),w.invokeHandler(this.getAttribute("on-close"),this)}});o.exports=C}),l("sdk.XFBML.LoginButton",["sdk.Helper","IframePlugin"],function(e,t,n,r,i,s){var o=t("sdk.Helper"),u=t("IframePlugin"),a=u.extend({constructor:function(e,t,n,r){this.parent(e,t,n,r);var i=u.getVal(r,"on_login");i&&this.subscribe("login.status",function(e){o.invokeHandler(i,null,[e])})},getParams:function(){return{scope:"string",perms:"string",size:"string",login_text:"text",show_faces:"bool",max_rows:"string",show_login_face:"bool",registration_url:"url_maybe",auto_logout_link:"bool",one_click:"bool",show_banner:"bool"}}});i.exports=a}),l("sdk.XFBML.Name",["copyProperties","sdk.Data","escapeHTML","sdk.Event","sdk.XFBML.Element","sdk.Helper","Log","sdk.Runtime"],function(e,t,n,r,i,s){var o=t("copyProperties"),u=t("sdk.Data"),a=t("escapeHTML"),f=t("sdk.Event"),l=t("sdk.XFBML.Element"),h=t("sdk.Helper"),p=t("Log"),d=t("sdk.Runtime"),v=l.extend({process:function(){o(this,{_uid:this.getAttribute("uid"),_firstnameonly:this._getBoolAttribute("first-name-only"),_lastnameonly:this._getBoolAttribute("last-name-only"),_possessive:this._getBoolAttribute("possessive"),_reflexive:this._getBoolAttribute("reflexive"),_objective:this._getBoolAttribute("objective"),_linked:this._getBoolAttribute("linked",!0),_subjectId:this.getAttribute("subject-id")});if(!this._uid){p.error('"uid" is a required attribute for <fb:name>'),this.fire("render");return}var e=[];this._firstnameonly?e.push("first_name"):this._lastnameonly?e.push("last_name"):e.push("name"),this._subjectId&&(e.push("sex"),this._subjectId==d.getUserID()&&(this._reflexive=!0));var t;f.monitor("auth.statusChange",c(function(){if(!this.isValid())return this.fire("render"),!0;if(!this._uid||this._uid=="loggedinuser")this._uid=d.getUserID();if(!this._uid)return;h.isUser(this._uid)?t=u._selectByIndex(e,"user","uid",this._uid):t=u._selectByIndex(["name","id"],"profile","id",this._uid),t.wait(c(function(e){this._subjectId==this._uid?this._renderPronoun(e[0]):this._renderOther(e[0]),this.fire("render")},"bind",!0,this))},"bind",!0,this))},_renderPronoun:function(e){var t="",n=this._objective;this._subjectId&&(n=!0,this._subjectId===this._uid&&(this._reflexive=!0));if(this._uid==d.getUserID()&&this._getBoolAttribute("use-you",!0))this._possessive?this._reflexive?t="your own":t="your":this._reflexive?t="yourself":t="you";else switch(e.sex){case"male":this._possessive?t=this._reflexive?"his own":"his":this._reflexive?t="himself":n?t="him":t="he";break;case"female":this._possessive?t=this._reflexive?"her own":"her":this._reflexive?t="herself":n?t="her":t="she";break;default:this._getBoolAttribute("use-they",!0)?this._possessive?this._reflexive?t="their own":t="their":this._reflexive?t="themselves":n?t="them":t="they":this._possessive?this._reflexive?t="his/her own":t="his/her":this._reflexive?t="himself/herself":n?t="him/her":t="he/she"}this._getBoolAttribute("capitalize",!1)&&(t=h.upperCaseFirstChar(t)),this.dom.innerHTML=t},_renderOther:function(e){var t="",n="";this._uid==d.getUserID()&&this._getBoolAttribute("use-you",!0)?this._reflexive?this._possessive?t="your own":t="yourself":this._possessive?t="your":t="you":e&&(null===e.first_name&&(e.first_name=""),null===e.last_name&&(e.last_name=""),this._firstnameonly&&e.first_name!==undefined?t=a(e.first_name):this._lastnameonly&&e.last_name!==undefined&&(t=a(e.last_name)),t||(t=a(e.name)),t!==""&&this._possessive&&(t+="'s")),t||(t=a(this.getAttribute("if-cant-see","Facebook User"))),t&&(this._getBoolAttribute("capitalize",!1)&&(t=h.upperCaseFirstChar(t)),e&&this._linked?n=h.getProfileLink(e,t,this.getAttribute("href",null)):n=t),this.dom.innerHTML=n}});i.exports=v}),l("sdk.XFBML.RecommendationsBar",["sdk.Arbiter","DOMEventListener","sdk.Event","sdk.XFBML.IframeWidget","resolveURI","sdk.Runtime"],function(t,i,s,o,u,a){var f=i("sdk.Arbiter"),l=i("DOMEventListener"),h=i("sdk.Event"),p=i("sdk.XFBML.IframeWidget"),d=i("resolveURI"),v=i("sdk.Runtime"),m=p.extend({getUrlBits:function(){return{name:"recommendations_bar",params:this._attr}},setupAndValidate:function(){function t(e,t){function s(){t(),i=null,n=c("Date","now",!1)}var n=0,i=null;return function(){if(!i){var t=c("Date","now",!1);t-n<e?i=r(s,e-(t-n)):s()}return!0}}function i(e){if(e.match(/^\d+(?:\.\d+)?%$/)){var t=Math.min(Math.max(parseInt(e,10),0),100);e=t/100}else e!="manual"&&e!="onvisible"&&(e="onvisible");return e}function s(e){return Math.max(parseInt(e,10)||30,10)}function o(e){return e=="left"||e=="right"?e:v.getRtl()?"left":"right"}this._attr={channel:this.getChannelUrl(),api_key:v.getClientID(),font:this.getAttribute("font"),colorscheme:this.getAttribute("colorscheme"),href:d(this.getAttribute("href")),side:o(this.getAttribute("side")),site:this.getAttribute("site"),action:this.getAttribute("action"),ref:this.getAttribute("ref"),max_age:this.getAttribute("max_age"),trigger:i(this.getAttribute("trigger","")),read_time:s(this.getAttribute("read_time")),num_recommendations:parseInt(this.getAttribute("num_recommendations"),10)||2},this._showLoader=!1,this.subscribe("iframe.onload",c(function(){var e=this.dom.children[0];e.className="fbpluginrecommendationsbar"+this._attr.side},"bind",!0,this));var u=c(function(){return l.remove(e,"scroll",u),l.remove(n.documentElement,"click",u),l.remove(n.documentElement,"mousemove",u),r(c(this.arbiterInform,"bind",!0,this,"platform/plugins/recommendations_bar/action",null,f.BEHAVIOR_STATE),this._attr.read_time*1e3),!0},"bind",!0,this);l.add(e,"scroll",u),l.add(n.documentElement,"click",u),l.add(n.documentElement,"mousemove",u);if(this._attr.trigger=="manual"){var a=c(function(e){return e==this._attr.href&&(h.unsubscribe("xfbml.recommendationsbar.read",a),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,f.BEHAVIOR_STATE)),!0},"bind",!0,this);h.subscribe("xfbml.recommendationsbar.read",a)}else{var p=t(500,c(function(){return this.calculateVisibility()&&(l.remove(e,"scroll",p),l.remove(e,"resize",p),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,f.BEHAVIOR_STATE)),!0},"bind",!0,this));l.add(e,"scroll",p),l.add(e,"resize",p),p()}this.visible=!1;var m=t(500,c(function(){return!this.visible&&this.calculateVisibility()?(this.visible=!0,this.arbiterInform("platform/plugins/recommendations_bar/visible")):this.visible&&!this.calculateVisibility()&&(this.visible=!1,this.arbiterInform("platform/plugins/recommendations_bar/invisible")),!0},"bind",!0,this));l.add(e,"scroll",m),l.add(e,"resize",m),m(),this.focused=!0;var y=c(function(){return this.focused=!this.focused,!0},"bind",!0,this);return l.add(e,"blur",y),l.add(e,"focus",y),this.resize_running=!1,this.animate=!1,this.subscribe("xd.signal_animation",c(function(){this.animate=!0},"bind",!0,this)),!0},getSize:function(){return{height:25,width:this._attr.action=="recommend"?140:96}},calculateVisibility:function(){var t=n.documentElement.clientHeight;if(!this.focused&&e.console&&e.console.firebug)return this.visible;switch(this._attr.trigger){case"manual":return!1;case"onvisible":var r=this.dom.getBoundingClientRect().top;return r<=t;default:var i=e.pageYOffset||n.body.scrollTop,s=n.documentElement.scrollHeight;return(i+t)/s>=this._attr.trigger}}});u.exports=m}),l("sdk.XFBML.Registration",["sdk.Auth","sdk.Helper","sdk.XFBML.IframeWidget","sdk.Runtime","UrlMap"],function(t,n,r,i,s,o){var u=n("sdk.Auth"),a=n("sdk.Helper"),f=n("sdk.XFBML.IframeWidget"),l=n("sdk.Runtime"),h=n("UrlMap"),p=f.extend({_visibleAfter:"immediate",_baseHeight:167,_fieldHeight:28,_skinnyWidth:520,_skinnyBaseHeight:173,_skinnyFieldHeight:52,setupAndValidate:function(){return this._attr={action:this.getAttribute("action"),border_color:this.getAttribute("border-color"),channel_url:this.getChannelUrl(),client_id:l.getClientID(),fb_only:this._getBoolAttribute("fb-only",!1),fb_register:this._getBoolAttribute("fb-register",!1),fields:this.getAttribute("fields"),height:this._getPxAttribute("height"),redirect_uri:this.getAttribute("redirect-uri",e.location.href),no_footer:this._getBoolAttribute("no-footer"),no_header:this._getBoolAttribute("no-header"),onvalidate:this.getAttribute("onvalidate"),width:this._getPxAttribute("width",600),target:this.getAttribute("target")},this._attr.onvalidate&&this.subscribe("xd.validate",c(function(e){var t=c("JSON","parse",!1,e.value),n=c(function(t){this.arbiterInform("Registration.Validation",{errors:t,id:e.id})},"bind",!0,this),r=a.executeFunctionByName(this._attr.onvalidate,t,n);r&&n(r)},"bind",!0,this)),this.subscribe("xd.authLogin",c(this._onAuthLogin,"bind",!0,this)),this.subscribe("xd.authLogout",c(this._onAuthLogout,"bind",!0,this)),!0},getSize:function(){return{width:this._attr.width,height:this._getHeight()}},_getHeight:function(){if(this._attr.height)return this._attr.height;var e;if(!this._attr.fields)e=["name"];else try{e=c("JSON","parse",!1,this._attr.fields)}catch(t){e=this._attr.fields.split(/,/)}return this._attr.width<this._skinnyWidth?this._skinnyBaseHeight+e.length*this._skinnyFieldHeight:this._baseHeight+e.length*this._fieldHeight},getUrlBits:function(){return{name:"registration",params:this._attr}},getDefaultWebDomain:function(){return h.resolve("www",!0)},_onAuthLogin:function(){u.getAuthResponse()||u.getLoginStatus(),a.fireEvent("auth.login",this)},_onAuthLogout:function(){u.getAuthResponse()||u.getLoginStatus(),a.fireEvent("auth.logout",this)}});s.exports=p}),l("sdk.XFBML.SocialContext",["sdk.Event","sdk.XFBML.IframeWidget"],function(e,t,n,r,i,s){var o=t("sdk.Event"),u=t("sdk.XFBML.IframeWidget"),a=u.extend({setupAndValidate:function(){var e=this.getAttribute("size","small");return this._attr={channel:this.getChannelUrl(),width:this._getPxAttribute("width",400),height:this._getPxAttribute("height",100),ref:this.getAttribute("ref"),size:this.getAttribute("size"),keywords:this.getAttribute("keywords"),urls:this.getAttribute("urls"),object_id:this.getAttribute("object_id")},this.subscribe("xd.social_context_stats",c(this._bubbleSocialContextStats,"bind",!0,this)),!0},_bubbleSocialContextStats:function(e){var t={pluginID:this.getAttribute("plugin-id"),socialContextPageIDs:c("JSON","parse",!1,e.social_context_page_ids)};o.fire("xfbml.social_context_stats",t)},getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"social_context",params:this._attr}}});i.exports=a}),l("legacy:fb.xfbml",["Assert","sdk.domReady","sdk.Event","FB","IframePlugin","PluginTags","wrapFunction","XFBML","sdk.XFBML.Comments","sdk.XFBML.CommentsCount","sdk.XFBML.ConnectBar","sdk.XFBML.LoginButton","sdk.XFBML.Name","sdk.XFBML.RecommendationsBar","sdk.XFBML.Registration","sdk.XFBML.SocialContext"],function(t,i,s,o){var u=i("Assert"),a=i("sdk.domReady"),f=i("sdk.Event"),l=i("FB"),h=i("IframePlugin"),p=i("PluginTags"),d=i("wrapFunction"),v=i("XFBML"),m={comments:i("sdk.XFBML.Comments"),comments_count:i("sdk.XFBML.CommentsCount"),connect_bar:i("sdk.XFBML.ConnectBar"),login_button:i("sdk.XFBML.LoginButton"),name:i("sdk.XFBML.Name"),recommendations_bar:i("sdk.XFBML.RecommendationsBar"),registration:i("sdk.XFBML.Registration"),social_context:i("sdk.XFBML.SocialContext")};c(c("Object","keys",!1,p),"forEach",!0,function(e){v.registerTag({xmlns:"fb",localName:e.replace(/_/g,"-"),ctor:h.withParams(p[e])})}),c(c("Object","keys",!1,m),"forEach",!0,function(e){v.registerTag({xmlns:"fb",localName:e.replace(/_/g,"-"),ctor:m[e]})}),l.provide("XFBML",{parse:function(e){return u.maybeXfbml(e,"Invalid argument"),e&&e.nodeType===9&&(e=e.body),v.parse.apply(null,arguments)}}),l.provide("XFBML.RecommendationsBar",{markRead:function(t){f.fire("xfbml.recommendationsbar.read",t||e.location.href)}}),v.subscribe("parse",c(f.fire,"bind",!0,f,"xfbml.parse")),v.subscribe("render",c(f.fire,"bind",!0,f,"xfbml.render")),f.subscribe("init:post",function(e){e.xfbml&&r(d(c(a,"bind",!0,null,v.parse),"entry","init:post:xfbml.parse"),0)}),u.define("Xfbml",function(e){return(e.nodeType===1||e.nodeType===9)&&typeof e.nodeName=="string"});try{n.namespaces&&!n.namespaces.item.fb&&n.namespaces.add("fb")}catch(g){}},3)}.call({},window.inDapIF?parent.window:window)}catch(e){(new Image).src="http://www.facebook.com/common/scribe_endpoint.php?c=jssdk_error&m="+encodeURIComponent('{"error":"LOAD", "extra": {"name":"'+e.name+'","line":"'+(e.lineNumber||e.line)+'","script":"'+(e.fileName||e.sourceURL||e.script)+'","stack":"'+(e.stackTrace||e.stack)+'","message":"'+e.message+'"}}')}define("facebook",function(){}),define("signup/views/facebooksignup",["vendor","views","registration","signup","signup/views/shopopup","utils/storage","facebook"],function(e,t,n,r,i,s){var o,u=t.BaseView,a=e.$,f=e._,l=e.Mustache,c;return o=u.extend({initialize:function(e){e&&e.callback&&(this.callback=e.callback),FB.init({appId:App.Settings.appId,status:!0,cookie:!0,xfbml:!0,oauth:!0})},signupFacebook:function(e,t){var r=this;this.linkWithFB=e&&e=="linkWithFB"?!0:!1,this.registrationController||(this.registrationController=new n({callback:r.calback})),this.loginfb(t)},loadFBLogin:function(){var e,t="facebook-jssdk",n=document.getElementsByTagName("script")[0];if(document.getElementById(t)){this.loginInfo=this.loginfb();return}e=document.createElement("script"),e.id=t,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(e,n)},getFBlogin:function(){var e=this;alert("getFBlogin"),FB.getLoginStatus(function(t){console.log(t),t.status==="connected"?this.actionFunction=function(){FB.api("/me",function(t){e.linkWithFB&&alert("Facebook Account linked Successfully."),routing.trigger("registration-with-facebook",e.callback)})}:t.status==="not_authorized"?(e.linkWithFB&&alert("There was a problem trying to establish a connection to Facebook."),console.log("not_authorized"),e.loginInfo||(e.loginInfo=e.loginfb())):e.loginInfo||(e.loginInfo=e.loginfb())},{scope:"email, user_birthday, user_photos"})},loginfb:function(e){var t=this;FB.login(function(n){console.log(n),n.authResponse?e&&f.isFunction(e)?e():routing.trigger("registration-with-facebook",t.callback):alert("Facebook Login has been Cancelled")},{scope:"email, user_birthday, user_photos"})},checkFBlogin:function(){var e=this;FB.getLoginStatus(function(t){t.status==="connected"&&FB.api("/me",function(t){routing.trigger("registration-with-facebook",e.callback)})},{scope:"email, user_birthday, user_photos"})}}),o}),define("text!signup/templates/basciFinal.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n\r\n\r\n<div id="regcontainer">\r\n	<div id="mainregfinal">\r\n		<div id="regpanefinal">\r\n			<form action="#/user/create" method="post" accept-charset="utf-8">\r\n				<div id="finalreg">\r\n					<div class="field" id="firstname">\r\n						<span>Name</span>\r\n						<input type="text" id="first_name" name="Name" placeholder="Name" />\r\n					</div>\r\n\r\n					<div class="field" id="email">\r\n						<div class="label">\r\n							<label for="Email">Email</label>\r\n						</div>\r\n						<input type="text" name="email" id="emailInput" placeholder="Email" />\r\n					</div>\r\n\r\n					<div class="field">\r\n						<span>Birthday</span>\r\n						<div style="width:94%;" id="dob"></div>\r\n					</div>\r\n\r\n					<div class="field">\r\n						<span>Password</span>\r\n						<input type="password" name="password" id="password" placeholder="Password" />\r\n						<input type="password" name="re_password" id="re_password" placeholder="Password Again" />\r\n					</div>\r\n\r\n					\r\n					<div style="height:40px; margin:10px 0 10px 0;">\r\n						<div class="row-fluid field">\r\n							<label for="re_terms_conditions">\r\n								<input type="checkbox" class="terms-condition-h" id="re_terms_conditions" name="re_terms_conditions"/>I have read and agree to the <a href="tos.html" target="_blank" style="text-decoration:underline;">Terms of Service</a>\r\n							</label>\r\n						</div>\r\n					</div>\r\n					<% if(fb_invite != undefined){ %>\r\n						<input type="hidden" name="fb_invite_id" value="<%= fb_invite %>" />\r\n					<% } %>\r\n					<input type="submit" name="create" value="Sign Up" class="next btn-common btn-green regsubmitfinal" />\r\n				</div>\r\n			</form>\r\n				\r\n			<%  if(!page) { %>	<br /><br/>\r\n				<div id="reglogin">\r\n					<span>Been here before <a href="#">sign in</a></span>\r\n				</div>\r\n			<% } %>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("signup/views/registration-basics-final",["require","text!signup/templates/basciFinal.html","backbone","underscore","views","facade","utils"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.callback=e.callback,this.template=r.template(t,{page:e.openAsPopUp?!0:!1,fb_invite:e.fb_invite?e.fb_invite:!1}),e.destination&&(this.$el=$(e.destination)),e.openAsPopUp&&(this.openAsPopUp=e.openAsPopUp),this.render()},render:function(){this.$el.html(this.template);var e=this,t=setTimeout(function(){e.$el.find(".regsubmitfinal").length?clearInterval(t):console.log("not found")},100);this.registrationElements(),this.payload=this.finalRegistrationPayload(this.options.attr),this.fetchpayload(this.payload)},events:{"click .regsubmitfinal":"next","click #editname":"editName"},editName:function(e){e.preventDefault(),$(".firstdiv").empty();var t=this.getnameElement("first_name","First Name","firstname"),n=this.getnameElement("last_name","Last Name","lastname"),r=this.getLabel("First Name"),i=this.getLabel("Second Name");$(".firstdiv").append(r),$(".firstdiv").append(t),$(".firstdiv").append(i),$(".firstdiv").append(n)},getLabel:function(e){var t=$("<div/>").attr({"class":"label"}),n=$("<lable/>").attr({For:e}).html(e);return t.append(n),t},getnameElement:function(e,t,n){var r=$("<input/>").attr({name:n,type:"text",id:e,placeholder:t});return r},finalRegistrationPayload:function(e){payload={};var t=e.attr;return $.each(t,function(e,t){payload[t.name]=t.value}),payload},registrationElements:function(){var e={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31"},n={1945:"1945",1946:"1946",1947:"1947",1948:"1948",1949:"1949",1950:"1950",1951:"1951",1952:"1952",1953:"1953",1954:"1954",1955:"1955",1956:"1956",1957:"1957",1958:"1958",1959:"1959",1960:"1960",1961:"1961",1962:"1962",1963:"1963",1964:"1964",1965:"1965",1966:"1966",1967:"1967",1968:"1968",1969:"1969",1970:"1970",1971:"1971",1972:"1972",1973:"1973",1974:"1974",1975:"1975",1976:"1976",1977:"1977",1978:"1978",1979:"1979",1980:"1980",1981:"1981",1982:"1982",1983:"1983",1984:"1984",1985:"1985",1986:"1986",1987:"1987",1988:"1988",1989:"1989",1990:"1990",1991:"1991",1992:"1992",1993:"1993",1994:"1994",1995:"1995",1996:"1996",1997:"1997",1998:"1998",1999:"1999",2e3:"2000",2001:"2001"},r=this.option(e,"born","06");this.$el.find("#dob").append(r);var i=this.option(t,"borndate","15");this.$el.find("#dob").append(i);var s=this.option(n,"borndyear","1985");this.$el.find("#dob").append(s)},option:function(e,t,n){var r='<select class="'+t+'">';return $.each(e,function(e,t){var i="";if(e==n)var i="selected='selected'";r+='<option value="'+e+'" '+i+">"+t+"</option>"}),r+="</select>",r},fetchpayload:function(e){this.$el.find("#first_name").val(e.firstname+" "+e.lastname),this.$el.find("#emailInput").val(e.email)},next:function(e){e.preventDefault();var t=this,n=$(".terms-condition-h").is(":checked");if(!n){alert("Please select terms and condition.");return}var i=this;console.log(this.payload);var s=this.$(":input").serializeArray();$.each(s,function(e,t){payload[t.name]=t.value}),console.log(payload,"new payload"),console.log($("#finalreg input#password")),console.log($("#finalreg input#re_password")),this.payload.gender=$("input:radio[name=gender]:checked").val(),this.payload.password=$("#finalreg input#password").val(),this.payload.re_password=$("#finalreg input#re_password").val(),this.payload.dob=$(".borndate").val()+"-"+$(".born").val()+"-"+$(".borndyear").val(),this.payload.accept_terms=n,this.model.save(this.payload,{success:function(e){$("#RegModal").modal("hide"),t.callback&&r.isFunction(t.callback)?(routing.trigger("common-popup-close"),App.header&&App.header.render(!0),t.callback(function(){})):location.href="#usersettings"},error:function(e){$(".errormsg").remove();var t=jQuery.parseJSON(e.request.responseText);errorArray=t.exec_data.error_array,$.each(errorArray,function(e,t){i.displayErrors(t)})}})},displayErrors:function(e){var t=$("#"+e.field),n=t.width();if(n){console.log(t.position(),"fieldName",n,"elemet width");var r=this.displayMesage(t.position(),e.error,n);$("#finalreg input.regsubmitfinal").before(r)}},displayMesage:function(e,t,n){console.log(n,"widthele");var r=e.left+15;r+=n,console.log(r,"posleft");var i=$("<div/>").attr({name:"error message","class":"errormsg"}).css({width:"90%","margin-top":"10px",color:"#CE0009"}).html(t);return i}}),i}),define("signup/views/registerbasic",["require","text!signup/templates/registration.html","text!signup/templates/registration_landing.html","backbone","underscore","registration","login","views","signup/views/facebooksignup","facade","utils","signup/views/registration-basics-final","signup/models/registration-basics-final"],function(e,t,n,r,i,s,o){var u,a=e("facade"),f=e("views"),l=e("signup/views/facebooksignup"),c=e("utils"),h=c.lib.Channel,p=e("signup/views/registration-basics-final"),d=e("signup/models/registration-basics-final"),v=r.View;return u=v.extend({initialize:function(e){e.openAsaPage&&(this.openAsaPage=e.openAsaPage),this.callback=e.callback,this.registrationController=new s({route:"",callback:this.callback}),this.fb_invite=e.fb_invite?e.fb_invite:!1,console.log("Options passed to registerbasics",e),this.AcceptData=e.data?e.data:undefined,e.showOnLanding==1?this.template=i.template(n,{onlyRegister:this.openAsaPage?!0:!1,fb_invite:this.fb_invite}):this.template=i.template(t,{onlyRegister:this.openAsaPage?!0:!1,fb_invite:this.fb_invite}),this.$el=$(e.destination),$("#errormsg, #preview").html(""),v.prototype.initialize.call(this,e),this.render(),this.facebookView=new l({callback:this.callback})},render:function(){this.$el.html(this.template),this.AcceptData&&(this.$el.find("input[name=firstname]").val(this.AcceptData.firstname),this.$el.find("input[name=lastname]").val(this.AcceptData.lastname))},events:{"click .regsubmit":"next","click #fbpane":"signupFacebook","click #reglogin a":"showLogin","click .login":"showLogin"},next:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=!0;$.each(this.$(":input"),function(e,t){t.value||(setTimeout(function(){$(t).addClass("field-failed"),setTimeout(function(){$(t).removeClass("field-failed")},2e3)},parseInt(e+"00")),n=!1)});try{if(this.openAsaPage&&n){routing.trigger("common-popup-close");var r={};r.height="500px",r.width="500px",r.title="The Basics",r.html='<div id="reg-cont"></div>',routing.trigger("common-popup-open",r),this.basic_type=new d;var r={model:this.basic_type,name:"Final registration",attr:{attr:t},openAsPopUp:!0,callback:this.callback,fb_invite:this.fb_invite,destination:$("#reg-cont")};this.selectRegisterBasicFinalView=new p(r)}else n&&routing.trigger("register-basic-final",t,this.callback)}catch(i){console.log(i.stack)}},signupFacebook:function(e){e.preventDefault(),$(e.target).parent().find("#label").addClass("loading").html("Connecting to Facebook..."),$("#RegModal").modal("hide"),this.facebookView.loginfb()},showLogin:function(e){e.preventDefault(),routing.trigger("common-popup-close"),this.logincontroller=new LoginController({callback:this.callback}),routing.trigger("Login")}}),u}),define("signup/models/image-upload",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"/api/user/savecrop/425983",payload:{}}),t}),define("text!signup/templates/imageupload.html",[],function(){return' <style type="text/css">\r\n\r\n </style>\r\n <div id="regcontainer">\r\n    <div id="mainregimg">\r\n      <div id="header">\r\n      <span class="regheader"> Upload a user pic</span>\r\n    </div>\r\n      <div id="imgcontainer" class="imgcontainer">\r\n       \r\n        <div class="textcenter pane" id="imgpreview" >\r\n          <img id="image-select" style="max-height: 245px; max-width: 320px;" />\r\n            <div class="coords" style="display:none;">\r\n                <div>crop x <input name="crop-x" type="hidden" /></div>\r\n                <div>crop y <input name="crop-y" type="hidden" /></div>\r\n                <div>crop width <input name="crop-width" type="hidden" /></div>\r\n                <div>crop height <input name="crop-height" type="hidden" /></div>\r\n                <div>image width <input name="image-width" type="hidden" /></div>\r\n                <div>image height <input name="image-height" type="hidden" /></div>            \r\n            </div>\r\n        </div>\r\n        <div id="imguploader" class="imguploader">\r\n          <input type="file" name= "preview" id="preview">\r\n        </div>\r\n        <div class="inputmask">\r\n          <div class="selectlabel">Select File</div>\r\n          <div class="showselected"></div>\r\n        </div>  \r\n         \r\n        <div id="imgupload"  class="imgupload">\r\n          <input type="submit" name="imgup" id="crpimgup" value="Crop and save" class="imgup" /> \r\n           <input type="submit" name="skip" id="skip" value="Skip" class="imgup" />   \r\n        </div>\r\n        \r\n      </div>\r\n    </div>  \r\n  </div>   '}),define("signup/views/image-upload",["require","text!signup/templates/imageupload.html","backbone","underscore","views","facade","utils","jquery.jrac"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),this.userinfo(this.options.attr)},events:{"change input":"preview","click #crpimgup":"imageupload","click #skip":"skip"},skip:function(e){e.preventDefault(),window.location.href="#usersettings"},userinfo:function(e){},preview:function(e){this.removeCropView();var t=window.URL||window.webkitURL;window.fileURL=t.createObjectURL(e.target.files[0]),this.srcimg=window.fileURL,$("#image-select").attr({src:window.fileURL}),this.initCropView()},initCropView:function(){$("#image-select").jrac({crop_width:200,crop_height:240,crop_aspect_ratio:"1:1",crop_x:0,crop_y:0,crop_resize:!1,viewport_resize:!1,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){$(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,$(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=$(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},imageupload:function(e){e.preventDefault(),this.getImageInfo()},removeCropView:function(){$("#image-select").jrac("destroy"),$("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=[],t=this.$(".coords :input").serializeArray();e.image_url=this.srcimg,$.each(t,function(t,n){e[n.name]=n.value}),console.log(e,"finalRegistrationPayload"),this.model.save(e,{success:function(e){a("upload-user-image").publish(e)},error:function(){}})}}),i}),define("signup",["require","text!signup/templates/layout.html","facade","controller","models","views","utils","signup/models/registerbasic","signup/models/registration-basics-final","signup/views/registerbasic","signup/views/registration-basics-final","signup/models/image-upload","signup/views/image-upload"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("signup/models/registerbasic"),f=e("signup/models/registration-basics-final"),l=e("signup/models/image-upload"),c=e("signup/views/registerbasic"),h=e("signup/views/registration-basics-final"),p=e("signup/views/image-upload"),d=o.LayoutView,v=r.$,m=r._,g=u.debug,y=u.lib.Channel,b=["/pages/signup/css/signupstyle.css","/css/style.jrac.css","/pages/imageup/imageup.css"];return n=i.extend({initialize:function(e){return y("load:css").publish(b),m.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){ga("send","event","Signup","Open","User opened registration box"),this.refreshPage(),this.setupLayout(),this.createData(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],pageLayout=new d({scheme:this.scheme,destination:"#modalBody",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.select_type=new a},refreshPage:function(){this.selectTypeView&&(v(this.selectTypeView.destination).html(""),position=v.inArray(this.selectTypeView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){v("#imgUploadModal").modal("show"),v("#imgUploadModal").on("hidden",function(){}),v("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){function t(t,n){e.initRegisterFinal({attr:t},n)}function n(t){e.uploadUserImage({attr:t})}var e=this;routing.off("register-basic"),routing.on("register-basic",function(t){e.setupSelectTypeView(t)}),routing.off("register-basic-final"),routing.on("register-basic-final",function(e,n){t(e,n)}),routing.off("upload-user-image"),routing.on("upload-user-image",function(e){n(e)})},initRegisterFinal:function(e,t){this.basic_type=new f,this.selectRegisterBasicFinalView=new h({model:this.basic_type,name:"Final registration",destination:"#modalBody",attr:e,callback:t}),this.layout.render()},uploadUserImage:function(e){this.basic_type=new l,this.selectRegisterBasicFinalView=new p({model:this.basic_type,name:"Final registration",destination:"#modalBody",attr:e}),this.layout.render();var t={};t.height="500px",t.width="500px",t.title="Register",routing.trigger("common-popup-open",t)},setupSelectTypeView:function(e){var t="modal-popup-signup",n="#"+t+" #modalBody",r={};r.height="500px",r.width="600px",r.title="Get Started on Athletez",r.id=t,routing.trigger("common-popup-open",r),this.selectTypeView=new c({model:this.select_type,name:"Select Registration Type",destination:n,showOnLanding:!0,callback:e})}}),n}),!function(e,t,n){!function(e){"function"==typeof define&&define.amd?define("vendor/plugins/qtip/qtip",["jquery"],e):jQuery&&!jQuery.fn.qtip&&e(jQuery)}(function(r){function i(e,t,n,i){this.id=n,this.target=e,this.tooltip=D,this.elements={target:e},this._id=V+"-"+n,this.timers={img:{}},this.options=t,this.plugins={},this.cache={event:{},target:r(),disabled:_,attr:i,onTooltip:_,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=_}function s(e){return e===D||"object"!==r.type(e)}function o(e){return!(r.isFunction(e)||e&&e.attr||e.length||"object"===r.type(e)&&(e.jquery||e.then))}function u(e){var t,n,i,u;return s(e)?_:(s(e.metadata)&&(e.metadata={type:e.metadata}),"content"in e&&(t=e.content,s(t)||t.jquery||t.done?t=e.content={text:n=o(t)?_:t}:n=t.text,"ajax"in t&&(i=t.ajax,u=i&&i.once!==_,delete t.ajax,t.text=function(e,t){var s=n||r(this).attr(t.options.content.attr)||"Loading...",o=r.ajax(r.extend({},i,{context:t})).then(i.success,D,i.error).then(function(e){return e&&u&&t.set("content.text",e),e},function(e,n,r){t.destroyed||0===e.status||t.set("content.text",n+": "+r)});return u?s:(t.set("content.text",s),o)}),"title"in t&&(s(t.title)||(t.button=t.title.button,t.title=t.title.text),o(t.title||_)&&(t.title=_))),"position"in e&&s(e.position)&&(e.position={my:e.position,at:e.position}),"show"in e&&s(e.show)&&(e.show=e.show.jquery?{target:e.show}:e.show===M?{ready:M}:{event:e.show}),"hide"in e&&s(e.hide)&&(e.hide=e.hide.jquery?{target:e.hide}:{event:e.hide}),"style"in e&&s(e.style)&&(e.style={classes:e.style}),r.each(X,function(){this.sanitize&&this.sanitize(e)}),e)}function f(e,t){for(var n,r=0,i=e,s=t.split(".");i=i[s[r++]];)r<s.length&&(n=i);return[n||e,s.pop()]}function l(e,t){var n,r,i;for(n in this.checks)for(r in this.checks[n])(i=(new RegExp(r,"i")).exec(e))&&(t.push(i),("builtin"===n||this.plugins[n])&&this.checks[n][r].apply(this.plugins[n]||this,t))}function h(e){return K.concat("").join(e?"-"+e+" ":" ")}function p(n){return n&&{type:n.type,pageX:n.pageX,pageY:n.pageY,target:n.target,relatedTarget:n.relatedTarget,scrollX:n.scrollX||e.pageXOffset||t.body.scrollLeft||t.documentElement.scrollLeft,scrollY:n.scrollY||e.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop}||{}}function d(e,t){return t>0?setTimeout(r.proxy(e,this),t):(e.call(this),void 0)}function v(e){return this.tooltip.hasClass(nt)?_:(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this.timers.show=d.call(this,function(){this.toggle(M,e)},this.options.show.delay),void 0)}function m(e){if(this.tooltip.hasClass(nt))return _;var t=r(e.relatedTarget),n=t.closest(Q)[0]===this.tooltip[0],i=t[0]===this.options.show.target[0];if(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this!==t[0]&&"mouse"===this.options.position.target&&n||this.options.hide.fixed&&/mouse(out|leave|move)/.test(e.type)&&(n||i))try{e.preventDefault(),e.stopImmediatePropagation()}catch(s){}else this.timers.hide=d.call(this,function(){this.toggle(_,e)},this.options.hide.delay,this)}function g(e){return this.tooltip.hasClass(nt)||!this.options.hide.inactive?_:(clearTimeout(this.timers.inactive),this.timers.inactive=d.call(this,function(){this.hide(e)},this.options.hide.inactive),void 0)}function y(e){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(e)}function w(e,n,i){r(t.body).delegate(e,(n.split?n:n.join(ft+" "))+ft,function(){var e=C.api[r.attr(this,J)];e&&!e.disabled&&i.apply(e,arguments)})}function E(e,n,s){var o,a,f,l,c,h=r(t.body),p=e[0]===t?h:e,d=e.metadata?e.metadata(s.metadata):D,v="html5"===s.metadata.type&&d?d[s.metadata.name]:D,m=e.data(s.metadata.name||"qtipopts");try{m="string"==typeof m?r.parseJSON(m):m}catch(g){}if(l=r.extend(M,{},C.defaults,s,"object"==typeof m?u(m):D,u(v||d)),a=l.position,l.id=n,"boolean"==typeof l.content.text){if(f=e.attr(l.content.attr),l.content.attr===_||!f)return _;l.content.text=f}if(a.container.length||(a.container=h),a.target===_&&(a.target=p),l.show.target===_&&(l.show.target=p),l.show.solo===M&&(l.show.solo=a.container.closest("body")),l.hide.target===_&&(l.hide.target=p),l.position.viewport===M&&(l.position.viewport=a.container),a.container=a.container.eq(0),a.at=new L(a.at,M),a.my=new L(a.my),e.data(V))if(l.overwrite)e.qtip("destroy",!0);else if(l.overwrite===_)return _;return e.attr($,n),l.suppress&&(c=e.attr("title"))&&e.removeAttr("title").attr(it,c).attr("title",""),o=new i(e,l,n,!!f),e.data(V,o),e.one("remove.qtip-"+n+" removeqtip.qtip-"+n,function(){var e;(e=r(this).data(V))&&e.destroy(!0)}),o}function S(e){return e.charAt(0).toUpperCase()+e.slice(1)}function x(e,t){var r,i,s=t.charAt(0).toUpperCase()+t.slice(1),o=(t+" "+wt.join(s+" ")+s).split(" "),u=0;if(bt[t])return e.css(bt[t]);for(;r=o[u++];)if((i=e.css(r))!==n)return bt[t]=r,i}function T(e,t){return Math.ceil(parseFloat(x(e,t)))}function N(e,t){this._ns="tip",this.options=t,this.offset=t.offset,this.size=[t.width,t.height],this.init(this.qtip=e)}var C,k,L,A,O,M=!0,_=!1,D=null,P="x",H="y",B="width",j="height",F="top",I="left",q="bottom",R="right",U="center",z="flipinvert",W="shift",X={},V="qtip",$="data-hasqtip",J="data-qtip-id",K=["ui-widget","ui-tooltip"],Q="."+V,G="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),Y=V+"-fixed",Z=V+"-default",et=V+"-focus",tt=V+"-hover",nt=V+"-disabled",rt="_replacedByqTip",it="oldtitle",st={ie:function(){for(var e=3,n=t.createElement("div");(n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n.getElementsByTagName("i")[0];);return e>4?e:0/0}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||_};k=i.prototype,k._when=function(e){return r.when.apply(r,e)},k.render=function(e){if(this.rendered||this.destroyed)return this;var t,n=this,i=this.options,s=this.cache,o=this.elements,u=i.content.text,a=i.content.title,f=i.content.button,l=i.position,c=("."+this._id+" ",[]);return r.attr(this.target[0],"aria-describedby",this._id),this.tooltip=o.tooltip=t=r("<div/>",{id:this._id,"class":[V,Z,i.style.classes,V+"-pos-"+i.position.my.abbrev()].join(" "),width:i.style.width||"",height:i.style.height||"",tracking:"mouse"===l.target&&l.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":_,"aria-describedby":this._id+"-content","aria-hidden":M}).toggleClass(nt,this.disabled).attr(J,this.id).data(V,this).appendTo(l.container).append(o.content=r("<div />",{"class":V+"-content",id:this._id+"-content","aria-atomic":M})),this.rendered=-1,this.positioning=M,a&&(this._createTitle(),r.isFunction(a)||c.push(this._updateTitle(a,_))),f&&this._createButton(),r.isFunction(u)||c.push(this._updateContent(u,_)),this.rendered=M,this._setWidget(),r.each(X,function(e){var t;"render"===this.initialize&&(t=this(n))&&(n.plugins[e]=t)}),this._unassignEvents(),this._assignEvents(),this._when(c).then(function(){n._trigger("render"),n.positioning=_,n.hiddenDuringWait||!i.show.ready&&!e||n.toggle(M,s.event,_),n.hiddenDuringWait=_}),C.api[this.id]=this,this},k.destroy=function(e){function t(){if(!this.destroyed){this.destroyed=M;var e=this.target,t=e.attr(it);this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),r.each(this.plugins,function(){this.destroy&&this.destroy()}),clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this._unassignEvents(),e.removeData(V).removeAttr(J).removeAttr($).removeAttr("aria-describedby"),this.options.suppress&&t&&e.attr("title",t).removeAttr(it),this._unbind(e),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=D,delete C.api[this.id]}}return this.destroyed?this.target:(e===M&&"hide"!==this.triggering||!this.rendered?t.call(this):(this.tooltip.one("tooltiphidden",r.proxy(t,this)),!this.triggering&&this.hide()),this.target)},A=k.checks={builtin:{"^id$":function(e,t,n,i){var s=n===M?C.nextid:n,o=V+"-"+s;s!==_&&s.length>0&&!r("#"+o).length?(this._id=o,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):e[t]=i},"^prerender":function(e,t,n){n&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(e,t,n){this._updateContent(n)},"^content.attr$":function(e,t,n,r){this.options.content.text===this.target.attr(r)&&this._updateContent(this.target.attr(n))},"^content.title$":function(e,t,n){return n?(n&&!this.elements.title&&this._createTitle(),this._updateTitle(n),void 0):this._removeTitle()},"^content.button$":function(e,t,n){this._updateButton(n)},"^content.title.(text|button)$":function(e,t,n){this.set("content."+t,n)},"^position.(my|at)$":function(e,t,n){"string"==typeof n&&(e[t]=new L(n,"at"===t))},"^position.container$":function(e,t,n){this.rendered&&this.tooltip.appendTo(n)},"^show.ready$":function(e,t,n){n&&(!this.rendered&&this.render(M)||this.toggle(M))},"^style.classes$":function(e,t,n,r){this.rendered&&this.tooltip.removeClass(r).addClass(n)},"^style.(width|height)":function(e,t,n){this.rendered&&this.tooltip.css(t,n)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(e,t,n){this.rendered&&this.tooltip.toggleClass(Z,!!n)},"^events.(render|show|move|hide|focus|blur)$":function(e,t,n){this.rendered&&this.tooltip[(r.isFunction(n)?"":"un")+"bind"]("tooltip"+t,n)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(this.rendered){var e=this.options.position;this.tooltip.attr("tracking","mouse"===e.target&&e.adjust.mouse),this._unassignEvents(),this._assignEvents()}}}},k.get=function(e){if(this.destroyed)return this;var t=f(this.options,e.toLowerCase()),n=t[0][t[1]];return n.precedance?n.string():n};var ot=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,ut=/^prerender|show\.ready/i;k.set=function(e,t){if(this.destroyed)return this;var n,i=this.rendered,s=_,o=this.options;return this.checks,"string"==typeof e?(n=e,e={},e[n]=t):e=r.extend({},e),r.each(e,function(t,n){if(i&&ut.test(t))return delete e[t],void 0;var u,l=f(o,t.toLowerCase());u=l[0][l[1]],l[0][l[1]]=n&&n.nodeType?r(n):n,s=ot.test(t)||s,e[t]=[l[0],l[1],n,u]}),u(o),this.positioning=M,r.each(e,r.proxy(l,this)),this.positioning=_,this.rendered&&this.tooltip[0].offsetWidth>0&&s&&this.reposition("mouse"===o.position.target?D:this.cache.event),this},k._update=function(e,t){var n=this,i=this.cache;return this.rendered&&e?(r.isFunction(e)&&(e=e.call(this.elements.target,i.event,this)||""),r.isFunction(e.then)?(i.waiting=M,e.then(function(e){return i.waiting=_,n._update(e,t)},D,function(e){return n._update(e,t)})):e===_||!e&&""!==e?_:(e.jquery&&e.length>0?t.empty().append(e.css({display:"block",visibility:"visible"})):t.html(e),this._waitForContent(t).then(function(e){e.images&&e.images.length&&n.rendered&&n.tooltip[0].offsetWidth>0&&n.reposition(i.event,!e.length)}))):_},k._waitForContent=function(e){var t=this.cache;return t.waiting=M,(r.fn.imagesLoaded?e.imagesLoaded():r.Deferred().resolve([])).done(function(){t.waiting=_}).promise()},k._updateContent=function(e,t){this._update(e,this.elements.content,t)},k._updateTitle=function(e,t){this._update(e,this.elements.title,t)===_&&this._removeTitle(_)},k._createTitle=function(){var e=this.elements,t=this._id+"-title";e.titlebar&&this._removeTitle(),e.titlebar=r("<div />",{"class":V+"-titlebar "+(this.options.style.widget?h("header"):"")}).append(e.title=r("<div />",{id:t,"class":V+"-title","aria-atomic":M})).insertBefore(e.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(e){r(this).toggleClass("ui-state-active ui-state-focus","down"===e.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(e){r(this).toggleClass("ui-state-hover","mouseover"===e.type)}),this.options.content.button&&this._createButton()},k._removeTitle=function(e){var t=this.elements;t.title&&(t.titlebar.remove(),t.titlebar=t.title=t.button=D,e!==_&&this.reposition())},k.reposition=function(n,i){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=M;var s,o,u=this.cache,f=this.tooltip,l=this.options.position,c=l.target,h=l.my,p=l.at,d=l.viewport,v=l.container,m=l.adjust,g=m.method.split(" "),y=f.outerWidth(_),w=f.outerHeight(_),E=0,S=0,x=f.css("position"),T={left:0,top:0},N=f[0].offsetWidth>0,C=n&&"scroll"===n.type,k=r(e),L=v[0].ownerDocument,A=this.mouse;if(r.isArray(c)&&2===c.length)p={x:I,y:F},T={left:c[0],top:c[1]};else if("mouse"===c)p={x:I,y:F},!A||!A.pageX||!m.mouse&&n&&n.pageX?n&&n.pageX||((!m.mouse||this.options.show.distance)&&u.origin&&u.origin.pageX?n=u.origin:(!n||n&&("resize"===n.type||"scroll"===n.type))&&(n=u.event)):n=A,"static"!==x&&(T=v.offset()),L.body.offsetWidth!==(e.innerWidth||L.documentElement.clientWidth)&&(o=r(t.body).offset()),T={left:n.pageX-T.left+(o&&o.left||0),top:n.pageY-T.top+(o&&o.top||0)},m.mouse&&C&&A&&(T.left-=(A.scrollX||0)-k.scrollLeft(),T.top-=(A.scrollY||0)-k.scrollTop());else{if("event"===c?n&&n.target&&"scroll"!==n.type&&"resize"!==n.type?u.target=r(n.target):n.target||(u.target=this.elements.target):"event"!==c&&(u.target=r(c.jquery?c:this.elements.target)),c=u.target,c=r(c).eq(0),0===c.length)return this;c[0]===t||c[0]===e?(E=st.iOS?e.innerWidth:c.width(),S=st.iOS?e.innerHeight:c.height(),c[0]===e&&(T={top:(d||c).scrollTop(),left:(d||c).scrollLeft()})):X.imagemap&&c.is("area")?s=X.imagemap(this,c,p,X.viewport?g:_):X.svg&&c&&c[0].ownerSVGElement?s=X.svg(this,c,p,X.viewport?g:_):(E=c.outerWidth(_),S=c.outerHeight(_),T=c.offset()),s&&(E=s.width,S=s.height,o=s.offset,T=s.position),T=this.reposition.offset(c,T,v),(st.iOS>3.1&&st.iOS<4.1||st.iOS>=4.3&&st.iOS<4.33||!st.iOS&&"fixed"===x)&&(T.left-=k.scrollLeft(),T.top-=k.scrollTop()),(!s||s&&s.adjustable!==_)&&(T.left+=p.x===R?E:p.x===U?E/2:0,T.top+=p.y===q?S:p.y===U?S/2:0)}return T.left+=m.x+(h.x===R?-y:h.x===U?-y/2:0),T.top+=m.y+(h.y===q?-w:h.y===U?-w/2:0),X.viewport?(T.adjusted=X.viewport(this,T,l,E,S,y,w),o&&T.adjusted.left&&(T.left+=o.left),o&&T.adjusted.top&&(T.top+=o.top)):T.adjusted={left:0,top:0},this._trigger("move",[T,d.elem||d],n)?(delete T.adjusted,i===_||!N||isNaN(T.left)||isNaN(T.top)||"mouse"===c||!r.isFunction(l.effect)?f.css(T):r.isFunction(l.effect)&&(l.effect.call(f,this,r.extend({},T)),f.queue(function(e){r(this).css({opacity:"",height:""}),st.ie&&this.style.removeAttribute("filter"),e()})),this.positioning=_,this):this},k.reposition.offset=function(e,n,i){function s(e,t){n.left+=t*e.scrollLeft(),n.top+=t*e.scrollTop()}if(!i[0])return n;var o,u,a,f,l=r(e[0].ownerDocument),c=!!st.ie&&"CSS1Compat"!==t.compatMode,h=i[0];do"static"!==(u=r.css(h,"position"))&&("fixed"===u?(a=h.getBoundingClientRect(),s(l,-1)):(a=r(h).position(),a.left+=parseFloat(r.css(h,"borderLeftWidth"))||0,a.top+=parseFloat(r.css(h,"borderTopWidth"))||0),n.left-=a.left+(parseFloat(r.css(h,"marginLeft"))||0),n.top-=a.top+(parseFloat(r.css(h,"marginTop"))||0),o||"hidden"===(f=r.css(h,"overflow"))||"visible"===f||(o=r(h)));while(h=h.offsetParent);return o&&(o[0]!==l[0]||c)&&s(o,1),n};var at=(L=k.reposition.Corner=function(e,t){e=(""+e).replace(/([A-Z])/," $1").replace(/middle/gi,U).toLowerCase(),this.x=(e.match(/left|right/i)||e.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(e.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!t;var n=e.charAt(0);this.precedance="t"===n||"b"===n?H:P}).prototype;at.invert=function(e,t){this[e]=this[e]===I?R:this[e]===R?I:t||this[e]},at.string=function(){var e=this.x,t=this.y;return e===t?e:this.precedance===H||this.forceY&&"center"!==t?t+" "+e:e+" "+t},at.abbrev=function(){var e=this.string().split(" ");return e[0].charAt(0)+(e[1]&&e[1].charAt(0)||"")},at.clone=function(){return new L(this.string(),this.forceY)},k.toggle=function(e,n){var i=this.cache,s=this.options,o=this.tooltip;if(n){if(/over|enter/.test(n.type)&&/out|leave/.test(i.event.type)&&s.show.target.add(n.target).length===s.show.target.length&&o.has(n.relatedTarget).length)return this;i.event=p(n)}if(this.waiting&&!e&&(this.hiddenDuringWait=M),!this.rendered)return e?this.render(1):this;if(this.destroyed||this.disabled)return this;var u,a,f,l=e?"show":"hide",c=this.options[l],h=(this.options[e?"hide":"show"],this.options.position),d=this.options.content,v=this.tooltip.css("width"),m=this.tooltip.is(":visible"),g=e||1===c.target.length,y=!n||c.target.length<2||i.target[0]===n.target;return(typeof e).search("boolean|number")&&(e=!m),u=!o.is(":animated")&&m===e&&y,a=u?D:!!this._trigger(l,[90]),this.destroyed?this:(a!==_&&e&&this.focus(n),!a||u?this:(r.attr(o[0],"aria-hidden",!e),e?(i.origin=p(this.mouse),r.isFunction(d.text)&&this._updateContent(d.text,_),r.isFunction(d.title)&&this._updateTitle(d.title,_),!O&&"mouse"===h.target&&h.adjust.mouse&&(r(t).bind("mousemove."+V,this._storeMouse),O=M),v||o.css("width",o.outerWidth(_)),this.reposition(n,arguments[2]),v||o.css("width",""),c.solo&&("string"==typeof c.solo?r(c.solo):r(Q,c.solo)).not(o).not(c.target).qtip("hide",r.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete i.origin,O&&!r(Q+'[tracking="true"]:visible',c.solo).not(o).length&&(r(t).unbind("mousemove."+V),O=_),this.blur(n)),f=r.proxy(function(){e?(st.ie&&o[0].style.removeAttribute("filter"),o.css("overflow",""),"string"==typeof c.autofocus&&r(this.options.show.autofocus,o).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):o.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(e?"visible":"hidden")},this),c.effect===_||g===_?(o[l](),f()):r.isFunction(c.effect)?(o.stop(1,1),c.effect.call(o,this),o.queue("fx",function(e){f(),e()})):o.fadeTo(90,e?1:0,f),e&&c.target.trigger("qtip-"+this.id+"-inactive"),this))},k.show=function(e){return this.toggle(M,e)},k.hide=function(e){return this.toggle(_,e)},k.focus=function(e){if(!this.rendered||this.destroyed)return this;var t=r(Q),n=this.tooltip,i=parseInt(n[0].style.zIndex,10),s=C.zindex+t.length;return n.hasClass(et)||this._trigger("focus",[s],e)&&(i!==s&&(t.each(function(){this.style.zIndex>i&&(this.style.zIndex=this.style.zIndex-1)}),t.filter("."+et).qtip("blur",e)),n.addClass(et)[0].style.zIndex=s),this},k.blur=function(e){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(et),this._trigger("blur",[this.tooltip.css("zIndex")],e),this)},k.disable=function(e){return this.destroyed?this:("toggle"===e?e=this.rendered?!this.tooltip.hasClass(nt):!this.disabled:"boolean"!=typeof e&&(e=M),this.rendered&&this.tooltip.toggleClass(nt,e).attr("aria-disabled",e),this.disabled=!!e,this)},k.enable=function(){return this.disable(_)},k._createButton=function(){var e=this,t=this.elements,n=t.tooltip,i=this.options.content.button,s="string"==typeof i,o=s?i:"Close tooltip";t.button&&t.button.remove(),t.button=i.jquery?i:r("<a />",{"class":"qtip-close "+(this.options.style.widget?"":V+"-icon"),title:o,"aria-label":o}).prepend(r("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),t.button.appendTo(t.titlebar||n).attr("role","button").click(function(t){return n.hasClass(nt)||e.hide(t),_})},k._updateButton=function(e){if(!this.rendered)return _;var t=this.elements.button;e?this._createButton():t.remove()},k._setWidget=function(){var e=this.options.style.widget,t=this.elements,n=t.tooltip,r=n.hasClass(nt);n.removeClass(nt),nt=e?"ui-state-disabled":"qtip-disabled",n.toggleClass(nt,r),n.toggleClass("ui-helper-reset "+h(),e).toggleClass(Z,this.options.style.def&&!e),t.content&&t.content.toggleClass(h("content"),e),t.titlebar&&t.titlebar.toggleClass(h("header"),e),t.button&&t.button.toggleClass(V+"-icon",!e)},k._storeMouse=function(e){(this.mouse=p(e)).type="mousemove"},k._bind=function(e,t,n,i,s){var o="."+this._id+(i?"-"+i:"");t.length&&r(e).bind((t.split?t:t.join(o+" "))+o,r.proxy(n,s||this))},k._unbind=function(e,t){r(e).unbind("."+this._id+(t?"-"+t:""))};var ft="."+V;r(function(){w(Q,["mouseenter","mouseleave"],function(e){var t="mouseenter"===e.type,n=r(e.currentTarget),i=r(e.relatedTarget||e.target),s=this.options;t?(this.focus(e),n.hasClass(Y)&&!n.hasClass(nt)&&clearTimeout(this.timers.hide)):"mouse"===s.position.target&&s.hide.event&&s.show.target&&!i.closest(s.show.target[0]).length&&this.hide(e),n.toggleClass(tt,t)}),w("["+J+"]",G,g)}),k._trigger=function(e,t,n){var i=r.Event("tooltip"+e);return i.originalEvent=n&&r.extend({},n)||this.cache.event||D,this.triggering=e,this.tooltip.trigger(i,[this].concat(t||[])),this.triggering=_,!i.isDefaultPrevented()},k._bindEvents=function(e,t,n,i,s,o){if(i.add(n).length===i.length){var u=[];t=r.map(t,function(t){var n=r.inArray(t,e);return n>-1?(u.push(e.splice(n,1)[0]),void 0):t}),u.length&&this._bind(n,u,function(e){var t=this.rendered?this.tooltip[0].offsetWidth>0:!1;(t?o:s).call(this,e)})}this._bind(n,e,s),this._bind(i,t,o)},k._assignInitialEvents=function(e){function t(e){return this.disabled||this.destroyed?_:(this.cache.event=p(e),this.cache.target=e?r(e.target):[n],clearTimeout(this.timers.show),this.timers.show=d.call(this,function(){this.render("object"==typeof e||i.show.ready)},i.show.delay),void 0)}var i=this.options,s=i.show.target,o=i.hide.target,u=i.show.event?r.trim(""+i.show.event).split(" "):[],a=i.hide.event?r.trim(""+i.hide.event).split(" "):[];/mouse(over|enter)/i.test(i.show.event)&&!/mouse(out|leave)/i.test(i.hide.event)&&a.push("mouseleave"),this._bind(s,"mousemove",function(e){this._storeMouse(e),this.cache.onTarget=M}),this._bindEvents(u,a,s,o,t,function(){clearTimeout(this.timers.show)}),(i.show.ready||i.prerender)&&t.call(this,e)},k._assignEvents=function(){var n=this,i=this.options,s=i.position,o=this.tooltip,u=i.show.target,f=i.hide.target,l=s.container,c=s.viewport,h=r(t),p=(r(t.body),r(e)),d=i.show.event?r.trim(""+i.show.event).split(" "):[],w=i.hide.event?r.trim(""+i.hide.event).split(" "):[];r.each(i.events,function(e,t){n._bind(o,"toggle"===e?["tooltipshow","tooltiphide"]:["tooltip"+e],t,null,o)}),/mouse(out|leave)/i.test(i.hide.event)&&"window"===i.hide.leave&&this._bind(h,["mouseout","blur"],function(e){/select|option/.test(e.target.nodeName)||e.relatedTarget||this.hide(e)}),i.hide.fixed?f=f.add(o.addClass(Y)):/mouse(over|enter)/i.test(i.show.event)&&this._bind(f,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+i.hide.event).indexOf("unfocus")>-1&&this._bind(l.closest("html"),["mousedown","touchstart"],function(e){var t=r(e.target),n=this.rendered&&!this.tooltip.hasClass(nt)&&this.tooltip[0].offsetWidth>0,i=t.parents(Q).filter(this.tooltip[0]).length>0;t[0]===this.target[0]||t[0]===this.tooltip[0]||i||this.target.has(t[0]).length||!n||this.hide(e)}),"number"==typeof i.hide.inactive&&(this._bind(u,"qtip-"+this.id+"-inactive",g),this._bind(f.add(o),C.inactiveEvents,g,"-inactive")),this._bindEvents(d,w,u,f,v,m),this._bind(u.add(o),"mousemove",function(e){if("number"==typeof i.hide.distance){var t=this.cache.origin||{},n=this.options.hide.distance,r=Math.abs;(r(e.pageX-t.pageX)>=n||r(e.pageY-t.pageY)>=n)&&this.hide(e)}this._storeMouse(e)}),"mouse"===s.target&&s.adjust.mouse&&(i.hide.event&&this._bind(u,["mouseenter","mouseleave"],function(e){this.cache.onTarget="mouseenter"===e.type}),this._bind(h,"mousemove",function(e){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(nt)&&this.tooltip[0].offsetWidth>0&&this.reposition(e)})),(s.adjust.resize||c.length)&&this._bind(r.event.special.resize?c:p,"resize",y),s.adjust.scroll&&this._bind(p.add(s.container),"scroll",y)},k._unassignEvents=function(){var n=[this.options.show.target[0],this.options.hide.target[0],this.rendered&&this.tooltip[0],this.options.position.container[0],this.options.position.viewport[0],this.options.position.container.closest("html")[0],e,t];this._unbind(r([]).pushStack(r.grep(n,function(e){return"object"==typeof e})))},C=r.fn.qtip=function(e,t,i){var s=(""+e).toLowerCase(),o=D,a=r.makeArray(arguments).slice(1),f=a[a.length-1],l=this[0]?r.data(this[0],V):D;return!arguments.length&&l||"api"===s?l:"string"==typeof e?(this.each(function(){var e=r.data(this,V);if(!e)return M;if(f&&f.timeStamp&&(e.cache.event=f),!t||"option"!==s&&"options"!==s)e[s]&&e[s].apply(e,a);else{if(i===n&&!r.isPlainObject(t))return o=e.get(t),_;e.set(t,i)}}),o!==D?o:this):"object"!=typeof e&&arguments.length?void 0:(l=u(r.extend(M,{},e)),this.each(function(e){var t,n;return n=r.isArray(l.id)?l.id[e]:l.id,n=!n||n===_||n.length<1||C.api[n]?C.nextid++:n,t=E(r(this),n,l),t===_?M:(C.api[n]=t,r.each(X,function(){"initialize"===this.initialize&&this(t)}),t._assignInitialEvents(f),void 0)}))},r.qtip=i,C.api={},r.each({attr:function(e,t){if(this.length){var n=this[0],i="title",s=r.data(n,"qtip");if(e===i&&s&&"object"==typeof s&&s.options.suppress)return arguments.length<2?r.attr(n,it):(s&&s.options.content.attr===i&&s.cache.attr&&s.set("content.text",t),this.attr(it,t))}return r.fn["attr"+rt].apply(this,arguments)},clone:function(e){var t=(r([]),r.fn["clone"+rt].apply(this,arguments));return e||t.filter("["+it+"]").attr("title",function(){return r.attr(this,it)}).removeAttr(it),t}},function(e,t){if(!t||r.fn[e+rt])return M;var n=r.fn[e+rt]=r.fn[e];r.fn[e]=function(){return t.apply(this,arguments)||n.apply(this,arguments)}}),r.ui||(r["cleanData"+rt]=r.cleanData,r.cleanData=function(e){for(var t,n=0;(t=r(e[n])).length;n++)if(t.attr($))try{t.triggerHandler("removeqtip")}catch(i){}r["cleanData"+rt].apply(this,arguments)}),C.version="2.2.0",C.nextid=0,C.inactiveEvents=G,C.zindex=15e3,C.defaults={prerender:_,id:_,overwrite:M,suppress:M,content:{text:M,attr:"title",title:_,button:_},position:{my:"top left",at:"bottom right",target:_,container:_,viewport:_,adjust:{x:0,y:0,mouse:M,scroll:M,resize:M,method:"flipinvert flipinvert"},effect:function(e,t){r(this).animate(t,{duration:200,queue:_})}},show:{target:_,event:"mouseenter",effect:M,delay:90,solo:_,ready:_,autofocus:_},hide:{target:_,event:"mouseleave",effect:M,delay:0,fixed:_,inactive:_,leave:"window",distance:_},style:{classes:"",widget:_,width:_,height:_,def:M},events:{render:D,move:D,show:D,hide:D,toggle:D,visible:D,hidden:D,focus:D,blur:D}};var lt,ct="margin",ht="border",pt="color",dt="background-color",vt="transparent",mt=" !important",gt=!!t.createElement("canvas").getContext,yt=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,bt={},wt=["Webkit","O","Moz","ms"];if(gt)var Et=e.devicePixelRatio||1,St=function(){var e=t.createElement("canvas").getContext("2d");return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}(),xt=Et/St;else var Tt=function(e,t,n){return"<qtipvml:"+e+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(t||"")+' style="behavior: url(#default#VML); '+(n||"")+'" />'};r.extend(N.prototype,{init:function(e){var t,n;n=this.element=e.elements.tip=r("<div />",{"class":V+"-tip"}).prependTo(e.tooltip),gt?(t=r("<canvas />").appendTo(this.element)[0].getContext("2d"),t.lineJoin="miter",t.miterLimit=1e5,t.save()):(t=Tt("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(t+t),e._bind(r("*",n).add(n),["click","mousedown"],function(e){e.stopPropagation()},this._ns)),e._bind(e.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(e){var t=this.qtip.elements.titlebar;return t&&(e.y===F||e.y===U&&this.element.position().top+this.size[1]/2+this.options.offset<t.outerHeight(M))},_parseCorner:function(e){var t=this.qtip.options.position.my;return e===_||t===_?e=_:e===M?e=new L(t.string()):e.string||(e=new L(e),e.fixed=M),e},_parseWidth:function(e,t,n){var r=this.qtip.elements,i=ht+S(t)+"Width";return(n?T(n,i):T(r.content,i)||T(this._useTitle(e)&&r.titlebar||r.content,i)||T(r.tooltip,i))||0},_parseRadius:function(e){var t=this.qtip.elements,n=ht+S(e.y)+S(e.x)+"Radius";return st.ie<9?0:T(this._useTitle(e)&&t.titlebar||t.content,n)||T(t.tooltip,n)||0},_invalidColour:function(e,t,n){var r=e.css(t);return!r||n&&r===e.css(n)||yt.test(r)?_:r},_parseColours:function(e){var t=this.qtip.elements,n=this.element.css("cssText",""),i=ht+S(e[e.precedance])+S(pt),s=this._useTitle(e)&&t.titlebar||t.content,o=this._invalidColour,u=[];return u[0]=o(n,dt)||o(s,dt)||o(t.content,dt)||o(t.tooltip,dt)||n.css(dt),u[1]=o(n,i,pt)||o(s,i,pt)||o(t.content,i,pt)||o(t.tooltip,i,pt)||t.tooltip.css(i),r("*",n).add(n).css("cssText",dt+":"+vt+mt+";"+ht+":0"+mt+";"),u},_calculateSize:function(e){var t,n,r,i=e.precedance===H,s=this.options.width,o=this.options.height,u="c"===e.abbrev(),a=(i?s:o)*(u?.5:1),f=Math.pow,l=Math.round,c=Math.sqrt(f(a,2)+f(o,2)),h=[this.border/a*c,this.border/o*c];return h[2]=Math.sqrt(f(h[0],2)-f(this.border,2)),h[3]=Math.sqrt(f(h[1],2)-f(this.border,2)),t=c+h[2]+h[3]+(u?0:h[0]),n=t/c,r=[l(n*s),l(n*o)],i?r:r.reverse()},_calculateTip:function(e,t,n){n=n||1,t=t||this.size;var r=t[0]*n,i=t[1]*n,s=Math.ceil(r/2),o=Math.ceil(i/2),u={br:[0,0,r,i,r,0],bl:[0,0,r,0,0,i],tr:[0,i,r,0,r,i],tl:[0,0,0,i,r,i],tc:[0,i,s,0,r,i],bc:[0,0,r,0,s,i],rc:[0,0,r,o,0,i],lc:[r,0,r,i,0,o]};return u.lt=u.br,u.rt=u.bl,u.lb=u.tr,u.rb=u.tl,u[e.abbrev()]},_drawCoords:function(e,t){e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.closePath()},create:function(){var e=this.corner=(gt||st.ie)&&this._parseCorner(this.options.corner);return(this.enabled=!!this.corner&&"c"!==this.corner.abbrev())&&(this.qtip.cache.corner=e.clone(),this.update()),this.element.toggle(this.enabled),this.corner},update:function(t,n){if(!this.enabled)return this;var i,s,o,u,f,l,c,h,p=this.qtip.elements,d=this.element,v=d.children(),m=this.options,g=this.size,y=m.mimic,b=Math.round;t||(t=this.qtip.cache.corner||this.corner),y===_?y=t:(y=new L(y),y.precedance=t.precedance,"inherit"===y.x?y.x=t.x:"inherit"===y.y?y.y=t.y:y.x===y.y&&(y[t.precedance]=t[t.precedance])),s=y.precedance,t.precedance===P?this._swapDimensions():this._resetDimensions(),i=this.color=this._parseColours(t),i[1]!==vt?(h=this.border=this._parseWidth(t,t[t.precedance]),m.border&&1>h&&!yt.test(i[1])&&(i[0]=i[1]),this.border=h=m.border!==M?m.border:h):this.border=h=0,c=this.size=this._calculateSize(t),d.css({width:c[0],height:c[1],lineHeight:c[1]+"px"}),l=t.precedance===H?[b(y.x===I?h:y.x===R?c[0]-g[0]-h:(c[0]-g[0])/2),b(y.y===F?c[1]-g[1]:0)]:[b(y.x===I?c[0]-g[0]:0),b(y.y===F?h:y.y===q?c[1]-g[1]-h:(c[1]-g[1])/2)],gt?(o=v[0].getContext("2d"),o.restore(),o.save(),o.clearRect(0,0,6e3,6e3),u=this._calculateTip(y,g,xt),f=this._calculateTip(y,this.size,xt),v.attr(B,c[0]*xt).attr(j,c[1]*xt),v.css(B,c[0]).css(j,c[1]),this._drawCoords(o,f),o.fillStyle=i[1],o.fill(),o.translate(l[0]*xt,l[1]*xt),this._drawCoords(o,u),o.fillStyle=i[0],o.fill()):(u=this._calculateTip(y),u="m"+u[0]+","+u[1]+" l"+u[2]+","+u[3]+" "+u[4]+","+u[5]+" xe",l[2]=h&&/^(r|b)/i.test(t.string())?8===st.ie?2:1:0,v.css({coordsize:c[0]+h+" "+(c[1]+h),antialias:""+(y.string().indexOf(U)>-1),left:l[0]-l[2]*Number(s===P),top:l[1]-l[2]*Number(s===H),width:c[0]+h,height:c[1]+h}).each(function(e){var t=r(this);t[t.prop?"prop":"attr"]({coordsize:c[0]+h+" "+(c[1]+h),path:u,fillcolor:i[0],filled:!!e,stroked:!e}).toggle(!!h||!!e),!e&&t.html(Tt("stroke",'weight="'+2*h+'px" color="'+i[1]+'" miterlimit="1000" joinstyle="miter"'))})),e.opera&&setTimeout(function(){p.tip.css({display:"inline-block",visibility:"visible"})},1),n!==_&&this.calculate(t,c)},calculate:function(e,t){if(!this.enabled)return _;var n,i,s=this,o=this.qtip.elements,u=this.element,a=this.options.offset,f=(o.tooltip.hasClass("ui-widget"),{});return e=e||this.corner,n=e.precedance,t=t||this._calculateSize(e),i=[e.x,e.y],n===P&&i.reverse(),r.each(i,function(r,i){var u,l,h;i===U?(u=n===H?I:F,f[u]="50%",f[ct+"-"+u]=-Math.round(t[n===H?0:1]/2)+a):(u=s._parseWidth(e,i,o.tooltip),l=s._parseWidth(e,i,o.content),h=s._parseRadius(e),f[i]=Math.max(-s.border,r?l:a+(h>u?h:-u)))}),f[e[n]]-=t[n===P?0:1],u.css({margin:"",top:"",bottom:"",left:"",right:""}).css(f),f},reposition:function(e,t,r){function i(e,t,n,r,i){e===W&&f.precedance===t&&l[r]&&f[n]!==U?f.precedance=f.precedance===P?H:P:e!==W&&l[r]&&(f[t]=f[t]===U?l[r]>0?r:i:f[t]===r?i:r)}function s(e,t,i){f[e]===U?m[ct+"-"+t]=v[e]=o[ct+"-"+t]-l[t]:(u=o[i]!==n?[l[t],-o[t]]:[-l[t],o[t]],(v[e]=Math.max(u[0],u[1]))>u[0]&&(r[t]-=l[t],v[t]=_),m[o[i]!==n?i:t]=v[e])}if(this.enabled){var o,u,a=t.cache,f=this.corner.clone(),l=r.adjusted,h=t.options.position.adjust.method.split(" "),p=h[0],d=h[1]||h[0],v={left:_,top:_,x:0,y:0},m={};this.corner.fixed!==M&&(i(p,P,H,I,R),i(d,H,P,F,q),f.string()===a.corner.string()||a.cornerTop===l.top&&a.cornerLeft===l.left||this.update(f,_)),o=this.calculate(f),o.right!==n&&(o.left=-o.right),o.bottom!==n&&(o.top=-o.bottom),o.user=this.offset,(v.left=p===W&&!!l.left)&&s(P,I,R),(v.top=d===W&&!!l.top)&&s(H,F,q),this.element.css(m).toggle(!(v.x&&v.y||f.x===U&&v.y||f.y===U&&v.x)),r.left-=o.left.charAt?o.user:p!==W||v.top||!v.left&&!v.top?o.left+this.border:0,r.top-=o.top.charAt?o.user:d!==W||v.left||!v.left&&!v.top?o.top+this.border:0,a.cornerLeft=l.left,a.cornerTop=l.top,a.corner=f.clone()}},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),lt=X.tip=function(e){return new N(e,e.options.style.tip)},lt.initialize="render",lt.sanitize=function(e){if(e.style&&"tip"in e.style){var t=e.style.tip;"object"!=typeof t&&(t=e.style.tip={corner:t}),/string|boolean/i.test(typeof t.corner)||(t.corner=M)}},A.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(e){this.size=[e.width,e.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},r.extend(M,C.defaults,{style:{tip:{corner:M,mimic:_,width:6,height:6,border:M,offset:0}}}),X.viewport=function(n,r,i,s,o,u,f){function l(e,t,n,i,s,o,u,a,f){var l=r[s],c=x[e],p=T[e],b=n===W,E=c===s?f:c===o?-f:-f/2,S=p===s?a:p===o?-a:-a/2,N=y[s]+w[s]-(v?0:d[s]),C=N-l,k=l+f-(u===B?m:g)-N,L=E-(x.precedance===e||c===x[t]?S:0)-(p===U?a/2:0);return b?(L=(c===s?1:-1)*E,r[s]+=C>0?C:k>0?-k:0,r[s]=Math.max(-d[s]+w[s],l-L,Math.min(Math.max(-d[s]+w[s]+(u===B?m:g),l+L),r[s],"center"===c?l-E:1e9))):(i*=n===z?2:0,C>0&&(c!==s||k>0)?(r[s]-=L+i,h.invert(e,s)):k>0&&(c!==o||C>0)&&(r[s]-=(c===U?-L:L)+i,h.invert(e,o)),r[s]<y&&-r[s]>k&&(r[s]=l,h=x.clone())),r[s]-l}var c,h,p,d,v,m,g,y,w,E=i.target,S=n.elements.tooltip,x=i.my,T=i.at,N=i.adjust,C=N.method.split(" "),k=C[0],L=C[1]||C[0],A=i.viewport,O=i.container,M=n.cache,D={left:0,top:0};return A.jquery&&E[0]!==e&&E[0]!==t.body&&"none"!==N.method?(d=O.offset()||D,v="static"===O.css("position"),c="fixed"===S.css("position"),m=A[0]===e?A.width():A.outerWidth(_),g=A[0]===e?A.height():A.outerHeight(_),y={left:c?0:A.scrollLeft(),top:c?0:A.scrollTop()},w=A.offset()||D,("shift"!==k||"shift"!==L)&&(h=x.clone()),D={left:"none"!==k?l(P,H,k,N.x,I,R,B,s,u):0,top:"none"!==L?l(H,P,L,N.y,F,q,j,o,f):0},h&&M.lastClass!==(p=V+"-pos-"+h.abbrev())&&S.removeClass(n.cache.lastClass).addClass(n.cache.lastClass=p),D):D},X.polys={polygon:function(e,t){var n,r,i,s={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:_},o=0,u=[],a=1,f=1,l=0,c=0;for(o=e.length;o--;)n=[parseInt(e[--o],10),parseInt(e[o+1],10)],n[0]>s.position.right&&(s.position.right=n[0]),n[0]<s.position.left&&(s.position.left=n[0]),n[1]>s.position.bottom&&(s.position.bottom=n[1]),n[1]<s.position.top&&(s.position.top=n[1]),u.push(n);if(r=s.width=Math.abs(s.position.right-s.position.left),i=s.height=Math.abs(s.position.bottom-s.position.top),"c"===t.abbrev())s.position={left:s.position.left+s.width/2,top:s.position.top+s.height/2};else{for(;r>0&&i>0&&a>0&&f>0;)for(r=Math.floor(r/2),i=Math.floor(i/2),t.x===I?a=r:t.x===R?a=s.width-r:a+=Math.floor(r/2),t.y===F?f=i:t.y===q?f=s.height-i:f+=Math.floor(i/2),o=u.length;o--&&!(u.length<2);)l=u[o][0]-s.position.left,c=u[o][1]-s.position.top,(t.x===I&&l>=a||t.x===R&&a>=l||t.x===U&&(a>l||l>s.width-a)||t.y===F&&c>=f||t.y===q&&f>=c||t.y===U&&(f>c||c>s.height-f))&&u.splice(o,1);s.position={left:u[0][0],top:u[0][1]}}return s},rect:function(e,t,n,r){return{width:Math.abs(n-e),height:Math.abs(r-t),position:{left:Math.min(e,n),top:Math.min(t,r)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(e,t,n,r,i){var s=X.polys._angles[i.abbrev()],o=0===s?0:n*Math.cos(s*Math.PI),u=r*Math.sin(s*Math.PI);return{width:2*n-Math.abs(o),height:2*r-Math.abs(u),position:{left:e+o,top:t+u},adjustable:_}},circle:function(e,t,n,r){return X.polys.ellipse(e,t,n,n,r)}},X.svg=function(e,n,i){for(var s,o,u,a,f,l,c,h,p,d,v,m=r(t),g=n[0],y=r(g.ownerSVGElement),w=1,E=1,S=!0;!g.getBBox;)g=g.parentNode;if(!g.getBBox||!g.parentNode)return _;s=y.attr("width")||y.width()||parseInt(y.css("width"),10),o=y.attr("height")||y.height()||parseInt(y.css("height"),10);var x=(parseInt(n.css("stroke-width"),10)||0)/2;switch(x&&(w+=x/s,E+=x/o),g.nodeName){case"ellipse":case"circle":d=X.polys.ellipse(g.cx.baseVal.value,g.cy.baseVal.value,(g.rx||g.r).baseVal.value+x,(g.ry||g.r).baseVal.value+x,i);break;case"line":case"polygon":case"polyline":for(p=g.points||[{x:g.x1.baseVal.value,y:g.y1.baseVal.value},{x:g.x2.baseVal.value,y:g.y2.baseVal.value}],d=[],h=-1,l=p.numberOfItems||p.length;++h<l;)c=p.getItem?p.getItem(h):p[h],d.push.apply(d,[c.x,c.y]);d=X.polys.polygon(d,i);break;default:d=g.getBoundingClientRect(),d={width:d.width,height:d.height,position:{left:d.left,top:d.top}},S=!1}return v=d.position,y=y[0],S&&(y.createSVGPoint&&(u=g.getScreenCTM(),p=y.createSVGPoint(),p.x=v.left,p.y=v.top,a=p.matrixTransform(u),v.left=a.x,v.top=a.y),y.viewBox&&(f=y.viewBox.baseVal)&&f.width&&f.height&&(w*=s/f.width,E*=o/f.height)),v.left+=m.scrollLeft(),v.top+=m.scrollTop(),d}})}(window,document),define("chrome/views/header",["vendor","views","text!chrome/templates/header.html","chrome/models/header","registration","login","signup","signup/views/shopopup","utils/storage","signup/views/facebooksignup","vendor/plugins/qtip/qtip"],function(e,t,n,r,i,s,o,u,a){var f,l=require("signup/views/facebooksignup"),c=t.BaseView,h=e.$,p=e._,d=e.Mustache;return f=c.extend({tagName:"header",className:"container-fluid clearfix",initialize:function(e){this.template=n,Channel("load:css").publish(["vendor/plugins/qtip/qtip.css"])},model:new r,events:{"click .signup-facebook":"signupFacebook","click .signup-email":"signupUser","click .account clearfix a":"login","click #userlogin":"userLogin","click #logoutId":"LogoutUser"},linkToFacebook:function(){console.log("link to fb called"),routing.trigger("link-to-facebook")},render:function(e){var t=this;return this.model.fetchSuccess=this.model.fetchError=function(n,r){console.log("MODEL:",n.toJSON());var i=p.template(t.template,n.toJSON());t.$el.html(i);if(typeof n.get("user_photo")=="object"&&typeof n.get("user_photo").types=="object")if(typeof n.get("user_photo").types.small_thumb=="object")var s=n.get("user_photo").types.small_thumb.url;else if(typeof n.get("user_photo").types.large_thumb=="object")var s=n.get("user_photo").types.large_thumb.url;else if(typeof n.get("user_photo").types.original=="object")var s=n.get("user_photo").types.original.url;else var s="";t.$(".photo img").attr("src",s);var o=n.get("authorized");if(o){var u=n.get("id");t.model.saveCookie(),routing.userLoggedIn=!0,routing.loggedInUserId=u,e||routing.trigger("app-inited",u)}else routing.userLoggedIn=!1,e||routing.trigger("app-inited");h("#main").removeClass("region-loader"),h(document).off("click","a[href*='#fbinvite']"),h(document).on("click","a[href*='#fbinvite']",function(e){e.preventDefault(),routing.trigger("fbInvite")}),t.bindDropdowns()},this.model.fetch(),this},bindDropdowns:function(){var e=this;this.$el.find("a.nav_dropdown").each(function(){console.log(this),h(this).qtip({content:h(this).next("ul.header_menu"),position:{my:"top center",at:"bottom center",viewport:h(window)},style:{classes:"tipsy header-dropdown",width:"360px"},hide:{fixed:!0,delay:500},events:{render:function(t,n){h(n.elements.tooltip).find(".link-to-fb-h").on("click",e.linkToFacebook)}}})})},userLogin:function(e){e.preventDefault(),this.logincontroller=new LoginController,routing.trigger("Login")},signupFBTest:function(e){},signupFacebook:function(e){e.preventDefault(),headView=new l,headView.signupFacebook()},signupUser:function(e){this.signupc=new o({route:""}),routing.trigger("register-basic",e),this.pop=new u},LogoutUser:function(e){e.preventDefault(),this.logincontroller||(this.logincontroller=new LoginController),routing.trigger("Logout",this.model)}}),f}),define("text!chrome/templates/main.html",[],function(){return"\r\n\r\n"}),define("chrome/models/main",["models/base"],function(e){var t;return t=e.extend({defaults:{}}),t}),define("chrome/views/main",["vendor","views","text!chrome/templates/main.html","chrome/models/main"],function(e,t,n,r){var i,s=t.BaseView,o=e.$,u=e._,a=e.Mustache;return i=s.extend({id:"main",className:"clear clearfix",initialize:function(e){this.template=n},model:new r,render:function(){var e=a.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("text!chrome/templates/footer.html",[],function(){return'<!--<div style="\r\n    position: fixed;\r\n    left: 0px;\r\n    bottom: 0;\r\n    height: 20px;\r\n    width: 20px;\r\n    text-align: center;\r\n    font-weight: bold;\r\n    font-size: 2em;\r\n    padding: 15px;\r\n    background: #000000;"><img src="http://athletez.s3.amazonaws.com/resources/img/A_small.png" /></div>-->'}),define("chrome/models/footer",["models/base"],function(e){var t;return t=e.extend({defaults:{}}),t}),define("chrome/views/footer",["vendor","views","text!chrome/templates/footer.html","chrome/models/footer"],function(e,t,n,r){var i,s=t.BaseView,o=e.$,u=e._,a=e.Mustache;return i=s.extend({tagName:"footer",className:"container-fluid clearfix",initialize:function(e){this.template=n},model:new r,render:function(){var e=a.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("chrome",["chrome/views/header","chrome/views/main","chrome/views/footer"],function(e,t,n){var r;return r=function(){$("#main").unbind().empty().addClass("region-loader"),App.header?App.header.render():(App.header=new e,App.header.render().$el.prependTo("body"));if(!$("#main").length){var r=new t;r.render().$el.appendTo("body")}if(!$("footer.container-fluid").length){var i=new n;i.render().$el.appendTo("body")}!$(".common-modal").length},r}),define("text!profile/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header" class="profile-header"></div>\r\n	<div class="green-left-heading">MESSAGE BOARD</div>\r\n	<div id="commenton-wrap" class="clearfix clear profile-comment-list-box"></div>\r\n	<div id="comment_div" class="clearfix"></div>\r\n	\r\n	\r\n	<div class="media-add-icons-h"></div>\r\n	<!-- <div class="green-left-heading"></div> -->\r\n	<div class="row-fluid" id="main-content">\r\n	<!-- <div id="video-wrap" class="clearfix"></div> -->\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<!--div id="add-media" class="clearfix">add media</div-->\r\n	</div>\r\n\r\n\r\n	<div class="green-left-heading">GAMES / EVENTS</div>\r\n	<div id="games_div" class="clearfix">		\r\n	</div>\r\n	<div class="fans-add-icons-h"></div>\r\n	<div id="fans-div" class="clearfix clear">&nbsp;</div>\r\n	\r\n	<div id="main-footer">\r\n	</div>\r\n</div>\r\n'}),define("text!votes/templates/vote.html",[],function(){return'{{#payload}}\r\n<a href="javascript:void(0);" class="vote {{#has_voted}}team-noaction-h link-disabled{{/has_voted}}{{^has_voted}}team-action-h{{/has_voted}}">Vote</a>\r\n<a href="javascript:void(0);" class="follow {{#is_following}}follow-noaction-h link-disabled{{/is_following}}{{^is_following}}follow-action-h{{/is_following}}">Follow</a>\r\n{{/payload}}'}),define("votes/models/vote",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/vote/add?subject_type_id="+this.entity_id+"&subject_id="+this.subject_id},setData:function(){this.set({subject_type_id:this.entity_id,subject_id:this.subject_id})}}),n}),define("votes/models/follow",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/ent/follow/"+this.entity_id+"/"+this.subject_id}}),n}),define("votes/views/vote-section",["require","text!votes/templates/vote.html","views","vendor","facade","utils","jqueryui","controller","votes/models/vote","votes/models/follow"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("votes/models/vote"),d=e("votes/models/follow");return n=o.extend({template:t,events:{"click .team-action-h":"vote","click .follow-action-h":"follow"},vote:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.voteModelOb.save(),u.when(this.voteModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")})},follow:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.followModelOb.save(),u.when(this.followModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled")}),h("new-fan").publish()},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){var t=this;a.bindAll(this),o.prototype.initialize.call(this,e)},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=this.model.get("payload");r.has_voted?this.$el.find(".team-action-h").addClass("link-disabled"):(this.voteModelOb=new p,this.voteModelOb.subject_id=r.id,this.voteModelOb.entity_id=r.enttypes_id,this.voteModelOb.setData()),r.is_following?this.$el.find(".follow-action-h").addClass("link-disabled"):(this.followModelOb=new d,this.followModelOb.subject_id=r.id,this.followModelOb.entity_id=r.enttypes_id)}}),n}),define("profile/models/basics",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("profile/models/addmedia",["models/base"],function(e){var t;return t=e.extend({sportName:undefined,firstName:undefined,defaults:{links:[{label:"Add "+this.sportName+" pics of "+this.firstName,link:"javascript:void(0);",id:"addPhoto"},{label:"Add "+this.sportName+" videos of "+this.firstName,link:"javascript:void(0);",id:"addVideo"}],userid:null},setData:function(){this.set({links:[{label:"Add "+this.sportName+" pics of "+this.firstName,link:"javascript:void(0);",id:"addPhoto"},{label:"Add "+this.sportName+" videos of "+this.firstName,link:"javascript:void(0);",id:"addVideo"}],userid:null})}}),t}),define("sportorg/models/org",["facade","models/base"],function(e,t){var n,r=e._,i=e.Backbone;return n=t.extend({initialize:function(e){e&&e.id&&(this.id=e.id)},methodToURL:{read:function(e){console.log(e);var t="/api/org/basics/"+e.id;return t},create:"/api/org/add/",update:function(e){var t="/api/org/basics/";return e.id&&(t+=e.id),t},"delete":function(e){return"/api/org/delete"+e.id}},sync:function(e,t,n){return n=n||{},n.url=typeof t.methodToURL[e.toLowerCase()]=="function"?t.methodToURL[e.toLowerCase()](t):t.methodToURL[e.toLowerCase()],i.sync.apply(this,arguments)}}),n}),define("sportorg/collections/orgs",["facade","collections","sportorg/models/org","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){var e=this,t="/api/org/search?sports_club="+encodeURIComponent(e.sports_club)+"&states_id="+encodeURIComponent(e.states_id)+"&org_name="+encodeURIComponent(e.org_name);return e.single_sport_id&&(t+="&single_sport_id="+e.single_sport_id),t},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5);var o=r[i],u=o.teams,a=[];for(var f in u){var l=u[f];a.push(l)}o.teams=a,s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),i}),define("profile/collections/orgs",["facade","sportorg/collections/orgs","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/orgs/"+this.id+"/"+this.sport_id:"/api/user/orgs/"+this.id+"?sport_id="+this.sport_id+"&_="+(new Date).getTime()}}),r}),define("user/models/related",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{user_id:0,user_name:null,user_picture:null,teams:[{sport:null,position:null,org:null,season:null,year:null}],num_votes:0,num_followers:0},desc:"Related user information about the user",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("user/collections/relateds",["facade","collections","user/models/related","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("profile/collections/relateds",["facade","user/collections/relateds","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?"/test/user/related/"+this.id+"/"+this.sport_id:"/api/user/related/"+this.id+"?sport_id="+this.sport_id}}),r}),define("user/models/fitnessbasic",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,val:null,units:null},desc:"Fitness Basic information about the user",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("user/collections/fitnessbasics",["facade","collections","user/models/fitnessbasic","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5);var o=[];for(var u in r[i].data)o.push(r[i].data[u]);o={data:o},s.set("payload",o),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profile/collections/fitnessbasics",["facade","user/collections/fitnessbasics","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/rdtree/"+this.id+"/?overview=1&sports_id="+this.sport_id:"/api/user/rdtree/"+this.id+"?overview=1&sports_id="+this.sport_id}}),r}),define("media/models/video",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{video_id:0,video_title:null,video_quality:0,video_thumb:null,video_src:null,org_name:null,teams:[{complevel:null,season:null,grad_year:0,team_name:null,schedule:{schedule_date:null,other_team:null,schedule_summary:null}}],games:[{team1_name:null,team2_name:null}],video_desc:null,user_name:null,post_date:null,tags_count:0,tags:[],num_votes:0,num_views:0,num_comments:0,social_links:[{"class":null,title:null,link:null}]},desc:"Video information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("media/collections/videos",["facade","collections","media/models/video","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profile/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/videos/"+this.id+"/"+this.sport_id:"/api/user/videos/"+this.id+"?sport_id="+this.sport_id}}),r}),define("profile/collections/image-videos",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({limit:8,offset:0,url:function(){if(testpath)return testpath+"/user/media/"+this.id+"/"+this.sport_id;var e=this.limit?"&limit="+this.limit:"";return"/api/user/media/"+this.id+"?offset="+this.offset+e+"&sport_id="+this.sport_id}}),r}),define("site/models/comment",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("site/collections/comments",["facade","collections","site/models/comment","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profile/collections/commentsof",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/commentsof/"+this.id:"/api/user/commentsof/"+this.id}}),r}),define("profile/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/comment/getall/"+this.id:"/api/comment/getall/?subject_enttypes_id="+this.subject_entity_type+"&subject_id="+this.id}}),r}),define("sportorg/models/team",["facade","models/base"],function(e,t){var n,r=e._,i=e.Backbone;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,location:null,picture:null,sport:null,complevel:null,season:null,year:null,mascot:null,unique_ident:null,statvals:[{statval:null,statdate:null,statteam:null,stat_context:null}]},desc:"Team information",exec_data:{exec_time:0,exec_error:!1}}),url:function(){return"/api/team/basics/"+this.id},parseAsRequired:function(e){return e}}),n}),define("schedules/collections/user-games",["facade","collections","sportorg/models/team","utils"],function(e,t,n,r){var i=t.BaseCollection,s=e._,o=r.lib.Channel;return i.extend({userId:undefined,sports_id:undefined,model:e.Backbone.Model.extend({}),url:function(){return"/api/user/games/"+this.userId+"?sports_id="+this.sports_id},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5);var o=r[i];o.is_race=parseInt(o.is_race)>0?!0:!1,s.set("payload",o),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}console.log("Updtaed Collection",e),e.deferred.resolve(t)}})}),define("profile/collections/fans",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/followers/"+this.id+"/"+this.sport_id:"/api/user/followers/"+this.id+"?sport_id="+this.sport_id}}),r}),define("text!profile/templates/header.html",[],function(){return'{{#payload}}\r\n<div class="row-fluid">\r\n	<div class="profile-heading" itemscope itemtype="http://schema.org/Person">\r\n		<div class="sports-h"></div>\r\n		<h3 class="username" itemprop="name">{{name}}</h3><h3> {{#grad_year}}\'{{grad_year}}{{/grad_year}}</h3>\r\n		<h4 class="sports-name-h"></h4>\r\n	</div>\r\n\r\n	<div class="row-fluid profile-pic-outer">\r\n		<div class="span7 border-right">\r\n			<ul class="span6 textcenter image-outer-h"></ul>\r\n			<div class="span6">\r\n				<div class="teams">\r\n					<h4 class="hide">Teams</h4>\r\n					<div id="sports-info"></div>\r\n					<a href="javascript: void(0);" class="see-more-teams-h hide">Show All</a>\r\n				</div>\r\n			</div>\r\n		</div>\r\n		\r\n		<div class="stats-panel span5" style="width:35%;">\r\n			<div class="stats-header">\r\n				<span id="profileName"></span>Stats{{#loggedInUser}}<span class="edit-message">Click an entry to edit</span>{{/loggedInUser}}\r\n			</div>\r\n			<div id="fitnessbasic-wrap"></div>\r\n		</div>\r\n	</div>\r\n			<div class="profile-info">\r\n			{{#height_ft}}\r\n				<div class="height">\r\n					Height: {{height_ft}}\r\n				</div>\r\n				{{/height_ft}}\r\n				{{#weight_lb}}\r\n				<div class="weight">\r\n					Weight: {{weight_lb}} lbs\r\n				</div>\r\n			{{/weight_lb}}\r\n		</div>\r\n\r\n</div>\r\n</div>\r\n{{/payload}}\r\n'}),define("text!profile/templates/sports.html",[],function(){return'{{#payload}}\r\n    <img src="{{large_icon}}" class="sports-icon-h" data-name="{{sport_name}}" data-sporttype="{{sport_type_id}}" data-id="{{id}}" />\r\n{{/payload}}\r\n'}),define("profile/collections/sports",["facade","sportorg/collections/sports","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/user/sports/"+this.id:"/api/user/sports/"+this.id}}),r}),define("text!profile/templates/sport-team.html",[],function(){return'{{#records}}\r\n	{{#payload}}\r\n	{{#name}}\r\n	<div>\r\n		<span class="icon-circle-arrow-right team-list-icon"></span><div class="teamlist-header">{{name}}</div>\r\n		{{#sports}}\r\n		 <span class="team-item list-container" style="display: none;">\r\n				{{#teams}}\r\n				   <a  title="{{complevel}} {{season}} {{year}}" href="/#!team/{{id}}" style="display: block;">{{complevel}} {{season}} {{year}}</a>\r\n			    {{/teams}}\r\n		</span>\r\n	    {{/sports}}\r\n    </div>\r\n    {{/name}}\r\n{{/payload}}\r\n{{/records}}'}),define("sportorg/collections/teams",["facade","collections","sportorg/models/team","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}console.log("Updtaed Collection",e),e.deferred.resolve(t)}}),i}),define("profile/collections/teams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return"/api/user/teamlist/"+this.id+"?sports_id="+this.sports_id}}),r}),define("text!sportorg/templates/team-item.html",[],function(){return'\r\n	<!--<a href="/#!game/{{id}}" class="background-blue team-info-h" tooltip="test">\r\n	<div class="game-info hide">\r\n		{{summary}}\r\n	</div> </a>\r\n-->'}),define("sportorg/views/team-item",["vendor","views","utils","text!sportorg/templates/team-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"team",events:{"mouseover .team-info-h":"showinfo","mouseout .team-info-h":"showinfo"},showinfo:function(e){e.preventDefault(),s(e.target).parents(".game-info").length||(s(e.target).find(".game-info").hasClass("hide")?s(e.target).find(".game-info").removeClass("hide"):s(".game-info").addClass("hide"))},initialize:function(e){this.teams_id=e.teams_id||null,console.log("Teams_id:",e),this.mpay=this.model.get("payload"),console.log("Team Item View",this.mpay),this.template=r},render:function(){var e=this.createOpponentString(),t=u.to_html(this.template,{id:this.mpay.id,summary:e});return this.$el.html(t),this},createOpponentString:function(){var e=this.mpay.game_day+" | ";return console.log("Game info",this.mpay),s.each(this.mpay.teams,function(){this.id>0&&this.id!=this.teams_id&&(e+=" VS. "+this.org_name)}),e}}),i}),define("text!sportorg/templates/team-list.html",[],function(){return'{{#data}}\r\n<div class="select-team">\r\n	<div class="game-box-outer">\r\n		<ul class="team-list-h">\r\n			\r\n		</ul>\r\n	</div>\r\n</div>\r\n</div>\r\n{{/data}}\r\n{{^data}}\r\n<div class="info">	\r\n	No games on the docket.  <a href="javascript: void(0);" title="add game" class="add-game-h">Click here to Add Game.</a>\r\n</div>\r\n{{/data}}\r\n'}),define("sportorg/views/team-list",["vendor","facade","views","utils","sportorg/views/team-item","text!sportorg/templates/team-list.html","utils/storage"],function(e,t,n,r,i,s,o){var u,a,f=t.$,l=t._,c=r.lib.Channel,h=n.CollectionView,p=e.Mustache;return SectionView=n.SectionView,a=h.extend(SectionView.prototype),u=a.extend({__super__:h.prototype,name:"Team List",events:{"click .add-game-h":"addGame"},_tagName:"li",_className:"team",template:s,_view:i,listView:".team-list-h",initialize:function(e){this.renderTemplate(),h.prototype.initialize.call(this,e);if(!this.collection)throw new Error("TeamListView expected options.collection.");l.bindAll(this),this.addSubscribers()},addGame:function(){var e=new o("user","localStorage");console.log(e.data);var t=0;if(e.data)for(var n in e.data){t=n;break}t&&routing.trigger("add-game",t)},renderTemplate:function(){var e={};e.data=this.collection.toJSON(),console.log("Schedule Data",e.data);var t=p.to_html(this.template,e);return this.$el.html(t),this}}),u}),define("profile/views/sport-item",["vendor","views","utils","text!profile/templates/sport-team.html","profile/collections/teams","sportorg/views/team-list"],function(e,t,n,r){var i,s=e.$,o=t.SectionView,u=e.Mustache,a=n.lib.Channel,f=require("sportorg/views/team-list"),l=require("profile/collections/teams");return i=o.extend({tagName:"li",className:"sport",initialize:function(e){function i(e){t.initTeamList(),console.log("CALLED REFRESH PROFILE CHANNEL"),a("refresh-profilepage").publish(e)}this.template=r;var t=this;this.id=e.model.collection.id;var n=this.model.get("payload").sport_id;routing.off("showTwmList"),routing.on("showTwmList",function(e){i(e)})},initTeamList:function(){var e=this,t=s(".sports-h img.selected-sport-h").data("id");this.teams=new l,this.teams.id=this.id,this.teams.sports_id=t,this.teams.fetch(),s.when(this.teams.request).done(function(){e.setupTeamListView()})},setupTeamListView:function(){var e=this,t=undefined;console.log("TEAMS===================================",this.teams);try{var t=this.teams.at(0);t.get("payload").sports[0]?s(".teams h4").removeClass("hide"):s(".teams h4").addClass("hide")}catch(n){s(".teams h4").addClass("hide")}var r=t&&t.get("payload").sports?t.get("payload").sports.length:0;if(r>2){s(".see-more-teams-h").html("Show All "+(r-2)),s(".see-more-teams-h").removeClass("hide"),this.allSportsRecords=this.teams.toArray();var i=this.allSportsRecords.slice(0,2);this.teams.reset(i),s(".see-more-teams-h").click(function(){s(this).addClass("hide"),e.teams.reset(e.allSportsRecords),e.showTeamView()})}else s(".see-more-teams-h").addClass("hide");this.showTeamView()},showTeamView:function(){var e={};e.records=this.teams.toJSON();var t=u.to_html(this.template,e);this.$el.html(t)},render:function(){var e=this,t=u.to_html(this.template,this.model.toJSON());return this.$el.html(t),this}}),i}),define("profile/views/sport-list",["facade","views","utils","profile/views/sport-item"],function(e,t,n,r){var i,s,o=e._,u=t.CollectionView,a=t.SectionView;return s=u.extend(a.prototype),i=s.extend({__super__:u.prototype,id:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,showList:function(e){var t=$(e.target).next("span.list-container");console.error(t.css("display")),t.css("display")==="none"?($(e.target).prev(".team-list-icon").removeClass("icon-circle-arrow-right").addClass("icon-circle-arrow-down"),t.slideDown()):($(e.target).prev(".team-list-icon").removeClass("icon-circle-arrow-down").addClass("icon-circle-arrow-right"),t.slideUp())},initialize:function(e){u.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");o.bindAll(this),this.addSubscribers();var t=this;$(document).off("click",".teamlist-header, .team-list-icon"),$(document).on("click",".teamlist-header, .team-list-icon",function(e){t.showList(e)})}}),i}),define("text!media/templates/image-item.html",[],function(){return'<a href="{{_link}}" data-index="{{index}}" data-id="{{_media_id}}" class="image-outer-h {{^_has_link}}open-photo-player-h{{/_has_link}}">\r\n	<div class="image-item-container">\r\n		{{#_thumbnail}}<img itemprop="image" class="list-thumbnail" src="{{_thumbnail}}" alt=""/>{{/_thumbnail}}\r\n		{{^_thumbnail}}\r\n\r\n			<div class="game-tile">{{_noicon_text}}</div>\r\n			<div class="back-cover">{{#_sports_icon}}<img src="{{_sports_icon}}" class="sports-icon" />{{/_sports_icon}}</div>\r\n\r\n		{{/_thumbnail}}\r\n		<div class="action-section">\r\n\r\n\r\n				<div class="action-block left-block vote vote-h {{#_has_voted}} link-disabled {{/_has_voted}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}">\r\n					<span>vote{{#_has_voted}}d{{/_has_voted}}</span>\r\n				</div>\r\n				{{#_can_follow}}\r\n				<div class="action-block right-block follow follow-h {{#_is_following}} link-disabled {{/_is_following}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>follow{{#_is_following}}ing{{/_is_following}}</span></div>\r\n				{{/_can_follow}}\r\n\r\n			{{#show_delete}}\r\n			<!--<div class="action-block left-block edit edit-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>edit</span></div>-->\r\n			<div class="action-block right-block delete delete-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>delete</span></div>\r\n			{{/show_delete}}\r\n			{{#usl_game_link_id}}\r\n			{{#show_edit}}\r\n			<div class="action-block right-block edit edit-h" subject-type-id="{{usl_enttype_id}}" subject-id="{{usl_game_link_id}}"><span>edit</span></div>\r\n			<div class="action-block left-block delete-from-game delete-h" subject-type-id="{{usl_enttype_id}}" subject-id="{{usl_game_link_id}}"><span>remove</span></div>\r\n			{{/show_edit}}\r\n			{{/usl_game_link_id}}\r\n\r\n		</div>\r\n		<div class="detail-view {{#_detailclass}}{{_detailclass}}{{/_detailclass}}">\r\n			{{#_label}}<h6>{{_label}}</h6>{{/_label}}\r\n			{{#_sublabel}}\r\n				{{#label}}\r\n					<span>{{label}}</span>\r\n				{{/label}}\r\n				{{^label}}\r\n					<span itemprop="description">{{_sublabel}}</span>\r\n				{{/label}}\r\n			{{/_sublabel}}\r\n			<div style="display: block; min-height: 150px;">&nbsp;</div>\r\n			{{#meta}}\r\n				<div itemprop="{{itemprop}}">{{content}}</div>\r\n			{{/meta}}\r\n		</div>\r\n	</div>\r\n</a>'}),define("common/models/delete",["models","facade"],function(e,t){var n=e.BaseModel,r=t.Backbone,i=t.$,s=t._;return n.extend({subject_id:undefined,enttypes_id:undefined,removeNode:undefined,id:1,url:function(){return"/api/ent/delete/"+this.enttypes_id+"/"+this.subject_id},destroyAndRemove:function(){if(confirm("Are you sure you want to delete this?")){var e=this;this.destroy({success:function(t,n){e.removeNode.remove()}})}}})}),define("common/models/entparse",["models","facade"],function(e,t){var n=e.BaseModel,r=t.Backbone,i=t.$,s=t._;return n.extend({mpay:{},thumb_size:220,display_width:220,display_height:220,parsedData:{},initialize:function(e){e.mpay&&(this.mpay=e.mpay),e.thumb_size&&(this.thumb_size=e.thumb_size),e.display_width&&(this.display_width=e.display_width),e.display_height&&(this.display_height=e.display_height),this.parseResult()},ucwords:function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},findCorrectType:function(e){var t=!1,n=this;s.each(e,function(e){t=t||e,e.height>=n.display_height&&e.width>=n.display_width&&(t.height<n.display_height&&t.width<n.display_width?t=e:t.height>e.height&&t.width>e.width&&(t=e))}),this.closest_image_format=t},parseResult:function(){var e=this,t=this.mpay,n={_enttypes_id:t.enttypes_id,_id:t.id,_has_voted:t.has_voted,_is_following:t.is_following,_can_follow:t.can_follow,show_play:!1,show_delete:!1,show_edit:!1};switch(t.enttypes_id){case"23":n=e.parse_video(t,n);break;case"21":n=e.parse_image(t,n);break;case"1":n=e.parse_user(t,n);break;case"8":n=e.parse_game(t,n);break;case"2":n=e.parse_org(t,n);break;case"5":n=e.parse_team(t,n)}e.closest_image_format!="undefined"&&e.closest_image_format!=null?n=e.imageFormat(n):n.imgData="",e.parsedData=n,console.log(n)},get_selected_icon:function(e,t){if(!t)var t="large";if(t=="large")var n=e.large_icon;if(t=="small")var n=e.small_icon;return n.split(".png")[0]+"_selected.png"},parse_team:function(e,t){return typeof e.picture_obj=="object"&&e.picture_obj!=null&&typeof e.picture_obj.types=="object"&&this.findCorrectType(e.picture_obj.types),t._noicon_text=e.org_name,t._color="#928add",t._sports_icon=this.get_selected_icon(e.org_sport_link_obj.sport),t._label=e.complevels_obj.abbr+" "+e.org_sport_link_obj.sport.sport_name+" "+e.year,t._sublabel="Votes: "+e.num_votes+", Followers: "+e.num_followers,t._link="/#!team/"+e.id,t._has_link=!0,e.hasOwnProperty("is_owner")&&(t.show_delete=e.is_owner),t.itemtype="http://schema.org/Organization",t.meta=[{itemprop:"name",content:e.team_name},{itemprop:"address",content:e.team_location},{itemprop:"url",content:t._link}],t},parse_org:function(e,t){return t._noicon_text="org",t._color="#928add",t._label=e.name,t._sublabel="Votes: "+e.num_votes+", Followers: "+e.num_followers,t._link="/#!team/"+e.id,t._has_link=!0,e.hasOwnProperty("is_owner")&&(t.show_delete=e.is_owner),t.itemtype="http://schema.org/Organization",t.meta=[{itemprop:"name",content:e.org_name},{itemprop:"address",content:e.org_location},{itemprop:"url",content:t._link}],t},parse_user:function(e,t){return typeof e.user_picture_obj=="object"&&typeof e.user_picture_obj.types=="object"&&this.findCorrectType(e.user_picture_obj.types),parseInt(e.usl_game_link_id)>0&&(t.usl_game_link_id=e.usl_game_link_id,t.usl_enttype_id=e.usl_enttype_id),e.can_edit==1&&(t.show_edit=!0),e.result_time&&e.result_time!="00:00:00:00"?t._sublabel="Result Time: "+e.result_time:t._sublabel="Votes: "+e.num_votes+", Followers: "+e.num_followers,t._noicon_text="hi",t._color="#c4df89",t._label=e.label,t._link="/#!profile/"+e.id,t._has_link=!0,e.hasOwnProperty("is_owner")&&(t.show_delete=e.is_owner),t.itemtype="http://schema.org/Person",t.meta=[{itemprop:"name",content:e.name},{itemprop:"url",content:t._link}],t},parse_video:function(e,t){return typeof e.standard_thumb=="object"?(this.closest_image_format=e.standard_thumb,t._thumbnail=this.closest_image_format.url):t._thumbnail=e.thumbs,t.show_play=!0,t._enttypes_id=typeof (e.media=="object")?e.media.enttypes_id:0,t._id=typeof (e.media=="object")?e.media.id:0,t._label=e.media.name,t._link="javascript: void(0);",t._has_link=!1,e.media.hasOwnProperty("is_owner")&&(t.show_delete=e.media.is_owner),t._noicon_text="play",t._color="#e27171",t},parse_image:function(e,t){t._enttypes_id=typeof (e.media_obj=="object")?e.media_obj.enttypes_id:0,t._id=typeof (e.media_obj=="object")?e.media_obj.id:0,typeof e.types=="object"&&this.findCorrectType(e.types),console.log(e.media_obj);var n=!s.isUndefined(e.media_obj.users_obj)&&!s.isUndefined(e.media_obj.users_obj.label)?e.media_obj.users_obj.label:!1;if(typeof e.media_obj.sports_obj=="object"){var r;parseInt(e.media_obj.sports_obj.male)==1&&parseInt(e.media_obj.sports_obj.female)==0?r="Men's ":parseInt(e.media_obj.sports_obj.female)==1&&parseInt(e.media_obj.sports_obj.male)==0?r="Women's ":parseInt(e.media_obj.sports_obj.male)==1&&parseInt(e.media_obj.sports_obj.female)==1&&(r="Coed "),r+=this.ucwords(e.media_obj.sports_obj.sport_name)}return t._sublabel=[],n&&t._sublabel.push({label:"Uploaded by "+n}),r&&t._sublabel.push({label:"Sport: "+r}),t.itemtype="http://schema.org/Person",t.meta=[{itemprop:"name",content:n||""}],t._link="javascript: void(0);",t._has_link=!1,e.media_obj.hasOwnProperty("is_owner")&&(t.show_delete=e.media_obj.is_owner),t._noicon_text="look",t._color="#dfe271",t},parse_game:function(e,t){return t._detailclass="game",typeof e.game_picture=="object"&&e.game_picture!=null&&typeof e.game_picture.types=="object"&&(this.findCorrectType(e.game_picture.types),t._thumbnail=this.closest_image_format.url),e.sports_obj&&(t._sports_icon=this.get_selected_icon(e.sports_obj)),t._label=e.game_name,t._link="/#!game/"+e.id,t._has_link=!0,e.hasOwnProperty("is_owner")&&(t.show_delete=e.is_owner),t._sublabel=e.full_date,t._noicon_text="vs",t._color="#e49f6f",console.log(t),t},imageFormat:function(e){var t=this;e._thumbnail=this.closest_image_format.url;var n=t.closest_image_format,r=n.width/this.display_width,i=n.height/this.display_height;n.width=parseInt(n.width),n.height=parseInt(n.height);var s=n.width>n.height?-(n.width/i-this.display_width)/2:-(n.height/r-this.display_height)/2;return s>0&&(s=0),n.width>n.height?(n.maxwidth=n.width/i,n.left=s):(n.maxheight=n.height/r,n.top=s),e.imgData=n,e}})}),define("media/views/image-item",["vendor","views","utils","text!media/templates/image-item.html","votes/models/vote","votes/models/follow","utils/storage","chrome/views/header","common/models/delete","common/models/entparse"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=require("votes/models/vote"),f=require("utils/storage"),l=require("votes/models/follow"),c=require("common/models/delete"),h=require("chrome/views/header"),p=require("common/models/entparse");return i=o.extend({tagName:"li",className:"image",events:{"click .vote-h":"vote","click .follow-h":"follow","click .edit-h":"edit","click .delete-h":"delete"},initialize:function(e){this.template=r;if(e.length)for(var t in e)this[t]=e[t];e.mainView&&(this.mainView=e.mainView)},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},render:function(){function f(e){console.log(s(this),e)}var e=this,t=this.model.get("payload");if(_.isArray(t)||t.image_id==0)return!1;var n=new p({mpay:t}),r=n.parsedData;r._media_id=t.media_id;var i=u.to_html(this.template,r);this.$el.html(i);var o="120px",a="92px";return this.$el.find(".image-item-container").mouseout(function(){s(this).find(".action-block").css({opacity:0}),s(this).find(".detail-view").css({bottom:"-"+a}),s(this).find(".detail-view.game").css({bottom:"-"+o})}),$nopic_words_div=this.$el.find(".game-tile"),$nopic_words_div.length&&($num_words=$nopic_words_div.text().length,console.log($num_words),$num_words<3?$nopic_words_div.css({"font-size":"5em",top:"90px",left:"60px"}):$num_words<5?$nopic_words_div.css({"font-size":"4em",top:"90px",left:"40px"}):$num_words<25?$nopic_words_div.css("font-size","2em"):$num_words<30?$nopic_words_div.css({"font-size":"1.7em",top:"65px"}):$num_words<40?$nopic_words_div.css({"font-size":"1.5em",top:"50px"}):$nopic_words_div.css("font-size","1em")),r.imgData.maxwidth&&this.$el.find("img.list-thumbnail").css({"max-width":r.imgData.maxwidth,left:r.imgData.left}),r.imgData.maxheight&&this.$el.find("img.list-thumbnail").css({"max-height":r.imgData.maxheight,top:r.imgData.top}),r.show_play&&this.$el.append('<div class="circle open-photo-player-h"><div class="play"></div></div>'),this.$el.find(".image-item-container").mouseover(function(){s(this).find(".detail-view").css({bottom:"0px"}),s(this).find(".action-block").css({opacity:90})}),this.$el.find(".circle").mouseover(function(){s(this).parent().find(".detail-view").css({bottom:"0px"}),s(this).parent().find(".action-block").css({opacity:90})}),this.$el.find(".vote-h").click(function(t){e.vote(t)}),this.$el.find(".follow-h").click(function(t){e.follow(t)}),this.$el.find(".edit-h").click(function(t){e.edit(t)}),this.$el.find(".delete-h").click(function(t){e["delete"](t)}),this},vote:function(e){e.preventDefault(),e.stopPropagation();var t=this,n=function(n){var r=new a;r.subject_id=t.model.get("payload").id,r.entity_id=t.model.get("payload").enttypes_id,r.setData(),r.save(),s.when(r.request).done(function(){s(e.currentTarget).addClass("link-disabled").html("voted"),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},follow:function(e){e.preventDefault(),console.log(e.target),e.stopPropagation();var t=this,n=function(n){var r=new l;r.subject_id=t.model.get("payload").id,r.entity_id=t.model.get("payload").enttypes_id,r.save(),s.when(r.request).done(function(){typeof r.get("payload").follower=="object"&&typeof r.get("payload").subject=="object"&&r.get("payload").id>0&&s(e.currentTarget).addClass("link-disabled").html("following"),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},edit:function(e){e.stopPropagation(),e.preventDefault()},"delete":function(e){e.stopPropagation(),e.preventDefault(),deleteModel=new c,deleteModel.subject_id=s(e.currentTarget).attr("subject-id"),deleteModel.enttypes_id=s(e.currentTarget).attr("subject-type-id"),deleteModel.removeNode=s(e.currentTarget).parents("li.image"),deleteModel.destroyAndRemove(),this.mainView&&this.mainView.showAddButton&&_.isFunction(this.mainView.showAddButton)&&this.mainView.showAddButton()}}),i}),define("profile/views/header",["require","text!profile/templates/header.html","text!profile/templates/sports.html","profile/models/basics","facade","views","utils","vendor","profile/collections/sports","profile/views/sport-list","utils/storage","media/views/image-item"],function(e,t,n){var r,s=e("facade"),o=e("views"),u=e("profile/models/basics"),a=o.SectionView,f=e("profile/views/sport-list"),l=e("profile/collections/sports"),c=e("utils"),h=c.lib.Channel,p=e("vendor"),d=p.Mustache,v=e("utils/storage"),m=e("media/views/image-item"),g=s.$;return r=a.extend({id:"main-header",template:t,selectSportTemplate:n,events:{"click .sports-icon-h":"selectSport"},initialize:function(e){a.prototype.initialize.call(this,e),this.sports_id=e.sports_id,this.initSportList()},initSportList:function(){var e=this;this.sports=new l,this.sports.id=this.model.id,this.sports.fetch(),this.model.get("payload").loggedInUser=this.checkForCurrentUser(),g.when(this.sports.request).done(function(){e.setupSportListView(),e.selectSport()})},checkForCurrentUser:function(){return routing.loggedInUserId==this.model.id?!0:!1},setupSportListView:function(){var e=this,t=new f({collection:this.sports}),n=this.addChildView(t);this.childViews.sportListView=t,this.callbacks.add(function(){n()}),e.$el.find("#sports-info").html(t.el);var r={payload:[]},s=t.collection;if(s.length){for(i=0;i<s.length;i++)r.payload[i]=s.at(i).get("payload");var o=d.to_html(e.selectSportTemplate,r);e.$el.find(".sports-h").html(o)}else this.model.get("payload").id!=routing.loggedInUserId?e.$el.find(".sports-h").html(this.model.get("payload").first_name+" has not entered any sports or teams."):e.$el.find(".sports-h").html('<a href="#!usersettings" title="edit sports" class="btn pull-right">Edit Sports</a>');t.render()},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},childViews:{},render:function(e,t,n){a.prototype.render.call(this,e,t,n),this.renderImage()},renderImage:function(){this.headerImage=new m({model:this.model}),this.headerImage.render(),this.$el.find(".image-outer-h").html(this.headerImage.$el)},getUserName:function(){return this.model.get("payload").label},selectSport:function(e){var t=e?g(e.target).data("id"):this.sports_id?this.sports_id:g(".sports-h img:first-child").data("id"),n=e?g(e.target).data("name"):g(".sports-h img:first-child").data("name");n?this.$el.find(".sports-name-h").html(n+" Profile"):this.$el.find(".sports-name-h").html("No Sport Selected"),ga("send","event","Profile-Action","Sport-Change",n,t),g(".sports-icon-h.selected-sport-h").each(function(){console.log(this);var e=String(g(this).attr("src")).split("_selected.png")[0];e=e.split(".png")[0]+".png",g(this).attr("src",e).removeClass("selected-sport-h")}),g(".sports-icon-h[data-id="+t+"]").addClass("selected-sport-h");var r=String(g(".sports-icon-h[data-id="+t+"]").attr("src")).split(".png")[0]+"_selected.png";g(".sports-icon-h[data-id="+t+"]").attr("src",r);var i=this.getUserName();t&&(i+=" | "+n,this.$(".sport-info").stop().slideUp(),this.$(".sport-info-"+t).stop().slideDown(),routing.trigger("showTwmList",t));if(t){var s=window.location.hash;s.match(/\/sport\/(.*)[0-9]\//i)?s=s.replace(/\/sport\/(.*)[0-9]\//i,"/sport/"+t+"/"):s.match(/\/sport\/(.*)[0-9]/i)?s=s.replace(/\/sport\/(.*)[0-9]/i,"/sport/"+t):s=s+"/sport/"+t,e?routing.navigate(s,{trigger:!1}):routing.navigate(s,{trigger:!1,replace:!0})}document.title=i}}),r}),define("text!media/templates/add-media.html",[],function(){return'{{#links}}\r\n	<div>\r\n	<a href="{{link}}" title="{{label}}" id="{{id}}">\r\n	</a>\r\n	<span class="hide character-limit-h">{{label}}</span>		\r\n	</div>\r\n\r\n{{/links}}'}),define("profile/views/add-media",["require","text!media/templates/add-media.html","application","profile/models/addmedia","facade","views"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=i._;return r=o.extend({id:"add-media",tagName:"div",template:t,events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup","click #addGame":"openAddGamePopup","mouseover a":"showText","mouseout a":"showicon"},setOptions:function(e){if(!this.model)throw new Error("ProfileAddMediaView expects option with model property.");this.model.userid=e.userid},showText:function(e){$(e.target).parent().find("span").removeClass("hide")},afterRender:function(){var e=this;$ele=this.$el.find(".character-limit-h"),$ele.each(function(){e.adJustFontDynamically($(this))})},showicon:function(e){$(e.target).parent().find("span").addClass("hide")},openAddGamePopup:function(){ga("send","event","Open-Add-Popup","Game","User opened game adder",this.model.userid),routing.trigger("add-game",this.model.userid)},openAddImagePopup:function(e){ga("send","event","Open-Add-Popup","Image","User opened image uploader",this.model.userid);var t=$(".selected-sport-h").data("id"),n="/api/user/addimage/"+this.model.userid,n="/api/user/addimage/"+this.model.userid,r={sports_id:t};routing.trigger("add-image",n,r)},openAddvideoPopup:function(e){ga("send","event","Open-Add-Popup","Video","User opened video uploader",this.model.userid);var t="/api/user/addvideo/"+this.model.userid;Channel("add-video").publish(t)}}),r}),define("text!schedules/templates/schedule-item.html",[],function(){return'{{#payload}}\r\n	<div class="select-team">\r\n	{{#teams}}\r\n		<div class="org-name">\r\n			<a href="/#!team/{{team_id}}"><span class="team-label">{{org_name}} | {{complevel}} | {{season}} {{year}}</span></a>\r\n			<a href="javascript: void(0);" data-team-id="{{team_id}}" data-sport-id="0" title="add game" class="add-game-h right-with-icon">Add Game</a>\r\n			<!--<a href="javascript: void(0);" data-sport-id="0" title="add team" class="add-event-h">Click here to Add Event.</a>-->\r\n		</div>\r\n			<div class="game-box-outer">\r\n				<ul>\r\n				{{#schedules}}\r\n					<li data-game-id="{{id}}">\r\n						<a href="#game/{{id}}" data-team-id="{{team_id}}" class="{{#isWinner}}win{{/isWinner}}{{^isWinner}}background-blue{{/isWinner}} team-info-h">\r\n							<div class="game-info hide">\r\n								<span class="game-day">{{gameDay}}</span>{{#teams}}<span class="team-name" data-winner="{{isWinner}}" data-team-id="{{id}}">\r\n								&nbsp; vs. {{team_name}}</span>{{/teams}}\r\n								<span class="game-score">{{#teams}}{{#points_scored}}<span class="team-score {{#isWinner}}win{{/isWinner}}{{^isWinner}}loss{{/isWinner}}">{{points_scored}}</span>{{/points_scored}}{{/teams}}</span>\r\n							</div>\r\n						</a>\r\n					</li>\r\n				{{/schedules}}\r\n			</ul>\r\n		</div>\r\n	{{/teams}}\r\n	</div>\r\n{{/payload}}'}),define("text!schedules/templates/schedule-single-item.html",[],function(){return'{{#payload}}\r\n<a href="#game/{{id}}" data-team-id="{{teams_id}}" class="background-blue team-info-h">\r\n	<div class="game-info hide">\r\n		<span class="game-day">{{gameDay}}</span>{{#teams}}<span class="team-name" data-winner="{{isWinner}}" data-team-id="{{id}}">\r\n									&nbsp; vs. {{team_name}}</span>{{/teams}}\r\n		<span class="game-score">{{#teams}}{{#points_scored}}<span class="team-score {{#isWinner}}win{{/isWinner}}{{^isWinner}}loss{{/isWinner}}">{{points_scored}}</span>{{/points_scored}}{{/teams}}</span>\r\n	</div>\r\n</a>\r\n{{/payload}}'}),define("text!schedules/templates/schedule-event-item.html",[],function(){return'{{#payload}}\r\n	<a href="#game/{{id}}" class="{{#result_time}}background-blue{{/result_time}}{{^result_time}}noscore{{/result_time}} team-info-h"><div class="game-info hide">\r\n		<span class="game-header"><span class="game-day">{{event_name}}</span></span>\r\n		<span class="game-day">{{game_day}}</span><br/>\r\n		<span class="team-name">{{game_location}}</span><br/>\r\n		{{#is_race}}\r\n		{{#result_time}}<span class="game-score"><span class="team-score">{{result_time}}</span></span>{{/result_time}}\r\n		{{^result_time}}<span class="game-score"><span class="team-score add-score" data-uslgamelink="{{usl_game_link_id}}">Add My Time</span></span>{{/result_time}}\r\n		{{/is_race}}\r\n	</div></a>\r\n{{/payload}}'}),define("schedules/views/schedule-item",["vendor","views","utils","text!schedules/templates/schedule-item.html","text!schedules/templates/schedule-single-item.html","text!schedules/templates/schedule-event-item.html"],function(e,t,n,r,i,s){var o=e.$,u=t.BaseView,a=e.Mustache;return u.extend({tagName:"li",className:"org",events:{"change #select-team":"selectTeam"},initialize:function(e){console.log(e),e.model&&e.model.collection&&(this.teams_id=e.model.collection.id),e.teamView&&(this.teamView=e.teamView),e.eventView&&(this.eventView=e.eventView)},render:function(){if(this.teamView){this.mpay=this.model.get("payload"),this.template=i;var e=a.to_html(this.template,{payload:this.mpay,teams_id:this.teams_id});o(this.el).attr("data-team-id",this.teams_id)}else if(this.eventView&&this.eventView!=""){delete this.teams_id;if(this.model.get("payload")!==null&&this.model.get("payload").result_time==="0h 0m 0s"){var t=this.model.get("payload");t.result_time=null,this.model.set("payload",t)}console.log("schedule item event",this.model.toJSON()),this.template=s;var e=a.to_html(this.template,this.model.toJSON())}else{delete this.teams_id,this.template=r;var e=a.to_html(this.template,this.model.toJSON())}return this.$el.html(e),this.select_team=this.$("#select-team"),console.log(this.select_team),this.selectTeam(),this.setWins(),this},setWins:function(){var e=this.teams_id!=undefined?this.teams_id:o(this.el).find("div.org-name a.add-game-h").attr("data-team-id"),t=this,n=o(this.el).attr("data-team-id")?o(this.el):o(this.el).find("ul li");n.each(function(t){e=o(this).find("a.team-info-h").attr("data-team-id");var n=o(this).find('span.team-name[data-team-id="'+e+'"]');o(this).find('span.team-name[data-team-id="'+e+'"][data-winner="true"]').length&&o(this).find("a.team-info-h").addClass("win").removeClass("background-blue"),o(this).find('span.team-name[data-winner="true"]').length||o(this).find("a.team-info-h").addClass("noscore").removeClass("background-blue"),o(this).find('span.team-name[data-team-id="'+e+'"]').hide()})},selectTeam:function(e){var t=this.select_team.val();this.$(".team-info").stop().slideUp(),this.$(".team-info-"+t).stop().slideDown(),console.log(t)}})}),define("text!schedules/templates/schedule-list.html",[],function(){return'{{#data}}\r\n	<div>\r\n		{{#eventPage}}\r\n			<span class="event-sport-label">{{eventPage}} Events</span>\r\n			<a href="javascript: void(0);" title="Add an Event / Meet" class="add-event-h right-with-icon">Add Event / Meet</a>\r\n		{{/eventPage}}\r\n\r\n		{{^eventPage}}\r\n			<span class="event-sport-label">&nbsp;</span>\r\n			<a href="javascript: void(0);" title="Add a Game" class="add-game-h right-with-icon">Add Game.</a>\r\n		{{/eventPage}}\r\n	</div>\r\n<div class="select-team">\r\n	<div class="game-box-outer">\r\n		<ul class="schedule-list-h">\r\n			\r\n		</ul>\r\n	</div>\r\n</div>\r\n</div>\r\n{{/data}}\r\n{{^data}}\r\n<div class="info">\r\n	{{#eventPage}}\r\n	<div>\r\n		<a href="javascript: void(0);" title="Add an Event" class="add-event-h right-with-icon">Add Event / Meet</a>\r\n	</div>\r\n	{{/eventPage}}\r\n	{{^eventPage}}\r\n	<div>\r\n		<a href="javascript: void(0);" title="add game" class="add-game-h right-with-icon">Add Game.</a>\r\n	</div>\r\n	{{/eventPage}}\r\n\r\n</div>\r\n{{/data}}\r\n'}),define("common/models/add",["facade","models/base"],function(e,t){var n=e._;return t.extend({defaults:n.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromResponse:function(e,t){var n=this,r=e;return n.id=Math.ceil(Math.random()*1e5),typeof t!="undefined"?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this},processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),typeof t!="undefined"?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this}})}),define("sportorg/models/uslgamelink",["facade","models/base"],function(e,t){var n,r=e._,i=e.Backbone;return n=t.extend({initialize:function(e){e&&e.id&&(this.id=e.id)},methodToURL:{read:function(e){console.log(e);var t="/api/uslgamelink/basics/"+e.id;return t},create:"/api/uslgamelink/add/",update:function(e){var t="/api/uslgamelink/add/";return e.id&&(t+=e.id),t},"delete":function(e){return"/api/uslgamelink/delete"+e.id}},sync:function(e,t,n){return n=n||{},n.url=typeof t.methodToURL[e.toLowerCase()]=="function"?t.methodToURL[e.toLowerCase()](t):t.methodToURL[e.toLowerCase()],i.sync.apply(this,arguments)}}),n}),define("text!common/templates/add-description.html",[],function(){return'<div class="add-big-list-container">\r\n<div class="border-wrapper">\r\n	<div class="left-text">\r\n		{{data.message.left}}\r\n	</div>\r\n	<div class="right-secton {{data.className.mainDiv}} {{data.page}}">\r\n		{{#data.className.btn1}}\r\n			<div>\r\n				<a href="javascript: void(0);" data-target="{{data.className.btn1}}" class="btn1 add-icon-large"></a>\r\n				<span>{{data.message.btn1}}</span>\r\n			</div>\r\n		{{/data.className.btn1}}\r\n		\r\n		{{#data.className.btn2}}\r\n			<div>\r\n				<a href="javascript: void(0);" data-target="{{data.className.btn2}}" class="btn2 add-icon-large"></a>\r\n				<span>{{data.message.btn2}}</span>\r\n			</div>\r\n		{{/data.className.btn2}}\r\n	</div>\r\n</div>\r\n</div>'}),define("common/views/add-description",["require","text!common/templates/add-description.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=r.Backbone.View.extend({}),o=i.BaseView;return n=o.extend({className:"",events:{"click .btn1":"targetElement","click .btn2":"targetElement"},initialize:function(e){console.error(e);for(var t in e)this[t]=e[t];this.initializeData(),this.render()},targetElement:function(e){console.log(e,this.page);switch(this.page){case"fans":$(".fans-add-icons-h").find("."+$(e.target).attr("data-target")).trigger("click");break;case"media":$(".media-add-icons-h").find("."+$(e.target).attr("data-target")).trigger("click");break;case"games":$(".media-add-icons-h").find("."+$(e.target).attr("data-target")).trigger("click");break;case"rosters":$(e.target).parents("#roster-wrap").find("."+$(e.target).attr("data-target")).trigger("click");break;case"participants":console.log($(".participants-add-icons-h").find("."+$(e.target).attr("data-target"))),$(".participants-add-icons-h").find("."+$(e.target).attr("data-target")).trigger("click")}},initializeData:function(){this.messages={fans:{left:"Become a fan and get notified whenever there's any activity for "+this.teamName+". Get notifications for new games or game changes, photos, videos, new team members or new messages.",btn1:"Click here to add yourself to the fan's list and receive notifications.",btn2:"Click here to invite friends from facebook to receive notifications."},media:{left:"The Photo/Video section displays all media that "+this.teamName+" is tagged in. There are currently no photos to show in this section. Use the buttons above to upload new photos or videos.",btn1:"Click here to upload photos of this team.",btn2:"Click here to upload videos of team."},games:{left:"The game timeline shows all of the scheduled games for this team. Each dot is a game. You can hover over the dot to get a preview, or click on the dot to go to game page. Click the 'add game' Button to add a new game to the timeline.",btn1:"Click here to add a game to this team's calendar. All team members will be notified of this new game."},rosters:{left:"This section is a team roster and it lists all registered users for "+this.teamName+". You can add yourself to this roster or invite friends from facebook who play for this team.'",btn1:"Click here to add yourself to this team's roster.'",btn2:"Click here to invite friends from facebook that play for this team."},participants:{left:"This section lists all participants competing in this event.  Click the 'Add Me' button to add yourself as a participant.",btn1:"Click here to add me as a participant in this event",btn2:"Invite a friend from facebook to participate in this event"}}},btnClasses:{fans:{btn1:"add-to-list-h",btn2:"invite-fans-from-fb-h",mainDiv:"fans"},media:{btn1:"add-image-h",btn2:"add-video-h",mainDiv:"media"},games:{btn1:"game-adder-h",mainDiv:"games"},rosters:{btn1:"add-to-roster-list-h",btn2:"invite-roster-from-fb-h",mainDiv:"roster"},participants:{btn1:"add-to-participants-list-h",btn2:"invite-participant-from-fb-h",mainDiv:"participants"}},render:function(){var e=this,n={};n.message=this.messages[this.page],n.className=this.btnClasses[this.page],n.page=this.page;var e=this,r=Mustache.to_html(t,{data:n});console.log(r),$(this.target).is("ul")?setTimeout(function(){var t=$(e.target).parent();$(e.target).replaceWith("<div></div>"),e.$el.html(r),e.el=e.$el,t.html(e.$el)},500):(this.$el.html(r),this.el=this.$el,console.log(this.el),this.target.html(this.$el))}}),n}),define("schedules/views/schedule-list",["vendor","facade","views","utils","schedules/views/schedule-item","utils/storage","text!schedules/templates/schedule-list.html","chrome/views/header","common/models/add","sportorg/models/uslgamelink","vendor/plugins/qtip/qtip","common/views/add-description"],function(e,t,n,r,i,s,o,u,a,f){var l,c,h=t.$,p=t._,d=r.lib.Channel,v=n.CollectionView,m=require("common/views/add-description"),g=e.Mustache,y=n.SectionView;return c=v.extend(y.prototype),l=c.extend({__super__:v.prototype,id:"schedule-list",name:"schedule List",tagName:"ul",currentSection:"games",_tagName:"li",_className:"org",_view:i,events:{"click .add-game-h":"addGame","click .add-event-h":"addEvent"},showinfo:function(e){e.preventDefault(),h(e.target).parents(".game-info").length||(h(e.target).find(".game-info").hasClass("hide")?h(e.target).find(".game-info").removeClass("hide"):h(".game-info").addClass("hide"))},checkForUser:function(){return!p.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},getUserId:function(){if(!p.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn)return routing.loggedInUserId},addRecordToCollection:function(e){var t=new addModel;t.processItemFromPayload(participants.toJSON()),_self.$el.find(".add-to-event").hide(),_self.collection.add(t)},addGame:function(e){var t=this;t.checkForUser()?t.openAddGamePopup(e):routing.trigger("showSignup",function(){t.openAddGamePopup(e)})},openAddGamePopup:function(e){var t=this;if(!p.isUndefined(this.teamRecords)&&this.teamRecords)routing.trigger("add-game",0,h("#team-h").val(),h("#sports-h").val(),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("common-popup-close")});else{var n=h(".selected-sport-h").data("id")||h("#sports-h").val();routing.trigger("add-game",0,h(e.currentTarget).data("team-id"),n,t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("common-popup-close")})}},addEvent:function(e){var t=this;if(!this.checkForUser()){h("#userlogin").trigger("click");return}!p.isUndefined(this.teamRecords)&&this.teamRecords?routing.trigger("add-event",0,h("#sports-h").val(),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("popup-close")}):(console.log(h(".selected-sport-h").data("id")),routing.trigger("add-event",0,h(".selected-sport-h").data("id"),t.controller.id,function(e){t.controller&&t.controller.getOrgData(),routing.trigger("popup-close")}))},initialize:function(e){var t=this;d("load:css").publish(["vendor/plugins/qtip/qtip.css"]),t.eventPage=e.eventPage||!1,t.teamRecords=e.teamRecords,t.controller=e.controller||!1,!p.isUndefined(e.teamRecords)&&e.teamRecords&&(t.renderTemplate(),t.listView=".schedule-list-h",t.singleView=!0),!p.isUndefined(e.eventPage)&&e.eventPage&&(t.renderTemplate(t.eventPage),t.listView=".schedule-list-h",t.eventView=!0),v.prototype.initialize.call(t,e);if(!t.collection)throw new Error("Schedule expected options.collection.");p.bindAll(t),t.addSubscribers()},afterRender:function(){var e=this;this.$el.find("a.team-info-h").each(function(){var t=h(this);h(this).qtip({content:t.find("div.game-info").html(),position:{my:"bottom center",at:"top center",viewport:h(window)},style:{classes:"tipsy game-info",width:"360px"},hide:{fixed:!0,delay:1e3},events:{render:function(t,n){h(n.elements.tooltip).find(".add-score").on("click",e.addScore)}}})})},addScore:function(e){e.stopPropagation();var t=h(e.target).data("uslgamelink");h(e.target).off("click",this.addScore).html('<input type="text" placeholder="00:00:00" data-uslgamelink="'+t+'" style="width:100px; margin:0px;" id="usl_result_time_'+t+'" />'+'<span id="save_result_time'+t+'" style="margin-left:8px;">save</span>').find("#save_result_time"+t).on("click",this.updateGameLink)},updateGameLink:function(e){var t=h(e.target).prev(),n=new f({id:t.data("uslgamelink"),result_time:t.val()});n.save(),h.when(n.request).done(function(e){console.log(e),t.parent().html(e.payload.result_time)})},renderTemplate:function(e){var t=g.to_html(o,{data:this.collection.length,eventPage:e});return this.$el.html(t),this}}),l}),define("text!user/templates/related-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid">\r\n    <div class="span6">\r\n        <img src="{{base_url}}{{user_picture}}" alt="{{user_name}}"/>\r\n    </div>\r\n    <div class="span6">\r\n        <div class="username">{{user_name}}</div>\r\n        <div class="votes">Votes: {{num_votes}}</div>\r\n        <div class="fans">Followers: {{num_followers}}</div>\r\n    </div>\r\n</div>\r\n<table class="table">\r\n{{#teams}}\r\n    <tr>\r\n        <td>{{sport}}</td>\r\n        <td>{{position}}</td>\r\n        <td>{{org}}</td>\r\n        <td>{{season}}</td>\r\n        <td>{{year}}</td>\r\n    </tr>\r\n{{/teams}}\r\n</table>\r\n{{/payload}}\r\n\r\n'}),define("user/views/related-item",["vendor","views","utils","text!user/templates/related-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"related",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("user/views/related-list",["facade","views","utils","user/views/related-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"related-list",name:"Related List",tagName:"ul",_tagName:"li",_className:"related",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("RelatedListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("text!user/templates/fitnessbasic-item.html",[],function(){return'{{#payload}}\r\n	{{#data}}\r\n		<div class="fitness-overview-data-piece" style="">\r\n			<img title="{{name}}" src="{{icon}}" style=""/>\r\n			<span class="stat-val-outer">\r\n				<span class="stats-val-h">{{#val}}{{val}}{{/val}}{{^val}}--{{/val}}</span>\r\n				<input type="text" data-id="{{id}}" class="stats-input stats-input-h hide-force" value="{{#val}}{{val}}{{/val}}{{^val}}{{/val}}"/>\r\n			</span>\r\n		</div>\r\n	{{/data}}\r\n	{{^data}}\r\n		<div class="stats-empty-area">\r\n			Either no sport is selected,\r\n			or the selected sport has no \r\n			atheletic metrices to fill out.\r\n		</div>\r\n	{{/data}}\r\n{{/payload}}\r\n\r\n'}),define("user/models/rdtree",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("user/models/fitness",["facade","user/models/rdtree"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,resume_data_id:this.resume_data_id,user_value:this.user_value},processData:!0,url:function(){return"api/resumedataval/add/"}}),n}),define("user/views/fitnessbasic-item",["vendor","views","utils","text!user/templates/fitnessbasic-item.html","user/models/fitness"],function(e,t,n,r,i){var s,o=e.$,u=t.BaseView,a=e.Mustache;return s=u.extend({tagName:"li",className:"fitnessbasic",events:{},showInput:function(e){o(e.target).addClass("hide-force"),o(e.target).parents("span.stat-val-outer").find(".stats-input-h").removeClass("hide-force").focus()},hideInput:function(e){var t=o(e.target).data("id"),n=-1,r=this.model.get("payload").data;for(var s in r)if(r[s].id==t){n=s;break}if(n!=-1){var u=new i;u.set({user_id:routing.loggedInUserId,resume_data_id:r[s].resume_data_id,user_value:o(e.target).val()}),u.save();var a=o(e.target).parents("span.stat-val-outer").find(".stats-val-h");a.html(o(e.target).val()),o.when(u.request).done(function(){a.html(u.get("payload").user_value!=""?u.get("payload").user_value:"--"),o(e.target).addClass("hide-force"),a.removeClass("hide-force")})}},initialize:function(e){this.template=r,this.recordId=e.recordId},calculate:function(){if(this.unit_type=="time")var e="00:"+this.user_value+":00";else var e=this.user_value;return e},render:function(){var e={},t=this;e=this.model.toJSON(),e.view=this,console.log("Fitness Data getting passed to template",e);var n=a.to_html(this.template,e);return this.$el.html(n),routing.loggedInUserId==this.recordId&&(this.$el.find(".stats-val-h").click(function(e){t.showInput(e)}),this.$el.find(".stats-input-h").blur(function(e){t.hideInput(e)})),this}}),s}),define("user/views/fitnessbasic-list",["facade","views","utils","user/views/fitnessbasic-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"fitnessbasic-list",name:"Fitness Basic List",tagName:"ul",_tagName:"li",_className:"fitnessbasic",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("FitnessBasicListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("text!media/templates/video-item.html",[],function(){return'<input type="hidden" class="id" value="{{id}}"/>\r\n{{#payload}}    \r\n    <img src="{{base_url}}{{video_thumb}}" alt="{{video_title}}"/>\r\n<div class="row-fluid" style="display:none;">\r\n    <div class="span6">\r\n        <img src="{{base_url}}{{video_thumb}}" alt="{{video_title}}"/>\r\n    </div>\r\n    <div class="span6">\r\n        {{video_title}}<br/>\r\n        Teams: \r\n        {{#teams}}\r\n            {{.}}&nbsp;\r\n        {{/teams}}\r\n        <br/>\r\n        Games: \r\n        {{#games}}\r\n            {{.}}&nbsp; \r\n        {{/games}}\r\n        <br/>\r\n        Posted by {{user_name}}, {{post_date}}<br/>\r\n        {{num_votes}} Votes, {{num_views}} Views, {{num_comments}} Comments<br/>\r\n        <p>{{video_desc}}</p>\r\n        {{#tags_count}}\r\n            {{tags_count}} Tagged<br/>\r\n            {{#tags}}\r\n                <img src="{{base_url}}{{.}}"/>\r\n            {{/tags}}\r\n        {{/tags_count}}\r\n    </div>\r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("media/views/video-item",["vendor","views","utils","text!media/templates/video-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"video",events:{click:"changeVideo"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeVideo:function(){Channel("changevideo"+this.model.collection.id).publish(this.model)}}),i}),define("text!media/templates/video-player.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter"><img src="{{base_url}}{{video_src}}" alt="{{video_title}}"/></div>\r\n    <h3>{{video_title}}</h3>\r\n    {{#games}} \r\n        {{team1_name}} vs {{team2_name}}\r\n    {{/games}}    \r\n    Votes: {{num_votes}}, Views: {{num_views}}, Comments: {{num_comments}}<br/>\r\n    <br>\r\n\r\n		{{#video_type}}\r\n				{{video_type_name}}\r\n				{{meta_details.url}}\r\n				<br>\r\n		{{/video_type}}\r\n    <div class="social-links">\r\n    {{#social_links}}\r\n        <a class="{{class}}" href="{{link}}" title="{{title}}">{{title}}</a>\r\n    {{/social_links}}\r\n    </div>\r\n{{/payload}}\r\n\r\n'}),define("media/views/video-player",["require","text!media/templates/video-player.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.BaseView,o=r._;return n=s.extend({tagName:"li",className:"video-player",template:t,setOptions:function(e){if(!this.model)throw new Error("VideoPlayerView expected options.model.")},render:function(){s.prototype.render.call(this)}}),n}),define("text!media/templates/add-video.html",[],function(){return'\r\n{{#payload}}\r\n<form>\r\n<div class="row-fluid">\r\n    <input type="text" name="title" id="title" placeholder="Video Title"/><br/>\r\n    ...<br/>\r\n    <input type="button" id="addvideo" value="Add Video"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("media/views/add-video",["require","text!media/templates/add-video.html","facade","views","media/models/video"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("media/models/video"),o=i.BaseView,u=r._;return n=o.extend({tagName:"li",template:t,events:{"click #addvideo":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("AddVideoView expected options.collection.");this.model||(this.model=new s({id:this.collection.id}),this.model.fetch())},render:function(){o.prototype.render.call(this),this.input=this.$("#title")},submitHandler:function(e){alert("AddVideoView"),e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();if(t!=""){var n=this.model.get("payload");n.video_title=this.input.val(),this.model.save();var r=this.model.clone();r.id=Math.ceil(Math.random()*1e5),this.collection.push(r),this.input.val("")}}}),n}),define("media/views/video-list",["facade","views","utils","media/views/video-item","media/views/video-player","media/views/add-video"],function(e,t,n,r,i,s){var o,u,a=e.$,f=e._,l=n.lib.Channel,c=t.CollectionView,h=t.SectionView;return u=c.extend(h.prototype),o=u.extend({__super__:c.prototype,id:"video-list",name:"Video List",tagName:"ul",_tagName:"li",_className:"video",_view:r,initialize:function(e){c.prototype.initialize.call(this,e);if(!this.collection)throw new Error("VideoListView expected options.collection.");f.bindAll(this),this.addSubscribers(),this.setupPlayerView(),this.setupAddView()},childViews:{},setupAddView:function(){function r(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new s({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),l("addvideo:fetch").subscribe(r)},setupPlayerView:function(){function r(e){t.model=e,t.render()}if(this.collection.size()==0)return;var e=this,t=new i({collection:this.collection,model:this.collection.at(0)}),n=this.addChildView(t);this.childViews.player=t,this.callbacks.add(function(){n(),t.render(),e.$el.prepend(t.el)}),l("changevideo"+this.collection.id).subscribe(r)}}),o}),define("profile/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/addvideo/"+this.id+"/"+this.sport_id:"/api/user/addvideo?team_id="+this.id+"&sport_id="+this.sport_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gameaddvideo:fetch").publish(e)}}),r}),define("profile/views/add-video",["require","profile/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("ProfileAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id}))}}),r}),define("profile/views/video-list",["facade","utils","media/views/video-list","profile/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gameaddvideo:fetch").subscribe(i)}}),i}),define("text!media/templates/image-board.html",[],function(){return'<!--{{#payload}}\r\n    <div class="textcenter"><img src="{{base_url}}{{image_path}}" alt="{{image_title}}"/></div>\r\n    {{#image_title}}<h3>{{image_title}}</h3>{{/image_title}}\r\n    {{#num_votes}}Votes: {{num_votes}} <br/>{{/num_votes}}\r\n{{/payload}}-->'}),define("media/views/image-board",["require","text!media/templates/image-board.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.BaseView,o=r._;return n=s.extend({tagName:"li",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){s.prototype.render.call(this)}}),n}),define("text!media/templates/add-image.html",[],function(){return'\r\n{{#payload}}\r\n<form>\r\n<div class="row-fluid">\r\n    <input type="text" name="title" id="title" placeholder="Image Title"/><br/>\r\n    ...<br/>\r\n    <input type="button" id="addimage" value="Add Image"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("media/views/add-image",["require","text!media/templates/add-image.html","facade","views","media/models/image"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("media/models/image"),o=i.BaseView;return n=o.extend({tagName:"li",template:t,events:{"click #addimage":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("AddImageView expected options.collection.");!this.model},render:function(){o.prototype.render.call(this),this.input=this.$("#title")},submitHandler:function(e){e.preventDefault(),this.createOnEnter(e)},createOnEnter:function(e){var t=this.input.val();if(t!=""){var n=this.model.get("payload");n.image_title=this.input.val(),this.model.save();var r=this.model.clone();r.id=Math.ceil(Math.random()*1e5),this.collection.push(r),this.input.val("")}}}),n}),define("text!media/templates/image-list.html",[],function(){return'<ul class="image-list">\r\n</ul>\r\n<!--{{#target}}\r\n<div class="image-drop-area-outer">\r\n	<div class="image-drop-area" id="image-place-holder">\r\n		<div class="drop-text">DROP PHOTOS HERE</div>\r\n		<div>OR CLICK TO UPLOAD</div>\r\n		\r\n	</div>\r\n</div>\r\n{{/target}}-->\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">More</a></div>\r\n'}),define("media/views/image-list",["facade","views","utils","media/views/image-item","media/views/image-board","media/views/add-image","text!media/templates/image-list.html","votes/models/follow","common/views/add-description"],function(e,t,n,r,i,s,o){var u,a,f=e.$,l=e._,c=require("vendor"),h=require("votes/models/follow"),p=n.lib.Channel,d=require("common/views/add-description"),v=t.CollectionView,m=t.SectionView,g=c.Mustache;return a=v.extend(m.prototype),u=a.extend({__super__:v.prototype,template:o,_tagName:"li",_className:"image",page:0,page_limit:7,currentSection:"media",listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore","click .open-photo-player-h":"initPhotoPlayer","dragover #image-place-holder":"drag","drop #image-place-holder":"drop","click .add-to-fans-h":"follow"},renderTemplate:function(){var e=g.to_html(this.template,{target:this.target_id});return this.$el.html(e),this},drag:function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},checkForUser:function(){return!l.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},follow:function(e){e.preventDefault(),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}var t=this,n=new h;n.subject_id=this.data.payload.id,n.entity_id=this.data.payload.enttypes_id,console.log(n),n.save(),f.when(n.request).done(function(){typeof n.get("payload").follower=="object"&&typeof n.get("payload").subject=="object"&&n.get("payload").id>0?(t.controllerObject.reloadFans(),f(e.currentTarget).parents("li").addClass("hide")):console.log("FAIL")})},drop:function(e){var t=this;e.stopPropagation(),e.preventDefault();var n=e.originalEvent.dataTransfer.files;this.files_drag=e.originalEvent.dataTransfer.files;var r=[],i=[],s=0;for(var o=0,u;u=n[o];o++){if(!u.type.match("image.*"))continue;var a=new FileReader;a.onload=function(e){return function(r){var o="preview_"+s;s++,i.push({preview_id:o,drag_info:t.files_drag,width:"150",height:"150",filesrc:r.target.result,title:escape(e.name)}),s==n.length&&(data={data:i},t.openImageUploader(data))}}(u),a.readAsDataURL(u)}},openImageUploader:function(e){var t=this.sport_id,n=this.target_url+this.target_id,r={sports_id:t},i=e;routing.trigger("add-image",n,r,i)},checkForUser:function(){return!l.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(t){console.log("IMAGE LIST",t);for(var n in t)this[n]=t[n];t.name?this.name=t.name:this.name="image list",this.teamName=t.teamName,this.pageName=t.pageName?t.pageName:"profile",t.collecton&&(this.collection=t.collection),t.dontrenderTemplate||this.renderTemplate();var r=this;if(!this.collection.limit){r.allData=this.collection.toArray();var i=r.allData.length;r.start=0,r.end=r.page_limit,r.page_limit=8}r.seeMore(),v.prototype.initialize.call(this,t);if(!this.collection)throw new Error("ImageListView expected options.collection.");var i=r.collection.toJSON().length;(!i||i<r.collection.limit)&&r.$el.find(".see-more-h").hide();if(!i){var s=e.Backbone.Model.extend({});new d({page:this.currentSection,target:this.$el,model:new s,teamName:this.teamName,name:"view - "+Math.random()})}l.bindAll(this),this.addSubscribers(),this.setupBoardView(),this.setupAddView(),r.media_id&&setTimeout(function(){routing.trigger("photo-player-init",undefined,r.collection,r.user_id,!0,r.pageName,r.target_id,r.media_id)},500)},initPhotoPlayer:function(e){var t=this,n=t.collection.limit,r=f(e.target).parents("li").index();r-=1,r<0&&(r=0),routing.trigger("photo-player-init",r,t.collection,t.user_id,!0,t.pageName,t.target_id)},seeMore:function(e){var t=this;if(e&&this.collection.limit)this.collection.offset+=this.collection.limit,this.collection.fetch({remove:!1}),f.when(t.collection.request).done(function(){var e=t.collection.toJSON().length;e<t.collection.limit&&t.$el.find(".see-more-h").hide()});else if(!this.collection.limit){var n=this.allData.length;e&&(this.start=this.end,this.end=this.end+this.page_limit),n<=this.end&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(this.start,this.end)):this.collection.reset(this.allData.slice(this.start,this.end)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())}},childViews:{},setupAddView:function(){function r(e){t.model=e,t.render(),f(this.listView).append(t.el)}var e,t=new s({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),p("addimage:fetch").subscribe(r)},filterWithImageType:function(e){var t=this.collection;return f.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t},addButtons:function(){},setupBoardView:function(){function s(e){n.model=e,n.render()}this.addButtons();if(this.collection.size()==0)return;var e=this.filterWithImageType(this.imagetype),t,n=new i({collection:e,model:e.at(0)}),r=this.addChildView(n);this.childViews.board=n,this.callbacks.add(function(){r(),n.render(),f(this.listView).prepend(n.el)}),p("changeimage"+this.collection.id).subscribe(s)}}),u}),define("profile/views/image-video-list",["facade","utils","media/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",name:"Image List",setupAddView:function(){}}),r}),define("text!site/templates/comment-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid" data-id="bbbbbbbb">\r\n	<div class="user-photo">\r\n		<a href="#profile/{{user.id}}" title="{{user.name}}">\r\n			<img src="{{base_url}}{{poster_picture}}" alt="{{poster}}" />\r\n		</a>\r\n	</div>\r\n\r\n	<div>\r\n		<div class="bubble">\r\n			<div class="pointer"></div>\r\n			<div class="content">\r\n\r\n				<span class="comment-date"><a href="#profile/{{user.id}}" title="{{user.name}}">{{user.name}}</a>  {{poster}} {{comment_date}}</span>\r\n				\r\n				<p class="comment-text">{{{comment}}}</p>\r\n\r\n				{{#is_owner}}<a href="javascript: void(0);" title="delete" class="delete-comment-h comment-delete">Delete</a>{{/is_owner}}\r\n\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n{{/payload}}\r\n\r\n\r\n\r\n'}),define("site/views/comment-item",["vendor","views","utils","text!site/templates/comment-item.html","common/models/delete"],function(e,t,n,r){var i,s=t.BaseView,o=require("common/models/delete"),u=e.Mustache;return i=s.extend({tagName:"li",className:"comment",events:{"click .delete-comment-h":"deleteComments"},initialize:function(e){e.template?this.template=e.template:this.template=r},render:function(){var e=this.model.get("payload");e.comment=e.comment.replace(/\n/g,"<br />"),this.model.set("payload",e);var t=u.to_html(this.template,this.model.toJSON());this.$el.html(t);var n=this;if(e)try{var r=e.user.user_picture_obj.types.small_thumb.url;n.$(".user-photo img").attr("src",r)}catch(i){console.log(i)}return this},deleteComments:function(e){console.log(this.model),e.stopPropagation(),e.preventDefault();var t=this,n=new o;console.log("payload",this.model.get("payload")),n.subject_id=this.model.get("payload").id,n.enttypes_id=this.model.get("payload").enttypes_id,n.removeNode=$(e.currentTarget).parents("li.comment"),n.destroyAndRemove()}}),i}),define("text!site/templates/comment-form.html",[],function(){return'<a href="javascript: void(0);" class="add-comment-h">Comment</a>\r\n{{#payload}}\r\n\r\n<form class="add-comment-form-h hide" method="post" action="#">\r\n<div class="row-fluid">\r\n    <div class="field-message submit-result"></div>\r\n    <textarea style="width:85%;-webkit-border-radius: 15px; border-radius: 15px; height: 20px;\r\n	margin-top: 4%;" id="new-comment" placeholder="Leave a comment" ></textarea>\r\n    <br/><input type="button" id="comment-submit" value="Submit"/>\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("site/views/comment-form",["require","text!site/templates/comment-form.html","facade","views","site/models/comment"],function(e){var t,n=e("text!site/templates/comment-form.html"),r=e("facade"),i=e("views"),s=e("site/models/comment"),o=i.BaseView;return t=o.extend({tagName:"li",template:n,events:{"click #comment-submit":"submitHandler"},setOptions:function(e){if(!this.collection)throw new Error("CommentFormView expected options.collection.");!this.model},render:function(){console.log("RENDER CALLED!!!!"),o.prototype.render.call(this),this.input=this.$("#new-comment");var e=this.model.get("payload");console.log("return payloady",e);var t=this;if(e)var n=e.user_picture,r=e.email;return this},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},submitHandler:function(e){e.preventDefault();var t=this,n=function(n){t.createOnEnter(e)};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){})})},createOnEnter:function(e){var t=this.input.val();t!=""&&this.input.val("")}}),t}),define("text!site/templates/comment-list.html",[],function(){return'<div class="comment-outer-h">\r\n<ul id="comment-list"></ul>\r\n</div>\r\n<div class="clear">\r\n	<a href="javascript: void(0);" class="see-more-h">See More</a>\r\n</div>'}),define("site/views/comment-list",["facade","views","utils","site/views/comment-item","site/views/comment-form","text!site/templates/comment-list.html"],function(e,t,n,r,i,s){var o,u,a=n.lib.Channel,f=require("vendor"),l=t.CollectionView,c=t.SectionView,h=f.Mustache;return u=l.extend(c.prototype),o=u.extend({__super__:l.prototype,listView:"#comment-list",_tagName:"li",_className:"comment",page:1,page_limit:5,prepend:!1,_view:r,template:s,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=h.to_html(this.template);return this.$el.html(e),this},initialize:function(e){this.renderTemplate();var t=this;this.collection=e.collection,console.log(this.collection.toJSON()),t.allData=this.collection.toArray(),t.seeMore(),l.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CommentListView expected options.collection.");_.bindAll(this),this.addSubscribers(),this.setupFormView(),console.log(this.collection.toJSON())},seeMore:function(e){var t=this.allData.length,n=t<this.page_limit?t:this.page_limit,r=t-this.page*n,i=r+this.page_limit;r<=0&&this.$el.find(".see-more-h").hide(),this.prepend=!0,e?this.collection.add(this.allData.slice(r,i)):this.collection.reset(this.allData.slice(r,i)),this.page++,this.prepend=!1,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},childViews:{},setupFormView:function(){function r(n){t.model=n,t.render(),$(e.listView).prepend(t.el)}var e=this,t=new i({collection:this.collection}),n=this.addChildView(t);console.log("Form:",t),this.childViews.form=t,this.callbacks.add(function(){n()}),a("commentform:fetch").subscribe(r)}}),o}),define("profile/views/commentof-list",["facade","utils","site/views/comment-list"],function(e,t,n){var r;return r=n.extend({setupFormView:function(){}}),r}),define("profile/models/commentonform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/commentonform/"+this.id:"/api/user/basics/"+this.id},initialize:function(e,n){i.bindAll(this),t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),routing.trigger("profilecommentonform:fetch",e)}}),r}),define("profile/views/commenton-form",["require","text!site/templates/comment-form.html","profile/models/commentonform","site/views/comment-form","models/base","views"],function(e,t,n,r,i){var s,o=e("views"),u=o.BaseView;return s=u.extend({initialize:function(e){console.error(e),_.bindAll(this),this.setOptions(),u.prototype.initialize.call(this,e)},el:"#comment_div",template:t,events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox"},setOptions:function(e){if(!this.collection)throw new Error("ProfileCommentOnFormView expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(e){var t=this.$el.find(".add-comment-form-h");t.hasClass("hide")?($(e.target).html("Hide"),t.removeClass("hide")):($(e.target).html("Comment"),t.addClass("hide"))},refreshComments:function(e){this.$("#new-comment").val("")},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=this.model.get("id");var s=new i(r);s.url=function(){return _.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/comment/add/":"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.on("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return u.prototype.render.call(this),this.input=this.$("#new-comment"),this.collection.length||$(".add-comment-h").trigger("click"),console.log("run here now",this.el),this}}),s}),define("profile/views/commenton-list",["facade","utils","site/views/comment-list","profile/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}console.log("called");var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){s(e)})}}),s}),define("component/fb",["require","facade","views","utils","vendor","facebook"],function(e){return function(e){var t=this,n="facebook-jssdk-api",r=function(){if(e)for(var t in e)this.currentTarget=e[t]}(),i=function(){FB.init({appId:App.Settings.appId,status:!0,cookie:!0,xfbml:!0,oauth:!0})},s=function(e,n){setTimeout(function(){t[e](n)},2e3)};checkIfScriptExists=function(){var e=document.getElementById(n)?!0:!1;return manageLoader(e),e},manageLoader=function(e){this.currentTarget&&(e?$(this.currentTarget).removeClass("blue-loading"):$(this.currentTarget).addClass("blue-loading"))},this.shareOnFacebook=function(e){if(FB&&typeof FB!="undefined"){if(e.link)var t=window.location.protocol+"//"+window.location.host+"/"+e.link+"/";else var t=undefined;FB.ui({method:e.method||"",name:e.name||"Facebook Dialogs",link:t||"http://localhost/",picture:e.picture||"",caption:e.caption||"",description:e.description||""},function(t){t&&t.post_id?e.success&&_.isFunction(e.success)&&e.success():e.error&&_.isFunction(e.error)&&e.error()})}else new s("shareOnFacebook",e)},this.sendInvite=function(e){if(FB&&typeof FB!="undefined"){if(e.link)var t=window.location.protocol+"//athletez.com/"+e.link+"/";else var t=undefined;FB.ui({method:e.method||"send",to:e.to||"",name:e.name||"Come join Me on Atheletez",link:t||"http://localhost/",picture:e.picture||"",description:e.description||""},function(t){t&&t.success?e.success&&_.isFunction(e.success)&&e.success():e.error&&_.isFunction(e.error)&&e.error()})}else i(),new s("sendInvite",e)},this.getFriends=function(){FB&&typeof FB!="undefined"?FB.api("/me/friends?fields=id,first_name",function(e){}):new s("getFriends",{})},i()}}),define("profile/views/fans-image-list",["facade","utils","media/views/image-list","component/fb","votes/models/follow"],function(e,t,n){var r,i=require("component/fb"),s=require("votes/models/follow");return r=n.extend({imagetype:"large_thumb",currentSection:"fans",setupAddView:function(){},events:{"click .invite-to-fb-h":"inviteFBFriend","mouseover a.tiles":"showText","mouseout a.tiles":"showicon","click .add-to-fans-h":"addToFanList"},showText:function(e){$(e.target).parent().find("span").removeClass("hide")},showicon:function(e){$(e.target).parent().find("span").addClass("hide")},inviteFBFriend:function(e){var t=this,n={},r=function(){n.invite_type="follow",n.subject_id=t.target_id,n.enttype_id=t.controllerObject.basics.get("payload").enttypes_id,routing.trigger("fbInvite",undefined,n)};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},addToFanList:function(e){e.preventDefault();var t=this,n=function(n){var r=new s;r.subject_id=t.collection.id,r.entity_id=t.controllerObject.basics.get("payload").enttypes_id,r.save(),$.when(r.request).done(function(){typeof r.get("payload").follower=="object"&&typeof r.get("payload").subject=="object"&&r.get("payload").id>0&&($(e.target).addClass("link-disabled"),t.controllerObject&&t.controllerObject.reloadFans&&t.controllerObject.reloadFans()),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},afterRender:function(){var e=this,t=setInterval(function(){$ele=e.$el.find(".character-limit-h"),$ele.length&&(clearInterval(t),$ele.each(function(){e.adJustFontDynamically($(this))}))},100)},addButtons:function(){}}),r}),define("text!common/templates/heading.html",[],function(){return'<div class="green-left-heading">{{heading}}</div>\r\n<div class="buttons-h pull-left"></div>'}),define("roster/models/roster",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({}),n}),define("text!vendor/plugins/qtip/qtip.css",[],function(){return'\r\n.qtip{position:absolute;left:-28000px;top:-28000px;display:none;max-width:280px;min-width:50px;font-size:10.5px;line-height:12px;direction:ltr;box-shadow:none;padding:0}.qtip-content{position:relative;padding:5px 9px;overflow:hidden;text-align:left;word-wrap:break-word}.qtip-titlebar{position:relative;padding:5px 35px 5px 10px;overflow:hidden;border-width:0 0 1px;font-weight:700}.qtip-titlebar+.qtip-content{border-top-width:0!important}.qtip-close{position:absolute;right:-9px;top:-9px;cursor:pointer;outline:medium none;border-width:1px;border-style:solid;border-color:transparent}.qtip-titlebar .qtip-close{right:4px;top:50%;margin-top:-9px}* html .qtip-titlebar .qtip-close{top:16px}.qtip-titlebar .ui-icon,.qtip-icon .ui-icon{display:block;text-indent:-1000em;direction:ltr}.qtip-icon,.qtip-icon .ui-icon{-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;text-decoration:none}.qtip-icon .ui-icon{width:18px;height:14px;line-height:14px;text-align:center;text-indent:0;font:400 bold 10px/13px Tahoma,sans-serif;color:inherit;background:transparent none no-repeat -100em -100em}.qtip-focus{}.qtip-hover{}.qtip-default{border-width:1px;border-style:solid;border-color:#F1D031;background-color:#FFFFA3;color:#555}.qtip-default .qtip-titlebar{background-color:#FFEF93}.qtip-default .qtip-icon{border-color:#CCC;background:#F1F1F1;color:#777}.qtip-default .qtip-titlebar .qtip-close{border-color:#AAA;color:#111} .qtip-light{background-color:#fff;border-color:#E2E2E2;color:#454545}.qtip-light .qtip-titlebar{background-color:#f1f1f1} .qtip-dark{background-color:#505050;border-color:#303030;color:#f3f3f3}.qtip-dark .qtip-titlebar{background-color:#404040}.qtip-dark .qtip-icon{border-color:#444}.qtip-dark .qtip-titlebar .ui-state-hover{border-color:#303030} .qtip-cream{background-color:#FBF7AA;border-color:#F9E98E;color:#A27D35}.qtip-cream .qtip-titlebar{background-color:#F0DE7D}.qtip-cream .qtip-close .qtip-icon{background-position:-82px 0} .qtip-red{background-color:#F78B83;border-color:#D95252;color:#912323}.qtip-red .qtip-titlebar{background-color:#F06D65}.qtip-red .qtip-close .qtip-icon{background-position:-102px 0}.qtip-red .qtip-icon{border-color:#D95252}.qtip-red .qtip-titlebar .ui-state-hover{border-color:#D95252} .qtip-green{background-color:#CAED9E;border-color:#90D93F;color:#3F6219}.qtip-green .qtip-titlebar{background-color:#B0DE78}.qtip-green .qtip-close .qtip-icon{background-position:-42px 0} .qtip-blue{background-color:#E5F6FE;border-color:#ADD9ED;color:#5E99BD}.qtip-blue .qtip-titlebar{background-color:#D0E9F5}.qtip-blue .qtip-close .qtip-icon{background-position:-2px 0}.qtip-shadow{-webkit-box-shadow:1px 1px 3px 1px rgba(0,0,0,.15);-moz-box-shadow:1px 1px 3px 1px rgba(0,0,0,.15);box-shadow:1px 1px 3px 1px rgba(0,0,0,.15)}.qtip-rounded,.qtip-tipsy,.qtip-bootstrap{-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.qtip-rounded .qtip-titlebar{-moz-border-radius:4px 4px 0 0;-webkit-border-radius:4px 4px 0 0;border-radius:4px 4px 0 0}.qtip-youtube{-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-webkit-box-shadow:0 0 3px #333;-moz-box-shadow:0 0 3px #333;box-shadow:0 0 3px #333;color:#fff;border-width:0;background:#4A4A4A;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#4A4A4A),color-stop(100%,#000));background-image:-webkit-linear-gradient(top,#4A4A4A 0,#000 100%);background-image:-moz-linear-gradient(top,#4A4A4A 0,#000 100%);background-image:-ms-linear-gradient(top,#4A4A4A 0,#000 100%);background-image:-o-linear-gradient(top,#4A4A4A 0,#000 100%)}.qtip-youtube .qtip-titlebar{background-color:#4A4A4A;background-color:rgba(0,0,0,0)}.qtip-youtube .qtip-content{padding:.75em;font:12px arial,sans-serif;filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#4a4a4a, EndColorStr=#000000);-ms-filter:"progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#4a4a4a, EndColorStr=#000000);"}.qtip-youtube .qtip-icon{border-color:#222}.qtip-youtube .qtip-titlebar .ui-state-hover{border-color:#303030}.qtip-jtools{background:#232323;background:rgba(0,0,0,.7);background-image:-webkit-gradient(linear,left top,left bottom,from(#717171),to(#232323));background-image:-moz-linear-gradient(top,#717171,#232323);background-image:-webkit-linear-gradient(top,#717171,#232323);background-image:-ms-linear-gradient(top,#717171,#232323);background-image:-o-linear-gradient(top,#717171,#232323);border:2px solid #ddd;border:2px solid rgba(241,241,241,1);-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-webkit-box-shadow:0 0 12px #333;-moz-box-shadow:0 0 12px #333;box-shadow:0 0 12px #333}.qtip-jtools .qtip-titlebar{background-color:transparent;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171, endColorstr=#4A4A4A);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171, endColorstr=#4A4A4A)"}.qtip-jtools .qtip-content{filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A, endColorstr=#232323);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A, endColorstr=#232323)"}.qtip-jtools .qtip-titlebar,.qtip-jtools .qtip-content{background:transparent;color:#fff;border:0 dashed transparent}.qtip-jtools .qtip-icon{border-color:#555}.qtip-jtools .qtip-titlebar .ui-state-hover{border-color:#333}.qtip-cluetip{-webkit-box-shadow:4px 4px 5px rgba(0,0,0,.4);-moz-box-shadow:4px 4px 5px rgba(0,0,0,.4);box-shadow:4px 4px 5px rgba(0,0,0,.4);background-color:#D9D9C2;color:#111;border:0 dashed transparent}.qtip-cluetip .qtip-titlebar{background-color:#87876A;color:#fff;border:0 dashed transparent}.qtip-cluetip .qtip-icon{border-color:#808064}.qtip-cluetip .qtip-titlebar .ui-state-hover{border-color:#696952;color:#696952}.qtip-tipsy{background:#000;background:rgba(0,0,0,.87);color:#fff;border:0 solid transparent;font-size:11px;font-family:\'Lucida Grande\',sans-serif;font-weight:700;line-height:16px;text-shadow:0 1px #000}.qtip-tipsy .qtip-titlebar{padding:6px 35px 0 10px;background-color:transparent}.qtip-tipsy .qtip-content{padding:6px 10px}.qtip-tipsy .qtip-icon{border-color:#222;text-shadow:none}.qtip-tipsy .qtip-titlebar .ui-state-hover{border-color:#303030}.qtip-tipped{border:3px solid #959FA9;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-color:#F9F9F9;color:#454545;font-weight:400;font-family:serif}.qtip-tipped .qtip-titlebar{border-bottom-width:0;color:#fff;background:#3A79B8;background-image:-webkit-gradient(linear,left top,left bottom,from(#3A79B8),to(#2E629D));background-image:-webkit-linear-gradient(top,#3A79B8,#2E629D);background-image:-moz-linear-gradient(top,#3A79B8,#2E629D);background-image:-ms-linear-gradient(top,#3A79B8,#2E629D);background-image:-o-linear-gradient(top,#3A79B8,#2E629D);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8, endColorstr=#2E629D);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8, endColorstr=#2E629D)"}.qtip-tipped .qtip-icon{border:2px solid #285589;background:#285589}.qtip-tipped .qtip-icon .ui-icon{background-color:#FBFBFB;color:#555}.qtip-bootstrap{font-size:14px;line-height:20px;color:#333;padding:1px;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,.2);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,.2);box-shadow:0 5px 10px rgba(0,0,0,.2);-webkit-background-clip:padding-box;-moz-background-clip:padding;background-clip:padding-box}.qtip-bootstrap .qtip-titlebar{padding:8px 14px;margin:0;font-size:14px;font-weight:400;line-height:18px;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;-webkit-border-radius:5px 5px 0 0;-moz-border-radius:5px 5px 0 0;border-radius:5px 5px 0 0}.qtip-bootstrap .qtip-titlebar .qtip-close{right:11px;top:45%;border-style:none}.qtip-bootstrap .qtip-content{padding:9px 14px}.qtip-bootstrap .qtip-icon{background:transparent}.qtip-bootstrap .qtip-icon .ui-icon{width:auto;height:auto;float:right;font-size:20px;font-weight:700;line-height:18px;color:#000;text-shadow:0 1px 0 #fff;opacity:.2;filter:alpha(opacity=20)}.qtip-bootstrap .qtip-icon .ui-icon:hover{color:#000;text-decoration:none;cursor:pointer;opacity:.4;filter:alpha(opacity=40)}.qtip:not(.ie9haxors) div.qtip-content,.qtip:not(.ie9haxors) div.qtip-titlebar{filter:none;-ms-filter:none}.qtip .qtip-tip{margin:0 auto;overflow:hidden;z-index:10}x:-o-prefocus,.qtip .qtip-tip{visibility:hidden}.qtip .qtip-tip,.qtip .qtip-tip .qtip-vml,.qtip .qtip-tip canvas{position:absolute;color:#123456;background:transparent;border:0 dashed transparent}.qtip .qtip-tip canvas{top:0;left:0}.qtip .qtip-tip .qtip-vml{behavior:url(#default#VML);display:inline-block;visibility:visible}\r\n.qtip-athletez{\r\n    font-size: 1em;\r\n    font-family: "Helvetica Neue", "Raleway";\r\n    line-height: 1.0em;\r\n    padding:4px;\r\n    color: white;\r\n}\r\n.qtip-photo{\r\n    background-color: #ddd43a;\r\n    border-color: #ddd43a;\r\n}\r\n.qtip-video, .qtip-red-c{\r\n    background-color: #c43737;\r\n    border-color: #c43737;\r\n}\r\n.qtip-yellow-c {\r\n	 background-color: #ddd439;\r\n    border-color: #ddd439;\r\n}\r\n.qtip-question {\r\n	 background-color: #014a7f;\r\n    border-color: #014a7f;\r\n}\r\n.qtip-green-c {\r\n	 background-color: #1ba0af;\r\n    border-color: #1ba0af;\r\n}\r\n.qtip-fb-c {\r\n	 background-color: #6b74b7;\r\n    border-color: #6b74b7;\r\n}\r\n.qtip-game {\r\n	 background-color: #d65d28;\r\n    border-color: #d65d28;\r\n	\r\n}\r\n.qtip-team{\r\n	 background-color: #948ce1;\r\n    border-color: #948ce1;\r\n}\r\n.qtip-team {\r\n    background-color: #4b3dc6;\r\n    border-color: #4b3dc6;\r\n}\r\n.qtip-game{\r\n    background-color: #d36011;\r\n    border-color: #d36011;\r\n}\r\n.qtip-athlete{\r\n    background-color: #9cca3c;\r\n    border-color: #9cca3c;\r\n}\r\n.qtip-orange {\r\n    background-color: #d45c27;\r\n    border-color: #d45c27;\r\n	\r\n}\r\n'}),define("common/views/add-media-buttons",["require","text!common/templates/heading.html","facade","views","votes/models/follow","roster/models/roster","vendor/plugins/qtip/qtip","text!vendor/plugins/qtip/qtip.css"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("votes/models/follow"),o=e("roster/models/roster"),u=i.BaseView;return n=u.extend({events:{"click .add-image-h":"addImage","click .add-video-h":"addVideo","click .question":"addQuestion","click .add-to-list-h":"addToList","click .invite-fans-from-fb-h":"InviteFromFB","click .invite-participant-from-fb-h":"InviteFromFB","click .add-to-roster-list-h":"addToRoster","click .add-to-participants-list-h":"addParticipant","click .invite-roster-from-fb-h":"InviteFromFB"},addImage:function(e){var t=$(e.currentTarget).data("page-base")||"user",n=$(e.currentTarget).data("ent-id"),r=$(e.currentTarget).data("sports-id");ga("send","event","Open-Add-Popup","Image","User opened "+t+" image uploader",n);var i=$(".selected-sport-h").data("id")||$(".sports-h").val()||$(".sports-h").attr("data-id"),s="/api/"+t+"/addimage/"+n,o={sports_id:r};routing.trigger("add-image",s,o)},addVideo:function(e){ga("send","event","Open-Add-Popup","Video","User opened video uploader",this.model.userid);var t="/api/user/addvideo/"+this.model.userid;Channel("add-video").publish(t)},addQuestion:function(e){},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},addParticipant:function(e){routing.trigger("add-to-event")},addToList:function(e){e.preventDefault();var t=this,n=function(n){var r=new s;r.subject_id=t.collection.id,r.entity_id=t.controllerObject.basics.get("payload").enttypes_id,r.save(),$.when(r.request).done(function(){typeof r.get("payload").follower=="object"&&typeof r.get("payload").subject=="object"&&r.get("payload").id>0&&($(e.target).addClass("link-disabled"),t.controllerObject&&t.controllerObject.reloadFans&&t.controllerObject.reloadFans()),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},InviteFromFB:function(e){var t=this,n={};console.log(t.controllerObject),t.data.inviteData==undefined||!typeof t.data.inviteData==="object"?(n.invite_type="follow",n.subject_id=t.target_id?t.target_id:t.controllerObject.basics.get("payload").id,n.enttype_id=t.controllerObject.basics.get("payload").enttypes_id):n=t.data.inviteData,console.log(n);var r=function(){routing.trigger("fbInvite",undefined,n)};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},addToRoster:function(e){this.addToRoster&&this.addToRoster()},className:"pull-left",initialize:function(e){console.error(e);for(var t in e)this[t]=e[t];this.data=e,this.render()},render:function(){var e=this,n=Mustache.to_html(t,{heading:this.heading});this.$el.html(n),$(this.target).html(this.$el);var r=Mustache.to_html(this.template,{data:this.data});this.$el.find(".buttons-h").html(r),this.$el.find("a").each(function(){$(this).qtip({content:$(this).data("content"),position:{my:"bottom center",at:"top center"},style:{classes:$(this).data("tip-style")}})})}}),n}),define("text!common/templates/add-media-buttons.html",[],function(){return'<a href="javascript: void(0);" data-page-base="{{data.page_base}}" data-ent-id="{{data.ent_id}}" data-sports-id="{{data.sports_id}}" data-tip-style="qtip-athletez qtip-yellow-c" class="add-image add-icon add-image-h" data-content="{{#data.teamName}}Upload images of {{data.teamName}}{{/data.teamName}}{{#data.message}} {{data.message.photo}} {{/data.message}}"></a>\r\n<a href="javascript: void(0);" data-page-base="{{data.page_base}}" data-ent-id="{{data.ent_id}}" data-sports-id="{{data.sports_id}}" class="add-video add-icon add-video-h" data-tip-style="qtip-athletez qtip-red-c" data-content="{{#data.teamName}}Upload images of {{data.teamName}}{{/data.teamName}}{{#data.message.video}} {{data.message.video}} {{/data.message.video}}" ></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-question" data-content="The media section has a list of all images or videos.  Click on a tile to open it in the photo / video player" data-page="media" class="question question-h add-icon"></a>'}),define("text!common/templates/add-fans-buttons.html",[],function(){return'<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-green-c" data-content="{{#data.teamName}}Follow {{data.teamName}} and stay notified of any updates{{/data.teamName}}{{#data.message.addMe}} {{data.message.addMe}} {{/data.message.addMe}}" class="add-to-list add-icon add-to-list-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-fb-c" data-content="{{#data.teamName}}Invite friends from facebook to get notified of any updates to {{data.teamName}}{{/data.teamName}}{{#data.message.fb}} {{data.message.fb}} {{/data.message.fb}}" class="invite-from-fb add-icon invite-fans-from-fb-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-question" data-content="The fans section shows a list of all people who receive notifications when there is any action on this page." data-page="fans" class="question question-h add-icon"></a>'}),define("text!common/templates/add-games-buttons.html",[],function(){return'<!--<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-game" data-content="{{#data.teamName}}Add a new game to the schedule for {{data.teamName}}{{/data.teamName}}" class="game-adder add-icon game-adder-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-question" data-content="this is for test" data-page="fans" class="question question-h add-icon"></a>-->'}),define("profile",["require","text!profile/templates/layout.html","application","votes/views/vote-section","facade","controller","models","views","utils","profile/models/basics","profile/models/addmedia","profile/collections/orgs","profile/collections/relateds","profile/collections/fitnessbasics","profile/collections/videos","profile/collections/image-videos","profile/collections/commentsof","profile/collections/commentson","schedules/collections/user-games","profile/collections/fans","profile/views/header","profile/views/add-media","schedules/views/schedule-list","user/views/related-list","user/views/fitnessbasic-list","profile/views/video-list","profile/views/image-video-list","profile/views/commentof-list","profile/views/commenton-list","profile/views/fans-image-list","common/views/add-media-buttons","text!common/templates/add-media-buttons.html","text!common/templates/add-fans-buttons.html","text!common/templates/add-games-buttons.html","application"],function(e,t,n,r){var i,s=e("facade"),o=e("controller"),u=e("models"),a=e("views"),f=e("utils"),l=e("profile/models/basics"),c=e("profile/models/addmedia"),h=e("profile/collections/orgs"),p=e("profile/collections/relateds"),d=e("profile/collections/fitnessbasics"),v=e("profile/collections/image-videos"),m=e("profile/collections/commentsof"),g=e("profile/collections/commentson"),y=e("schedules/collections/user-games"),b=e("profile/collections/fans"),w=e("profile/views/header"),E=e("profile/views/add-media"),S=e("schedules/views/schedule-list"),x=e("user/views/related-list"),T=e("user/views/fitnessbasic-list"),N=e("profile/views/image-video-list"),C=e("profile/views/commentof-list"),k=e("profile/views/commenton-list"),L=e("profile/views/fans-image-list"),A=e("common/views/add-media-buttons"),O=e("text!common/templates/add-media-buttons.html"),M=e("text!common/templates/add-fans-buttons.html"),_=e("text!common/templates/add-games-buttons.html"),D=e("media/models/image"),P=a.LayoutView,H=s.$,B=s._,j=f.debug,F=f.lib.Channel,I=["/pages/profile/profile.css"];return i=o.extend({initialize:function(e){this.callbackcount=1;var t=this;return F("load:css").publish(I),B.bindAll(t),t.handleOptions(e),t.scheme=[],e.params&&this.setParamsArray(e.params),e.userId?(t.id=e.userId,t.init()):t.init(),t},init:function(){this.setupLayout().render(),this.createData(),this.handleDeferreds()},createData:function(){function t(t){if(e.ajaxCalls&&e.ajaxCalls.length){for(var r in e.ajaxCalls)e.ajaxCalls[r].abort();e.ajaxCalls=[]}delete e.orgViewname,e.refreshPage(),e.sports_id=t,e.orgs=new h,e.orgs.id=e.id,e.orgs.sport_id=t,e.orgs.targetElement="#games_div",e.ajaxCalls.push(e.orgs.fetch()),e.fitnessbasics=new d,e.fitnessbasics.id=e.id,e.fitnessbasics.sport_id=t,e.ajaxCalls.push(e.fitnessbasics.fetch()),e.images=new v,e.images.id=e.id,e.images.sport_id=t,e.images.targetElement="#image-wrap",e.ajaxCalls.push(e.images.fetch()),e.handleDeferredsDynamic(),n(t)}function n(t){e.fans=new b,e.fans.id=e.id,e.fans.sport_id=t,e.fans.targetElement="#fans-div",e.fans.fetch(),H.when(e.fans.request).done(function(t){if(e.fansListView){var n;H(e.fansListView.destination).html(""),n=H.inArray(e.fansListView,e.scheme),~n&&e.scheme.splice(n,1)}e.setupFansListView()})}this.basics=new l({id:this.id}),this.basics.id=this.id,this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new c,this.addmedia.id=this.id,this.fans=new b,this.fans.id=this.id,this.fans.targetElement="#fans-div",this.fans.fetch();var e=this;e.ajaxCalls=[],F("new-fan","nomemory unique").subscribe(n),F("refresh-profilepage","unique").subscribe(t)},handleDeferreds:function(){var e=this;H.when(this.basics.request).done(function(){e.setupHeaderView(),e.initVoteView();var t=e.basics.get("payload").enttypes_id;e.commentson=new g,e.commentson.subject_entity_type=t,e.commentson.id=e.id,e.commentson.targetElement="#commenton-wrap",e.commentson.fetch(),H.when(e.commentson.request).done(function(){e.setupCommentOnListView()})})},initVoteView:function(){var e=new r({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},handleDeferredsDynamic:function(){var e=this;H.when(this.orgs.request).done(function(){e.setupOrgListView()}),H.when(this.fitnessbasics.request).done(function(){e.setupFitnessBasicListView()}),H.when(this.fans.request).done(function(t){e.setupFansListView()}),H.when(this.images.request).done(function(t){e.setupImageListView()})},refreshPage:function(){var e;this.orgListView&&(H(this.orgListView.destination).html(""),e=H.inArray(this.orgListView,this.scheme),~e&&this.scheme.splice(e,1)),this.relatedListView&&(H(this.relatedListView.destination).html(""),e=H.inArray(this.relatedListView,this.scheme),~e&&this.scheme.splice(e,1)),this.fitnessBasicListView&&(H(this.fitnessBasicListView.destination).html(""),e=H.inArray(this.fitnessBasicListView,this.scheme),~e&&this.scheme.splice(e,1)),this.imageListView&&(H(this.imageListView.destination).html(""),e=H.inArray(this.imageListView,this.scheme),~e&&this.scheme.splice(e,1)),this.fansListView&&(H(this.fansListView.destination).html(""),e=H.inArray(this.fansListView,this.scheme),~e&&this.scheme.splice(e,1))},setupHeaderView:function(){var e;e=new w({model:this.basics,sports_id:this.sports_id>0?this.sports_id:null,name:"Header",sports_id:this.sport_id,destination:"#main-header"}),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(e){},getOrgData:function(){var e;this.orgListView&&(H(this.orgListView.destination).html(""),e=H.inArray(this.orgListView,this.scheme),~e&&this.scheme.splice(e,1));var t=this;t.orgs.fetch(),H.when(t.orgs.request).done(function(){t.setupOrgListView()})},setupOrgListView:function(){var e;H(".selected-sport-h").data("sporttype")==1?this.setUpOrgView():this.setUpUserSportView()},setUpUserSportView:function(){var e=this;this.orgViewname="sport",this.orgs=new y,this.orgs.userId=e.id,this.orgs.sports_id=H(".selected-sport-h").data("id"),this.orgs.fetch(),H.when(this.orgs.request).done(function(){e.orgListView&&(H(e.orgListView.destination).html(""),position=H.inArray(e.orgListView,e.scheme),~position&&e.scheme.splice(position,1)),e.orgListView=new S({collection:e.orgs,controller:e,destination:"#games_div",eventPage:H(".selected-sport-h").data("name"),teamName:e.basics.get("payload").first_name}),e.scheme.push(e.orgListView),e.layout.render()})},setUpOrgView:function(){var e;this.orgListView&&(H(this.orgListView.destination).html(""),e=H.inArray(this.orgListView,this.scheme),~e&&this.scheme.splice(e,1)),this.orgViewname="org",this.orgListView=new S({collection:this.orgs,controller:this,destination:"#games_div"}),this.scheme.push(this.orgListView),this.layout.render()},setupRelatedListView:function(){var e;this.relatedListView=new x({collection:this.relateds,destination:"#related-wrap"}),this.scheme.push(this.relatedListView),this.layout.render()},setupFitnessBasicListView:function(){var e;this.fitnessBasicListView=new T({collection:this.fitnessbasics,destination:"#fitnessbasic-wrap"}),this.scheme.push(this.fitnessBasicListView),this.layout.render()},setupVideoListView:function(){var e;this.videoListView=new ProfileVideoListView({collection:this.videos,destination:"#video-wrap"}),this.scheme.push(this.videoListView),this.layout.render()},setupImageListView:function(){var e=this;this.addmedia.sportName=H(".selected-sport-h").data("name"),this.addmedia.firstName=this.basics.get("payload").first_name,this.addmedia.setData();var t=new A({target:".media-add-icons-h",heading:"PHOTO/VIDEO",template:O,controllerObject:e,page_base:"user",ent_id:e.id,sports_id:H(".selected-sport-h").data("id"),model:e.addmedia,message:{photo:"Add "+this.addmedia.sportName+" pics of "+this.addmedia.firstName,video:"Add "+this.addmedia.sportName+" videos of "+this.addmedia.firstName}});routing.off("image-upload-success"),routing.on("image-upload-success",function(t){e.updateImages(t)}),routing.off("setup-add-icons"),routing.on("setup-add-icons",function(t){e.setupAddMediaView(t)}),this.imageListView=new N({collection:this.images,destination:"#image-wrap",target_id:this.id,target_url:"/api/user/addimage/",sport_id:H(".selected-sport-h").data("id"),media_id:this.media_id,user_id:this.id,name:"images View 2",pageName:"profile",triggerItem:"setup-add-icons",teamName:this.basics.get("payload").first_name}),this.scheme.push(this.imageListView),this.layout.render()},reloadFans:function(){var e=this,t;this.fansListView&&(H(this.fansListView.destination).html(""),t=H.inArray(this.fansListView,this.scheme),~t&&this.scheme.splice(t,1)),e.fans.fetch(),H.when(e.fans.request).done(function(){e.setupFansListView()})},setupFansListView:function(){var e=new A({target:".fans-add-icons-h",heading:"FANS",template:M,controllerObject:this,collection:this.fans,inviteData:{invite_type:"follow",subject_id:this.basics.get("payload").id,enttypes_id:this.basics.get("payload").enttypes_id},message:{addMe:"Keep me notified of "+this.basics.get("payload").first_name+"'s activity",fb:"Invite a friend to receive notifications about  "+this.basics.get("payload").first_name+"'s activity"}});this.fansListView&&(H(this.fansListView.destination).html(""),position=H.inArray(this.fansListView,this.scheme),~position&&this.scheme.splice(position,1)),this.fansListView=new L({collection:this.fans,destination:"#fans-div",target_id:this.id,controllerObject:this,pageName:"profile",data:this.basics.toJSON(),name:"fansView",teamName:this.basics.get("payload").first_name}),this.scheme.push(this.fansListView),this.layout.render()},reloadImages:function(){var e=this,t;this.imageListView&&(H(this.imageListView.destination).html(""),t=H.inArray(this.imageListView,this.scheme),~t&&this.scheme.splice(t,1)),e.images.fetch(),H.when(e.images.request).done(function(){e.setupImageListView()})},updateImages:function(e){var t=new D;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON()),console.log(this.imageListView.collection),this.imageListView.collection.length==1&&this.reloadImages()},setupCommentOfListView:function(){var e;e=new C({collection:this.commentsof,destination:"#commentof-wrap"})},setupCommentOnListView:function(){var e;this.commentOnListView=new k({collection:this.commentson,destination:"#commenton-wrap"}),this.scheme.push(this.commentOnListView),this.layout.render()},setupLayout:function(){var e;return e=new P({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),i}),define("text!imageup/templates/basic.html",[],function(){return'<!--<div id="url" class="url">URL\r\n	<select id="url_tag">\r\n		<option value="user">Users</option>\r\n		<option value="game">Games</option>\r\n		<option value="team">Teams</option>\r\n	</select>\r\n	<input type="text" name="id_tag" id="id_tag" placeholder="ID"/>\r\n</div>\r\n<a href="#imgUploadModal" role="button" class="btn" data-toggle="modal">Upload Image</a>\r\n--><div id="imgUploadModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n		<h3 id="label">Image Uploader</h3>\r\n	</div>\r\n\r\n	<div class="side-panel" id="left_upload">\r\n		\r\n	</div>\r\n\r\n	<div class="main-body">\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n<div class="clear"></div>\r\n</div>'}),define("text!imageup/templates/uploader.html",[],function(){return'<div id="main-content-img" class="imageholder">\r\n	<div align="center" class="m_top_50"><input type="file" id="image_file" class="files" name="image_file[]" multiple="">\r\n		<div class="clear"></div>\r\n		<div class="textcenter m_top_50 bigger">\r\n			<button class="btn fileuploader btn-primary" id="imageup" type="button">Upload and Finish</button>\r\n		</div>\r\n	</div>\r\n</div>\r\n<div id="main-content-tag-section" class="imageholder floatLeft m_top_2 displayNone">\r\n		<div id="image-tagging" class="displayNone">\r\n			\r\n		</div>\r\n		<div id="select-allup" class="tag_select_all">\r\n			\r\n		</div>	\r\n</div>'}),define("imageup/models/basic",["facade","media/models/image"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("imageup/models/imageupload",["facade","media/models/image"],function(e,t){var n,r=e._;return ImageUploadModel=t.extend({initialize:function(e,n){t.prototype.initialize.call(e,n)}}),n}),define("imageup/models/errorshow",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{msg:null,color:null}),initialize:function(e,t){}}),n}),define("imageup/collections/basics",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/"+this.id+"/images/":"/api/user/images/"}}),r}),define("imageup/models/preview",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({initialize:function(e,t){}}),n}),define("text!imageup/templates/select_all.html",[],function(){return'<div class="well-large div_select_all">\r\n	<div class="text-center m_top_20 bigger">SELECT IMAGES TO TAG A TEAM, PLAYER OR GAME</div>\r\n	<div class="clear"></div>\r\n	<div class="text-center m_top_20 bigger" >OR</div>\r\n	<div class="clear"></div>\r\n	<div class="text-center m_top_20 bigger"><a href="javascript:void(0)" id="btn_select_all_h">SELECT ALL</a></div>\r\n	<div class="clear"></div>\r\n</div>'}),define("text!usercontrols/tag/templates/layout.html",[],function(){return'<div class="well-large container_batch_tag">\r\n	<h4>Tagging</h4>\r\n	<div class="section-Add-Sports_h well-large">\r\n	<div class="m_bottom_10">\r\n		Select Sport:\r\n	</div>\r\n	<div class="row-fluid section_inner">\r\n		<span class="span-ddl-sports-tag_h dropdown"></span>\r\n		<div class="clear"></div>\r\n		<!-- <select class="ddl-tag-sports_h" style=></select> -->\r\n		<span class="displayNone field-message"></span> \r\n	<br/>\r\n	<button class="btn btn-primary btn-tag-sport_h displayNone">Done</button>\r\n	</div>\r\n	\r\n	</div>\r\n	<div class="div-tag-list_h section_outer">		\r\n	<div class="section-sports_h displayNone">\r\n		<label class="lbl-tag-sport-name_h bigger"></label>\r\n		<!-- <div class="clear"></div> -->\r\n		<span>\r\n			<a href="javascript:void(0)" class="btn-tag-edit-sport_h">Change Sport</a></span>\r\n	</div>\r\n	\r\n	<div class="section-team_h displayNone section_inner">\r\n		<strong>Teams :</strong> <br/>\r\n		<label class="lbl-tag-team-name_h"></label><span><button class="btn btn-tag-edit-team_h displayNone">Edit</button></span>\r\n	</div>\r\n\r\n	<div class="section-events_h displayNone section_inner">\r\n		<strong>Event:</strong> <br/>\r\n		<label class="lbl-tag-event-name_h"></label><span><button class="btn btn-tag-edit-event_h displayNone">Edit</button></span>\r\n	</div>\r\n	\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-team_h displayNone section_outer">\r\n		Tag a Team : \r\n		<br/>\r\n		<input type="text" class="txt-tag-team-state_h displayNone" placeholder="Enter State" />\r\n		<div class="clear"></div>\r\n		<input type="text" class="txt-tag-team-city_h displayNone" placeholder="Enter City" />\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-tag-team-school_h" placeholder="Enter Team" />\r\n	<!--	<select class="ddl-tag-team-level_h displayNone"></select>\r\n		<select class="ddl-tag-team-season_h displayNone"></select> -->\r\n	 	<div class="clear"></div>\r\n	 	<span class="displayNone field-message"></span> \r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-team-Done_h displayNone">Done</button>\r\n		\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-event_h displayNone section_outer">\r\n		Tag an Event:\r\n		<br/>\r\n		<input type="text" class="txt-tag-event-state_h" placeholder="Enter State" />\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-tag-event_h" disabled="disabled" placeholder="Enter The Event\'s Title" />\r\n		<div class="clear"></div>\r\n		<span class="displayNone field-message"></span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-event-Done_h displayNone">Done</button>\r\n\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-player_h displayNone section_outer">\r\n		Tag a Player : \r\n		<br/>\r\n		<div class="section-tag-player-input_h">\r\n		<input type="text" class="txt-tag-player-name_h" placeholder="Enter Name" />\r\n		</div>\r\n		<div class="clear"></div>\r\n		<span class="btn-tag-add-player_h strong">\r\n			+\r\n		</span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-player-Done_h">Done</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-team-players_h displayNone section_inner">\r\n		<strong>Players :</strong> \r\n<div class="clear"></div>\r\n		<label class="lbl-tag-players-name_h"></label>\r\n		<span class="displayNone"><button class="btn btn-tag-edit-players-team_h displayNone">Edit</button></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-tag-game_h displayNone section_outer">\r\n		<strong>Tag a Game : </strong>\r\n		<div class="clear"></div>\r\n		<span class="span-ddl-games-tag_h  dropdown"></span>\r\n		<!-- <select class="ddl-tag-game_h"></select> -->\r\n		<div class="clear"></div>\r\n		<span class="displayNone field-message"></span>\r\n		<div class="clear"></div>\r\n		<button class="btn btn-primary btn-tag-game-Done_h displayNone">Done</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-team-games_h displayNone section_outer">\r\n		<strong>Games :</strong>\r\n		<div class="clear"></div>\r\n		<label class="lbl-tag-games-name_h"></label><span class="displayNone"><button class="btn btn-tag-edit-games-team_h displayNone">Edit</button></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-link_h displayNone section_outer">\r\n\r\n		<div class="fixed-icons">\r\n			<ul>\r\n				<li><a id="user" class="link-tag-player_h icons athlete restype" data-selected-class="athlete_selected icon_selected" data-number="2" title="Tag a Player" href="javascript:void(0);"></a></li>\r\n				<li><a id="org" class="link-tag-team_h icons team restype" data-selected-class="team_selected icon_selected" data-number="4" title="Tag a Team" href="javascript:void(0);"></a></li>\r\n				<li><a id="game" class="link-tag-Game_h icons events-games restype" data-selected-class="events-games_selected icon_selected" data-number="3" title="Tag a Game" href="javascript:void(0);"></a></li>\r\n				<li><a id="event" class="link-tag-event_h icons events-games restype" data-selected-class="events-games_selected icon_selected" data-number="3" title="Tag an Event" href="javascript:void(0);"></a></li>\r\n			</ul>\r\n		</div>\r\n		<span class="displayNone field-message"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<!-- <div class="section_outer">\r\n		<button class="btn btn-primary btn-tag-Finish_h displayNone">Finish</button>\r\n	</div> -->\r\n</div>'}),define("text!imageup/templates/error_template.html",[],function(){return'<div class="alert {{color}}" align="center">\r\n	<button type="button" class="close" data-dismiss="alert">&times;</button>\r\n	{{msg}}\r\n</div>'}),define("imageup/views/errors",["require","text!imageup/templates/error_template.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=e("vendor"),a=i.SectionView,f=r.$,l=r._,c=s.debug;return n=a.extend({id:"main-content",template:t,initialize:function(e){a.prototype.initialize.call(this,e),c.log("error view")}}),n}),define("usercontrols/tag/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports_listall",["facade","collections","sportorg/collections/sports"],function(e,t,n){var r;return r=n.extend({sport_type:null,sport_type_id:null,male:1,female:0,url:function(){return baseUrl="/api/sport/listall/?male="+this.male+"&female="+this.female+"&sport_type="+this.sport_type+"&sport_type_id="+this.sport_type_id},ParseForDropdown:function(){var e=this,t=e.toJSON();return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var n=t.payload,r="";n.male=="1"&&n.female=="1"?r="":n.male=="1"?r="Men's ":n.female=="1"&&(r="Women's "),t.payload.custom_name=r+n.sport_name,t.payload.team_type=n.sport_type?n.sport_type.name||"":""}}),t}}),r}),define("usercontrols/tag/collections/schools",["facade","utils","sportorg/collections/orgs","sportorg/models/org"],function(e,t,n,r){var i;return i=n.extend({url:function(){var e=this;return testpath?testpath+"/api/org/search/"+this.sport_id:"/api/org/search?states_id="+e.states_id+"&org_name="+e.org_name},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("usercontrols/tag/collections/teams",["facade","collections","sportorg/collections/teams","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.team_name&&(e+="team_name="+this.team_name),this.team_name&&(e+="&searchtext="+this.team_name),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.sports_id&&(e+="&sports_id="+this.sports_id),e+="&response_profile=team_min","/api/team/search?"+e}}),i}),define("models/common",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("location/collections/cities",["facade","collections","models/common","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){if(this.city_name==undefined)return"/api/city/search";var e="?city_name="+this.city_name;return this.states_id&&(e+="&states_id="+this.states_id),"/api/city/search/"+e},fetchSuccess:function(e,t){e.reset();var n=t.payload;if(n!=null)for(i=0;i<(n.length>10?10:n.length);i++){var r={};r.city=n[i].name,r.county=n[i].county.name,r.state=n[i].county.state.name,r.id=n[i].id,e.push(r)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("user/models/common",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("user/collections/users",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,url:function(){var e="";return this.user_name&&(e+="searchtext="+this.user_name),this.sports_id&&(e+="&sports_id="+this.sports_id),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.team_id&&(e+="&team_id="+this.cities_id),"/api/user/search?"+e},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("sportorg/models/game",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,game_name:null,game_day:null,game_time:null,game_picture:null,teams:[{team_name:null,team_location:null,points_scored:0,points_against:0,is_winner:null}],game_location:null},desc:"Game information",exec_data:{exec_time:0,exec_error:!1}}),url:function(){return"/api/game/basics/"+this.id}}),n}),define("sportorg/collections/games",["facade","collections","sportorg/models/game","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},ParseForDropdown:function(){var e=this,t=e.toJSON();return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var n=t.payload;t.payload.custom_name=n.game_name}}),t}}),s}),define("usercontrols/tag/collections/games",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.sports_id&&(e+="sports_id="+this.sports_id+"&"),this.teams_id&&(e+="teams_id="+this.teams_id+"&"),"/api/game/search/0?"+e}}),i}),define("sportorg/models/complevel",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,min_age:0,max_age:0},desc:"Complevel information",exec_data:{exec_time:0,exec_error:!1}}),fetchSuccess:function(e,t){}}),n}),define("usercontrols/tag/models/complevel",["facade","sportorg/models/complevel"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/org/basics/"+this.orgs_id+"?id1="+this.orgs_id)},fetchSuccess:function(e,t){}}),n}),define("text!usercontrol/dropdown/template/layout.html",[],function(){return'<div class="dropdown-container">\r\n	<input type="hidden" class="hidden-input-dropdown-h" value="" />\r\n	<div class="drop-down-outer">\r\n		<div class="region-dark dropdown-header-box">\r\n			{{dropView.title}}\r\n		</div>\r\n		<div class="down-arrow-outer">\r\n			<a href="javascript: void(0);" class="down-arrow up-down-arrow-h">\r\n				<span class="icon-white icon-chevron-down"></span>\r\n			</a>\r\n		</div>\r\n	</div>\r\n	<div class="common-container">\r\n		<ul class="common-dropdown">\r\n			{{#records}}\r\n			<li class="{{#dropView.defaultSelected}}{{dropView.defaultSelected}}{{/dropView.defaultSelected}}">\r\n				<a data-id="{{#dropView.getRecordId}}{{dropView.getRecordId}}{{/dropView.getRecordId}}" href="javascript: void(0);">{{#dropView.getRecordValue}}{{dropView.getRecordValue}}{{/dropView.getRecordValue}}</a>\r\n			</li>\r\n			{{/records}}\r\n		</ul>\r\n	</div>\r\n</div>\r\n'}),define("usercontrol/dropdown/view/dropdown",["require","text!usercontrol/dropdown/template/layout.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=i.BaseView,h=r.Backbone,p,d;return p=h.View.extend({template:t,multiple:!1,selectedOptions:[],className:"dropdown-wrapper",events:{"click .up-down-arrow-h":"showDropdown","click li a":"selectOptions"},selectOptions:function(e){var t=l(e.target).data("id");this.multiple?this.setMultipleOptions(t,e):this.setSingleOption(t,e),this.showSelectedValue(),this.callback&&this.callback(this.selectedOptions)},showSelectedValue:function(){var e=this.$el.find(".common-dropdown li.selected").text()||this.title;this.$el.find(".dropdown-header-box").html(e)},setMultipleOptions:function(e,t){var n=this.checkifExists(e);n==-1?(l(t.target).parent().addClass("selected"),this.selectedOptions.push(e)):(l(t.target).parent().removeClass("selected"),this.selectedOptions.splice(n,1))},setSingleOption:function(e,t){var n=this.checkifExists(e);n==-1&&(this.selectedOptions=[],console.log(this.$el.find(".common-dropdown li")),this.$el.find(".common-dropdown li").removeClass("selected"),l(t.target).parent().addClass("selected"),this.selectedOptions.push(e),this.$el.find(".hidden-input-dropdown-h").val(e),this.hideDropdown())},checkifExists:function(e){var t=-1;for(var n in this.selectedOptions)if(this.selectedOptions[n]==e){t=n;break}return t},initialize:function(e){d=this,n=this,this.selectedOptions=[],n.setOptions(e),this.render(),this.$el.find(".hidden-input-dropdown-h").attr("id",this.elementId)},hideDropdown:function(e){if(!e||!this.$el.find(l(e.target)).parents(".dropdown-container").length)this.$el.find(".dropdown-container").removeClass("increase-dropown-zindex"),this.$el.find(".up-down-arrow-h span").removeClass("icon-chevron-up").addClass("icon-chevron-down"),this.$el.find(".common-dropdown").slideUp()},showDropdown:function(e){e.preventDefault();var t=this;l(e.currentTarget).find("span").hasClass("icon-chevron-down")?(l(e.currentTarget).find("span").removeClass("icon-chevron-down").addClass("icon-chevron-up"),l(".dropdown-container").removeClass("increase-dropown-zindex"),t.$el.find(".dropdown-container").addClass("increase-dropown-zindex"),l("html").bind("click",function(e){t.hideDropdown(e)})):(t.$el.find(".dropdown-container").removeClass("increase-dropown-zindex"),l(e.currentTarget).find("span").removeClass("icon-chevron-up").addClass("icon-chevron-down")),l(e.currentTarget).parents(".dropdown-container").find(".common-dropdown").slideToggle()},getRecordId:function(){return this.payload[d.data.recordId]},defaultSelected:function(e){if(d.multiple){if(_.isArray(d.selectedValue))for(var t in d.selectedValue)if(d.selectedValue[t]==this.payload[d.data.recordId])return"selected"}else if(d.selectedValue&&d.selectedValue==this.payload[d.data.recordId])return"selected"},getRecordValue:function(){return this.payload[d.data.recordValue]},render:function(){this.data.dropView=this;if(!this.selectedValue){if(this.data.records.length)var e=this.data.records[0].payload[this.data.recordId];this.multiple?(this.selectedValue=[],this.selectedValue.push(e)):this.selectedValue=e}var t=this,n=f.to_html(t.template,this.data);return l(t.el).html(n),this.targetView.$el.find(this.destination).html(this.el),this.$el.find(".hidden-input-dropdown-h").val(this.selectedValue),this.selectedOptions.push(this.selectedValue),this.showSelectedValue(),l("#"+this.elementId).length?t.callback&&t.callback(this.selectedOptions):setTimeout(function(){if(!t.$el.find("li.selected").length){var e=t.$el.find(".common-dropdown li:first-child");e.addClass("selected"),t.$el.find("#"+t.elementId).val(e.find("a").data("id")),t.showSelectedValue()}t.callback&&t.callback(t.selectedOptions)},200),!0},setOptions:function(e){for(var t in e)this[t]=e[t]}}),p}),define("usercontrols/tag/models/sport",["facade","sportorg/models/sport"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/sport/basics/"+this.id}}),n}),define("usercontrols/tag/collections/events",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.sports_id&&(e+="sports_id="+this.sports_id+"&"),this.states_id&&(e+="states_id="+this.states_id+"&"),this.event_name&&(e+="searchtext="+encodeURI(this.event_name)),"/api/game/search?"+e}}),i}),define("usercontrols/tag/views/main",["require","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","usercontrols/tag/models/basic_info","sportorg/collections/sports_listall","location/collections/states","usercontrols/tag/collections/schools","usercontrols/tag/collections/teams","location/collections/cities","user/collections/users","usercontrols/tag/collections/games","usercontrols/tag/models/complevel","usercontrol/dropdown/view/dropdown","usercontrols/tag/models/sport","usercontrols/tag/collections/events"],function(e){var t=e("text!usercontrols/tag/templates/layout.html"),n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/tag/collections/schools"),m=e("user/collections/users"),g=e("usercontrols/tag/collections/games"),y=e("usercontrols/tag/collections/teams"),b=e("usercontrols/tag/models/complevel"),w=e("usercontrol/dropdown/view/dropdown"),E=e("usercontrols/tag/models/sport"),S=e("usercontrols/tag/collections/events");return TagView=s.extend({template:t,tagData:{Game:{},Player:{},Team:{}},events:{"change .ddl-tag-sports_h":"changeSport","click .btn-tag-sport_h":"sportsDone","click .btn-tag-edit-sport_h":"editSport","click .link-tag-team_h":"showTeamSection","keyup .txt-tag-team-state_h":"keyupState","blur .txt-tag-team-state_h":"changeState","keyup .txt-tag-team-city_h":"keyupCity","blur .txt-tag-team-city_h":"changeCity","keyup .txt-tag-team-school_h":"keyupSchool","blur .txt-tag-team-school_h":"changeSchool","change .ddl-tag-team-level_h":"changeCompLevel","change .ddl-tag-team-season_h":"changeSeason","click .btn-tag-team-Done_h":"doneTagTeamTagging","keyup .txt-tag-event-state_h":"keyupState","blur .txt-tag-event-state_h":"changeState","keyup .txt-tag-event_h":"keyupEvent","blur .txt-tag-event_h":"changeEvent","click .btn-tag-event-Done_h":"doneTagTeamTagging","click .link-tag-event_h":"showEventSection","click .btn-tag-event-Done_h":"doneEventTagging","change .ddl-tag-event_h":"changeEvent","click .link-tag-player_h":"showPlayer","click .btn-tag-add-player_h":"addPlayer","keyup .txt-tag-player-name_h":"keyUpPlayer","change .txt-tag-player-name_h":"setPlayerId","click .btn-tag-player-Done_h":"donePlayerTagging","click .link-tag-Game_h":"showGameSection","click .btn-tag-game-Done_h":"doneGameTagging","change .ddl-tag-game_h":"changeGame","click .btn-tag-Finish_h":"finishTagging"},controls:{secAddSports:".section-Add-Sports_h",divTagList:".div-tag-list_h",secSports:".section-sports_h",lblSportName:".lbl-tag-sport-name_h",btnEditSport:".btn-tag-edit-sport_h",btnSportsDone:".btn-tag-sport_h",ddlSports:".ddl-tag-sports_h",spnSports:".span-ddl-sports-tag_h",dropdownHeader:".dropdown-header-box",secTeam:".section-team_h",lblTeamName:".lbl-tag-team-name_h",secTagTeam:".section-tag-team_h",txtTeamState:".txt-tag-team-state_h",txtTeamCity:".txt-tag-team-city_h",txtTeamSchool:".txt-tag-team-school_h",btnTeamDone:".btn-tag-team-Done_h",secEvent:".section-events_h",lblEventName:".lbl-tag-event-name_h",secTagEvent:".section-tag-event_h",txtEventState:".txt-tag-event-state_h",txtEvent:".txt-tag-event_h",btnEventDone:".btn-tag-event-Done_h",secPlayer:".section-tag-player_h",secPlayerInput:".section-tag-player-input_h",txtPlayerName:".txt-tag-player-name_h",additionalPlayer:".additional_h",btnAddPlayer:".btn-tag-add-player_h",btnPlayerDone:".btn-tag-player-Done_h",sectionSelectedPlayers:".section-team-players_h",lblPlayerNames:".lbl-tag-players-name_h",secGame:".section-tag-game_h",ddlGame:".ddl-tag-game_h",btnGameDone:".btn-tag-game-Done_h",secFooterLinks:".section-link_h",lnkTeam:".link-tag-team_h",lnkPlayer:".link-tag-player_h",lnkGame:".link-tag-Game_h",lnkEvent:".link-tag-event_h",sectionSelectedGames:".section-team-games_h",lblGameNames:".lbl-tag-games-name_h",spnGames:".span-ddl-games-tag_h",btnTeamFinish:".btn-tag-Finish_h",fieldMessage:".field-message",fieldError:".field-error",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnGamesIdData:"hdn_game_id",hdnGamesId:"#hdn_game_id"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",eventId:"eventid"},inlineTemplates:{sportOption:'{{#sports}}<option value="{{sport_id}}">{{sport_name}}</option>{{/sports}}',compLevelOption:'{{#levels}}<option value="{{complevel_id}}">{{complevel_name}}</option>{{/levels}}',seasonOption:'{{#seasons}}<option value="{{season_id}}">{{season_name}}</option>{{/seasons}}',addPlayerText:'</br><input type="text" class="txt-tag-player-name_h additional_h" placeholder="Enter Name" value="" />'},messages:{dataNotExist:"Not finding anything... ",dataNotExistAwards:"Not finding any awards. ",MandatoryFields:"Sport, Name and Year are mandatory.",selectOrganization:"Please Select High School Or Club & Season. ",selectEvent:"Please select an event. ",selectTeamAndSports:"Please Select Both Sports And A Team. "},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id,e.is_owner==undefined||e.is_owner==null?this.is_owner=null:this.is_owner=e.is_owner;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null},init:function(){n.setupView()},setupView:function(){n.setUpMainView(),n.fillSports()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e),console.log("isowner",n.is_owner)},fillSports:function(){if(!(n.sports&&n.sports.length>0)){var e=new h;e.processResult=function(t){var r=e.ParseForDropdown();n.SetupSportsView(r)},e.fetch()}},SetupSportsView:function(e){n.sports=e;var t={};t.records=n.sports,t.recordId="id",t.recordValue="custom_name";var r=new w({data:t,title:"Select Sport",elementId:n.controls.hdnSportsIdData,destination:n.controls.spnSports,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeSport(e)}});n.sports_id&&(n.sportsDone(),n.is_owner==0&&(console.log("insideoop"),l(n.destination).find(n.controls.btnEditSport).addClass("display_none_important")))},changeSport:function(e){e&&e!=0?l(n.destination).find(n.controls.btnSportsDone).fadeIn():l(n.destination).find(n.controls.btnSportsDone).fadeOut()},setSport:function(){return n.sportsId?(n.sport=new E({id:n.sportsId}),n.sport.fetch(),l.when(n.sport.request).done(function(){var e=n.sport.get("payload");e.sport_type_id==1?(l(n.destination).find(n.controls.lnkTeam).fadeIn(),l(n.destination).find(n.controls.lnkGame).fadeIn(),l(n.destination).find(n.controls.lnkEvent).fadeOut()):e.sport_type_id==2&&(l(n.destination).find(n.controls.lnkEvent).fadeIn(),l(n.destination).find(n.controls.lnkGame).fadeOut(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.lnkTeam).fadeOut()),l(n.destination).find(n.controls.lblSportName).html(l(n.destination).find(n.controls.spnSports).find(n.controls.dropdownHeader).text()),l(n.destination).find(n.controls.secAddSports).fadeOut(),l(n.destination).find(n.controls.secSports).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}),n.sport):!1},sportsDone:function(e){n.sportsId=l(n.destination).find(n.controls.hdnSportsId).val(),n.setSport()},editSport:function(){this.tagData={Game:{},Player:{},Team:{}},l(n.destination).find(n.controls.secSports).fadeOut(),l(n.destination).find(n.controls.secAddSports).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeOut(),l(n.destination).find("*").show(),l(n.destination).find(".displayNone").hide(),l(n.destination).find("input").val(""),l(n.destination).find(n.controls.additionalPlayer).remove()},showTeamSection:function(e){l(n.destination).find(n.controls.secTagTeam).fadeIn(),l(n.destination).find(n.controls.secTagTeam+" input").val(""),l(n.destination).find(n.controls.btnTeamFinish).fadeOut()},showEventSection:function(e){l(n.destination).find(n.controls.secGame).fadeOut(),l(n.destination).find(n.controls.secTagEvent).fadeIn(),l(n.destination).find(n.controls.btnEventDone).fadeOut()},keyupState:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.stateId),n.CheckTeamControlsVisibility();var i=new p;i.state_name=l(e.target).val(),n.stateFetchRequest=n.stateFetchRequest||[],n.stateFetchRequest.push(n.cityFetchRequest||[]),n.stateFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.stateFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.stateFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.states=[];for(var s in t)n.states.push(t[s].payload);n.states.forEach(function(e,t){r.push(e.name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeState(e)},changeState:function(e){console.log(l(e.target),l(e.target).hasClass("txt-tag-event-state_h"));var t=l(e.target).val();l(e.target).removeAttr(n.attributes.stateId);var r=!1;n.states_id="",n.states&&n.states.forEach(function(i,s){i["name"]==t&&(r=!0,n.states_id=i.id,l(e.target).attr(n.attributes.stateId,n.states_id),l(e.target).hasClass("txt-tag-event-state_h")?l(e.target).parent().find(n.controls.txtEvent).removeAttr("disabled").attr(n.attributes.stateId,n.states_id):l(e.target).parent().find(n.controls.txtTeamSchool).removeAttr("disabled").attr(n.attributes.stateId,n.states_id))}),r||(n.states_id=0,l(n.destination).find(n.controls.txtTeamSchool).attr("disabled","disabled").removeAttr(n.attributes.stateId).fadeOut()),n.CheckTeamControlsVisibility()},keyupCity:function(e){var t=l(e.target).val(),r=[];if(t.length>2)if(n.isValidAutoCompleteKey(e)==1){try{n.$(e.target).autocomplete("destroy")}catch(i){}l(e.target).removeAttr(n.attributes.cityId),n.CheckTeamControlsVisibility();var s=new d;s.states_id=n.states_id,s.city_name=l(e.target).val(),console.log("City Request Abort Request Function AddGame/Main.js"),n.cityFetchRequest=n.cityFetchRequest||[],n.cityFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.cityFetchRequest=n.abortRequest(n.cityFetchRequest);var o=s.fetch();n.cityFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.cities=[];for(var i in t)n.cities.push(t[i]);n.cities.forEach(function(e,t){r.push(e.city)}),n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeCity(e)},changeCity:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.cityId);var r=!1;n.city_id="",n.cities&&n.cities.forEach(function(i,s){i["city"]==t&&(r=!0,n.city_id=i.id,l(e.target).attr(n.attributes.cityId,n.city_id))}),r?l(n.destination).find(n.controls.txtTeamSchool).removeAttr("disabled"):(n.city_id=0,l(n.destination).find(n.controls.txtTeamSchool).attr("disabled","disabled").removeAttr(n.attributes.cityId).fadeOut()),n.CheckTeamControlsVisibility()},keyupSchool:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility();var s=new y;s.states_id=l(e.target).attr(n.attributes.stateId),s.sports_id=l(n.destination).find(n.controls.hdnSportsId).val(),s.team_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.TeamFetchRequest=n.abortRequest(n.TeamFetchRequest);var o=s.fetch();n.TeamFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.teams=[];for(var i in t)n.teams.push(t[i].payload);n.teams.forEach(function(e,t){r.push(e.team_name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r,select:function(e,t){console.log(t),n.changeSchool(e,t)}}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeSchool(e)},changeSchool:function(e,t){var r=e.type=="autocompleteselect"&&t!=undefined?t.item.value:l(e.target).val();console.log("Event",e),console.log("Name",r);var i=!1;n.team_id=0,n.teams&&(console.log("teams",n.teams),n.teams.forEach(function(t,s){var o=t.team_name;o==r&&(i=!0,n.team_id=t.id,l(e.target).attr(n.attributes.teamId,n.team_id))})),i||l(e.target).removeAttr(n.attributes.teamId),n.CheckTeamControlsVisibility()},keyupEvent:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility();var s=new S;s.states_id=l(e.target).attr(n.attributes.stateId),s.sports_id=n.sport.id,s.event_name=t,l(e.target).addClass("ui-autocomplete-loading"),console.log("Event Request Abort Request Function"),n.EventFetchRequest=n.abortRequest(n.EventFetchRequest);var o=s.fetch();n.EventFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.events=[];for(var i in t)n.events.push(t[i].payload);n.events.forEach(function(e,t){r.push(e.event_name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility(),n.isEnterKey(e)&&n.changeEvent(e)},changeEvent:function(e){var t=l(e.target).val(),r=!1;n.event_id=0,n.events&&n.events.forEach(function(i,s){var o=i.event_name;o==t&&(r=!0,n.event_id=i.id,l(e.target).attr(n.attributes.eventId,n.event_id))}),r||l(e.target).removeAttr(n.attributes.eventId),n.CheckEventControlsVisibility()},CheckEventControlsVisibility:function(){var e=l(n.destination).find(n.controls.txtEventState).attr(n.attributes.stateId);e&&e!=""&&e!=0?l(n.destination).find(n.controls.txtEvent).show():l(n.destination).find(n.controls.txtEvent).val("").removeAttr(n.attributes.eventId).hide(),e=l(n.destination).find(n.controls.txtEvent).attr(n.attributes.eventId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnEventDone).show():l(n.destination).find(n.controls.btnEventDone).hide()},doneEventTagging:function(e){var t=l(n.destination).find(n.controls.txtEvent).attr(n.attributes.eventId);n.event_id=t;var r=[];if(t&&t!=""&&t!=0&&t&&t!=""&&t!=0){var i=l(n.destination).find(n.controls.txtEvent).val();r.push(t),l(n.destination).find(n.controls.lblEventName).html(i),l(n.destination).find(n.controls.secTagEvent).fadeOut(),l(n.destination).find(n.controls.secEvent).fadeIn(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}else n.$(e.target).parents(n.controls.secTagEvent).find(n.controls.fieldMessage).html(n.messages.selectOrganization).stop().fadeIn();var s={8:r};u(n.channel).publish(s)},CheckTeamControlsVisibility:function(){var e=l(n.destination).find(n.controls.txtTeamState).attr(n.attributes.stateId);e=l(n.destination).find(n.controls.txtTeamSchool).attr(n.attributes.teamId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnTeamDone).show():l(n.destination).find(n.controls.btnTeamDone).hide()},doneTagTeamTagging:function(e){var t=l(n.destination).find(n.controls.txtTeamSchool).attr(n.attributes.teamId);n.team_id=t;var r=l(n.destination).find(n.controls.ddlTeamSeason).val(),i=[];if(t&&t!=""&&t!=0&&t&&t!=""&&t!=0){var s=l(n.destination).find(n.controls.txtTeamSchool).val();i.push(t),l(n.destination).find(n.controls.lblTeamName).html(s),l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secTeam).fadeIn(),l(n.destination).find(n.controls.lnkPlayer).fadeIn(),l(n.destination).find(n.controls.lnkTeam).fadeIn(),l(n.destination).find(n.controls.lnkGame).fadeIn(),l(n.destination).find(n.controls.secFooterLinks).fadeIn()}else n.$(e.target).parents(n.controls.secTagTeam).find(n.controls.fieldMessage).html(n.messages.selectOrganization).stop().fadeIn();var o={5:i};u(n.channel).publish(o)},showPlayer:function(e){l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secGame).fadeOut(),l(n.destination).find(n.controls.secPlayer).fadeIn(),l(n.destination).find(n.controls.btnTeamFinish).fadeOut()},addPlayer:function(e){l(n.destination).find(n.controls.secPlayerInput).append(n.inlineTemplates.addPlayerText)},keyUpPlayer:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.playersId);var i=new m;i.user_name=t,i.states_id=n.states_id,i.sports_id=l(n.destination).find(n.controls.hdnSportsId).val(),l(e.target).addClass("ui-autocomplete-loading"),console.log("Player Request Abort Request Function"),n.PlayerFetchRequest=n.abortRequest(n.PlayerFetchRequest);var s=i.fetch();n.PlayerFetchRequest.push(s),l.when(i.request).done(function(){var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.users=[];for(var s in t)n.users.push(t[s].payload);n.users.forEach(function(e,t){r.push(e.name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.setPlayerId(e),n.isEnterKey(e)&&n.addPlayer(e);else l(e.target).removeAttr(n.attributes.playersId)},setPlayerId:function(e){if(n.users){var t=l(e.target).val().toLowerCase();for(var r in n.users)if(n.users[r].name.toLowerCase()==t){l(e.target).attr(n.attributes.playersId,n.users[r].id);return}}},donePlayerTagging:function(e){var t=[],r="",i=[];l(n.destination).find(n.controls.txtPlayerName).each(function(){var e=l(this).attr(n.attributes.playersId);e>0&&(t.push({name:l(this).val(),id:e}),r+=","+l(this).val(),i.push(e))});if(t.length>0){var s={players:t},o=l(n.destination).find(n.controls.sectionSelectedPlayers);l(o).find(n.controls.lblPlayerNames).html(r),l(o).fadeIn(),l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.btnTeamFinish).fadeIn();var a={1:i};u(n.channel).publish(a)}else{l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.selectPlayer).fadeIn();var o=l(n.destination).find(n.controls.sectionSelectedPlayers);l(o).find(n.controls.lblPlayerNames).html(""),l(o).fadeOut()}},showGameSection:function(e){n.bindGamesData(e),l(n.destination).find(n.controls.secTagTeam).fadeOut(),l(n.destination).find(n.controls.secPlayer).fadeOut(),l(n.destination).find(n.controls.secGame).fadeIn(),l(n.destination).find(n.controls.btnTeamFinish).fadeOut()},bindGamesData:function(e){var t=l(n.destination).find(n.controls.hdnSportsId).val();if(n.sportsId){var r=new g;r.states_id=n.states_id,r.sports_id=n.sportsId,r.teams_id=n.team_id,l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html("").fadeOut(),r.processResult=function(e){n.SetupGamesView(e)},console.log("Team Request Abort Request Function"),n.GameFetchRequest=n.abortRequest(n.GameFetchRequest);var i=r.fetch();n.GameFetchRequest.push(i)}else l(e.target).parents(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.selectTeamAndSports).fadeIn()},SetupGamesView:function(e){var t=e.toJSON();if(t==null||t.length<1){l(n.destination).find(n.controls.secGame).find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn();return}n.games=t;var r={};r.records=n.games,r.recordId="id",r.recordValue="game_name";var i=new w({data:r,title:"Select Game",elementId:n.controls.hdnGamesIdData,destination:n.controls.spnGames,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeGame(e)}})},changeGame:function(e){var t=e;t&&t!=""&&t!=0?l(n.destination).find(n.controls.secGame).find(n.controls.btnGameDone).fadeIn():l(n.destination).find(n.controls.secGame).find(n.controls.btnGameDone).fadeOut()},doneGameTagging:function(e){var t=this,n=l(e.target).parents(t.controls.secGame).find(t.controls.hdnGamesId).val(),r="";if(n&&n!=""&&n!=0){r=l(e.target).parents(t.controls.secGame).find(t.controls.spnGames).find(t.controls.dropdownHeader).text();var i={game:{id:n,game_name:r}},s=[];s.push(n),t.tagData.Game=i;var o=l(t.destination).find(t.controls.sectionSelectedGames);l(o).find(t.controls.lblGameNames).html(r),l(o).fadeIn(),l(t.destination).find(t.controls.secGame).fadeOut(),l(t.destination).find(t.controls.btnTeamFinish).fadeIn();var a={8:s};u(t.channel).publish(a)}else{var o=l(t.destination).find(t.controls.sectionSelectedGames);l(o).find(t.controls.lblGameNames).html(""),l(o).fadeIn()}},finishTagging:function(){}}),TagView}),define("imageup/views/basic",["require","text!imageup/templates/uploader.html","text!imageup/templates/select_all.html","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","imageup/models/basic","imageup/views/errors","usercontrols/tag/views/main"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=o.SectionView,c=e("imageup/models/basic"),h=e("imageup/views/errors"),p=s.$,d=s._,v=u.debug,m=e("usercontrols/tag/views/main");return v.log("SectionView: ",l),i=l.extend({id:"imageuploadForm",events:{"click #imageup":"imageUploadClick","change #image_file":"imagePreview","dragover #imageholder":"drag","drop #imageholder":"drop","click #btn_select_all_h":"selectAllImages"},template:t,data:t,tagCollection:[],tagData:{1:[],5:[],8:[]},"const":{User:1,Team:5,Game:8},files_byUploader:[],files_drag:[],initialize:function(e,t){p("#errormsg, #preview").html(""),l.prototype.initialize.call(this,e),this.files_byUploader=[],this.attr=t,this.files_drag=[],this.scheme=e.scheme,this.layout=e.layout,this.dropedImage=e.dropedImage,this.attr?this.sports_id=this.attr.sports_id||null:this.sports_id=null,a("tag-team-image-success").empty(),a("tag-team-image-success").subscribe(this.tagFunction),p("#imgUploadModal").modal("show"),p("#imgUploadModal").on("hidden",function(){routing.trigger("refresh-onImageUpload")}),p("#imgUploadModal").on("hide",function(){routing.trigger("refresh-onImageUpload")})},drag:function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},drop:function(e){var t=this;e.stopPropagation(),e.preventDefault(),p("#errormsg").hide(),this.files_drag=this.files_drag||[];var n=e.originalEvent.dataTransfer.files;n.length>0&&t.showLoader(t);var r=[];t.dataum=t.dataum||[];var i=t.dataum.length;for(var s=0,o;o=n[s];s++){if(!o.type.match("image.*"))continue;this.files_drag.push(o);var u=new FileReader;u.onload=function(e){return function(n){var r="preview_"+i;i++,t.dataum.push({preview_id:r,width:"250px",height:"250px",filesrc:n.target.result,title:escape(e.name)}),data={data:t.dataum},p("#image_file").attr("disabled","disabled"),routing.trigger("imageup-preview",data),t.hideLoader()}}(o),t.setUpBottomView(),u.readAsDataURL(o)}},imagePreview:function(e){var t=this;p("#preview").hide(),p("#errormsg").hide(),this.files_byUploader=this.files_byUploader||[];var n=p("#image_file")[0].files;n.length>0&&t.showLoader(t),t.dataum=[];var r,i=t.dataum.length,s=0;for(;r=n[s];s++){if(!r.type.match("image.*"))continue;t.files_byUploader.push(r);var o=new FileReader;o.onload=function(e){return function(r){var s="preview_"+i;i++,t.dataum.push({preview_id:s,width:"250px",height:"250px",filesrc:r.target.result,title:escape(e.name)}),i==n.length&&(data={data:t.dataum,ImageIndex:t.files_byUploader.length-1,filesUploader:t.files_byUploader},routing.trigger("imageup-preview",data),t.hideLoader())}}(r),o.readAsDataURL(r)}t.setUpBottomView()},imageUploadClick:function(e){e.preventDefault();var t=this;p("#errormsg").hide(),p("#imageup").attr("disabled","disabled"),p(".closepreview").attr("disabled","disabled"),p(".rotate").attr("disabled","disabled");if(p(".previewimg").length==0){var n={msg:"Image Field Empty",color:"alert-error"};routing.trigger("imageup-msg",n),p("#imageup").removeAttr("disabled")}else if(this.dropedImage){var r=this.files_drag.length;jQuery.each(this.dropedImage.data[0].drag_info,function(e,n){var i=new FormData;if(p("#preview_"+e+"group").length>0){i.append("image_file",n),p("#preview_"+e+"rotang").val()>0?i.append("rotate",p("#preview_"+e+"rotang").val()):i.append("rotate","false");for(var s in t.attr)console.error(s,t.attr[s]),i.append(s,t.attr[s]);var o={dataum:i,id:e,len:r};console.log(o),routing.trigger("imageup-add-image",o)}}),this.files_drag=[],p("#imageup").removeAttr("disabled")}else if(this.files_drag.length>=1){var r=this.files_drag.length;jQuery.each(this.files_drag,function(e,n){var i=new FormData;if(p("#preview_"+e+"group").length>0){i.append("image_file",n),p("#preview_"+e+"rotang").val()>0?i.append("rotate",p("#preview_"+e+"rotang").val()):i.append("rotate","false");for(var s in t.attr)console.error(s,t.attr[s]),i.append(s,t.attr[s]);var o=t.getTagData(p("#preview_"+e+"group"));i.append("tag",JSON.stringify(o));var u={dataum:i,id:e,len:r};console.log(u),routing.trigger("imageup-add-image",u)}}),this.files_drag=[],p("#imageup").removeAttr("disabled")}else console.log("file_byUploader"),console.log(this.files_byUploader),jQuery.each(t.files_byUploader,function(e,n){var r=new FormData;if(p("#preview_"+e+"group").length>0){r.append("image_file",n),p("#preview_"+e+"rotang").val()>0?r.append("rotate",p("#preview_"+e+"rotang").val()):r.append("rotate","false");for(var i in t.attr)r.append(i,t.attr[i]);var s=t.getTagData(p("#preview_"+e+"group"));r.append("tag",JSON.stringify(s));var o={dataum:r,id:e,len:t.files_byUploader.length};routing.trigger("imageup-add-image",o)}}),t.files_byUploader=[],p("#imageup").removeAttr("disabled");this.dataum=[]},getTagData:function(e){var t=p(e).attr("gameIndex"),n=p(e).attr("teamIndex"),r=p(e).attr("userIndex"),i={1:[],5:[],8:[]};if(t>-1){var s=this.tagData[this["const"].Game][t];s&&(i[this["const"].Game]=s)}if(n>-1){var s=this.tagData[this["const"].Team][n];s&&(i[this["const"].Team]=s)}if(r>-1){var s=this.tagData[this["const"].User][r];s&&(i[this["const"].User]=s)}return i},setUpBottomView:function(){p("#main-content-tag-section").fadeIn(),this.setUpSelectAllView(),this.setUpTagView()},setUpSelectAllView:function(){var e=this;p("#select-allup").html(n),e.showSelectAllImages()},setUpTagView:function(){var e=this;this.tagView=new m({model:this.model,template:r,name:"tag-image "+(new Date).toString(),destination:"#image-tagging",user_id:e.user_id||null,sports_id:e.sports_id,channel:"tag-team-image-success"}),this.scheme.push(this.tagView),this.layout.render()},tagFunction:function(e){var t=this;this.tagCollection.push(e);var n=0,r=p(".previewimg.selected");console.log("selected",r);for(var i in e)t.tagData[i]=t.tagData[i]||[],t.tagData[i].push(e[i]),n=t.tagData[i].length-1,i==t["const"].Game?r.attr("gameIndex",n):i==t["const"].Team?r.attr("teamIndex",n):i==t["const"].User&&r.attr("userIndex",n)},selectAllImages:function(e){p(".previewimg").addClass("selected"),p("#select-allup").hide(),p("#image-tagging").show()},showSelectAllImages:function(){p("#select-allup").show(),p("#image-tagging").hide()}}),i}),define("text!imageup/templates/preview_template.html",[],function(){return'{{#data}} \r\n	<div class="previewimg" id="{{preview_id}}group"align="center">\r\n		\r\n		<div class="previewimgsrc" id="{{preview_id}}pre" align="center">\r\n			<div class="click-to-tag">Click to Tag</div>\r\n			<img src="{{filesrc}}" class="img-polaroid" width="{{width}}" height="{{height}}" title="{{title}}" draggable="false">\r\n			<!-- <button type="button" class="close closepreview" value ="{{preview_id}}"data-dismiss="{{preview_id}}">&times;</button> -->\r\n			<input type="hidden" id="{{preview_id}}rotang" value="0">\r\n\r\n		\r\n		</div>\r\n		\r\n		<div class="clear"></div>\r\n		<div id="{{preview_id}}rot" class="previewrotate lnkFooter">\r\n			<button title="Rotate 90°" id="{{preview_id}}pre img" value="{{preview_id}}" class="btn rotate"><img src="http://cdn.athletez.com/resources/img/rotate.png" /></button>\r\n			<button title="Delete" type="button" class="btn close closepreview" value ="{{preview_id}}"data-dismiss="{{preview_id}}">&times;</button>\r\n		</div>\r\n		<div class="clear"></div>\r\n		<div id="{{preview_id}}" class="previewprogress"></div>\r\n		<div class="clear"></div>\r\n	</div>\r\n{{/data}} '}),define("imageup/views/preview",["require","text!imageup/templates/preview_template.html","text!usercontrols/tag/templates/layout.html","text!imageup/templates/select_all.html","facade","views","utils","vendor","usercontrols/tag/views/main"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=o.SectionView,c=s.$,h=s._,p=e("usercontrols/tag/views/main"),d=u.debug;return i=l.extend({id:"imgpreview",template:t,events:{"click .rotate":"imageRotate","click .close":"closePreview","click .previewimgsrc":"selectImage","mouseover .previewimg":"showFooter","mouseout .previewimg":"hideFooter"},initialize:function(e){l.prototype.initialize.call(this,e),this.degree=0,this.scheme=e.scheme,this.layout=e.layout,this.ImageIndex=e.ImageIndex,this.filesUploader=e.filesUploader},imageRotate:function(e){id=e.currentTarget.id,val=e.currentTarget.value,this.degree=c("#"+val+"rotang").val(),this.degree=parseInt(this.degree)+90,this.degree>=360&&(this.degree=0),c("#"+id).css({"-webkit-transform":"rotate("+this.degree+"deg)","-moz-transform":"rotate("+this.degree+"deg)","-ms-transform":"rotate("+this.degree+"deg)","-o-transform":"rotate("+this.degree+"deg)",transform:"rotate("+this.degree+"deg)",zoom:1}),c("#"+val+"rotang").val(this.degree)},closePreview:function(e){var t=[];h.each(this.model.get("data"),function(n,r,i){console.log(n.preview_id,e.currentTarget.value),n.preview_id!=e.currentTarget.value&&t.push(n)}),this.model.set("data",t),id=e.currentTarget.value+"group";var n=document.getElementById(id);n.parentNode.removeChild(n),this.filesUploader.splice(this.ImageIndex,1)},selectImage:function(e){var t=c(e.target).hasClass("previewimg"),n=t?c(e.target):c(e.target).parents(".previewimg");n.find(".click-to-tag").hide(),n.toggleClass("selected");var r=c(this.destination).find(".previewimg.selected");r.length<1?this.setUpSelectAllView():this.setUpTagView()},setUpSelectAllView:function(){c("#image-tagging").hide(),c("#select-allup").show()},setUpTagView:function(){c("#select-allup").hide(),c("#image-tagging").show()},showFooter:function(e){c(e.target).parents(".previewimg").find(".lnkFooter").show(),c(e.target).parents(".previewimg:not(.selected)").find(".click-to-tag").show()},hideFooter:function(e){c(e.target).parents(".previewimg").find(".lnkFooter").hide(),c(e.target).parents(".previewimg").find(".click-to-tag").hide()}}),i}),define("imageup",["require","text!imageup/templates/basic.html","text!imageup/templates/uploader.html","facade","controller","models","views","utils","imageup/models/basic","imageup/models/imageupload","imageup/models/errorshow","imageup/collections/basics","imageup/models/preview","imageup/views/basic","imageup/views/errors","imageup/views/preview"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("imageup/models/basic"),f=e("imageup/models/imageupload"),l=e("imageup/models/errorshow"),c=e("imageup/collections/basics"),h=e("imageup/models/preview"),p=e("imageup/views/basic"),d=e("imageup/views/errors"),v=e("imageup/views/preview"),m=o.LayoutView,g=r.$,y=r._,b=u.debug,w=u.lib.Channel,E=["/pages/imageup/imageup.css"];return n=i.extend({initialize:function(e){return console.error(e),w("load:css").publish(E),y.bindAll(this),this.scheme=[],this.handleOptions(e),this.init(e),this},init:function(e){this.url=e.url,this.attr=e.attr,this.data=e.data,this.count=0,this.setupLayout(),this.handleDeferreds(),this.showuploader(),this.data&&this.showPreviewDropImage()},handleDeferreds:function(){function t(t){e.imageUpload(t)}function n(t){e.msgShowup(t)}function r(t){e.previewShowup(t)}function i(){e.rerender()}var e=this;routing.off("imageup-add-image"),routing.on("imageup-add-image",function(e){t(e)}),routing.off("imageup-msg"),routing.on("imageup-msg",function(e){n(e)}),routing.off("imageup-preview"),routing.on("imageup-preview",function(e){console.log("this is"),r(e)}),routing.off("imageup-rerender"),routing.on("imageup-rerender",function(e){i(e)})},showuploader:function(){var e=new p({scheme:this.scheme,layout:this.layout,name:"Add Media",dropedImage:this.data,model:new a,destination:"#left_upload"},this.attr);this.scheme.push(e),this.layout.render()},setupLayout:function(){var e;return this.scheme=[],g(".model-popup-h").remove(),g("body").append('<div id="modalPopup" class="model-popup-h"></div>'),e=new m({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=e,this.layout},previewShowup:function(e){var t=new h(e);for(var n in this.scheme)this.scheme[n].id=="imgpreview"&&delete this.scheme[n];console.error(e),previewShowView=new v({scheme:this.scheme,layout:this.layout,name:"Preview Show View",model:t,ImageIndex:e.ImageIndex,filesUploader:e.filesUploader,destination:"#preview",displayWhen:"ready"}),this.scheme.push(previewShowView),g("#preview").show(),routing.trigger("imageup-rerender")},rerender:function(){this.showuploader()},showPreviewDropImage:function(){this.data&&routing.trigger("imageup-preview",this.data)},imageUpload:function(e){var t=e.id,n=e.len,r=[],i="",s=this,r=e.dataum;g("#preview_"+t).addClass("image_upload_loader_new"),g(".previewimgsrc").addClass("fade-out"),g.ajax({url:this.url,data:r,cache:!1,processData:!1,contentType:!1,type:"POST",success:function(e){g("#preview_"+t).fadeOut("slow"),g("#preview_"+t+"rot").fadeOut("slow"),routing.trigger("image-upload-success",e),g("imageup").attr("disabled","disabled"),s.count++,s.count==n&&(i={msg:" File Uploaded Succesfully",color:"alert-success"},routing.trigger("imageup-msg",i),g("#imageup").removeAttr("disabled"),g("#image_file").removeAttr("disabled"),g(".closepreview").removeAttr("disabled")),g("#preview_"+t).unbind().removeClass("image_upload_loader_new").html("").attr("disabled","disabled")},error:function(e){g("#preview_"+t).fadeOut("slow"),g(".previewimgsrc").removeClass("fade-out"),g("#preview_"+t).fadeIn("slow").html("<b>Upload Error!</b>"),b.log(e),i={msg:e.statusText,color:"alert-error"},routing.trigger("imageup-msg",i),g("#imageup").removeAttr("disabled"),g("#image_file").removeAttr("disabled"),g(".closepreview").removeAttr("disabled");return}})},msgShowup:function(e){for(var t in this.scheme)this.scheme[t].destination=="#errormsg"&&delete this.scheme[t];errorShowModel=new l(e),addErrorView=new d({name:"File Upload Msg",model:errorShowModel,destination:"#errormsg",displayWhen:"ready"}),this.scheme.push(addErrorView),g("#errormsg").show(),routing.trigger("imageup-rerender")}}),n}),define("text!pages/home/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header"></div>\r\n	<div id="main-content" class="row-fluid">\r\n		<div class="green-left-heading">\r\n			Top Rated Profiles\r\n		</div>\r\n		<div id="top-rated" class="p-l-20 clearfix clear"></div>\r\n		<div class="green-left-heading">\r\n			Find Content\r\n		</div>\r\n		<div id="menu" class="p-l-20 clear"></div>\r\n		<div class="search-result-outer">\r\n\r\n			<div id="search-result" class="p-l-20 clear"></div>\r\n			<a href="javascript: void(0);" class="left-arrow-page home-page-arrow left-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/left_arrow.png">\r\n			</a>\r\n			<a href="javascript: void(0);" class="right-arrow-page home-page-arrow right-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/right_arrow.png">\r\n			</a>\r\n		</div>\r\n	</div>\r\n	<div id="main-footer"></div>\r\n</div>'}),define("pages/home/models/menu",["models"],function(e){var t,n=e.BaseModel;return t=n.extend({defaults:{name:null,views:{browse:[{name:"VOTES",value:"votes"},{name:"RECENT",value:"newest"},{name:"FANS",value:"followers"}],time:[{name:"TODAY",value:"DAY"},{name:"THIS WEEK",value:"WEEK"},{name:"THIS MONTH",value:"MONTH"},{name:"ALL TIME",value:"YEAR"}]}}}),t}),define("packages/location/models/city",["models","facade"],function(e,t){var n,r=e.BaseModel,s=t.$,o=t._;return n=r.extend({defaults:{name:null},initialize:function(e,t){this.id=this.id||o.uniqueId("m"),this.addSubscribers(),o.bindAll(this)},search:function(e){this.request&&this.request.abort(),this.request=s.ajax({url:"/api/location/search/?search_text="+e}).done(function(t,n,r){var s=[],u=t.payload;if(u!=null)for(i=0;i<(u.length>10?10:u.length);i++){var a={};a.label=u[i].str,a.id=u[i].type=="states_id"?"":u[i].id;var f=o.isUndefined(u[i].obj.states_obj)?!o.isUndefined(u[i].obj.city)&&!o.isUndefined(u[i].obj.city.states_obj)?u[i].obj.city.states_obj:{}:u[i].obj.states_obj;a.state_id=u[i].type=="states_id"?u[i].id:f.id,a.country_id=o.isUndefined(f.country)?"":f.country.id,s.push(a)}Channel("response :"+e).publish(s)})},addSubscribers:function(){var e=this;Channel("changeInput"+this.id).subscribe(e.search)}}),n}),define("sport/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{sport_id:0,sport_name:null,sport_type:null},desc:"Sport Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("packages/sport/collections/sports",["require","sport/models/sport","facade","collections","utils"],function(e,t){var n,r=e("utils"),s=e("facade"),o=e("collections"),u=r.debug,a=o.BaseCollection,f=s._;return n=a.extend({model:t,url:function(){var e="/api/sport/listall?",t=this.name||"boys",n="";switch(t){case"boys":n="male=1";break;case"both":n="male=1&";case"girls":n+="female=1"}return e+n},initialize:function(e,t){this.url=t.url||this.url,this.name=t.name,a.prototype.initialize.call(this,e,t)},fetchSuccess:function(e,n){e.reset();var r=n.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new t;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",n.desc),s.set("exec_data",n.exec_data),e.push(s)}e.deferred.resolve(n)}}),n}),define("pages/home/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("pages/home/collections/image",["facade","collections","pages/home/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,initialize:function(e,t){debug.log("HomeImageList initialize..."),this.cid=this.cid||o.uniqueId("c"),this.deferred=new $.Deferred,this.num=t.num,o.bindAll(this)},fetchSuccess:function(e,t){var r=o.first(t.payload,e.num);e.reset();for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("text!pages/home/templates/menu.html",[],function(){return'<div class="demo-select">\r\n\r\n</div>\r\n\r\n<div class="fixed-icons">\r\n	<ul>\r\n		<li><a id="image" class="icons restype photos" data-tip-style="qtip-athletez qtip-photo" data-selected-class="photos_selected icon_selected" data-number="1" title="Find Images" href="javascript:void(0);"></a></li>\r\n		<li><a id="video" class="icons videos restype" data-tip-style="qtip-athletez qtip-video" data-selected-class="videos_selected icon_selected" title="Show Videos" data-number="0" href="javascript:void(0);"></a></li>\r\n		<li><a  id="user" class="icons athlete restype" data-tip-style="qtip-athletez qtip-athlete" data-selected-class="athlete_selected icon_selected" data-number="2" title="Search for an Athlete" href="javascript:void(0);"></a></li>\r\n		<li><a id="org" class="icons team restype" data-tip-style="qtip-athletez qtip-team" data-selected-class="team_selected icon_selected" data-number="4" title="Find a Team" href="javascript:void(0);"></a></li>\r\n		<li><a id="game" class="icons events-games restype" data-tip-style="qtip-athletez qtip-game" data-selected-class="events-games_selected icon_selected" data-number="3" title="Search for Games, Events, or Matches" href="javascript:void(0);"></a></li>\r\n	</ul>\r\n</div>\r\n\r\n\r\n<div class="clearfix"></div>\r\n\r\n<div class="menu-outer-h">\r\n\r\n	<!--div id="resulttype" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h restype-link-h"><span class="option-heading-h">Athletes</span>\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h restype-options-h">\r\n\r\n\r\n			<ul class="dropdown-menu" style="display: block; position: relative;">\r\n				<li><a id="user" class="restype" data-number="2" href="javascript:void(0)">Athletes</a></li>\r\n				<li><a id="image" class="restype" data-number="1" href="javascript:void(0)">Images</a></li>\r\n				<li><a id="video" class="restype"  data-number="0" href="javascript:void(0)">Videos</a></li>\r\n				<li><a id="game" class="restype" data-number="3" href="javascript:void(0)">Games &amp; Events</a></li>\r\n				<li><a id="org" class="restype" data-number="4" href="javascript:void(0)">Teams</a></li>\r\n			</ul>\r\n		</div>\r\n	</div-->\r\n	\r\n	<!--div class="menu individual-reset-btn">\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link reset-option-btn-h hide" data-type="restype"><span class="option-heading-h" style="text-decoration: underline;">RESET</span></a>\r\n	</div-->\r\n	\r\n	<div id="sport" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h sport-link-h" title="Use this menu to filter the results to only show a specific sport.">\r\n			<span class="option-heading-h">ALL SPORTS</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-sport-area-h sports-option-h">\r\n			<!--<a href="javascript: void(0);" class="btn sport-reset-btn-h">Reset</a>-->\r\n			<div class="left text-center">\r\n				<strong>Guys</strong>\r\n				<div id=\'boys\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Girls</strong>\r\n				<div id=\'girls\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Both</strong>\r\n				<div id=\'both\' class="text-left sport-list"></div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="menu individual-reset-btn">\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link reset-option-btn-h hide" data-type="sport"><span class="option-heading-h">&times;</span></a>\r\n	</div>\r\n\r\n	<div id="location" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h location-link-h" title="Filter the results by location.  You can search for a state or a city in the United States and the results will be narrowed to that location."> <span class="option-heading-h">PLACE</span>\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-location-area-h no-padding">\r\n			<!--<a href="javascript: void(0);" class="btn location-reset-btn-h">Reset</a>-->\r\n			<!--div class="state"></div-->\r\n			<div class="city"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="menu individual-reset-btn">\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link reset-option-btn-h hide" data-type="city"><span class="option-heading-h">&times;</span></a>\r\n	</div>\r\n\r\n	<div id="views" class="menu span2">\r\n		<a href="javascript:void(0)" class="menu-link-h view-link-h" title="Choose how you want your results ordered."><span class="option-heading-h">ORDER</span>\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h view-options-h">\r\n			<div class="dropdown">\r\n				<span> SORT BY</span>\r\n\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative; margin-bottom:15px;">\r\n					{{#views.browse}}\r\n					<li><a class="browse" data-id="{{value}}" href="javascript:void(0);">{{name}}</a></li>\r\n					{{/views.browse}}\r\n				</ul>\r\n			</div>\r\n			<br/>\r\n\r\n			<div class="dropdown">\r\n				<span>TIME FRAME</span>\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative;">\r\n					{{#views.time}}\r\n					<li><a class="time" data-id="{{value}}" href="javascript: void(0)">{{name}}</a></li>\r\n					{{/views.time}}\r\n				</ul>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="menu individual-reset-btn">\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link reset-option-btn-h hide" data-type="views"><span class="option-heading-h">&times;</span></a>\r\n	</div>\r\n	\r\n	<!--div id="reset" class="menu span2">\r\n		<a href="javascript:void(0)" class="menu-link-h btn-link"><span class="option-heading-h reset-all-btn-h">&times;</span></a>\r\n	</div-->\r\n\r\n	<div class="pull-right search-box">\r\n		<input type="text" id="search" placeholder="SEARCH" style="height: 28px; margin:0px 5px;;"/><a href="javascript:void(0);" class="common-btn common-default-sky-dark common-btn-small">SEARCH</a>\r\n	</div>\r\n</div>'}),function(e){jQuery.fn.extend({slimScroll:function(n){var r=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function i(t){if(p){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3),e(t.target||t.srcTarget||t.srcElement).closest("."+r.wrapperClass).is(x.parent())&&s(n,!0),t.preventDefault&&!S&&t.preventDefault(),S||(t.returnValue=!1)}}function s(e,t,n){S=!1;var i=e,s=x.outerHeight()-N.outerHeight();t&&(i=parseInt(N.css("top"))+e*parseInt(r.wheelStep)/100*N.outerHeight(),i=Math.min(Math.max(i,0),s),i=0<e?Math.ceil(i):Math.floor(i),N.css({top:i+"px"})),b=parseInt(N.css("top"))/(x.outerHeight()-N.outerHeight()),i=b*(x[0].scrollHeight-x.outerHeight()),n&&(i=e,e=i/x[0].scrollHeight*x.outerHeight(),e=Math.min(Math.max(e,0),s),N.css({top:e+"px"})),x.scrollTop(i),x.trigger("slimscrolling",~~i),l(),c()}function o(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1),this.addEventListener("MozMousePixelScroll",i,!1)):document.attachEvent("onmousewheel",i)}function u(){y=Math.max(x.outerHeight()/x[0].scrollHeight*x.outerHeight(),E),N.css({height:y+"px"});var e=y==x.outerHeight()?"none":"block";N.css({display:e})}function l(){u(),clearTimeout(m),b==~~b?(S=r.allowPageScroll,w!=b&&x.trigger("slimscroll",0==~~b?"top":"bottom")):S=!1,w=b,y>=x.outerHeight()?S=!0:(N.stop(!0,!0).fadeIn("fast"),r.railVisible&&C.stop(!0,!0).fadeIn("fast"))}function c(){r.alwaysVisible||(m=setTimeout(function(){r.disableFadeOut&&p||d||v||(N.fadeOut("slow"),C.fadeOut("slow"))},1e3))}var p,d,v,m,g,y,b,w,E=30,S=!1,x=e(this);if(x.parent().hasClass(r.wrapperClass)){var T=x.scrollTop(),N=x.parent().find("."+r.barClass),C=x.parent().find("."+r.railClass);u();if(e.isPlainObject(n)){if("height"in n&&"auto"==n.height){x.parent().css("height","auto"),x.css("height","auto");var k=x.parent().parent().height();x.parent().css("height",k),x.css("height",k)}if("scrollTo"in n)T=parseInt(r.scrollTo);else if("scrollBy"in n)T+=parseInt(r.scrollBy);else if("destroy"in n){N.remove(),C.remove(),x.unwrap();return}s(T,!1,!0)}}else{r.height="auto"==r.height?x.parent().height():r.height,T=e("<div></div>").addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height}),x.css({overflow:"hidden",width:r.width,height:r.height});var C=e("<div></div>").addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),N=e("<div></div>").addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),k="right"==r.position?{right:r.distance}:{left:r.distance};C.css(k),N.css(k),x.wrap(T),x.parent().append(N),x.parent().append(C),r.railDraggable&&N.bind("mousedown",function(n){var r=e(document);return v=!0,t=parseFloat(N.css("top")),pageY=n.pageY,r.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,N.css("top",currTop),s(0,N.position().top,!1)}),r.bind("mouseup.slimscroll",function(e){v=!1,c(),r.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),C.hover(function(){l()},function(){c()}),N.hover(function(){d=!0},function(){d=!1}),x.hover(function(){p=!0,l(),c()},function(){p=!1,c()}),x.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(g=e.originalEvent.touches[0].pageY)}),x.bind("touchmove",function(e){S||e.originalEvent.preventDefault(),e.originalEvent.touches.length&&(s((g-e.originalEvent.touches[0].pageY)/r.touchScrollStep,!0),g=e.originalEvent.touches[0].pageY)}),u(),"bottom"===r.start?(N.css({top:x.outerHeight()-N.outerHeight()}),s(0,!0)):"top"!==r.start&&(s(e(r.start).position().top,null,!0),r.alwaysVisible||N.hide()),o()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery),define("jquery.slimscroll",["jquery","jqueryui"],function(){}),define("common/models/get-city",["facade","models/base"],function(e,t){var n=e._;return t.extend({cityId:undefined,url:function(){return"/api/city/basics/"+this.cityId}})}),define("pages/home/views/menu",["require","text!pages/home/templates/menu.html","facade","views","jquery.slimscroll","common/models/get-city","vendor/plugins/qtip/qtip","text!vendor/plugins/qtip/qtip.css"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("common/models/get-city");return n=s.extend({id:"menu",events:{"blur #search":"updateSearch","focus #search":"hideDropdown","click .restype":"changeBaseUrl","click .dropdown-menu-alias > li > a":"select","click .dd":"doNothing","click .menu-link-h":"showMenuDropdown","click .views-reset-btn-h":"resetView","click .sport-reset-btn-h":"resetSport","click .location-reset-btn-h":"resetLocation","click .reset-all-btn-h":"resetAll","click .reset-option-btn-h":"resetIndividual"},demoSelect:function(){},resetIndividual:function(e){var t=$(e.currentTarget).data("type");$(e.currentTarget).addClass("hide"),t&&_.isFunction(this[t])&&this[t]()},restype:function(){Channel("resetIndividual").publish("restype")},sport:function(){Channel("resetIndividual").publish("sports")},city:function(){Channel("resetIndividual").publish("location")},views:function(){Channel("resetIndividual").publish("view")},resetAll:function(){this.resetView(),this.resetLocation(),this.resetSport()},resetView:function(){var e="view";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-view-area-h ul li a.select, .reset-view-area-h ul li.select").removeClass("select")},resetSport:function(){var e="sports";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-sport-area-h ul li a.select, .reset-sport-area-h ul li.select").removeClass("select")},resetLocation:function(){var e="location";Channel("resetFilter").publish(e),this.$el.find("#city").val(""),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-location-area-h ul li a.select, .reset-location-area-h ul li.select").removeClass("select")},template:t,initialize:function(e){s.prototype.initialize.call(this,e),this.options=e.options?e.options:{}},bindToolTips:function(){this.$el.find("a.restype").each(function(){var e=$(this);$(this).qtip({position:{my:"left center",at:"right center"},style:{classes:e.data("tip-style")}})}),this.$el.find("a.menu-link-h").each(function(){var e=$(this);$(this).qtip({position:{my:"bottom center",at:"top center"},style:{classes:"header-dropdown"}})})},updateSearch:function(e){Channel("textChanged").publish($(e.target).val())},changeBaseUrl:function(e){var t=$(e.currentTarget);this.$el.find(".icons").each(function(){$(this).removeClass($(this).data("selected-class"))}),t.addClass(t.data("selected-class"));var n=t.data("number");Channel("baseUrlChanged").publish(n)},stateListChange:function(e){var t=$(e.currentTarget).val();console.log(t);var n=t.data("id");routing.trigger("stateChanged",n)},doNothing:function(e){e.preventDefault(),e.stopPropagation()},hideDropdown:function(){this.$el.find(".menu-detail-h").hide()},hideAllDropdowns:function(){var e=this;$("html, #search").click(function(t){$(t.target).parents(".menu").length||e.hideDropdown()})},showMenuDropdown:function(e){var t=$(e.currentTarget).next();t.css("display")=="none"?(this.$el.find(".menu-detail-h").hide(),t.show()):t.hide()},select:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),n=t.attr("class");$(".dropdown-menu > li > a."+n).removeClass("select"),n=t.attr("class").split(" ")[0],$(t).addClass("select"),$(".menu-detail-h").hide(),this.$el.find(".reset-option-btn-h[data-type="+$(t).parents(".menu").attr("id")+"]").removeClass("hide");var r={submenu:n,value:$(t).data("id")||$(t).text()};Channel("viewFilterChanged").publish(r)},toggle:function(e){e.preventDefault();var t=$(e.currentTarget),n=$(t).offset(),r=n.top+40,i=n.left+10,s=t.attr("id");s="#"+s+" .dd",$(s).attr("class")==="dd open"?$(s).hide().removeClass("open"):($(".open").hide().removeClass("open"),$(s).css("top",r).css("left",i),$(s).show(),$(s).addClass("open"))},afterRender:function(){this.hideAllDropdowns();var e=this,t=setInterval(function(){try{$(e.el).find(".sport-list").slimScroll(),clearInterval(t)}catch(n){}},1e3);this.bindToolTips();var n=this.model.toJSON();this.options.searchtext&&this.$el.find("#search").val(this.options.searchtext),this.options.cities_id||this.options.states_id||this.options.country_id;if(this.options.base){var r=this.$el.find(".restype[data-number="+this.options.base+"]");r.addClass(r.data("selected-class"))}this.options.sports_id&&this.options.sports_id!="0"&&e.$el.find(".reset-option-btn-h[data-type=sport]").removeClass("hide"),this.options.orderby!="random"&&e.$el.find(".reset-option-btn-h[data-type=views]").removeClass("hide");if(this.options.orderby){var i=this.$el.find("a.browse[data-id="+this.options.orderby+"]");i.parents("ul").find("a").removeClass("select"),i.addClass("select");var s=setInterval(function(){$("#views .view-link-h .option-heading-h").length&&(clearInterval(s),i.text()&&$("#views .view-link-h .option-heading-h").html(i.text()))},500)}}}),n}),define("pages/home/views/image-list",["facade","views","utils","media/views/image-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"image-list",name:"Image List",tagName:"ul",_tagName:"li",_className:"image",events:{"click .open-photo-player-h":"initPhotoPlayer"},_view:r,initialize:function(e){var t=this;this.name=e.name||this.name,this.media_id=e.media_id,this.pageName=e.pageName,this.viewName=e.viewName,this.userId=e.user_id,f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");u.bindAll(this),this.addSubscribers(),t.media_id&&setTimeout(function(){t.viewName=="search-result"&&routing.trigger("photo-player-init",undefined,t.collection,t.collection.id,undefined,t.pageName,undefined,t.media_id)},500)},initPhotoPlayer:function(e){e.preventDefault();var t=o(e.target).parents("li").index();routing.trigger("photo-player-init",t,this.collection,this.collection.id,undefined,this.pageName)},childViews:{}}),i}),define("text!packages/location/templates/state-item.html",[],function(){return'{{#payload}}\r\n<div data-id="{{id}}" class="state-{{id}}">{{name}}</div>\r\n{{/payload}}\r\n\r\n'}),define("packages/location/views/state-item",["vendor","views","utils","text!packages/location/templates/state-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"state",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeState:function(){console.log(this.model),Channel("stateChanged:"+this.model.collection.cid).publish(this.model)}}),i}),define("packages/location/views/state-list",["facade","views","utils","packages/location/views/state-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"state-list",name:"State List",tagName:"ul",_tagName:"li",_className:"state",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("StateListView expected options.collection.");u.bindAll(this),this.addSubscribers()},childViews:{}}),i}),define("pages/home/views/state-list",["facade","views","utils","packages/location/views/state-list"],function(e,t,n,r){var i,s=e.$,o=e._,u=n.lib.Channel,a=t.SectionView;return i=r.extend({tagName:"select",_tagName:"option",events:{change:"changeState"},initialize:function(e){r.prototype.initialize.call(this,e),this.id=e.id||this.id||o.uniqueId("v")},changeState:function(e){console.log(this.collection);var t=s(e.target).val(),n="";this.collection.each(function(e){e.get("payload").name==t&&(n=e.get("payload").id)}),n!=""&&(console.log("sdsd"),routing.trigger("stateChanged",n))}}),i}),define("text!sport/templates/sport-item.html",[],function(){return'{{#payload}}\r\n<a href="javascript: void(0);" class="sport-item-h" data-id="{{sport_id}}">\r\n<img src="{{small_icon}}"  class="tiny-sport-icon"/>{{sport_name}}</a>\r\n{{/payload}}'}),define("sport/views/sport-item",["vendor","views","utils","text!sport/templates/sport-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"sport",events:{},initialize:function(e){this.template=r},render:function(){var e=this,t=u.to_html(this.template,this.model.toJSON());return this.$el.html(t),this.$el.find("a").click(function(t){e.selectSport(t)}),this},selectSport:function(e){s(".reset-option-btn-h[data-type=sport]").removeClass("hide"),s(".menu-detail-h").hide(),s("li.sport").removeClass("select"),this.$el.addClass("select"),Channel("sportChanged:"+this.model.collection.cid).publish(this.model)}}),i}),define("packages/sport/views/sport-list",["facade","views","utils","sport/views/sport-item","jqueryui","jquery.slimscroll"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=n.debug;return CollectionView=t.CollectionView,SectionView=t.SectionView,s=CollectionView.extend(SectionView.prototype),i=s.extend({__super__:CollectionView.prototype,className:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){s.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");u.bindAll(this),this.sports_id=e.sports_id||undefined,this.name=e.name||this.name,this._tagName=e._tagName||this._tagName,this.tagName=e.tagName||this.tagName,this._className=e._className||this._className,this._view=e._view||this._view,this.addSubscribers()},initScroll:function(){o("."+this.className).slimScroll({height:"200px"})},addSubscribers:function(){var e=this;a("layout:ready").subscribe(e.initScroll)},afterRender:function(){if(this.sports_id){var e=this.$el.find("a.sport-item-h[data-id="+this.sports_id+"]");o("li.sport").removeClass("select"),e.addClass("select");var t=setInterval(function(){o("#sport .sport-link-h .option-heading-h").length&&(clearInterval(t),e.text()&&o("#sport .sport-link-h .option-heading-h").html(e.text()))},2e3)}},childViews:{}}),i}),define("text!location/templates/city.html",[],function(){return'<input id="city" type="text" placeholder="Enter a City"/>'}),define("packages/location/views/city",["require","text!location/templates/city.html","views","facade","utils","jqueryui","controller"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("controller");return n=o.extend({template:t,className:"ui-front",initialize:function(e){o.prototype.initialize.call(this,e),this.id=e.id||this.id||a.unique("v"),this.addSubscribers()},initPlugin:function(){var e=this,t=this.model.id;u("#city").autocomplete({minLength:2,source:function(e,n){var r=e.term,i=l.prototype.appStates;if(i){var s=i.findByNameInStorage(r);if(s){n(s.data);return}}var o=function(e){var t=l.prototype.appStates;t&&(t.add({name:r,data:e,storage:"localStorage",expires:new Date(Date.now()+3154e5)}),t.save(r)),n(e)};Channel("response :"+r).subscribe(o),Channel("changeInput"+t).publish(r)},select:function(t,n){Channel("cityChanged:"+e.id).publish(n.item),f.log(n.item)}})},addSubscribers:function(){var e=this;Channel("layout:ready").subscribe(e.initPlugin)}}),n}),define("home",["require","text!pages/home/templates/layout.html","facade","controller","models","views","utils","pages/home/models/menu","packages/location/models/city","signup/models/registerbasic","packages/sport/collections/sports","pages/home/collections/image","location/collections/states","pages/home/views/menu","pages/home/views/image-list","pages/home/views/state-list","packages/sport/views/sport-list","signup/views/registerbasic","packages/location/views/city"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("packages/sport/collections/sports"),f=e("location/collections/states"),l=e("pages/home/collections/image"),c=e("pages/home/models/menu"),h=e("packages/location/models/city"),p=e("signup/models/registerbasic"),d=e("pages/home/views/menu"),v=e("signup/views/registerbasic"),m=e("pages/home/views/image-list"),g=e("pages/home/views/state-list"),y=e("packages/sport/views/sport-list"),b=e("packages/location/views/city"),w=o.LayoutView,E=r.$,S=r._,x=u.lib.Channel,T=[base_url+"pages/home/home.css",base_url+"vendor/plugins/qtip/qtip.css"];return n=i.extend({searchPage:0,initialize:function(e){return x("load:css").publish(T),S.bindAll(this),e.params&&this.setParamsArray(e.params),this.handleOptions(e),e.userId&&(this.userId=e.userId),this.scheme=[],this.genderTypes=["boys","girls","both"],this.init(),this},init:function(){this.initUrlOptions(),this.createData(),this.handleDeferreds()},initUrlOptions:function(){this.searchUrls=["/api/video/search","/api/image/search","/api/user/search","/api/game/search","/api/team/search"];var e=!!S.isUndefined(this.base)||this.base==""&&this.base!=0?1:this.base;this.baseUrl=this.searchUrls[e],this.urlOptions={sports_id:this.sports_id||"0",cities_id:this.cities_id||"0",orderby:this.orderby||"random",time:this.time||"DAY",states_id:this.states_id||"0",searchtext:this.searchtext||"",country_id:this.country_id||"0"},this.urlOptionByPageView={restype:["base"],location:["cities_id","states_id","country_id"],view:["orderby"],sports:["sports_id"]},this.menuValues=[{page:"view",src:".view-options-h .browse.select",target:".view-link-h .option-heading-h",input:!1,defaultValue:"ORDER"},{page:"sports",src:".sports-option-h .sport.select",target:".sport-link-h .option-heading-h",input:!1,defaultValue:"ALL SPORTS"},{page:"location",src:"#city",target:".location-link-h .option-heading-h",input:!0,defaultValue:"PLACE"},{page:"restype",src:"#resulttype a.restype.select",target:".restype-link-h .option-heading-h",input:!1,defaultValue:"ATHLETES"}],this.viewOptions=["orderby","time"],this.sportsOptions=["sports_id"],this.locationOptions=["cities_id","states_id","country_id"]},addSubscribers:function(){var e=this;S.each(this.genderTypes,function(e){x("sportChanged:"+this.collections[e].cid,"unique").subscribe(this.changeSportFilter)},this),x("cityChanged:"+this.sections.city.id,"unique").subscribe(this.changeCityFilter),routing.off("stateChanged"),routing.on("stateChanged",function(t){e.changeStateFilter(t)}),x("resetIndividual","unique").subscribe(this.updateIndividual),x("textChanged","unique").subscribe(this.updateText),x("viewFilterChanged","unique").subscribe(this.changeViewFilter),x("baseUrlChanged","unique").subscribe(this.updateBaseUrl),x("resetFilter","unique").subscribe(this.resetFilter)},setupScheme:function(){var e,t=this.params;for(e=0;e<this.meta.activeViews.length;e++)this.scheme.push(this.sections[this.meta.activeViews[e]])},updateIndividual:function(e){for(var t in this.menuValues)this.menuValues[t].page==e&&(this.menuValues[t].input?E(this.menuValues[t].src).val(""):E(this.menuValues[t].src).removeClass("select"));switch(e){case"view":for(var t in this.viewOptions)this.viewOptions[t]=="orderby"?(E(".dropdown-menu .browse").removeClass("select"),this.urlOptions[this.viewOptions[t]]="random"):t=="time"&&(this.urlOptions[this.viewOptions[t]]="today");break;case"sports":for(var t in this.sportsOptions)this.urlOptions[this.sportsOptions[t]]="0";break;case"restype":this.baseUrl=this.searchUrls[0];break;case"location":for(var t in this.locationOptions)this.urlOptions[this.locationOptions[t]]="0"}this.updateUrlAfterReset(this.urlOptionByPageView[e]),this.transitionView()},updateUrlAfterReset:function(e){var t=window.location.hash;if(e&&e.length)for(var n in e){var r=new RegExp(e[n]+"/[0-9a-zA-Z]+/","i"),i=new RegExp(e[n]+"/[0-9a-zA-Z]+","i");r.test(t)?t=t.replace(r,""):i.test(t)&&(t=t.replace(i,""))}routing.navigate(t,{trigger:!1})},initSections:function(){this.setupMenuView(),S.each(this.genderTypes,this.setupSportListView),S.each(["top-rated","search-result"],this.setupImageListView),this.setupLocationDDView(),this.setupScheme(),this.setupLayout().render(),this.setUpRegistrationView(),this.cityView&&this.cityView.initPlugin(),this.userId&&E(".register-wrapper, .register-wrapper-h").hide().html("")},updateBaseUrl:function(e){this.baseUrl=this.searchUrls[e];var t={base:e};this.transitionView(t)},updateText:function(e){this.urlOptions.searchtext=e;var t={searchtext:e};this.transitionView(t)},changeViewFilter:function(e){e.submenu==="browse"?options={orderby:e.value}:options={time:e.value},options.orderby=="random"?E(".left-arrow-page").fadeOut():E(".left-arrow-page").fadeIn(),this.transitionView(options)},changeSportFilter:function(e){var t={sports_id:e.attributes.payload.sport_id};this.transitionView(t)},changeStateFilter:function(e){var t={states_id:e};this.transitionView(t)},changeCityFilter:function(e){E(".menu-detail-h").hide(),E(".reset-option-btn-h[data-type=city]").removeClass("hide"),e.label&&E("#city").val(e.label);var t={cities_id:e.id,states_id:e.state_id,country_id:e.country_id};this.transitionView(t)},resetFilter:function(e){for(var t in this.menuValues)this.menuValues[t].input?E(this.menuValues[t].src).val(""):E(this.menuValues[t].src).removeClass("select");switch(e){case"view":for(var t in this.viewOptions)this.viewOptions[t]=="orderby"?(E(".dropdown-menu .browse").removeClass("select"),this.urlOptions[this.viewOptions[t]]="random"):t=="time"&&(this.urlOptions[this.viewOptions[t]]="today");break;case"sports":for(var t in this.sportsOptions)this.urlOptions[this.sportsOptions[t]]="0";break;case"location":for(var t in this.locationOptions)this.urlOptions[this.locationOptions[t]]="0"}this.removeParamsFromUrl(),this.transitionView()},transitionView:function(e){this.searchPage=0,this.searchView(e)},manageHomePageUrl:function(e){var t,n=window.location.hash.match("home")?window.location.hash:window.location.hash+"/!home";n=n.match("search")?n:n+"/search";if(e)for(var r in e)if(!S.isUndefined(e[r])&&(e[r]!=""||e[r]=="0")){var i=new RegExp(r+"/(.*)[0-9a-zA-Z]","i"),s=new RegExp(r+"/(.*)[0-9a-zA-Z]","i");i.test(n)?n=n.replace(i,r+"/"+e[r]):s.test(n)?n=n.replace(s,r+"/"+e[r]):(t=n[n.length-1]!="/"?"/":"",n+=t+r+"/"+e[r])}routing.navigate(n,{trigger:!1})},removeParamsFromUrl:function(){routing.navigate("!home",{trigger:!1})},searchView:function(e){var t=this,n="search-result",r=this.collections[n];controller=this,this.manageHomePageUrl(e),r.url=this.url(e),r.targetElement="#search-result",r.fetch();var i=i||null;E.when(r.request).done(function(){r.length<12?E(".right-arrow-page-h").addClass("disable-arrow-link"):E(".right-arrow-page-h").removeClass("disable-arrow-link"),t.searchPage==0||controller.urlOptions.orderby=="random"?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link");var e=new m({collection:r,name:n,destination:"#"+n,user_id:this.userId,media_id:i,pageName:"home"});controller.layout.transition(n,e)});for(var s in this.menuValues){if(this.menuValues[s].input)var o=E(this.menuValues[s].src).val();else var o=E(this.menuValues[s].src).text();o!=""?E(this.menuValues[s].target).html(o):E(this.menuValues[s].target).html(this.menuValues[s].defaultValue)}},bindCickEvents:function(){var e=this;E(document).on("click",".left-arrow-page-h",function(){e.searchPage-=12,e.searchView()}),E(document).on("click",".right-arrow-page-h",function(){e.searchPage+=12,e.searchView()}),e.searchPage==0?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link")},url:function(e){var t=this.baseUrl+"?offset="+this.searchPage+"&";S.extend(this.urlOptions,e);var n=[];return E.each(this.urlOptions,function(e,t){n.push(e+"="+encodeURIComponent(t))}),t+=n.join("&"),this.media_id&&(t+="&media_id="+this.media_id),t},createData:function(){var e=this;e.collections={},e.collections["search-result"]=new l([],{url:e.url(),num:"12",media_id:e.media_id,targetElement:"#search-result"}),e.collections.state=new f,e.collections["top-rated"]=new l([],{url:"/api/user/search",num:"4",targetElement:"#top-rated"}),S.each(e.genderTypes,function(t){e.collections[t]=new a([],{name:t})})},handleDeferreds:function(){var e=this,t=[];S.each(this.collections,function(e,n,r){t.push(e.fetch())}),E.when.apply(E,t).done(e.initSections,e.addSubscribers)},setupImageListView:function(e){var t;t=new m({collection:this.collections[e],name:e,destination:"#"+e,user_id:this.userId,media_id:this.media_id,pageName:"home",viewName:e}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setupSportListView:function(e){var t;t=new y({collection:this.collections[e],name:e,id:e,sports_id:this.sports_id,destination:"#sport #"+e}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setUpRegistrationView:function(){var e;this.select_type=new p},setupMenuView:function(){var e=new c,t,n="menu",r=this.urlOptions;r.base=this.base,t=new d({model:e,name:n,destination:"#"+n,options:r}),t.render(),this.sections[n]=t,this.meta.activeViews.push(n)},setupLocationDDView:function(){var e,t="state",n=new h,r="city";this.cityView=new b({model:n,name:r,destination:"#location .city"}),this.cityView.render(),this.sections[r]=this.cityView,this.meta.activeViews.push(r)},setupLayout:function(){var e;return e=new w({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.bindCickEvents(),this.layout}}),n}),define("text!videopreview/templates/basic.html",[],function(){return'<div id="imgUploadModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n		<h3 id="label">Video Uploader</h3>\r\n	</div>\r\n\r\n	<div class="modal-body">\r\n		<div id="main-content-img" class="video"></div>\r\n\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n\r\n</div>'}),define("videopreview/models/base",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{URL:window.URL||window.webkitURL}),files:[],initialize:function(){!this.URL},playSelectedFile:function(e){var t=this.files[0],n=t.type,r=document.querySelector("video"),i=r.canPlayType(n);i=i===""?"no":i;var s='Can play type "'+n+'": '+i,o=i==="no";this.displayMessage(s,o);if(o)return;var u=this.URL.createObjectURL(t);r.src=u}}),n}),define("videopreview/models/videoup",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({initialize:function(e){},doUpload:function(e){return new plupload.Uploader({runtimes:"html5,gears,flash,silverlight,browserplus",browse_button:"pickfiles",container:"container_plupload",max_file_size:"500mb",max_file_count:1,chunk_size:"5mb",url:e,unique_names:!0,flash_swf_url:"/plupload/js/plupload.flash.swf",silverlight_xap_url:"/plupload/js/plupload.silverlight.xap",filters:[{title:"Video files",extensions:"mov,mp4,mpeg4,avi,mkv,webm,ogg"}],multipart_params:{title:""},init:{ChunkUploaded:function(e,t,n){console.log(t,n)},FileUploaded:function(e,t,n){$("#"+t.id+" b").html("100%"),$("#uploadfiles").removeClass("isUploading"),e.refresh(),$("form.form input").val("");var r=$.parseJSON(n.response);console.log(r),r.result=="success"&&$("#resultdiv").html("SUCCESS! Your video has been uploaded and is now being encoded.  This may take a few minutes.  You will receive an email when the video is ready to view.  If anything goes wrong you can refer to the encode job ID: "+r.jobID).show(),console.log(t,n)}}})}}),n}),define("text!videopreview/templates/upload.html",[],function(){return'<!--<input type="file" id="chooseVideoFile" accept="video/*"/>\r\n<form>\r\n	<div id="container">\r\n		<div id="pickfiles">Find a Video</div>\r\n		<div class="modal-footer">\r\n			<button class="btn fileuploader btn-primary" id="videoup" type="button">Upload</button>\r\n			<button class="btn" data-dismiss="modal"  aria-hidden="true">Close</button>\r\n		</div>\r\n	</div>\r\n</form>-->\r\n\r\n<div id="file_upload"></div>\r\n<form class="form" id="upload_form" method="post">\r\n	<div id="container_plupload">\r\n\r\n	<div style="padding:5px 0 20px 10px;">The video uploader will let you upload large videos to our servers.  Once the upload is finished, it takes a couple minutes for everything to process.\r\n	So nothing will happen right away, but it will be on your profile within a couple minutes of when you hit upload.</div>\r\n	<span class="file-wrapper">\r\n				<div class="qq-upload-button" id="pickfiles" style="float:left; width:95%;">\r\n					<a class="btn-common common-default-sky-dark">Select a Video File</a>\r\n					<span style="font-size:11px; display:block; color:#880000;" id="fileVal"></span>\r\n				</div></span><br/>\r\n		<input type="text" id="title" name="title" style="width:95%" placeholder="Enter a Title"/>\r\n		<label style="margin-bottom: 2px;">Sport</label>\r\n		<select name="sports_id" id="sports_id" style="width:95%;" class="">\r\n			<option value="1">Baseball (Men\'s)</option>\r\n			<option value="2">Basketball (Men\'s)</option>\r\n			<option value="20">Basketball (Women\'s)</option>\r\n			<option value="52">Beach Volleyball (Individual)</option>\r\n			<option value="53">Boxing (Men\'s)</option>\r\n			<option value="54">Boxing (Women\'s)</option>\r\n			<option value="55">Brazilian Jujitsu (Men\'s)</option>\r\n			<option value="56">Brazilian Jujitsu (Women\'s)</option>\r\n			<option value="22">Cheerleading (Women\'s)</option>\r\n			<option value="19">Crew (Men\'s)</option>\r\n			<option value="35">Crew (Women\'s)</option>\r\n			<option value="3">Cross Country (Men\'s)</option>\r\n			<option value="21">Cross Country (Women\'s)</option>\r\n			<option value="74">Crossfit (Individual)</option>\r\n			<option value="72">Cycling (Individual)</option>\r\n			<option value="39">Diving (Men\'s)</option>\r\n			<option value="47">Diving (Women\'s)</option>\r\n			<option value="41">Fencing (Men\'s)</option>\r\n			<option value="42">Fencing (Women\'s)</option>\r\n			<option value="34">Field Hockey (Women\'s)</option>\r\n			<option value="6">Football (Men\'s)</option>\r\n			<option value="82">Golf (Individual)</option>\r\n			<option value="8">Golf (Team) (Men\'s)</option>\r\n			<option value="23">Golf (Team) (Women\'s)</option>\r\n			<option value="36">Gymnastics (Men\'s)</option>\r\n			<option value="43">Gymnastics (Women\'s)</option>\r\n			<option value="9">Hockey (Men\'s)</option>\r\n			<option value="24">Hockey (Women\'s)</option>\r\n			<option value="40">Indoor Track (Men\'s)</option>\r\n			<option value="46">Indoor Track (Women\'s)</option>\r\n			<option value="62">Karate (Men\'s)</option>\r\n			<option value="63">Karate (Women\'s)</option>\r\n			<option value="64">Kickboxing (Men\'s)</option>\r\n			<option value="65">Kickboxing (Women\'s)</option>\r\n			<option value="10">Lacrosse (Men\'s)</option>\r\n			<option value="25">Lacrosse (Women\'s)</option>\r\n			<option value="50">Long Distance Running (Individual)</option>\r\n			<option value="57">MMA (Men\'s)</option>\r\n			<option value="58">MMA (Women\'s)</option>\r\n			<option value="78">Mountain Climbing (Individual)</option>\r\n			<option value="37">Rifle (Men\'s)</option>\r\n			<option value="44">Rifle (Women\'s)</option>\r\n			<option value="7">Rugby (Men\'s)</option>\r\n			<option value="38">Skiing (Men\'s)</option>\r\n			<option value="45">Skiing (Women\'s)</option>\r\n			<option value="11">Soccer (Men\'s)</option>\r\n			<option value="27">Soccer (Women\'s)</option>\r\n			<option value="26">Softball (Women\'s)</option>\r\n			<option value="70">Spartan Race (Individual)</option>\r\n			<option value="48">Squash (Men\'s)</option>\r\n			<option value="49">Squash (Women\'s)</option>\r\n			<option value="76">Surfing (Individual)</option>\r\n			<option value="68">Swimming (Individual)</option>\r\n			<option value="12">Swimming (Team) (Men\'s)</option>\r\n			<option value="28">Swimming (Team) (Women\'s)</option>\r\n			<option value="66">Tennis (Individual)</option>\r\n			<option value="14">Tennis (Team) (Men\'s)</option>\r\n			<option value="30">Tennis (Team) (Women\'s)</option>\r\n			<option value="15">Track and Field (Men\'s)</option>\r\n			<option value="31">Track and Field (Women\'s)</option>\r\n			<option value="51">Triathalon (Individual)</option>\r\n			<option value="16">Volleyball (Men\'s)</option>\r\n			<option value="32">Volleyball (Women\'s)</option>\r\n			<option value="17">Water Polo (Men\'s)</option>\r\n			<option value="33">Water Polo (Women\'s)</option>\r\n			<option value="18">Wrestling (Men\'s)</option>\r\n		</select>\r\n\r\n		<div id="uploadfiles" class="common-default-sky-dark btn-common" style="width:70px;">Upload</div>\r\n		<div id="filelist"></div>\r\n	</div>\r\n</form>\r\n\r\n<div id="resultdiv" style="display: none; padding-left: 10px;"></div></div>'}),function(){function l(){this.returnValue=!1}function c(){this.cancelBubble=!0}var e=0,t=[],n={},r={},i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},s=/[<>&\"\']/g,o,u=window.setTimeout,a={},f;(function(e){var t=e.split(/,/),n,i,s;for(n=0;n<t.length;n+=2){s=t[n+1].split(/ /);for(i=0;i<s.length;i++)r[s[i]]=t[n]}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var h={VERSION:"1.5.4",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:r,ua:function(){var e=navigator,t=e.userAgent,n=e.vendor,r,i,s;return r=/WebKit/.test(t),s=r&&n.indexOf("Apple")!==-1,i=window.opera&&window.opera.buildNumber,{windows:navigator.platform.indexOf("Win")!==-1,ie:!r&&!i&&/MSIE/gi.test(t)&&/Explorer/gi.test(e.appName),webkit:r,gecko:!r&&/Gecko/.test(t),safari:s,opera:!!i}}(),typeOf:function(e){return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(e){return h.each(arguments,function(t,n){n>0&&h.each(t,function(t,n){e[n]=t})}),e},cleanName:function(e){var t,n;n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,""),e},addRuntime:function(e,n){return n.name=e,t[e]=n,t.push(n),n},guid:function(){var t=(new Date).getTime().toString(32),n;for(n=0;n<5;n++)t+=Math.floor(Math.random()*65535).toString(32);return(h.guidPrefix||"p")+t+(e++).toString(32)},buildUrl:function(e,t){var n="";return h.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},each:function(e,t){var n,r,i;if(e){n=e.length;if(n===o){for(r in e)if(e.hasOwnProperty(r)&&t(e[r],r)===!1)return}else for(i=0;i<n;i++)if(t(e[i],i)===!1)return}},formatSize:function(e){return e===o||/\D/.test(e)?h.translate("N/A"):e>1073741824?Math.round(e/1073741824,1)+" GB":e>1048576?Math.round(e/1048576,1)+" MB":e>1024?Math.round(e/1024,1)+" KB":e+" b"},getPos:function(e,t){function a(e){var t,n,r=0,i=0;return e&&(n=e.getBoundingClientRect(),t=s.compatMode==="CSS1Compat"?s.documentElement:s.body,r=n.left+t.scrollLeft,i=n.top+t.scrollTop),{x:r,y:i}}var n=0,r=0,i,s=document,o,u;e=e,t=t||s.body;if(e&&e.getBoundingClientRect&&navigator.userAgent.indexOf("MSIE")>0&&s.documentMode<8)return o=a(e),u=a(t),{x:o.x-u.x,y:o.y-u.y};i=e;while(i&&i!=t&&i.nodeType)n+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;i=e.parentNode;while(i&&i!=t&&i.nodeType)n-=i.scrollLeft||0,r-=i.scrollTop||0,i=i.parentNode;return{x:n,y:r}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSize:function(e){var t;return typeof e=="string"&&(e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],t=="g"&&(e*=1073741824),t=="m"&&(e*=1048576),t=="k"&&(e*=1024)),e},xmlEncode:function(e){return e?(""+e).replace(s,function(e){return i[e]?"&"+i[e]+";":e}):e},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},inArray:function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1},addI18n:function(e){return h.extend(n,e)},translate:function(e){return n[e]||e},isEmptyObj:function(e){if(e===o)return!0;for(var t in e)return!1;return!0},hasClass:function(e,t){var n;return e.className==""?!1:(n=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),n.test(e.className))},addClass:function(e,t){h.hasClass(e,t)||(e.className=e.className==""?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return t===" "&&n===" "?" ":""})},getStyle:function(e,t){if(e.currentStyle)return e.currentStyle[t];if(window.getComputedStyle)return window.getComputedStyle(e,null)[t]},addEvent:function(e,t,n){var r,i,s,u;u=arguments[3],t=t.toLowerCase(),f===o&&(f="Plupload_"+h.guid()),e.addEventListener?(r=n,e.addEventListener(t,r,!1)):e.attachEvent&&(r=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=l,e.stopPropagation=c,n(e)},e.attachEvent("on"+t,r)),e[f]===o&&(e[f]=h.guid()),a.hasOwnProperty(e[f])||(a[e[f]]={}),i=a[e[f]],i.hasOwnProperty(t)||(i[t]=[]),i[t].push({func:r,orig:n,key:u})},removeEvent:function(e,t){var n,r,i;typeof arguments[2]=="function"?r=arguments[2]:i=arguments[2],t=t.toLowerCase();if(!(e[f]&&a[e[f]]&&a[e[f]][t]))return;n=a[e[f]][t];for(var s=n.length-1;s>=0;s--)if(n[s].key===i||n[s].orig===r){e.removeEventListener?e.removeEventListener(t,n[s].func,!1):e.detachEvent&&e.detachEvent("on"+t,n[s].func),n[s].orig=null,n[s].func=null,n.splice(s,1);if(r!==o)break}n.length||delete a[e[f]][t];if(h.isEmptyObj(a[e[f]])){delete a[e[f]];try{delete e[f]}catch(u){e[f]=o}}},removeAllEvents:function(e){var t=arguments[1];if(e[f]===o||!e[f])return;h.each(a[e[f]],function(n,r){h.removeEvent(e,r,t)})}};h.Uploader=function(e){function f(){var e,t=0,n;if(this.state==h.STARTED){for(n=0;n<i.length;n++)!e&&i[n].status==h.QUEUED?(e=i[n],e.status=h.UPLOADING,this.trigger("BeforeUpload",e)&&this.trigger("UploadFile",e)):t++;t==i.length&&(this.stop(),this.trigger("UploadComplete",i))}}function l(){var e,t;r.reset();for(e=0;e<i.length;e++)t=i[e],t.size!==o?(r.size+=t.size,r.loaded+=t.loaded):r.size=o,t.status==h.DONE?r.uploaded++:t.status==h.FAILED?r.failed++:r.queued++;r.size===o?r.percent=i.length>0?Math.ceil(r.uploaded/i.length*100):0:(r.bytesPerSec=Math.ceil(r.loaded/((+(new Date)-s||1)/1e3)),r.percent=r.size>0?Math.ceil(r.loaded/r.size*100):0)}var n={},r,i=[],s,a=!1;r=new h.QueueProgress,e=h.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},e),h.extend(this,{state:h.STOPPED,runtime:"",features:{},files:i,settings:e,total:r,id:h.guid(),init:function(){function v(){var e=a[p++],t,r,i;if(e){t=e.getFeatures(),r=n.settings.required_features;if(r){r=r.split(",");for(i=0;i<r.length;i++)if(!t[r[i]]){v();return}}e.init(n,function(r){r&&r.success?(n.features=t,n.runtime=e.name,n.trigger("Init",{runtime:e.name}),n.trigger("PostInit"),n.refresh()):v()})}else n.trigger("Error",{code:h.INIT_ERROR,message:h.translate("Init error.")})}var n=this,r,a,c,p=0,d;typeof e.preinit=="function"?e.preinit(n):h.each(e.preinit,function(e,t){n.bind(t,e)}),e.page_url=e.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(e.url)||(e.url=e.page_url+e.url),e.chunk_size=h.parseSize(e.chunk_size),e.max_file_size=h.parseSize(e.max_file_size),n.bind("FilesAdded",function(t,r){var s,a,f=0,l,c=e.filters;c&&c.length&&(l=[],h.each(c,function(e){h.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?l.push("\\.*"):l.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),l=new RegExp(l.join("|")+"$","i"));for(s=0;s<r.length;s++){a=r[s],a.loaded=0,a.percent=0,a.status=h.QUEUED;if(l&&!l.test(a.name)){t.trigger("Error",{code:h.FILE_EXTENSION_ERROR,message:h.translate("File extension error."),file:a});continue}if(a.size!==o&&a.size>e.max_file_size){t.trigger("Error",{code:h.FILE_SIZE_ERROR,message:h.translate("File size error."),file:a});continue}i.push(a),f++}if(!f)return!1;u(function(){n.trigger("QueueChanged"),n.refresh()},1)}),e.unique_names&&n.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),r="tmp";n&&(r=n[1]),t.target_name=t.id+"."+r}),n.bind("UploadProgress",function(e,t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,l()}),n.bind("StateChanged",function(e){if(e.state==h.STARTED)s=+(new Date);else if(e.state==h.STOPPED)for(r=e.files.length-1;r>=0;r--)e.files[r].status==h.UPLOADING&&(e.files[r].status=h.QUEUED,l())}),n.bind("QueueChanged",l),n.bind("Error",function(e,t){t.file&&(t.file.status=h.FAILED,l(),e.state==h.STARTED&&u(function(){f.call(n)},1))}),n.bind("FileUploaded",function(e,t){t.status=h.DONE,t.loaded=t.size,e.trigger("UploadProgress",t),u(function(){f.call(n)},1)});if(e.runtimes){a=[],d=e.runtimes.split(/\s?,\s?/);for(r=0;r<d.length;r++)t[d[r]]&&a.push(t[d[r]])}else a=t;v(),typeof e.init=="function"?e.init(n):h.each(e.init,function(e,t){n.bind(t,e)})},refresh:function(){this.trigger("Refresh")},start:function(){i.length&&this.state!=h.STARTED&&(this.state=h.STARTED,this.trigger("StateChanged"),f.call(this))},stop:function(){this.state!=h.STOPPED&&(this.state=h.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(){a=arguments[0]!==o?arguments[0]:!0,this.trigger("DisableBrowse",a)},getFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e)return i[t]},removeFile:function(e){var t;for(t=i.length-1;t>=0;t--)if(i[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){var n;return n=i.splice(e===o?0:e,t===o?i.length:t),this.trigger("FilesRemoved",n),this.trigger("QueueChanged"),n},trigger:function(e){var t=n[e.toLowerCase()],r,i;if(t){i=Array.prototype.slice.call(arguments),i[0]=this;for(r=0;r<t.length;r++)if(t[r].func.apply(t[r].scope,i)===!1)return!1}return!0},hasEventListener:function(e){return!!n[e.toLowerCase()]},bind:function(e,t,r){var i;e=e.toLowerCase(),i=n[e]||[],i.push({func:t,scope:r||this}),n[e]=i},unbind:function(e){e=e.toLowerCase();var t=n[e],r,i=arguments[1];if(t){if(i!==o){for(r=t.length-1;r>=0;r--)if(t[r].func===i){t.splice(r,1);break}}else t=[];t.length||delete n[e]}},unbindAll:function(){var e=this;h.each(n,function(t,n){e.unbind(n)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},h.File=function(e,t,n){var r=this;r.id=e,r.name=t,r.size=n,r.loaded=0,r.percent=0,r.status=0},h.Runtime=function(){this.getFeatures=function(){},this.init=function(e,t){}},h.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},h.runtimes={},window.plupload=h}(),function(){if(window.google&&google.gears)return;var e=null;if(typeof GearsFactory!="undefined")e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory"),e.getBuildInfo().indexOf("ie_mobile")!=-1&&e.privateSetGlobalObject(this)}catch(t){typeof navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-googlegears"]&&(e=document.createElement("object"),e.style.display="none",e.width=0,e.height=0,e.type="application/x-googlegears",document.documentElement.appendChild(e))}if(!e)return;window.google||(window.google={}),google.gears||(google.gears={factory:e})}(),function(e,t,n,r){function s(e,t,n){var r,i,s,o;i=google.gears.factory.create("beta.canvas");try{i.decode(e),t.width||(t.width=i.width),t.height||(t.height=i.height),o=Math.min(width/i.width,height/i.height);if(o<1||o===1&&n==="image/jpeg")return i.resize(Math.round(i.width*o),Math.round(i.height*o)),t.quality?i.encode(n,{quality:t.quality/100}):i.encode(n)}catch(u){}return e}var i={};n.runtimes.Gears=n.addRuntime("gears",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(r,o){function d(e){var t,s,o=[],u;for(s=0;s<e.length;s++)t=e[s],u=n.guid(),i[u]=t.blob,o.push(new n.File(u,t.name,t.blob.length));r.trigger("FilesAdded",o)}var u,l,h=!1;if(!e.google||!google.gears)return o({success:!1});try{u=google.gears.factory.create("beta.desktop")}catch(p){return o({success:!1})}r.bind("PostInit",function(){var e=r.settings,i=t.getElementById(e.drop_element);i&&(n.addEvent(i,"dragover",function(e){u.setDropEffect(e,"copy"),e.preventDefault()},r.id),n.addEvent(i,"drop",function(e){var t=u.getDragData(e,"application/x-gears-files");t&&d(t.files),e.preventDefault()},r.id),i=0),n.addEvent(t.getElementById(e.browse_button),"click",function(t){var n=[],r,i,s;t.preventDefault();if(h)return;e:for(r=0;r<e.filters.length;r++){s=e.filters[r].extensions.split(",");for(i=0;i<s.length;i++){if(s[i]==="*"){n=[];break e}n.push("."+s[i])}}u.openFiles(d,{singleFile:!e.multi_selection,filter:n})},r.id)}),r.bind("CancelUpload",function(){l.abort&&l.abort()}),r.bind("UploadFile",function(e,t){function v(){function y(r){var i,s="----pluploadboundary"+n.guid(),o="--",u="\r\n",f,h;a&&(l.setRequestHeader("Content-Type","multipart/form-data; boundary="+s),i=google.gears.factory.create("beta.blobbuilder"),n.each(n.extend(m,e.settings.multipart_params),function(e,t){i.append(o+s+u+'Content-Disposition: form-data; name="'+t+'"'+u+u),i.append(e+u)}),h=n.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",i.append(o+s+u+'Content-Disposition: form-data; name="'+e.settings.file_data_name+'"; filename="'+t.name+'"'+u+"Content-Type: "+h+u+u),i.append(r),i.append(u+o+s+o+u),f=i.getAsBlob(),p=f.length-r.length,r=f),l.send(r)}var s,a=e.settings.multipart,p=0,m={name:t.target_name||t.name},g=e.settings.url;if(t.status==n.DONE||t.status==n.FAILED||e.state==n.STOPPED)return;d&&(m.chunk=r,m.chunks=o),s=Math.min(u,t.size-r*u),a||(g=n.buildUrl(e.settings.url,m)),l=google.gears.factory.create("beta.httprequest"),l.open("POST",g),a||(l.setRequestHeader("Content-Disposition",'attachment; filename="'+t.name+'"'),l.setRequestHeader("Content-Type","application/octet-stream")),n.each(e.settings.headers,function(e,t){l.setRequestHeader(t,e)}),l.upload.onprogress=function(n){t.loaded=h+n.loaded-p,e.trigger("UploadProgress",t)},l.onreadystatechange=function(){var i;if(l.readyState==4&&e.state!==n.STOPPED)if(l.status==200){i={chunk:r,chunks:o,response:l.responseText,status:l.status},e.trigger("ChunkUploaded",t,i);if(i.cancelled){t.status=n.FAILED;return}h+=s,++r>=o?(t.status=n.DONE,e.trigger("FileUploaded",t,{response:l.responseText,status:l.status})):v()}else e.trigger("Error",{code:n.HTTP_ERROR,message:n.translate("HTTP Error."),file:t,chunk:r,chunks:o,status:l.status})},r<o&&y(i[t.id].slice(r*u,s))}var r=0,o,u,h=0,p=e.settings.resize,d;p&&/\.(png|jpg|jpeg)$/i.test(t.name)&&(i[t.id]=s(i[t.id],p,/\.png$/i.test(t.name)?"image/png":"image/jpeg")),t.size=i[t.id].length,u=e.settings.chunk_size,d=u>0,o=Math.ceil(t.size/u),d||(u=t.size,o=1),v()}),r.bind("DisableBrowse",function(e,t){h=t}),r.bind("Destroy",function(e){var r,i,s={browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(r in s)i=t.getElementById(s[r]),i&&n.removeAllEvents(i,e.id)}),o({success:!0})}})}(window,document,plupload),function(e,t,n,r){function o(e){var t,n=typeof e,i,s,u;if(e===r||e===null)return"null";if(n==="string")return t="\bb	t\nn\ff\rr\"\"''\\\\",'"'+e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(e,n){var r=t.indexOf(n);return r+1?"\\"+t.charAt(r+1):(e=n.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e)})+'"';if(n=="object"){i=e.length!==r,t="";if(i){for(s=0;s<e.length;s++)t&&(t+=","),t+=o(e[s]);t="["+t+"]"}else{for(u in e)e.hasOwnProperty(u)&&(t&&(t+=","),t+=o(u)+":"+o(e[u]));t="{"+t+"}"}return t}return""+e}function u(e){var t=!1,n=null,r=null,i,s,o,u,a,f=0;try{try{r=new ActiveXObject("AgControl.AgControl"),r.IsVersionSupported(e)&&(t=!0),r=null}catch(l){var c=navigator.plugins["Silverlight Plug-In"];if(c){i=c.description,i==="1.0.30226.2"&&(i="2.0.30226.2"),s=i.split(".");while(s.length>3)s.pop();while(s.length<4)s.push(0);o=e.split(".");while(o.length>4)o.pop();do u=parseInt(o[f],10),a=parseInt(s[f],10),f++;while(f<o.length&&u===a);u<=a&&!isNaN(u)&&(t=!0)}}}catch(h){t=!1}return t}var i={},s={};n.silverlight={trigger:function(e,t){var r=i[e],s,o;r&&(o=n.toArray(arguments).slice(1),o[0]="Silverlight:"+t,setTimeout(function(){r.trigger.apply(r,o)},0))}},n.runtimes.Silverlight=n.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(r,l){function E(){return t.getElementById(r.id+"_silverlight").content.Upload}var p,v="",m=r.settings.filters,y,w=t.body;if(!u("2.0.31005.0")||e.opera&&e.opera.buildNumber){l({success:!1});return}s[r.id]=!1,i[r.id]=r,p=t.createElement("div"),p.id=r.id+"_silverlight_container",n.extend(p.style,{position:"absolute",top:"80px",background:r.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:r.settings.shim_bgcolor||t.documentMode>8?"":.01}),p.className="plupload silverlight",r.settings.container&&(w=t.getElementById(r.settings.container),n.getStyle(w,"position")==="static"&&(w.style.position="relative")),w.appendChild(p);for(y=0;y<m.length;y++)v+=(v!=""?"|":"")+m[y].title+" | *."+m[y].extensions.replace(/,/g,";*.");p.innerHTML='<object id="'+r.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+r.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+r.id+",filter="+v+",multiselect="+r.settings.multi_selection+'"/></object>',r.bind("Silverlight:Init",function(){var e,u={};if(s[r.id])return;s[r.id]=!0,r.bind("Silverlight:StartSelectFiles",function(t){e=[]}),r.bind("Silverlight:SelectFile",function(t,r,i,s){var o;o=n.guid(),u[o]=r,u[r]=o,e.push(new n.File(o,i,s))}),r.bind("Silverlight:SelectSuccessful",function(){e.length&&r.trigger("FilesAdded",e)}),r.bind("Silverlight:UploadChunkError",function(e,t,i,s,o){r.trigger("Error",{code:n.IO_ERROR,message:"IO Error.",details:o,file:e.getFile(u[t])})}),r.bind("Silverlight:UploadFileProgress",function(e,t,r,i){var s=e.getFile(u[t]);s.status!=n.FAILED&&(s.size=i,s.loaded=r,e.trigger("UploadProgress",s))}),r.bind("Refresh",function(e){var r,i,s;r=t.getElementById(e.settings.browse_button),r&&(i=n.getPos(r,t.getElementById(e.settings.container)),s=n.getSize(r),n.extend(t.getElementById(e.id+"_silverlight_container").style,{top:i.y+"px",left:i.x+"px",width:s.w+"px",height:s.h+"px"}))}),r.bind("Silverlight:UploadChunkSuccessful",function(e,t,r,i,s){var o,a=e.getFile(u[t]);o={chunk:r,chunks:i,response:s},e.trigger("ChunkUploaded",a,o),a.status!=n.FAILED&&e.state!==n.STOPPED&&E().UploadNextChunk(),r==i-1&&(a.status=n.DONE,e.trigger("FileUploaded",a,{response:s}))}),r.bind("Silverlight:UploadSuccessful",function(e,t,r){var i=e.getFile(u[t]);i.status=n.DONE,e.trigger("FileUploaded",i,{response:r})}),r.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)E().RemoveFile(u[t[n].id])}),r.bind("UploadFile",function(e,t){var r=e.settings,i=r.resize||{};E().UploadFile(u[t.id],e.settings.url,o({name:t.target_name||t.name,mime:n.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,image_width:i.width,image_height:i.height,image_quality:i.quality||90,multipart:!!r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,headers:r.headers}))}),r.bind("CancelUpload",function(){E().CancelUpload()}),r.bind("Silverlight:MouseEnter",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_hover,i&&s&&n.addClass(i,s)}),r.bind("Silverlight:MouseLeave",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_hover,i&&s&&n.removeClass(i,s)}),r.bind("Silverlight:MouseLeftButtonDown",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_active,i&&s&&(n.addClass(i,s),n.addEvent(t.body,"mouseup",function(){n.removeClass(i,s)}))}),r.bind("Sliverlight:StartSelectFiles",function(e){var i,s;i=t.getElementById(r.settings.browse_button),s=e.settings.browse_button_active,i&&s&&n.removeClass(i,s)}),r.bind("DisableBrowse",function(e,t){E().DisableBrowse(t)}),r.bind("Destroy",function(e){var r;n.removeAllEvents(t.body,e.id),delete s[e.id],delete i[e.id],r=t.getElementById(e.id+"_silverlight_container"),r&&w.removeChild(r)}),l({success:!0})})}})}(window,document,plupload),function(e,t,n,r){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}var i={},s={};n.flash={trigger:function(e,t,n){setTimeout(function(){var r=i[e],s,o;r&&r.trigger("Flash:"+t,n)},0)}},n.runtimes.Flash=n.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(e,r){function p(){return t.getElementById(e.id+"_flash")}function v(){if(l++>5e3){r({success:!1});return}s[e.id]===!1&&setTimeout(v,1)}var u,f,l=0,h=t.body;if(o()<10){r({success:!1});return}s[e.id]=!1,i[e.id]=e,u=t.getElementById(e.settings.browse_button),f=t.createElement("div"),f.id=e.id+"_flash_container",n.extend(f.style,{position:"absolute",top:"0px",background:e.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),f.className="plupload flash",e.settings.container&&(h=t.getElementById(e.settings.container),n.getStyle(h,"position")==="static"&&(h.style.position="relative")),h.appendChild(f),function(){var r,i;r='<object id="'+e.id+'_flash" type="application/x-shockwave-flash" data="'+e.settings.flash_swf_url+'" ',n.ua.ie&&(r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+e.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(e.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',n.ua.ie?(i=t.createElement("div"),f.appendChild(i),i.outerHTML=r,i=null):f.innerHTML=r}(),v(),u=f=null,e.bind("Destroy",function(e){var r;n.removeAllEvents(t.body,e.id),delete s[e.id],delete i[e.id],r=t.getElementById(e.id+"_flash_container"),r&&h.removeChild(r)}),e.bind("Flash:Init",function(){var i={},o;try{p().setFileFilters(e.settings.filters,e.settings.multi_selection)}catch(u){r({success:!1});return}if(s[e.id])return;s[e.id]=!0,e.bind("UploadFile",function(t,r){var s=t.settings,o=e.settings.resize||{};p().uploadFile(i[r.id],s.url,{name:r.target_name||r.name,mime:n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:s.chunk_size,width:o.width,height:o.height,quality:o.quality,multipart:s.multipart,multipart_params:s.multipart_params||{},file_data_name:s.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:s.headers,urlstream_upload:s.urlstream_upload})}),e.bind("CancelUpload",function(){p().cancelUpload()}),e.bind("Flash:UploadProcess",function(e,t){var r=e.getFile(i[t.id]);r.status!=n.FAILED&&(r.loaded=t.loaded,r.size=t.size,e.trigger("UploadProgress",r))}),e.bind("Flash:UploadChunkComplete",function(e,t){var r,s=e.getFile(i[t.id]);r={chunk:t.chunk,chunks:t.chunks,response:t.text},e.trigger("ChunkUploaded",s,r),s.status!==n.FAILED&&e.state!==n.STOPPED&&p().uploadNextChunk(),t.chunk==t.chunks-1&&(s.status=n.DONE,e.trigger("FileUploaded",s,{response:t.text}))}),e.bind("Flash:SelectFiles",function(t,r){var s,o,u=[],a;for(o=0;o<r.length;o++)s=r[o],a=n.guid(),i[a]=s.id,i[s.id]=a,u.push(new n.File(a,s.name,s.size));u.length&&e.trigger("FilesAdded",u)}),e.bind("Flash:SecurityError",function(t,r){e.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:GenericError",function(t,r){e.trigger("Error",{code:n.GENERIC_ERROR,message:n.translate("Generic error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:IOError",function(t,r){e.trigger("Error",{code:n.IO_ERROR,message:n.translate("IO error."),details:r.message,file:e.getFile(i[r.id])})}),e.bind("Flash:ImageError",function(t,r){e.trigger("Error",{code:parseInt(r.code,10),message:n.translate("Image error."),file:e.getFile(i[r.id])})}),e.bind("Flash:StageEvent:rollOver",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.addClass(i,s)}),e.bind("Flash:StageEvent:rollOut",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_hover,i&&s&&n.removeClass(i,s)}),e.bind("Flash:StageEvent:mouseDown",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&(n.addClass(i,s),n.addEvent(t.body,"mouseup",function(){n.removeClass(i,s)},r.id))}),e.bind("Flash:StageEvent:mouseUp",function(r){var i,s;i=t.getElementById(e.settings.browse_button),s=r.settings.browse_button_active,i&&s&&n.removeClass(i,s)}),e.bind("Flash:ExifData",function(t,n){e.trigger("ExifData",e.getFile(i[n.id]),n.data)}),e.bind("Flash:GpsData",function(t,n){e.trigger("GpsData",e.getFile(i[n.id]),n.data)}),e.bind("QueueChanged",function(t){e.refresh()}),e.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)p().removeFile(i[t[n].id])}),e.bind("StateChanged",function(t){e.refresh()}),e.bind("Refresh",function(r){var i,s,o;p().setFileFilters(e.settings.filters,e.settings.multi_selection),i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(r.settings.container)),o=n.getSize(i),n.extend(t.getElementById(r.id+"_flash_container").style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}))}),e.bind("DisableBrowse",function(e,t){p().disableBrowse(t)}),r({success:!0})})}})}(window,document,plupload),function(e){e.runtimes.BrowserPlus=e.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(t,n){function u(n){var r,s,o=[],u,f;for(s=0;s<n.length;s++)u=n[s],f=e.guid(),i[f]=u,o.push(new e.File(f,u.name,u.size));s&&t.trigger("FilesAdded",o)}function f(){var f=!1;t.bind("PostInit",function(){function h(e,t){r.DragAndDrop.AddDropTarget({id:e},function(n){r.DragAndDrop.AttachCallbacks({id:e,hover:function(e){!e&&t&&t()},drop:function(e){t&&t(),u(e)}},function(){})})}function p(){document.getElementById(o).style.top="-1000px"}var n,i=s.drop_element,o=t.id+"_droptarget",l=document.getElementById(i),c;l&&(document.attachEvent&&/MSIE/gi.test(navigator.userAgent)?(n=document.createElement("div"),n.setAttribute("id",o),e.extend(n.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0}),document.body.appendChild(n),e.addEvent(l,"dragenter",function(t){var n,r;n=document.getElementById(i),r=e.getPos(n),e.extend(document.getElementById(o).style,{top:r.y+"px",left:r.x+"px",width:n.offsetWidth+"px",height:n.offsetHeight+"px"})}),h(o,p)):h(i)),e.addEvent(document.getElementById(s.browse_button),"click",function(t){var n=[],i,o,l=s.filters,c,h;t.preventDefault();if(f)return;e:for(i=0;i<l.length;i++){c=l[i].extensions.split(",");for(o=0;o<c.length;o++){if(c[o]==="*"){n=[];break e}h=e.mimeTypes[c[o]],h&&e.inArray(h,n)===-1&&n.push(e.mimeTypes[c[o]])}}r.FileBrowse.OpenBrowseDialog({mimeTypes:n},function(e){e.success&&u(e.value)})}),l=n=null}),t.bind("CancelUpload",function(){r.Uploader.cancel({},function(){})}),t.bind("DisableBrowse",function(e,t){f=t}),t.bind("UploadFile",function(t,n){function d(i,s){var o;if(n.status==e.FAILED)return;u.name=n.target_name||n.name,f&&(u.chunk=""+i,u.chunks=""+s),o=p.shift(),r.Uploader.upload({url:t.settings.url,files:{file:o},cookies:document.cookies,postvars:e.extend(u,t.settings.multipart_params),progressCallback:function(e){var r,s=0;l[i]=parseInt(e.filePercent*o.size/100,10);for(r=0;r<l.length;r++)s+=l[r];n.loaded=s,t.trigger("UploadProgress",n)}},function(r){var o,u;r.success?(o=r.value.statusCode,f&&t.trigger("ChunkUploaded",n,{chunk:i,chunks:s,response:r.value.body,status:o}),p.length>0?d(++i,s):(n.status=e.DONE,t.trigger("FileUploaded",n,{response:r.value.body,status:o}),o>=400&&t.trigger("Error",{code:e.HTTP_ERROR,message:e.translate("HTTP Error."),file:n,status:o}))):t.trigger("Error",{code:e.GENERIC_ERROR,message:e.translate("Generic Error."),file:n,details:r.error})})}function v(e){n.size=e.size,f?r.FileAccess.chunk({file:e,chunkSize:f},function(e){if(e.success){var t=e.value,n=t.length;l=Array(n);for(var r=0;r<n;r++)l[r]=0,p.push(t[r]);d(0,n)}}):(l=Array(1),p.push(e),d(0,1))}var s=i[n.id],u={},f=t.settings.chunk_size,l,p=[];o&&/\.(png|jpg|jpeg)$/i.test(n.name)?BrowserPlus.ImageAlter.transform({file:s,quality:o.quality||90,actions:[{scale:{maxwidth:o.width,maxheight:o.height}}]},function(e){e.success&&v(e.value.file)}):v(s)}),n({success:!0})}var r=window.BrowserPlus,i={},s=t.settings,o=s.resize;r?r.init(function(e){var t=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];o&&t.push({service:"ImageAlter",version:"4"}),e.success?r.require({services:t},function(e){e.success?f():n()}):n()}):n()}})}(plupload),function(e,t,n,r){function u(t,n){var r;if(!("FileReader"in e))return n(t.getAsDataURL());r=new FileReader,r.readAsDataURL(t),r.onload=function(){n(r.result)}}function a(t,n){var r;if(!("FileReader"in e))return n(t.getAsBinary());r=new FileReader,r.readAsBinaryString(t),r.onload=function(){n(r.result)}}function f(e,n,r,i){var o,a,f,l,p=this;u(s[e.id],function(s){o=t.createElement("canvas"),o.style.display="none",t.body.appendChild(o),a=o.getContext("2d"),f=new Image,f.onerror=f.onabort=function(){i({success:!1})},f.onload=function(){var t,u,d,m,g;n.width||(n.width=f.width),n.height||(n.height=f.height),l=Math.min(n.width/f.width,n.height/f.height);if(l<1||l===1&&r==="image/jpeg"){t=Math.round(f.width*l),u=Math.round(f.height*l),o.width=t,o.height=u,a.drawImage(f,0,0,t,u);if(r==="image/jpeg"){m=new c(atob(s.substring(s.indexOf("base64,")+7))),m.headers&&m.headers.length&&(g=new h,g.init(m.get("exif")[0])&&(g.setExif("PixelXDimension",t),g.setExif("PixelYDimension",u),m.set("exif",g.getBinary()),p.hasEventListener("ExifData")&&p.trigger("ExifData",e,g.EXIF()),p.hasEventListener("GpsData")&&p.trigger("GpsData",e,g.GPS())));if(n.quality)try{s=o.toDataURL(r,n.quality/100)}catch(y){s=o.toDataURL(r)}}else s=o.toDataURL(r);s=s.substring(s.indexOf("base64,")+7),s=atob(s),m&&m.headers&&m.headers.length&&(s=m.restore(s),m.purge()),o.parentNode.removeChild(o),i({success:!0,data:s})}else i({success:!1})},f.src=s})}function l(){function n(n,r){var i=e?0:-8*(r-1),s=0,o;for(o=0;o<r;o++)s|=t.charCodeAt(n+o)<<Math.abs(i+o*8);return s}function i(e,n,r){var r=arguments.length===3?r:t.length-n-1;t=t.substr(0,n)+e+t.substr(r+n)}function s(t,n,r){var s="",o=e?0:-8*(r-1),u;for(u=0;u<r;u++)s+=String.fromCharCode(n>>Math.abs(o+u*8)&255);i(s,t,r)}var e=!1,t;return{II:function(t){if(t===r)return e;e=t},init:function(n){e=!1,t=n},SEGMENT:function(e,n,r){switch(arguments.length){case 1:return t.substr(e,t.length-e-1);case 2:return t.substr(e,n);case 3:i(r,e,n);break;default:return t}},BYTE:function(e){return n(e,1)},SHORT:function(e){return n(e,2)},LONG:function(e,t){if(t===r)return n(e,4);s(e,t,4)},SLONG:function(e){var t=n(e,4);return t>2147483647?t-4294967296:t},STRING:function(e,t){var r="";for(t+=e;e<t;e++)r+=String.fromCharCode(n(e,1));return r}}}function c(e){var t={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},n=[],i,s,o=r,u=0,a;i=new l,i.init(e);if(i.SHORT(0)!==65496)return;s=2,a=Math.min(1048576,e.length);while(s<=a){o=i.SHORT(s);if(o>=65488&&o<=65495){s+=2;continue}if(o===65498||o===65497)break;u=i.SHORT(s+2)+2,t[o]&&i.STRING(s+4,t[o].signature.length)===t[o].signature&&n.push({hex:o,app:t[o].app.toUpperCase(),name:t[o].name.toUpperCase(),start:s,length:u,segment:i.SEGMENT(s,u)}),s+=u}return i.init(null),{headers:n,restore:function(e){i.init(e);var t=new c(e);if(!t.headers)return!1;for(var r=t.headers.length;r>0;r--){var o=t.headers[r-1];i.SEGMENT(o.start,o.length,"")}t.purge(),s=i.SHORT(2)==65504?4+i.SHORT(4):2;for(var r=0,u=n.length;r<u;r++)i.SEGMENT(s,0,n[r].segment),s+=n[r].length;return i.SEGMENT()},get:function(e){var t=[];for(var r=0,i=n.length;r<i;r++)n[r].app===e.toUpperCase()&&t.push(n[r].segment);return t},set:function(e,t){var r=[];typeof t=="string"?r.push(t):r=t;for(var i=ii=0,s=n.length;i<s;i++){n[i].app===e.toUpperCase()&&(n[i].segment=r[ii],n[i].length=r[ii].length,ii++);if(ii>=r.length)break}},purge:function(){n=[],i.init(null)}}}function h(){function u(t,n){var i=e.SHORT(t),u,a,f,l,c,h,p,d,v=[],m={};for(u=0;u<i;u++){p=h=t+12*u+2,f=n[e.SHORT(p)];if(f===r)continue;l=e.SHORT(p+=2),c=e.LONG(p+=2),p+=4,v=[];switch(l){case 1:case 7:c>4&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.BYTE(p+a);break;case 2:c>4&&(p=e.LONG(p)+s.tiffHeader),m[f]=e.STRING(p,c-1);continue;case 3:c>2&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.SHORT(p+a*2);break;case 4:c>1&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.LONG(p+a*4);break;case 5:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.LONG(p+a*4)/e.LONG(p+a*4+4);break;case 9:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4);break;case 10:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4)/e.SLONG(p+a*4+4);break;default:continue}d=c==1?v[0]:v,o.hasOwnProperty(f)&&typeof d!="object"?m[f]=o[f][d]:m[f]=d}return m}function a(){var n=r,i=s.tiffHeader;return e.II(e.SHORT(i)==18761),e.SHORT(i+=2)!==42?!1:(s.IFD0=s.tiffHeader+e.LONG(i+=2),n=u(s.IFD0,t.tiff),s.exifIFD="ExifIFDPointer"in n?s.tiffHeader+n.ExifIFDPointer:r,s.gpsIFD="GPSInfoIFDPointer"in n?s.tiffHeader+n.GPSInfoIFDPointer:r,!0)}function f(n,r,o){var u,a,f,l=0;if(typeof r=="string"){var c=t[n.toLowerCase()];for(hex in c)if(c[hex]===r){r=hex;break}}u=s[n.toLowerCase()+"IFD"],a=e.SHORT(u);for(i=0;i<a;i++){f=u+12*i+2;if(e.SHORT(f)==r){l=f+8;break}}return l?(e.LONG(l,o),!0):!1}var e,t,s={},o;return e=new l,t={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},o={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return s={tiffHeader:10},t===r||!t.length?!1:(e.init(t),e.SHORT(0)===65505&&e.STRING(4,5).toUpperCase()==="EXIF\0"?a():!1)},EXIF:function(){var e;e=u(s.exifIFD,t.exif);if(e.ExifVersion&&n.typeOf(e.ExifVersion)==="array"){for(var r=0,i="";r<e.ExifVersion.length;r++)i+=String.fromCharCode(e.ExifVersion[r]);e.ExifVersion=i}return e},GPS:function(){var e;return e=u(s.gpsIFD,t.gps),e.GPSVersionID&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){return e!=="PixelXDimension"&&e!=="PixelYDimension"?!1:f("exif",e,t)},getBinary:function(){return e.SEGMENT()}}}var s={},o;n.runtimes.Html5=n.addRuntime("html5",{getFeatures:function(){var r,i,s,u,a,f;return i=s=a=f=!1,e.XMLHttpRequest&&(r=new XMLHttpRequest,s=!!r.upload,i=!!r.sendAsBinary||!!r.upload),i&&(u=!!(r.sendAsBinary||e.Uint8Array&&e.ArrayBuffer),a=!(!File||!File.prototype.getAsDataURL&&!e.FileReader||!u),f=!!File&&!!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),o=n.ua.safari&&n.ua.windows,{html5:i,dragdrop:function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),jpgresize:a,pngresize:a,multipart:a||!!e.FileReader||!!e.FormData,canSendBinary:u,cantSendBlobInFormData:!!(n.ua.gecko&&e.FormData&&e.FileReader&&!FileReader.prototype.readAsArrayBuffer),progress:s,chunks:f,multi_selection:!n.ua.safari||!n.ua.windows,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,i){function c(e){var t,i,o=[],u,a={};for(i=0;i<e.length;i++){t=e[i];if(a[t.name])continue;a[t.name]=!0,u=n.guid(),s[u]=t,o.push(new n.File(u,t.fileName||t.name,t.fileSize||t.size))}o.length&&r.trigger("FilesAdded",o)}var u,l;u=this.getFeatures();if(!u.html5){i({success:!1});return}r.bind("Init",function(e){var i,s,o=[],u,a,f=e.settings.filters,l,h,d=t.body,v;i=t.createElement("div"),i.id=e.id+"_html5_container",n.extend(i.style,{position:"absolute",background:r.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:r.settings.shim_bgcolor?"":0}),i.className="plupload html5",r.settings.container&&(d=t.getElementById(r.settings.container),n.getStyle(d,"position")==="static"&&(d.style.position="relative")),d.appendChild(i);e:for(u=0;u<f.length;u++){l=f[u].extensions.split(/,/);for(a=0;a<l.length;a++){if(l[a]==="*"){o=[];break e}h=n.mimeTypes[l[a]],h&&n.inArray(h,o)===-1&&o.push(h)}}i.innerHTML='<input id="'+r.id+'_html5"  style="font-size:999px" type="file" accept="'+o.join(",")+'" '+(r.settings.multi_selection&&r.features.multi_selection?'multiple="multiple"':"")+" />",i.scrollTop=100,v=t.getElementById(r.id+"_html5"),e.features.triggerDialog?n.extend(v.style,{position:"absolute",width:"100%",height:"100%"}):n.extend(v.style,{cssFloat:"right",styleFloat:"right"}),v.onchange=function(){var e=window.URL||window.webkitURL;window.fileURL=e.createObjectURL(this.files[0]),c(this.files),this.value=""},s=t.getElementById(e.settings.browse_button);if(s){var m=e.settings.browse_button_hover,g=e.settings.browse_button_active,y=e.features.triggerDialog?s:i;m&&(n.addEvent(y,"mouseover",function(){n.addClass(s,m)},e.id),n.addEvent(y,"mouseout",function(){n.removeClass(s,m)},e.id)),g&&(n.addEvent(y,"mousedown",function(){n.addClass(s,g)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(s,g)},e.id)),e.features.triggerDialog&&n.addEvent(s,"click",function(n){var r=t.getElementById(e.id+"_html5");r&&!r.disabled&&r.click(),n.preventDefault()},e.id)}}),r.bind("PostInit",function(){var e=t.getElementById(r.settings.drop_element);if(e){if(o){n.addEvent(e,"dragenter",function(i){var s,o,u;s=t.getElementById(r.id+"_drop"),s||(s=t.createElement("input"),s.setAttribute("type","file"),s.setAttribute("id",r.id+"_drop"),s.setAttribute("multiple","multiple"),n.addEvent(s,"change",function(){c(this.files),n.removeEvent(s,"change",r.id),s.parentNode.removeChild(s)},r.id),e.appendChild(s)),o=n.getPos(e,t.getElementById(r.settings.container)),u=n.getSize(e),n.getStyle(e,"position")==="static"&&n.extend(e.style,{position:"relative"}),n.extend(s.style,{position:"absolute",display:"block",top:0,left:0,width:u.w+"px",height:u.h+"px",opacity:0})},r.id);return}n.addEvent(e,"dragover",function(e){e.preventDefault()},r.id),n.addEvent(e,"drop",function(e){var t=e.dataTransfer;t&&t.files&&c(t.files),e.preventDefault()},r.id)}}),r.bind("Refresh",function(e){var i,s,o,u,a;i=t.getElementById(r.settings.browse_button),i&&(s=n.getPos(i,t.getElementById(e.settings.container)),o=n.getSize(i),u=t.getElementById(r.id+"_html5_container"),n.extend(u.style,{top:s.y+"px",left:s.x+"px",width:o.w+"px",height:o.h+"px"}),r.features.triggerDialog&&(n.getStyle(i,"position")==="static"&&n.extend(i.style,{position:"relative"}),a=parseInt(n.getStyle(i,"z-index"),10),isNaN(a)&&(a=0),n.extend(i.style,{zIndex:a}),n.extend(u.style,{zIndex:a-1})))}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById(e.id+"_html5");r&&(r.disabled=n)}),r.bind("CancelUpload",function(){l&&l.abort&&l.abort()}),r.bind("UploadFile",function(t,r){function h(e,t,n){var r;if(!File.prototype.slice)return(r=File.prototype.webkitSlice||File.prototype.mozSlice)?r.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(i){return e.slice(t,n-t)}}function p(s){function c(){function S(i){var s=0,f="----pluploadboundary"+n.guid(),h,d="--",v="\r\n",S="";l=new XMLHttpRequest,l.upload&&(l.upload.onprogress=function(e){r.loaded=Math.min(r.size,a+e.loaded-s),t.trigger("UploadProgress",r)}),l.onreadystatechange=function(){var e,s;if(l.readyState==4&&t.state!==n.STOPPED){try{e=l.status}catch(u){e=0}if(e>=400)t.trigger("Error",{code:n.HTTP_ERROR,message:n.translate("HTTP Error."),file:r,status:e});else{if(m){s={chunk:o,chunks:m,response:l.responseText,status:e},t.trigger("ChunkUploaded",r,s),a+=b;if(s.cancelled){r.status=n.FAILED;return}r.loaded=Math.min(r.size,(o+1)*y)}else r.loaded=r.size;t.trigger("UploadProgress",r),i=p=h=S=null,!m||++o>=m?(r.status=n.DONE,t.trigger("FileUploaded",r,{response:l.responseText,status:e})):c()}}};if(t.settings.multipart&&u.multipart){g.name=r.target_name||r.name,l.open("post",E,!0),n.each(t.settings.headers,function(e,t){l.setRequestHeader(t,e)});if(typeof i!="string"&&!!e.FormData){h=new FormData,n.each(n.extend(g,t.settings.multipart_params),function(e,t){h.append(t,e)}),h.append(t.settings.file_data_name,i),l.send(h);return}if(typeof i=="string"){l.setRequestHeader("Content-Type","multipart/form-data; boundary="+f),n.each(n.extend(g,t.settings.multipart_params),function(e,t){S+=d+f+v+'Content-Disposition: form-data; name="'+t+'"'+v+v,S+=unescape(encodeURIComponent(e))+v}),w=n.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",S+=d+f+v+'Content-Disposition: form-data; name="'+t.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(r.name))+'"'+v+"Content-Type: "+w+v+v+i+v+d+f+d+v,s=S.length-i.length,i=S;if(l.sendAsBinary)l.sendAsBinary(i);else if(u.canSendBinary){var x=new Uint8Array(i.length);for(var T=0;T<i.length;T++)x[T]=i.charCodeAt(T)&255;l.send(x.buffer)}return}}E=n.buildUrl(t.settings.url,n.extend(g,t.settings.multipart_params)),l.open("post",E,!0),l.setRequestHeader("Content-Type","application/octet-stream"),n.each(t.settings.headers,function(e,t){l.setRequestHeader(t,e)}),l.send(i)}var p,d,m,g,y,b,w,E=t.settings.url;if(r.status==n.DONE||r.status==n.FAILED||t.state==n.STOPPED)return;g={name:r.target_name||r.name},i.chunk_size&&r.size>i.chunk_size&&(u.chunks||typeof s=="string")?(y=i.chunk_size,m=Math.ceil(r.size/y),b=Math.min(y,r.size-o*y),typeof s=="string"?p=s.substring(o*y,o*y+b):p=h(s,o*y,o*y+b),g.chunk=o,g.chunks=m):(b=r.size,p=s),t.settings.multipart&&u.multipart&&typeof p!="string"&&f&&u.cantSendBlobInFormData&&u.chunks&&t.settings.chunk_size?(f.onload=function(){S(f.result)},f.readAsBinaryString(p)):S(p)}var o=0,a=0,f="FileReader"in e?new FileReader:null;c()}var i=t.settings,o,c;o=s[r.id],u.jpgresize&&t.settings.resize&&/\.(png|jpg|jpeg)$/i.test(r.name)?f.call(t,r,t.settings.resize,/\.png$/i.test(r.name)?"image/png":"image/jpeg",function(e){e.success?(r.size=e.data.length,p(e.data)):u.chunks?p(o):a(o,p)}):!u.chunks&&u.jpgresize?a(o,p):p(o)}),r.bind("Destroy",function(e){var r,i,s=t.body,o={inputContainer:e.id+"_html5_container",inputFile:e.id+"_html5",browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(r in o)i=t.getElementById(o[r]),i&&n.removeAllEvents(i,e.id);n.removeAllEvents(t.body,e.id),e.settings.container&&(s=t.getElementById(e.settings.container)),s.removeChild(t.getElementById(o.inputContainer))}),i({success:!0})}})}(window,document,plupload),function(e,t,n,r){function i(e){return t.getElementById(e)}n.runtimes.Html4=n.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:n.ua.gecko&&e.FormData||n.ua.webkit}},init:function(r,s){r.bind("Init",function(s){function T(){var e,u,l,c;p=n.guid(),v.push(p),e=t.createElement("form"),e.setAttribute("id","form_"+p),e.setAttribute("method","post"),e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.setAttribute("target",s.id+"_iframe"),e.style.position="absolute",u=t.createElement("input"),u.setAttribute("id","input_"+p),u.setAttribute("type","file"),u.setAttribute("accept",g),u.setAttribute("size",1),c=i(s.settings.browse_button),s.features.triggerDialog&&c&&n.addEvent(i(s.settings.browse_button),"click",function(e){u.disabled||u.click(),e.preventDefault()},s.id),n.extend(u.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"}),n.extend(e.style,{overflow:"hidden"}),l=s.settings.shim_bgcolor,l&&(e.style.background=l),m&&n.extend(u.style,{filter:"alpha(opacity=0)"}),n.addEvent(u,"change",function(t){var o=t.target,a,l=[],h;o.value&&(i("form_"+p).style.top="-1048575px",a=o.value.replace(/\\/g,"/"),a=a.substring(a.length,a.lastIndexOf("/")+1),l.push(new n.File(p,a)),s.features.triggerDialog?n.removeEvent(c,"click",s.id):n.removeAllEvents(e,s.id),n.removeEvent(u,"change",s.id),T(),l.length&&r.trigger("FilesAdded",l))},s.id),e.appendChild(u),o.appendChild(e),s.refresh()}function N(){var r=t.createElement("div");r.innerHTML='<iframe id="'+s.id+'_iframe" name="'+s.id+'_iframe" src="'+l+':&quot;&quot;" style="display:none"></iframe>',u=r.firstChild,o.appendChild(u),n.addEvent(u,"load",function(t){var r=t.target,i,o;if(!c)return;try{i=r.contentWindow.document||r.contentDocument||e.frames[r.id].document}catch(u){s.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),file:c});return}o=i.body.innerHTML,o&&(c.status=n.DONE,c.loaded=1025,c.percent=100,s.trigger("UploadProgress",c),s.trigger("FileUploaded",c,{response:o}))},s.id)}var o=t.body,u,l="javascript",c,h,p,v=[],m=/MSIE/.test(navigator.userAgent),g=[],y=s.settings.filters,w,E,S,x;e:for(w=0;w<y.length;w++){E=y[w].extensions.split(/,/);for(x=0;x<E.length;x++){if(E[x]==="*"){g=[];break e}S=n.mimeTypes[E[x]],S&&n.inArray(S,g)===-1&&g.push(S)}}g=g.join(","),s.settings.container&&(o=i(s.settings.container),n.getStyle(o,"position")==="static"&&(o.style.position="relative")),s.bind("UploadFile",function(e,r){var s,o;if(r.status==n.DONE||r.status==n.FAILED||e.state==n.STOPPED)return;s=i("form_"+r.id),o=i("input_"+r.id),o.setAttribute("name",e.settings.file_data_name),s.setAttribute("action",e.settings.url),n.each(n.extend({name:r.target_name||r.name},e.settings.multipart_params),function(e,r){var i=t.createElement("input");n.extend(i,{type:"hidden",name:r,value:e}),s.insertBefore(i,s.firstChild)}),c=r,i("form_"+p).style.top="-1048575px",s.submit()}),s.bind("FileUploaded",function(e){e.refresh()}),s.bind("StateChanged",function(t){t.state==n.STARTED?N():t.state==n.STOPPED&&e.setTimeout(function(){n.removeEvent(u,"load",t.id),u.parentNode&&u.parentNode.removeChild(u)},0),n.each(t.files,function(e,t){if(e.status===n.DONE||e.status===n.FAILED){var r=i("form_"+e.id);r&&r.parentNode.removeChild(r)}})}),s.bind("Refresh",function(e){var r,s,o,u,f,l,c,h,d;r=i(e.settings.browse_button),r&&(f=n.getPos(r,i(e.settings.container)),l=n.getSize(r),c=i("form_"+p),h=i("input_"+p),n.extend(c.style,{top:f.y+"px",left:f.x+"px",width:l.w+"px",height:l.h+"px"}),e.features.triggerDialog&&(n.getStyle(r,"position")==="static"&&n.extend(r.style,{position:"relative"}),d=parseInt(r.style.zIndex,10),isNaN(d)&&(d=0),n.extend(r.style,{zIndex:d}),n.extend(c.style,{zIndex:d-1})),o=e.settings.browse_button_hover,u=e.settings.browse_button_active,s=e.features.triggerDialog?r:c,o&&(n.addEvent(s,"mouseover",function(){n.addClass(r,o)},e.id),n.addEvent(s,"mouseout",function(){n.removeClass(r,o)},e.id)),u&&(n.addEvent(s,"mousedown",function(){n.addClass(r,u)},e.id),n.addEvent(t.body,"mouseup",function(){n.removeClass(r,u)},e.id)))}),r.bind("FilesRemoved",function(e,t){var n,r;for(n=0;n<t.length;n++)r=i("form_"+t[n].id),r&&r.parentNode.removeChild(r)}),r.bind("DisableBrowse",function(e,n){var r=t.getElementById("input_"+p);r&&(r.disabled=n)}),r.bind("Destroy",function(e){var r,s,u,f={inputContainer:"form_"+p,inputFile:"input_"+p,browseButton:e.settings.browse_button};for(r in f)s=i(f[r]),s&&n.removeAllEvents(s,e.id);n.removeAllEvents(t.body,e.id),n.each(v,function(e,t){u=i("form_"+e),u&&o.removeChild(u)})}),T()}),s({success:!0})}})}(window,document,plupload),define("plupload",["jquery"],function(){}),define("videopreview/views/uploader",["vendor","views","facade","videopreview/models/videoup","text!videopreview/templates/upload.html","plupload"],function(e,t,n,r){var i=require("text!videopreview/templates/upload.html"),s,o=e.$,u=n._,a=t.SectionView,f=e.Mustache;return s=a.extend({name:"Video Preview Form View",id:"videoPreviewForm",template:i,data:i,events:{"change input:file":"play","click #uploadfiles":"uploadFiles"},initialize:function(e){a.prototype.initialize.call(this,e),u.bindAll(this,"beforeRender","render","afterRender");var t=this;this.render=u.wrap(this.render,function(e){return t.beforeRender(),e(),t}),o("#imgUploadModal").modal("show")},beforeRender:function(){console.log("beforeRender")},afterRender:function(){},uploadFiles:function(e){this.uploader=this.model.uploader,console.log(this.uploader,"up");if(o("input#title").val()==""){alert("Please enter a title for this video.");return}this.uploader.settings.multipart_params.name=o("input#title").val(),this.uploader.settings.multipart_params.mm=o("input#mm").is(":checked"),this.uploader.settings.multipart_params.sports_id=o("select#sports_id").val(),o("#uploadfiles").addClass("isUploading"),this.uploader.start(),e.preventDefault()},plupInit:function(){},play:function(e){var t=window.fileURL;Channel("select-video-preview-change").publish(t)},videoUploadClick:function(e){console.log("called",this.file),e.preventDefault(),o("#errormsg").hide(),o("#imageup").attr("disabled","disabled"),Channel("mediaup-add-video").publish(this.file)}}),s}),define("text!videopreview/templates/preview.html",[],function(){return'<video  width="320" height="240" controls autoplay></video>'}),define("videopreview/views/preview",["vendor","views","utils","text!videopreview/templates/preview.html"],function(e,t,n){var r=require("text!videopreview/templates/preview.html"),i,s=e.$,o=t.SectionView;return i=o.extend({name:"Video Preview View",id:"videoPreviewWindow",template:r,data:r,initialize:function(e){o.prototype.initialize.call(this,e),Channel("select-video-preview-change").subscribe(this.changeVideo)},changeVideo:function(e){document.querySelector(this.$el.selector+" video").src=e},displayMessage:function(e,t){var n=this.$el.find(".message");n.html(e),n.className=t?"error":"info"}}),i}),define("videopreview",["require","text!videopreview/templates/basic.html","facade","controller","models","views","utils","videopreview/models/base","videopreview/models/videoup","videopreview/views/uploader","videopreview/views/preview"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=s.LayoutView,p=n.$,d=n._,v=o.debug,m=o.lib.Channel,g=["/pages/imageup/imageup.css"];return c=r.extend({initialize:function(e){return m("load:css").publish(g),d.bindAll(this),this.handleOptions(e),this.init(e),this},init:function(e){this.url=e.url,this.attr=e.attr,v.log("VideoPreview Init"),this.setupLayout(),this.showVideoPreview()},setupLayout:function(){return this.scheme=[],p("div#modalPopup").remove(),p("body").append('<div id="modalPopup"></div>'),pageLayout=new h({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,console.log(this.layout),this.layout},showVideoPreview:function(e){var t=new a,n=this,r=new l({name:"Video Preview View",model:t,destination:".modal-body #preview"},this.attr);this.scheme.push(r);var i=new f({name:"Video Upload View",model:t,destination:"#main-content-img"},this.attr);this.scheme.push(i),this.layout.render(),this.afterRender(t)},afterRender:function(e){e.uploader=e.doUpload(this.url),e.uploader.bind("Init",function(e,t){p("#filelist").html("<div></div>")});try{e.uploader.init()}catch(t){alert(t)}e.uploader.bind("FilesAdded",function(t,n){maxCountError=!1,p.each(n,function(n,r){e.uploader.settings.max_file_count&&n>=e.uploader.settings.max_file_count?(maxCountError=!0,setTimeout(function(){t.removeFile(r)},50)):p("#filelist").append('<div id="'+r.id+'">'+r.name+" ("+plupload.formatSize(r.size)+") <b></b>"+"</div>"),maxCountError&&p("#resultdiv").html("You can only select one video at a time.").show()}),t.refresh()}),e.uploader.bind("UploadProgress",function(e,t){p("#"+t.id+" b").html(t.percent+"%")}),e.uploader.bind("Error",function(e,t){p("#filelist").append("<div>Error: "+t.code+", Message: "+t.message+(t.file?", File: "+t.file.name:"")+"</div>"),e.refresh()})},uploadVideo:function(e){alert("inside uploadvideo"),console.log("Called",e);var t=new a({file:e})}}),c}),define("text!game/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header" class="profile-header"></div>\r\n\r\n	<div class="media-add-icons-h"></div>\r\n	<div class="row-fluid" id="main-content">\r\n		<!-- <div id="video-wrap" class="clearfix"></div> -->\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<!--div id="add-media" class="clearfix">add media</div-->\r\n	</div>\r\n\r\n	<div class="green-left-heading">MESSAGE BOARD</div>\r\n	<div id="commenton-wrap" class="clearfix clear commentson-outer-box-h"></div>\r\n	<div id="comment_div" class="clearfix"></div>\r\n	\r\n	<div id="roster-wrap" class="clearfix clear"></div>\r\n	\r\n	<div class="participants-add-icons-h participants-heading-h hide"></div>\r\n	<div id="participants_div" class="clearfix clear"></div>\r\n	\r\n	<div class="row-fluid">\r\n		<div class="span4" id="main-sidebar">\r\n			<div id="org-wrap" class="clearfix hide"></div>\r\n			<div id="related-wrap" class="clearfix"></div>\r\n			<div  class="clearfix"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	\r\n	\r\n	\r\n<!--div class="row-fluid">\r\n    <div class="span4" id="main-sidebar">\r\n    \r\n        <div id="add-media" class="clearfix">\r\n        </div>\r\n        \r\n        <div>MESSAGE BOARD</div>\r\n    	<div class="commentson-outer-box-h clear"></div>\r\n    	<div id="comment_div" class="clearfix"></div>\r\n        \r\n        <div id="roster-wrap" class="clearfix">\r\n        </div>\r\n    \r\n    </div>\r\n    <div class="span8" id="main-content">\r\n        \r\n        <div id="video-wrap" class="clearfix">\r\n        </div>\r\n        \r\n       \r\n        \r\n        <div id="comment-wrap" class="clearfix">\r\n        </div>\r\n        \r\n    </div>\r\n</div-->\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n</div>\r\n'}),define("votes/views/vote",["require","text!votes/templates/vote.html","views","vendor","facade","utils","jqueryui","controller","votes/models/vote","votes/models/follow"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("votes/models/vote"),d=e("votes/models/follow");return n=o.extend({template:t,events:{"click .team-action-h":"vote","click .follow-action-h":"follow"},vote:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.voteModelOb.save(),u.when(this.voteModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled").html("voted")})},follow:function(e){console.log(e);if(!this.checkForUser()){routing.trigger("showSignup");return}this.followModelOb.save(),u.when(this.followModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled").html("following")}),h("new-fan").publish()},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){var t=this;a.bindAll(this),o.prototype.initialize.call(this,e)},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=this.model.get("payload");r.has_voted?this.$el.find(".team-action-h").addClass("link-disabled"):(this.voteModelOb=new p,this.voteModelOb.subject_id=r.id,this.voteModelOb.entity_id=r.enttypes_id,this.voteModelOb.setData()),r.is_following?this.$el.find(".follow-action-h").addClass("link-disabled"):(this.followModelOb=new d,this.followModelOb.subject_id=r.id,this.followModelOb.entity_id=r.enttypes_id)}}),n}),define("game/models/basics",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/game/basics/"+this.id:"/api/game/basics/"+this.id}}),n}),define("game/models/addmedia",["models/base"],function(e){var t;return t=e.extend({defaults:{links:[{label:"Got Pics From this Game?",link:"javascript:void(0);",id:"addPhoto"},{label:"Got Videos From this Game?",link:"javascript:void(0);",id:"addVideo"}]}}),t}),define("sportorg/models/teamroster",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{team_id:0,team_name:null,rosters:[{name:null,user_picture:null,grad_year:0,sport_name:null,position:null}]},desc:"Team Roster information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/teamrosters",["facade","collections","sportorg/models/teamroster","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(!u.isUndefined(r)&&r!=null&&r){for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}e.deferred.resolve(t)}}),s}),define("game/collections/teamrosters",["facade","sportorg/collections/teamrosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/roster/"+this.id:"/api/team/roster/"+this.id}}),r}),define("game/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/videos/"+this.id:"/api/game/videos/"+this.id}}),r}),define("game/collections/images",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({limit:8,offset:0,url:function(){return testpath?testpath+"/game/media/"+this.id:"/api/game/media/"+this.id+"?limit="+this.limit+"&offset="+this.offset}}),r}),define("game/collections/participants",["facade","collections","utils"],function(e,t,n){var r=e._,i=t.BaseCollection,s=n.lib.Channel,o=e.Backbone;return i.extend({url:function(){return testpath?testpath+"/game/users/"+this.id:"/api/game/users/"+this.id},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var r in n){var i=new o.Model;i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),console.log(i),e.push(i)}e.deferred.resolve(t)}})}),define("game/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/comments/"+this.id:"/api/game/comments/"+this.id}}),r}),define("game/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/game/comments/"+this.id:"/api/game/comments/"+this.id}}),r}),define("text!game/templates/header.html",[],function(){return'{{#payload}}\r\n<div class="row-fluid">\r\n\r\n	<div class="game-heading">\r\n		<!--div class="sports-h"></div-->\r\n		<a href="javascript: void(0);" class="game-edit-btn-h pull-right">Edit Event</a>\r\n		<div class="game-general">\r\n			<!--<div class="stretch"></div>-->\r\n			{{#shared}}\r\n				{{#shared.sport}}<span class="sport-h" data-id="{{sports_id}}">{{shared.sport}}</span>{{/shared.sport}}\r\n				{{#shared.complevel}}<span>{{shared.complevel}}</span>{{/shared.complevel}}\r\n				{{#shared.season}}<span>{{shared.season}}</span>{{/shared.season}}\r\n			{{/shared}}\r\n			{{^shared}}\r\n				{{#event_name}}<span class="sport-h" data-id="{{sports_id}}">{{event_name}}</span>{{/event_name}}\r\n			{{/shared}}\r\n		</div>\r\n		<p>\r\n			{{game_day}} {{game_time}} - {{game_location}}\r\n		</p>\r\n		{{^shared}}<!--a href="javascript: void(0);" class="add-to-event common-btn common-default-sky-dark pull-right" title="Add me to this Event">Add me to this Event</a-->{{/shared}}\r\n\r\n	</div>\r\n\r\n	<ul class="span3 image-outer-h">\r\n			</ul>\r\n\r\n	<!--{{#game_picture}}\r\n	<a href="javascript: void(0);" class="header-image-container image-outer-h">\r\n	<div class="image-item-container">\r\n		<img src="{{game_picture.types.standard_thumb.url}}" alt="{{game_name}}" />\r\n		<div class="action-section">\r\n			{{#game_picture.is_owner}}\r\n			<div class="action-block left-block edit object-edit-h" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>E</span>\r\n			</div>\r\n			<div class="action-block right-block delete object-delete-h" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>D</span>\r\n			</div>\r\n			{{/game_picture.is_owner}}\r\n			{{^game_picture.is_owner}}\r\n			<div class="action-block left-block vote" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>V</span>\r\n			</div>\r\n			<div class="action-block right-block follow" subject-type-id="{{enttypes_id}}" subject-id="{{id}}">\r\n				<span>F</span>\r\n			</div>\r\n			{{/game_picture.is_owner}}\r\n		</div>\r\n	</div> </a>\r\n	{{/game_picture}}-->\r\n\r\n	<ul class="teams-list">\r\n		{{#teams}}\r\n		<li class="team-item">\r\n			<div class=\'score-box score-box-h {{#isWinner}}win{{/isWinner}}\'>\r\n				<a href="javascript: void(0);" title="edit score" class="edit-score-h"> <span class="game-score-el" style="width:100%; height: 100%">{{points_scored}}</span> </a>\r\n				<input type="hidden" value="{{points_scored}}" data-id="{{games_teams_link_id}}" class="edit-score-input-h input-mini game-score-el" />\r\n			</div>\r\n			<div class="org-info">\r\n				<span class="org-name"><a href="/#!team/{{id}}">{{org_sport_link_obj.org.org_name}}, {{complevels_obj.complevel_name}}, {{seasons_obj.season_name}} {{year}}</a></span>\r\n				<span class="org-location"> {{team_location}} </span>\r\n			</div>\r\n		</li>\r\n		{{/teams}}\r\n	</ul>\r\n	<div id="votes-area-h"></div>\r\n</div>\r\n\r\n<div id="modalPopupGameEdit" class="modal photo-frame-model hide fade">\r\n	<div class="modal-header"><span>Update Event Info</span>\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">\r\n			&times;\r\n		</button>\r\n	</div>\r\n	<form action="#" class="update-date-time-h" name="update-date-time">\r\n	<div class="modal-body page-content-h">\r\n\r\n			<div class="row-fluid">\r\n				<label>Event Name</label>\r\n				<input type="text" id="event_name" value="{{event_name}}" />\r\n			</div>\r\n			<div class="row-fluid">\r\n			<label>Date &amp; Time</label>\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" value="{{gameDay}}" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" value="{{game_hour}}" placeholder="Time" maxlength="5" />\r\n			<span class="spn-ddl-time-period_h"></span>\r\n			</div>\r\n			<div class="row-fluid"><label>Location</label></div>\r\n			\r\n			<textarea placeholder="Address" class="location-h address-h" rows="3" cols="25">{{game_location}}</textarea>\r\n			<a href="javascript: void(0);" title="Verify Address" class="verify-address-h">Verify Address</a>\r\n			<span class="address-error hide address-error-status-h"></span>\r\n			<div class="view-map-h"></div>\r\n\r\n\r\n	</div>\r\n	<div class="modal-footer"><input type="submit" class="common-btn common-btn-validation" name="submit_edit-form" value="Update" />	</div>\r\n	</form>\r\n</div>\r\n{{/payload}}\r\n'}),define("game/models/score",["models/base"],function(e){return e.extend({url:function(){return testpath?testpath+"/game/score/":"/api/game/score/"+this.gameId+"/?games_teams_link_id="+this.teams_id+"&score="+this.score}})}),define("text!usercontrols/location/templates/layout.html",[],function(){return'<div>\r\n	Location: <textarea placeholder="Address" class="location-h address-h" rows="3" cols="25"></textarea>\r\n	<span class="address-error hide address-error-status-h"></span>\r\n	<a href="javascript: void(0);" class="common-btn common-btn-validation verify-address-h">Verify Address</a>\r\n	<a href="javascript: void(0);" class="common-btn common-btn-direction link-disabled set-address-h">Set Address</a>\r\n	 <div id="map-canvas" style="width: 90%; height: 300px; margin-top: 40px;"></div>\r\n</div>'}),define("usercontrols/location/models/verify-adress",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/location/add?address="+this.address:"/api/location/add?address="+this.address}})}),define("usercontrols/location/models/save",["facade","models/base"],function(e,t){var n=e._;return t.extend({url:function(){return testpath?testpath+"/game/basics/"+this.id:"/api/game/basics/"+this.id}})}),define("usercontrols/location/views/location",["require","text!usercontrols/location/templates/layout.html","facade","views","utils","vendor","usercontrols/location/models/verify-adress","usercontrols/location/models/save"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=e("usercontrols/location/models/verify-adress"),l=e("usercontrols/location/models/save"),c=a.Mustache,h=r.$,p=i.BaseView,d=r.Backbone,v;return d.View.extend({template:t,events:{"click .verify-address-h":"verifyAddress","click .set-address-h":"setLocation"},initialize:function(e){v=this,v.game_id=e.game_id||undefined,v.location=e,v.selectedOptions=[],v.setOptions(e),v.render()},setLocation:function(e){var t=confirm("Are you sure want to set new address?");if(t&&this.locationId){var n=new l;n.id=this.game_id,n.set({locations_id:this.locationId,id:this.game_id}),n.save(),h.when(n.request).done(function(){routing.trigger("popup-close")})}},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new f,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),h.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id;if(e.locationId){e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.latitude=e.adressModel.get("payload").lat,e.location.latitude=e.adressModel.get("payload").lon,e.$el.find(".set-address-h").removeClass("link-disabled");var t=new google.maps.LatLng(e.adressModel.get("payload").lat,e.adressModel.get("payload").lon);e.marker.setPosition(t),e.map.panTo(t)}})},intializeMap:function(){console.log(v.location);var e=new google.maps.LatLng(v.location.latitude,v.location.longitude),t={zoom:13,center:e,scaleControl:!0,zoomControl:!0,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.$el.find("#map-canvas")[0],t),this.marker=new google.maps.Marker({position:e,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=c.to_html(e.template,{location:e.locaion});return h(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("component/forms",["require","facade","views","utils","vendor"],function(e){return function(t,n){var r={},s,o=e("facade"),u=e("views"),a=o.Backbone.Model.extend({schema:t}),f=new a,l=(new o.Backbone.Form({model:f,formValues:r})).render();n.append(l.el);if(t){var c=l.getValue();r.fields={};for(var h in c)r.fields[h]={currentValue:function(){return l.fields[h].editor.getValue()},form_field:l.fields[h].editor,deps:l.fields[h].editor.valueBindings?l.fields[h].editor.valueBindings:[],post_to_server:typeof l.fields[h].editor.post_to_server!="undefined"?l.fields[h].editor.post_to_server:!0};r.getFormValues=function(){var e={};if(r.fields)for(var t in r.fields)if(r.fields[t].post_to_server){var n=[];if(r.fields[t].deps&&r.fields[t].deps.length)for(var i in r.fields[t].deps)n.push(l.fields[r.fields[t].deps[i]].editor.getValue()||"");else n.push(l.fields[t].editor.getValue());var s=l.fields[t].editor.serverKey||t;e[s]=n.join(" ")}return e},r.updateUiAfterUpdatingObject=function(e,t){l.fields&&e&&l.fields[e]&&l.fields[e].editor.setValue(t)},r.getFieldValue=function(e){if(l.fields&&e&&l.fields[e]){var t=[];if(r.fields[e].deps&&r.fields[e].deps.length)for(var n in r.fields[e].deps)t.push(l.fields[r.fields[e].deps[n]].editor.getValue()||"");else t.push(l.fields[i].editor.getValue());return t.join(" ")}return undefined},r.updateFormValues=function(e){if(e&&e.objectValuesToUpdate)for(var t in e.objectValuesToUpdate){var n=l.fields[e.objectValuesToUpdate[t]].editor;n.setValue("","")}},r.showServersErrors=function(e){if(l.fields)for(var t in l.fields)if(l.fields[t].editor.serverDbField)for(var n in e)if(e[n].field==l.fields[t].editor.serverDbField){if(l.fields[t].editor.valueBindings&&l.fields[t].editor.valueBindings.length){var r=l.fields[l.fields[t].editor.valueBindings[0]].editor.id;$("#"+r).parents(".field-row").find("*[data-error='']").html(e[n].error).show()}else{var r=l.fields[t].editor.id;$("#"+r).parents(".field-row").find("*[data-error='']").html(e[n].error).show()}break}}}return{form:l,formValues:r}}}),define("vendor/plugins/dateformat",[],function(){var e=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,r=/[^-+\dA-Z]/g,i=function(e,t){e=String(e),t=t||2;while(e.length<t)e="0"+e;return e};return function(s,o,u){var a=e;arguments.length==1&&Object.prototype.toString.call(s)=="[object String]"&&!/\d/.test(s)&&(o=s,s=undefined),s=s?new Date(s):new Date,isNaN(s)&&console.error(this),o=String(a.masks[o]||o||a.masks["default"]),o.slice(0,4)=="UTC:"&&(o=o.slice(4),u=!0);var f=u?"getUTC":"get",l=s[f+"Date"](),c=s[f+"Day"](),h=s[f+"Month"](),p=s[f+"FullYear"](),d=s[f+"Hours"](),v=s[f+"Minutes"](),m=s[f+"Seconds"](),g=s[f+"Milliseconds"](),y=u?0:s.getTimezoneOffset(),b={d:l,dd:i(l),ddd:a.i18n.dayNames[c],dddd:a.i18n.dayNames[c+7],m:h+1,mm:i(h+1),mmm:a.i18n.monthNames[h],mmmm:a.i18n.monthNames[h+12],yy:String(p).slice(2),yyyy:p,h:d%12||12,hh:i(d%12||12),H:d,HH:i(d),M:v,MM:i(v),s:m,ss:i(m),l:i(g,3),L:i(g>99?Math.round(g/10):g),t:d<12?"a":"p",tt:d<12?"am":"pm",T:d<12?"A":"P",TT:d<12?"AM":"PM",Z:u?"UTC":(String(s).match(n)||[""]).pop().replace(r,""),o:(y>0?"-":"+")+i(Math.floor(Math.abs(y)/60)*100+Math.abs(y)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return o.replace(t,function(e){return e in b?b[e]:e.slice(1,e.length-1)})}}();return e.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},e.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},e}),define("game/views/header",["require","text!game/templates/header.html","facade","views","game/models/score","game/models/basics","votes/models/vote","votes/models/follow","usercontrols/location/views/location","usercontrols/location/models/verify-adress","usercontrols/location/models/save","chrome/views/header","usercontrol/dropdown/view/dropdown","media/views/image-item","component/forms","vendor/plugins/dateformat"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("game/models/score"),o=e("game/models/basics"),u=e("votes/models/vote"),a=e("votes/models/follow"),f=e("media/views/image-item"),l=e("usercontrols/location/views/location"),c=e("usercontrol/dropdown/view/dropdown"),h=e("usercontrols/location/models/verify-adress"),p=e("usercontrols/location/models/save"),d=e("component/forms"),v=e("vendor/plugins/dateformat"),m=i.SectionView;return n=m.extend({id:"main-header",template:t,events:{"click .edit-score-h":"editScore","blur .edit-score-input-h":"resumeEditScore","keyup .edit-score-input-h":"adjustFont","click .vote":"vote","click .follow":"follow","click .object-edit-h":"editObject","click .object-delete-h":"deleteObject","submit .update-date-time-h":"updateDateTime","click .game-edit-btn-h":"openEditPopup","click .verify-address-h":"verifyAddress","blur .address-h":"verifyAddress"},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},location:{lat:undefined,lon:undefined},initialize:function(e){m.prototype.initialize.call(this,e);var t=this.model.get("payload"),n;if(t.teams){if(t.teams.length)try{n=t.teams[0].org_name+" VS "+t.teams[1].org_name,n+=" "+t.shared.complevel}catch(r){n="Game Page"}}else n=t.event_name;n+=" | "+t.shared.sport+" | "+t.game_day,document.title=n,this.setDateFields()},setDateFields:function(){var e=this.model.get("payload"),t=e.game_time;console.log(t);if(t!=undefined)try{var n=t.split(" ");console.log(n),n.length&&(e.game_hour=n[0],e.game_ampm=n[1],console.log("full payload now",e),this.model.set("payload",e))}catch(r){}},adjustFont:function(e){var t=2.2,n=$(e.target).val().length-2,r=n>0?t-.5*n:t-0;r>0&&$(e.target).parents(".team-item").find(".game-score-el").css({"font-size":r+"em"})},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},openEditPopup:function(){if(!this.checkForUser()){routing.trigger("showSignup");return}var e={height:"500px",width:"500px",html:'<div id="editGameForm"></div>',title:"Edit Event Info"};routing.trigger("common-popup-open",e),this.drawEditGameForm()},drawEditGameForm:function(){var e=this,t=e.model.get("payload").time_as_int,n=new Date(t);console.log(t,n);var r=new d({date:{form_values:{defaultValue:v(n,"mmm d, yy"),post_to_server:!1,serverKey:"game_date",serverDbField:"gameDay",objectValuesToUpdate:["game_datetime"],getValue:function(){return this.$el.val()}},fieldClass:"date-picker-field",type:"Text",attr:{placeholder:"Enter Date","class":"txt-game-date_h txtDate"},showLable:!0,label:"Date and Time",bindDatePicker:!0},time:{form_values:{defaultValue:v(n,"h:MM"),post_to_server:!1,serverDbField:"gameTime",serverKey:"game_time",objectValuesToUpdate:["game_datetime"]},type:"Text",fieldClass:"time-picker-field",attr:{placeholder:"Time","class":"txt-game-time_h hasDatepicker txtTime"},showLable:!0,label:"&nbsp;",validators:[{type:"required",message:"Please enter a time"},/^(0?[1-9]|1[012])(:[0-5]\d)?$/]},Day_light:{type:"DropDown",fieldClass:"ampm-field",form_values:{post_to_server:!1,serverKey:"game_ampm",objectValuesToUpdate:["game_datetime"],data:{records:[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],recordId:"name",recordValue:"value",selectedValue:v(n,"TT")},elementId:"hidden_time_value",callback:function(e){}},showLable:!0,label:"&nbsp;"},game_datetime:{type:"Hidden",form_values:{serverDbField:"game_datetime",valueBindings:["date","time","Day_light"],serverKey:"game_datetime",post_to_server:!0}},eventname:{form_values:{defaultValue:e.model.get("payload").event_name,post_to_server:!0,serverDbField:"event_name",serverKey:"event_name"},type:"Text",fieldClass:"",attr:{placeholder:"Event Name","class":"txt-event-name"},showLable:!0,label:"Event Name"},Location:{form_values:{defaultValue:e.model.get("payload").location.full_address,serverKey:"locations_id",post_to_server:!0,serverDbField:"locations_id"},longitude:e.model.get("payload").location.lon,latitude:e.model.get("payload").location.lat,locationId:e.model.get("payload").location.id,type:"Location",label:"Location",validators:[{type:"required",message:'Please select location and click the "Verify Address" button'}]},users_id:{form_values:{serverKey:e.users_id,post_to_server:!0,value:e.user_id},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Save Changes"},showLable:!1,onSubmit:function(t){var n=i.commit();if(n)for(var r in n){var s=$("*[name="+r+"]"),o=s.position();s.parents(".common-modal #modalBody").animate({scrollTop:o.top},"500",function(){s.addClass("focus-error-animation"),setTimeout(function(){s.removeClass("focus-error-animation")},2e3)});break}else{if(e.formValues)var u=e.formValues.getFormValues();else var u=i.getValue();var u=e.formValues.getFormValues(),a=e;e.model.set({game_datetime:u.game_datetime,locations_id:u.locations_id,event_name:u.event_name}),console.log(a.model),a.model.save({}),$.when(a.model.request).done(function(t){e.updateHeaderData(a.model.id),routing.trigger("common-popup-close")}),$.when(a.model.request).fail(function(t){var n=JSON.parse(t.responseText),r=n.exec_data.error_array;e.formValues.showServersErrors(r)})}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel","class":"cancel-btn"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},$("#editGameForm")),i=r.form;this.formValues=r.formValues},editObject:function(){alert("Coming soon")},deleteObject:function(){alert("Coming soon")},gameEditBtn:function(){this.$el.find(".update-date-time-h").removeClass("hide")},updateHeaderData:function(e){var t=this;t.model.id=e,t.model.fetch(),$.when(t.model.request).done(function(){t.setDateFields(),console.error(t.model.toJSON()),$("#modalPopupGameEdit").modal("hide"),t.render()})},cancelDateTimeBtn:function(){this.$el.find(".update-date-time-h").addClass("hide")},afterRender:function(){this.$el.find(".edit-score-input-h").trigger("keyup"),this.$el.find(".image-outer-h").mouseover(function(){$(this).find(".action-block").css({opacity:90})}).mouseout(function(){$(this).find(".action-block").css({opacity:0})}),this.$el.find(".date-time-h").datetimepicker({timeFormat:"hh:mm:ss",dateFormat:"yy-mm-dd",showTimezone:!0,changeMonth:!0,changeYear:!0})},vote:function(e){e.preventDefault(),console.log(this.model);var t=new u;t.userId=this.model.id,t.entity_id=this.model.get("payload").enttypes_id,t.setData(),t.save()},follow:function(e){e.preventDefault(),console.log(e.target);var t=new a;t.userId=this.model.id,t.entity_id=this.model.get("payload").enttypes_id,t.save()},editScore:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}$(e.currentTarget).hide(),$(e.currentTarget).parents(".score-box-h").find(".edit-score-input-h").attr("type","text").focus()},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},resumeEditScore:function(e){var t=new s;t.teams_id=$(e.currentTarget).data("id"),t.score=$(e.target).val(),t.gameId=this.model.id,t.set({id:$(e.target).data("id"),games_teams_link_id:$(e.target).data("id"),score:$(e.target).val()}),t.save(),this.$el.find(".edit-score-input-h").attr("type","hidden"),this.$el.find(".edit-score-h").show(),$.when(t.request).done(function(){$(e.currentTarget).parents(".score-box-h").find(".edit-score-h span").html(t.get("score"))})},childViews:{},render:function(e,t,n){m.prototype.render.call(this,e,t,n),$(this.el).find(".txt-game-date_h").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0});var r=[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],i={};i.records=r,i.recordId="name",i.recordValue="value";var s=this,o=new c({data:i,elementId:"hdn_time-period_h",destination:".spn-ddl-time-period_h",targetView:s,selectedValue:this.model.get("payload").game_ampm,callback:function(e){}});this.renderImage()},renderImage:function(){this.headerImage=new f({model:this.model}),this.headerImage.render(),this.$el.find(".image-outer-h").html(this.headerImage.$el)}}),n}),define("game/views/add-media",["require","text!media/templates/add-media.html","game/models/addmedia","facade","views","sportorg/models/team"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("sportorg/models/team"),u=r._;return GameAddMediaView=s.extend({id:"add-media",tagName:"ul",template:t,events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup","mouseover a":"showText","mouseout a":"showicon"},game_model:{},initialize:function(e){s.prototype.initialize.call(this,e)},showText:function(e){$(e.target).parent().find("span").removeClass("hide")},showicon:function(e){$(e.target).parent().find("span").addClass("hide")},afterRender:function(){var e=this;$ele=this.$el.find(".character-limit-h"),$ele.each(function(){e.adJustFontDynamically($(this))})},openAddvideoPopup:function(e){var t="/api/user/addvideo/"+this.model.id;Channel("add-video").publish(t)},setOptions:function(e){if(!this.model)throw new Error("AddMediaView expects option with model property.")},childViews:{},render:function(e,t,n){s.prototype.render.call(this,e,t,n)},openAddImagePopup:function(e){if(this.game_model.attributes.payload.sports_id>0){var t="/api/game/addimage/"+this.game_model.attributes.id,n={sports_id:this.game_model.attributes.payload.sports_id};routing.trigger("add-image",t,n)}else try{var r=new o({id:this.game_model.attributes.payload.teams[0].id});r.fetch();var i=this;$.when(r.request).done(function(){var e="/api/game/addimage/"+i.game_model.attributes.id,t={sports_id:r.attributes.payload.org_sport_link_obj.sports_id};routing.trigger("add-image",e,t)})}catch(s){alert("Whaaaa...?  It seems like the sport isn't set for this game (weird), which means we can't add the photo.  Shoot an email to support@athletez.com and we'll figure out what went wrong.")}}}),GameAddMediaView}),define("game/views/commenton-list",["facade","utils","site/views/comment-list","profile/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({name:"games comments on view",initialize:function(e){o.bindAll(this),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){alert("refresh"),s(e)})}}),s}),define("text!sportorg/templates/teamroster-item.html",[],function(){return'\r\n{{#payload}}\r\n    <h3>{{name}}</h3>\r\n        <img src="{{user_picture}}" alt="{{name}}"/><br/>\r\n        {{name}} \'{{grad_year}}<br/>\r\n        {{sport_name}}<br/>\r\n        {{position}}<br/>\r\n        {{team_name}}<br/>\r\n    <br/><br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/teamroster-item",["vendor","views","utils","text!sportorg/templates/teamroster-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"teamroster",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/teamroster-list",["facade","views","utils","sportorg/views/teamroster-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"teamroster-list",name:"Team Roster List",tagName:"ul",_tagName:"li",_className:"teamroster",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("TeamRosterListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("game/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/game/addvideo/"+this.id:"/api/game/addvideo?game_id="+this.id},initialize:function(e,n){t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gameaddvideo:fetch").publish(e)}}),r}),define("game/views/add-video",["require","game/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("GameAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id}),this.model.fetch())}}),r}),define("game/views/video-list",["facade","utils","media/views/video-list","game/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gameaddvideo:fetch").subscribe(i)}}),i}),define("game/models/commentform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({defaults:{payload:{}},url:function(){return testpath?testpath+"/game/commentform/"+this.id:"/api/game/commentform/"+this.id},initialize:function(e,n){i.bindAll(this),t.prototype.initialize.call(e,n)},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("gamecommentform:fetch").publish(e)}}),r}),define("game/views/comment-form",["require","game/models/commentform","site/views/comment-form"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("GameCommentFormView expected options.collection.");this.model||(this.model=new t({id:this.collection.id}),this.model.fetch())}}),r}),define("game/views/comment-list",["facade","utils","site/views/comment-list","game/views/comment-form"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupFormView:function(){function i(n){t.model=n,t.render(),e.$el.prepend(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("gamecommentform:fetch").subscribe(i)}}),i}),define("text!roster/templates/roster.html",[],function(){return'<div class="roster-heading-h"></div>\r\n<!--div class="clear"><a href="javascript: void(0);" class="hide add-to-roster-h" title="Add to roster">Add to Roster</a></div-->\r\n<div  class="clear roster-images-h"></div>'}),define("roster/collections/roster",["facade","sportorg/collections/teamrosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/roster/"+this.id:"/api/team/roster/"+this.id}}),r}),define("roster/views/image-list",["facade","utils","media/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",tagName:"ul",currentSection:"rosters",setupAddView:function(){}}),r}),define("text!common/templates/add-roster-buttons.html",[],function(){return'<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-team" data-content="Click here to add yourself to {{#data.team_name}} {{data.team_name}}{{/data.team_name}}{{^data.team_name}} this team{{/data.team_name}}" class="add-to-roster-list add-icon add-to-roster-list-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-fb-c" data-content="Click here to invite friends from facebook that play for {{#data.team_name}} {{data.team_name}}{{/data.team_name}}{{^data.team_name}} this team{{/data.team_name}}" class="invite-from-fb add-icon invite-roster-from-fb-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-question" data-content="This is a team roster.  It lists all athletes on {{#data.team_name}} {{data.team_name}}{{/data.team_name}}{{^data.team_name}} this team{{/data.team_name}}." data-page="roster" class="question add-icon"></a>'}),define("roster/views/roster",["require","text!roster/templates/roster.html","views","vendor","facade","utils","jqueryui","controller","roster/models/roster","roster/collections/roster","roster/views/image-list","component/fb","common/views/add-media-buttons","text!common/templates/add-roster-buttons.html"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("component/fb"),d=e("roster/models/roster"),v=e("roster/views/image-list"),m=e("roster/collections/roster"),g=e("common/views/add-media-buttons"),y=e("text!common/templates/add-roster-buttons.html");return n=o.extend({template:t,events:{"click .add-to-roster-h":"addToRoster","mouseover a.tiles":"showText","mouseout a.tiles":"showicon","click .invite-team-player-h":"inviteFBFriend"},showText:function(e){u(e.target).parent().find("span").removeClass("hide")},showicon:function(e){u(e.target).parent().find("span").addClass("hide")},afterRender:function(){var e=this,t=setInterval(function(){$ele=e.$el.find(".character-limit-h"),$ele.length&&(clearInterval(t),$ele.each(function(){e.adJustFontDynamically(u(this))}))},100)},inviteFBFriend:function(e){var t=this,n={};n.subject_id=this.team_id,n.enttype_id=this.entityId,routing.trigger("fbInvite",undefined,n)},initialize:function(e){var t=this;e.mainView=this,this.mainView=this,o.prototype.initialize.call(this,e),console.log("roster view",e),t.team_id=e.team_id,t.teamName=e.teamName,t.entityId=e.entityId,t.team_name=e.team_name,t.controllerObject=e.controllerObject,t.viewName=e.viewName||"Image List"+Math.random(),a.bindAll(this),t.getTeams()},getTeams:function(){var e=this;e.team_id&&(e.collection1=new m,e.collection1.id=e.team_id,e.collection1.fetch(),u.when(e.collection1.request).done(function(){e.setupTeamRosterListView()}))},setupTeamRosterListView:function(){var e,t=!1;e=new v({collection:this.collection1,name:this.viewName,mainView:this,dontrenderTemplate:!0,model:new d,teamName:this.teamName});if(this.checkForUser())try{var n=this.collection1.toArray();for(var r in n)if(parseInt(n[r].attributes.payload.id)===parseInt(routing.loggedInUserId)){t=!0;break}}catch(i){}this.$el.find(".roster-images-h").html(e.$el),t&&this.$el.find(".roster-heading-h").find(".add-to-roster-list-h").addClass("link-disabled")},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},addToRoster:function(e){var t=this,n=new d,r=function(r){n.url="/api/team/player/"+t.team_id,n.save(),u.when(n.request).done(function(){u(e.currentTarget).addClass("link-disabled"),t.getTeams(),r&&r()})};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=new g({target:this.$el.find(".roster-heading-h"),heading:this.team_name,team_id:this.team_id,team_name:this.team_name,entityId:this.entityId,addToRoster:this.addToRoster,template:y,inviteData:{invite_type:"join",subject_id:this.team_id,enttypes_id:this.entityId}})}}),n}),define("text!common/templates/add-participants-buttons.html",[],function(){return'<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-orange" data-content="Add me to the list for &quot;{{data.message.event_name}}&quot;" class="add-participants add-to-participants add-to-participants-list-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-fb-c" data-content="Invite a friend from facebook to participate in &quot;{{data.message.event_name}}&quot;" class="invite-from-fb add-icon invite-participant-from-fb-h"></a>\r\n<a href="javascript: void(0);" data-tip-style="qtip-athletez qtip-question" data-content="" data-page="participants" class="question add-icon"></a>'}),define("text!game/templates/participats-list.html",[],function(){return'<div class="clear">\r\n\r\n</div>\r\n<ul class="image-list">\r\n</ul>\r\n\r\n<!--a href="javascript: void(0);" class="add-comment">Add Comment</a>\r\n<a href="javascript: void(0);" class="add-media">Add Media</a-->\r\n\r\n\r\n<!--{{#target}}\r\n<div class="image-drop-area-outer">\r\n	<div class="image-drop-area" id="image-place-holder">\r\n		<div class="drop-text">DROP PHOTOS HERE</div>\r\n		<div>OR CLICK TO UPLOAD</div>\r\n	</div>\r\n</div>\r\n{{/target}}-->\r\n\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">More</a></div>\r\n'}),define("game/views/participants-list",["facade","views","utils","media/views/image-item","text!game/templates/participats-list.html","sportorg/models/uslgamelink","common/models/add","component/fb","component/forms","common/views/add-description"],function(e,t,n,r,i,s,o){var u,a,f=e.$,l=e._,c=require("vendor"),h=n.lib.Channel,p=require("component/fb"),d=t.CollectionView,v=t.SectionView,m=require("component/forms"),g=c.Mustache,y=require("common/views/add-description"),b=d.extend(v.prototype);return b.extend({__super__:d.prototype,template:i,_tagName:"li",_className:"image",page:0,page_limit:8,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore","mouseover a.tiles":"showText","mouseout a.tiles":"showicon","click .invite-to-fb-h":"inviteFBFriend"},showText:function(e){f(e.target).parent().find("span").removeClass("hide")},showicon:function(e){f(e.target).parent().find("span").addClass("hide")},inviteFBFriend:function(e){var t=this,n={},r=function(){n.subject_id=t.game_id,n.enttype_id=t.controllerObject.basics.get("payload").enttypes_id,routing.trigger("fbInvite",undefined,n)};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},renderTemplate:function(){var e=g.to_html(this.template,{target:this.target_id});return console.log(e),this.$el.html(e),this},afterRender:function(){var e=this,t=setInterval(function(){$ele=e.$el.find(".character-limit-h"),$ele.length&&(clearInterval(t),$ele.each(function(){e.adJustFontDynamically(f(this))}))},100);this.$el.find(".edit-h").on("click",this.editResults)},editResults:function(e){e.preventDefault(),e.stopPropagation();if(f(e.target)[0].tagName=="SPAN")var t=f(e.target).parent().attr("subject-id");else var t=f(e.target).attr("subject-id");if(!this.checkForUser())routing.trigger("showSignup",function(e){addToList(function(){e&&e()})});else{var n={height:"500px",width:"500px",html:'<div id="addParticipantForm"></div>',title:"Edit My Times"};routing.trigger("common-popup-open",n),this.drawAddParticipantForm(t)}},addParticipant:function(){if(!this.checkForUser())routing.trigger("showSignup",function(e){addToList(function(){e&&e()})});else{var e={height:"500px",width:"500px",html:'<div id="addParticipantForm"></div>',title:"Add Me to This Event"};routing.trigger("common-popup-open",e),this.drawAddParticipantForm()}},drawAddParticipantForm:function(e){var t=this,n=!1,r=new s,i=function(){var e=new m({result_time:{form_values:{defaultValue:n?r.get("payload").result_time:"",post_to_server:!0,serverDbField:"result_time",serverKey:"result_time"},type:"Text",fieldClass:"",attr:{placeholder:"00:00:00","class":"txt-result-time"},showLable:!0,label:"Result Time"},bibnumber:{form_values:{defaultValue:n?r.get("payload").bib_number:"",post_to_server:!0,serverDbField:"bib_number",serverKey:"bib_number"},type:"Text",fieldClass:"",attr:{placeholder:"0","class":"txt-bib-number"},showLable:!0,label:"Bib Number"},games_id:{form_values:{serverKey:"games_id",serverDbField:"games_id",post_to_server:!0,value:t.game_id},type:"Hidden"},sports_id:{form_values:{serverKey:"sports_id",serverDbField:"sports_id",post_to_server:!0,value:t.sport_id},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Save Changes"},showLable:!1,onSubmit:function(e){var s=i.commit();if(s)for(var u in s){var a=f("*[name="+u+"]"),c=a.position();a.parents(".common-modal #modalBody").animate({scrollTop:c.top},"500",function(){a.addClass("focus-error-animation"),setTimeout(function(){a.removeClass("focus-error-animation")},2e3)});break}else{if(t.formValues)var h=t.formValues.getFormValues();else var h=i.getValue();var h=t.formValues.getFormValues();r.set({games_id:h.games_id,sports_id:h.sports_id,result_time:h.result_time,bib_number:h.bib_number}),r.save(),f.when(r.request).done(function(){var e=r.toJSON(),i=new o;i.processItemFromResponse(e.payload.usl.user),routing.trigger("common-popup-close"),t.$el.find(".add-to-event").addClass("link-disabled"),n||(t.collection.add(i),t.collection.length==1&&t.controllerObject&&t.controllerObject.reloadParticipants&&l.isFunction(t.controllerObject.reloadParticipants)&&t.controllerObject.reloadParticipants())}),f.when(r.request).fail(function(e){var n=JSON.parse(e.responseText),r=n.exec_data.error_array;t.formValues.showServersErrors(r)})}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel","class":"cancel-btn"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},f("#addParticipantForm")),i=e.form;t.formValues=e.formValues};e?(r.set("id",e),r.fetch(),f.when(r.request).done(function(){n=!0,i()})):i()},initialize:function(t){var n=this;routing.off("add-to-event"),routing.on("add-to-event",function(){if(!n.checkForUser()){routing.trigger("showSignup");return}n.addParticipant()}),f(".participants-heading-h").removeClass("hide"),t.name?this.name=t.name:this.name="image list",t.collecton&&(this.collection=t.collection),this.controllerObject=t.controllerObject,this.controller=t.controller,this.sports_id=t.sports_id,this.game_id=this.collection.id,this.mainView=this,t.mainView=this,this.renderTemplate();if(!this.collection.limit){n.allData=this.collection.toArray();var r=n.allData.length;n.start=0,n.end=n.page_limit,n.page_limit=8}var r=n.collection.length;(!r||r<n.collection.limit)&&n.$el.find(".see-more-h").hide(),console.log("PL",r,n.collection);if(!r){var i=e.Backbone.Model.extend({});new y({page:"participants",target:this.$el,model:new i,teamName:this.teamName,name:"view - "+Math.random()})}else{var s=this.collection.toArray(),o=!1;for(var u in s)routing.loggedInUserId==s[u].id&&(o=!0)}this.target_id=t.target_id,this.target_url=t.target_url,this.sport_id=t.sport_id,console.error(t);var n=this;n.allData=this.collection.toArray(),n.seeMore(),d.prototype.initialize.call(this,t);if(!this.collection)throw new Error("ImageListView expected options.collection.");l.bindAll(this),this.addSubscribers(),this.setupAddView(),setTimeout(function(){},0)},showAddButton:function(){this.$el.find(".add-to-event").removeClass("link-disabled")},seeMore:function(e){var t=this.allData.length,n=this.page*this.page_limit,r=n+this.page_limit;t<=r&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(n,r)):this.collection.reset(this.allData.slice(n,r)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupAddView&&this.setupAddView())},checkForUser:function(){return!l.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},childViews:{},setupAddView:function(){function i(e){n.model=e,n.render(),f(this.listView).append(n.el)}var e,t=this,n=new AddImageView({collection:this.collection}),r=this.addChildView(n);this.childViews.form=n,this.callbacks.add(function(){r()}),h("addimage:fetch").subscribe(i)},filterWithImageType:function(e){var t=this.collection;return f.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t}})}),define("game/views/participants-list-main",["facade","views","utils","game/views/participants-list"],function(e,t,n,r){return r.extend({imagetype:"large_thumb",setupAddView:function(){}})}),define("game",["require","text!game/templates/layout.html","votes/views/vote","facade","controller","models","views","utils","game/models/basics","game/models/addmedia","game/collections/teamrosters","game/collections/videos","game/collections/images","game/collections/participants","game/collections/comments","game/collections/commentson","game/views/header","game/views/add-media","game/views/commenton-list","sportorg/views/teamroster-list","game/views/video-list","profile/views/image-video-list","game/views/comment-list","game/views/commenton-list","roster/views/roster","common/views/add-media-buttons","text!common/templates/add-media-buttons.html","text!common/templates/add-participants-buttons.html","game/views/participants-list-main"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("game/models/basics"),l=e("game/models/addmedia"),c=e("game/collections/teamrosters"),h=e("game/collections/videos"),p=e("game/collections/images"),d=e("game/collections/comments"),v=e("game/collections/commentson"),m=e("game/collections/participants"),g=e("game/views/header"),y=e("game/views/add-media"),b=e("sportorg/views/teamroster-list"),w=e("game/views/video-list"),E=e("profile/views/image-video-list"),S=e("game/views/comment-list"),x=e("game/views/commenton-list"),T=e("media/models/image"),N=e("roster/views/roster"),C=e("common/views/add-media-buttons"),k=e("text!common/templates/add-media-buttons.html"),L=e("text!common/templates/add-participants-buttons.html"),A=e("game/views/participants-list-main"),O=u.LayoutView,M=i.$,_=i._,D=a.debug,P=a.lib.Channel,H=["/pages/game/game.css"];return r=s.extend({rosterViewsCount:0,initialize:function(e){return P("load:css").publish(H),_.bindAll(this),this.scheme=[],e.params&&this.setParamsArray(e.params),this.handleOptions(e),this.init(),this},handleOptions:function(e){this.id=e.gameId,this.userId=e.userId},init:function(){this.setupLayout().render(),this.createData(),this.handleDeferreds()},createData:function(){this.basics=new f({id:this.id}),this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new l,this.addmedia.id=this.id},handleDeferreds:function(){var e=this;M.when(this.basics.request).done(function(){e.setupHeaderView();var t=e.basics.get("payload"),n=t.enttypes_id;e.images=new p,e.images.id=e.id,e.images.targetElement="#image-wrap",e.images.fetch();var r=t.teams,i=r?r.length:0;for(var s=0;s<i;s++)e.setupRosterView(r[s].id,r[s].org_sport_link_obj.org.name,r[s].enttypes_id);e.commentson=new v,e.commentson.subject_entity_type=n,e.commentson.id=e.id,e.commentson.targetElement="#commenton-wrap",e.commentson.fetch(),console.error(e.basics.get("payload"));var o=e.basics.get("payload"),u=!_.isUndefined(o.teams)&&o.teams?o.teams.length:0;e.teamsCount=u,u||(e.participants=new m,e.participants.id=e.id,e.participants.targetElement="#roster-wrap",e.participants.fetch(),M.when(e.participants.request).done(function(){e.setupParticipantsListView()})),M.when(e.commentson.request).done(function(){e.setupCommentsOnListView()}),M.when(e.images.request).done(function(){e.setupImageListView()})})},initVoteView:function(){var e=new n({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},setupRosterView:function(e,t,n){M("#roster_wrap_"+this.rosterViewsCount).length||M("#roster-wrap").append('<div id="roster_wrap_'+this.rosterViewsCount+'" class="clear"></div>');var r,s=i.Backbone.Collection.extend({});r=new N({model:new s,team_id:e,entityId:n,team_name:t,controllerObject:this,name:"roster images"+Math.random()*Math.random(),destination:"#roster_wrap_"+this.rosterViewsCount,teamName:this.basics.get("payload").game_name}),this.scheme.push(r),this.layout.render(),this.rosterViewsCount++},setupHeaderView:function(){var e;e=new g({model:this.basics,name:"Header",destination:"#main-header"}),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(e){var t;t=new y({model:this.addmedia,name:"Add Media",destination:e,controllerObject:this}),t.game_model=this.basics,this.scheme.push(t),this.layout.render()},reloadParticipateView:function(){var e=this,t;this.participantsView&&(M(this.participantsView.destination).html(""),t=M.inArray(this.participantsView,this.scheme),~t&&this.scheme.splice(t,1)),e.participants.fetch(),M.when(e.participants.request).done(function(){e.setupParticipantsListView()})},reloadParticipants:function(){var e=this,t;this.participantsView&&(M(this.participantsView.destination).html(""),t=M.inArray(this.participantsView,this.scheme),~t&&this.scheme.splice(t,1)),e.participants.fetch(),M.when(e.participants.request).done(function(){e.setupParticipantsListView()})},setupParticipantsListView:function(){var e=this,t=new C({target:".participants-add-icons-h",heading:"PARTICIPANTS",template:L,controllerObject:e,inviteData:{invite_type:"join",subject_id:e.basics.get("payload").id,enttypes_id:e.basics.get("payload").enttypes_id},message:{event_name:e.basics.get("payload").game_name}});this.participantsView=new A({collection:this.participants,name:"participants view",controller:this,controllerObject:this,sport_id:this.basics.get("payload").sports_id,destination:"#participants_div",teamName:this.basics.get("payload").game_name}),this.scheme.push(this.participantsView),this.layout.render()},setupTeamRosterListView:function(){M("#roster_wrap_"+this.rosterViewsCount).length||M("#roster-wrap").append('<div id="#roster_wrap_'+this.rosterViewsCount+'" class="clear"></div>');var e;e=new E({collection:this.teamrosters,name:"roster images",destination:"#roster_wrap_"+this.rosterViewsCount,teamName:this.basics.get("payload").game_name}),this.scheme.push(e),this.layout.render(),this.rosterViewsCount++},setupTeamRosterSecondListView:function(){var e;e=new E({collection:this.teamrostersSecond,name:"roster roster second images",destination:"#roster-second-wrap",teamName:this.basics.get("payload").game_name}),this.scheme.push(e),this.layout.render()},setupVideoListView:function(){var e;e=new w({collection:this.videos,destination:"#video-wrap"}),this.scheme.push(e),this.layout.render()},setupImageListView:function(){var e=this,t,n=new C({target:".media-add-icons-h",heading:"PHOTO/VIDEO",template:k,page_base:"game",ent_id:e.id,sports_id:M(".sport-h").data("id"),controllerObject:e,model:e.addmedia,message:{photo:"Got Pics From this Game?",video:"Got Videos From this Game?"}});routing.off("setup-add-icons"),routing.on("setup-add-icons",function(t){e.setupAddMediaView(t)}),t=new E({collection:this.images,name:"image list",target_id:this.id,controllerObject:this,target_url:"/api/game/addimage/",sport_id:M(".sport-h").data("id"),destination:"#image-wrap",media_id:this.media_id,pageName:"game",triggerItem:"setup-add-icons",teamName:this.basics.get("payload").game_name}),this.imageListView=t,routing.off("image-upload-success"),routing.on("image-upload-success",function(t){e.updateImages(t)}),this.scheme.push(t),this.layout.render()},reloadImages:function(){var e=this,t;this.imageListView&&(M(this.imageListView.destination).html(""),t=M.inArray(this.imageListView,this.scheme),~t&&this.scheme.splice(t,1)),e.images.fetch(),M.when(e.images.request).done(function(){e.setupImageListView()})},updateImages:function(e){var t=new T;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON()),this.imageListView.collection.length==1&&this.reloadImages()},setupCommentListView:function(){},setupCommentsOnListView:function(){var e;e=new x({collection:this.commentson,userId:this.userId,destination:".commentson-outer-box-h",name:"games comment on view"}),this.scheme.push(e),this.layout.render()},setupLayout:function(){var e;return e=new O({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),r}),define("text!team/templates/layout.html",[],function(){return'<div class="template-container team-template-outer">\r\n<div id="main-header"></div>\r\n\r\n<div id="menu-container"></div>\r\n\r\n<div class="green-left-heading">MESSAGE BOARD</div>\r\n<div  class="clearfix clear commentson-outer-box-h profile-comment-list-box"></div>\r\n<div id="comment_div" class="clearfix"></div>\r\n\r\n\r\n<div class="media-add-icons-h"></div>\r\n	<div class="row-fluid" id="main-content">\r\n		<div id="image-wrap" class="clearfix clear">\r\n		</div>\r\n		<!--div id="add-media" class="clearfix">add media</div-->\r\n	</div>\r\n	\r\n	<div class="row-fluid">\r\n		<div class="span4" id="main-sidebar">\r\n			<div id="related-wrap" class="clearfix"></div>\r\n			<div  class="clearfix"></div>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="games-add-icons-h game-green-heading hide">GAMES</div>\r\n	<div id="games_div" class="clearfix">\r\n	</div>\r\n	\r\n	<div class="fans-add-icons-h"></div>\r\n	<div id="fans-div" class="clearfix clear">&nbsp;</div>\r\n\r\n	<div id="roster-wrap" class="clearfix clear"></div>\r\n\r\n<div id="votes-area-h"></div>\r\n<!--div class="row-fluid">\r\n    <div class="span4" id="main-sidebar">\r\n    \r\n        <div id="add-media" class="clearfix">\r\n        </div>\r\n        \r\n        Upcoming<br/>\r\n        <div id="upcoming-schedule" class="clearfix">\r\n        </div>\r\n        \r\n        Recent<br/>\r\n        <div id="recent-schedule" class="clearfix">        \r\n        </div>\r\n        \r\n        <a href="#">Missing a Game?</a>\r\n        \r\n        <div id="competitor-teams" class="clearfix">\r\n        </div>\r\n    \r\n    </div>\r\n    <div class="span8" id="main-content">\r\n    	\r\n    	\r\n    	\r\n        Roster\r\n        <div id="roster-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        Videos\r\n        <div id="video-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        Photos\r\n        <div id="image-wrap" class="clearfix">\r\n        </div>\r\n        \r\n        FanBoard\r\n        <div id="comment-wrap" class="clearfix">\r\n        </div>\r\n        \r\n    </div>\r\n</div-->\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n</div>'}),define("team/models/basics",["facade","sportorg/models/team"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/team/basics/"+this.id:"/api/team/basics/"+this.id}}),n}),define("team/models/addmedia",["models/base"],function(e){var t;return t=e.extend({id:undefined,sportName:undefined,firstName:undefined,defaults:{links:[{label:"Got pics of "+this.teamName,link:"javascript:void(0);",id:"addPhoto"},{label:"Got videos of "+this.teamName,link:"javascript:void(0);",id:"addVideo"}],userid:null},setData:function(){this.set({links:[{label:"Got pics of "+this.teamName,link:"javascript:void(0);",id:"addPhoto"},{label:"Got videos of "+this.teamName,link:"javascript:void(0);",id:"addVideo"}],userid:null})}}),t}),define("team/collections/upcoming_schedules",["facade","sportorg/collections/games","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/upcoming_schedules/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/upcoming_schedules/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/recent_schedules",["facade","sportorg/collections/games","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/recent_schedules/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/recent_schedules/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/competitor_teams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/competitor_teams/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/competitor_teams/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("sportorg/models/roster",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,user_picture:null,grad_year:0,sport_name:null,position:null,num_votes:0,num_followers:0},desc:"Roster information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/rosters",["facade","collections","sportorg/models/roster","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("team/collections/rosters",["facade","sportorg/collections/rosters","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/rosters/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/rosters/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/videos",["facade","media/collections/videos","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/videos/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/videos/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/images",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({limit:8,offset:0,url:function(){return testpath?testpath+"/team/media/"+this.team_id+"/"+this.sport_id:"/api/team/media/"+this.team_id+"?sport_id="+this.sport_id+"&limit="+this.limit+"&offset="+this.offset}}),r}),define("team/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/comments/"+this.id+"?sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id}}),r}),define("team/collections/commentson",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id:"/api/team/comments/"+this.id}}),r}),define("team/collections/orgs",["facade","sportorg/collections/orgs","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/games/"+this.id:"/api/team/games/"+this.id}}),r}),define("team/collections/fans",["facade","media/collections/images","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/team/followers/"+this.id+"/"+this.sport_id:"/api/team/followers/"+this.id+"?sport_id="+this.sport_id}}),r}),define("text!team/templates/header.html",[],function(){return'\r\n{{#payload}}\r\n<div class="row-fluid">\r\n	\r\n	<div class="profile-heading">\r\n            <h3 class="username">{{org_sport_link_obj.org.org_name	}}</h3>\r\n            <h4>{{org_sport_link_obj.sport.sport_name}} | {{complevels_obj.complevel_name}} | {{seasons_obj.season_name}} \'{{year}}</h4>\r\n            <a href="javascript: void(0);" id="editTeamLink" title="Edit Team">Edit Team</a>\r\n            \r\n            <div id="votes-area-h"></div>\r\n    </div>\r\n	\r\n    <!--div class="span4 textcenter">\r\n        {{#picture}}\r\n        <img src="{{picture}}" alt="{{name}}" />\r\n        {{/picture}}\r\n    </div>\r\n    <div class="span8">\r\n        <div>\r\n            <h3 class="teamname">{{name}}</h3>\r\n            <div class="teamloaction">{{location}}</div>\r\n            <div class="votes">Votes: {{num_votes}}</div>\r\n            <div class="followers">Followers: {{num_followers}}</div>\r\n        </div>\r\n        <div id="sports-info"></div>\r\n    </div-->\r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/sport-select.html",[],function(){return'<select name="sport" id="select-sport">\r\n{{#payload}}\r\n    <option value="{{sport_id}}">{{sport_name}}</option>    \r\n{{/payload}}\r\n</select>\r\n'}),define("team/collections/sports",["facade","sportorg/collections/sports","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/sports/"+this.id:"/api/org/sports/"+this.id}}),r}),define("text!team/templates/sport-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="sport-info sport-info-{{sport_id}}" style="display:none">\r\n    <div class="complevels"></div>     \r\n</div>            \r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/complevel-select.html",[],function(){return'<select name="complevel" class="select-complevel">\r\n{{#payload}}\r\n    <option value="{{complevel_id}}">{{complevel_name}}</option>    \r\n{{/payload}}\r\n</select>\r\n'}),define("sportorg/collections/complevels",["facade","collections","sportorg/models/complevel","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload||[];for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),s}),define("team/collections/complevels",["facade","sportorg/collections/complevels","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/complevels/"+this.id+"/"+this.sport_id:"/api/org/complevels/"+this.id+"?sports_id="+this.sport_id}}),r}),define("text!team/templates/complevel-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="complevel-info complevel-info-{{sport_id}}-{{complevel_id}}" style="display:none">\r\n    <div class="seasons"></div>     \r\n</div>\r\n{{/payload}}\r\n\r\n'}),define("text!team/templates/seasonteam-select.html",[],function(){return'<select name="season" id="select-season">\r\n{{#payload}}\r\n    <option value="{{seasons_id}}">{{seasons_obj.season_name}} {{year}}</option>\r\n{{/payload}}\r\n</select>\r\n'}),define("sportorg/models/season",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,season_name:null},desc:"Season information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/seasons",["facade","collections","sportorg/models/season","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},ParseForDropdown:function(){return this.toJSON()}}),s}),define("team/collections/seasons",["facade","sportorg/collections/seasons","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/seasons/"+this.id+"/"+this.sport_id+"/"+this.complevel_id:"/api/org/seasons/"+this.id+"?sports_id="+this.sport_id+"&complevels_id="+this.complevel_id}}),r}),define("team/collections/seasonteams",["facade","sportorg/collections/teams","utils"],function(e,t,n){var r,i=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/org/seasonteams/"+this.id+"/"+this.sport_id+"/"+this.complevel_id:"/api/org/seasonteams/"+this.id+"?sports_id="+this.sport_id+"&complevels_id="+this.complevel_id}}),r}),define("text!team/templates/season-item.html",[],function(){return'\r\n{{#payload}}\r\n<div class="season-info season-info-{{sport_id}}-{{complevel_id}}-{{season_id}}" style="display:none">\r\n    \r\n</div>            \r\n{{/payload}}\r\n\r\n'}),define("team/views/season-item",["vendor","views","utils","text!team/templates/season-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=n.lib.Channel,i=o.extend({tagName:"li",className:"complevel",initialize:function(e){function o(){a("refresh-teampage").publish(n,i,s)}this.template=r;var t=this;this.id=e.model.collection.id;var n=this.model.collection.sport_id,i=this.model.collection.complevel_id,s=this.model.get("payload").season_id;a("teamseasons:select"+n+"-"+i+"-"+s).subscribe(o)},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}});return i}),define("team/views/season-list",["facade","views","utils","team/views/season-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"season-list",name:"Season List",tagName:"ul",_tagName:"li",_className:"season",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SeasonListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/complevel-item",["vendor","views","utils","text!team/templates/complevel-item.html","text!team/templates/seasonteam-select.html","team/collections/seasons","team/collections/seasonteams","team/views/season-list"],function(e,t,n,r,s){var o,u=e.$,a=t.BaseView,f=e.Mustache,l=n.lib.Channel,c=require("team/views/season-list"),h=require("team/collections/seasons");return SeasonTeamList=require("team/collections/seasonteams"),o=a.extend({tagName:"li",className:"complevel",rendered:!1,events:{"change #select-season":"selectSeason"},initialize:function(e){function n(){if(t.rendered){t.selectSeason();return}t.rendered=!0,t.initList()}this.template=r,this.selectSeasonTemplate=s;var t=this;this.id=e.model.collection.id;var i=this.model.collection.sport_id;l("teamcomplevels:select"+i+"-"+this.model.get("payload").complevel_id).subscribe(n)},initList:function(){var e=this;this.seasons=new SeasonTeamList,this.seasons.id=this.id,this.seasons.sport_id=this.model.collection.sport_id,this.seasons.complevel_id=this.model.get("payload").complevel_id,this.seasons.fetch();var t=this.seasons.sport_id,n=this.seasons.complevel_id;u.when(this.seasons.request).done(function(){e.setupSeasonListView(t,n),l("teamseasons"+t+"-"+n+":fetch").publish(),e.select_season=e.$("#select-season"),e.selectSeason()})},setupSeasonListView:function(e,t){function s(){r.render(),n.$el.find(".seasons").html(r.el);var e={payload:[]},t=r.collection;if(t.length){for(i=0;i<t.length;i++)e.payload[i]=t.at(i).get("payload");var s=f.to_html(n.selectSeasonTemplate,e);n.$el.find(".seasons").prepend(s)}else n.$el.find(".seasons").html("")}var n=this,r=new c({collection:this.seasons});l("teamseasons"+e+"-"+t+":fetch").subscribe(s)},render:function(){var e=this.model.collection.sport_id,t=this.model.get("payload");t.sport_id=e,this.model.set("payload",t);var n=f.to_html(this.template,this.model.toJSON());return this.$el.html(n),this},selectSeason:function(){var e=this.select_season.val(),t=this.model.collection.sport_id,n=this.model.get("payload").complevel_id;this.$(".season-info").stop().slideUp(),this.$(".season-info-"+t+"-"+n+"-"+e).stop().slideDown(),l("teamseasons:select"+t+"-"+n+"-"+e).publish()}}),o}),define("team/views/complevel-list",["facade","views","utils","team/views/complevel-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return TeamComplevelListAbstract=f.extend(l.prototype),i=TeamComplevelListAbstract.extend({__super__:f.prototype,id:"complevel-list",name:"Complevel List",tagName:"ul",_tagName:"li",_className:"complevel",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ComplevelListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/sport-item",["vendor","views","utils","text!team/templates/sport-item.html","text!team/templates/complevel-select.html","team/collections/complevels","team/views/complevel-list"],function(e,t,n,r,s){var o,u=e.$,a=t.BaseView,f=e.Mustache,l=n.lib.Channel,c=require("team/views/complevel-list"),h=require("team/collections/complevels");return o=a.extend({tagName:"li",className:"sport",rendered:!1,events:{"change #select-complevel":"selectComplevel"},initialize:function(e){function n(){if(t.rendered){t.selectComplevel();return}t.rendered=!0,t.initList()}this.template=r,this.selectComplevelTemplate=s;var t=this;this.id=e.model.collection.id,l("teamsports:select"+this.model.get("payload").sport_id).subscribe(n)},initList:function(){var e=this;this.complevels=new h,this.complevels.id=this.id,this.complevels.sport_id=this.model.get("payload").sport_id,this.complevels.fetch();var t=this.complevels.sport_id;u.when(this.complevels.request).done(function(){e.setupComplevelListView(t),l("teamcomplevels"+t+":fetch").publish(),e.select_complevel=e.$("#select-complevel"),e.selectComplevel()})},setupComplevelListView:function(e){function r(){n.render(),t.$el.find(".complevels").html(n.el);var e={payload:[]},r=n.collection;if(r.length){for(i=0;i<r.length;i++)e.payload[i]=r.at(i).get("payload");var s=f.to_html(t.selectComplevelTemplate,e);t.$el.find(".complevels").prepend(s)}else t.$el.find(".complevels").html("")}var t=this,n=new c({collection:this.complevels});l("teamcomplevels"+e+":fetch").subscribe(r)},render:function(){var e=f.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},selectComplevel:function(){var e=this.select_complevel.val(),t=this.model.get("payload").sport_id;this.$(".complevel-info").stop().slideUp(),this.$(".complevel-info-"+t+"-"+e).stop().slideDown(),l("teamcomplevels:select"+t+"-"+e).publish()}}),o}),define("team/views/sport-list",["facade","views","utils","team/views/sport-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/header",["require","text!team/templates/header.html","text!team/templates/sport-select.html","team/models/basics","facade","views","utils","vendor","team/collections/sports","team/views/sport-list","usercontrol/dropdown/view/dropdown","sportorg/models/org","team/collections/seasonteams","component/forms","team/collections/complevels"],function(e,t,n){var r,s=e("facade"),o=e("views"),u=e("team/models/basics"),a=e("sportorg/models/org"),f=o.SectionView,l=e("team/views/sport-list"),c=e("team/collections/sports"),h=e("usercontrol/dropdown/view/dropdown"),p=e("team/collections/seasonteams"),d=e("team/collections/complevels"),v=e("component/forms"),m=e("utils"),g=m.lib.Channel,y=e("vendor"),b=y.Mustache,w=s.$,E=s._;return r=f.extend({template:t,selectSportTemplate:n,events:{"click #editTeamLink":"openEditPopup"},initialize:function(e){this.controllerObject=e.controllerObject,f.prototype.initialize.call(this,e),E.bindAll(this)},selectSport:function(e){self.select_sport=self.$("#select-sport");var t=this.select_sport.val()},updateHeaderData:function(e){var t=this;t.model.id!=e&&(t.model.id=e,t.model.fetch(),w.when(t.model.request).done(function(){t.render();var e=t.model.get("payload"),n=e.id,r=e.org_sport_link_obj.org.name;t.controllerObject.setupRosterView(n,r),t.controllerObject.showVote()}))},showAllTeamData:function(){routing.trigger("refresh-teampage",w("#sports-h").val(),w("#team-h").val(),this.season.id)},insertOption:function(e,t){var n="",r=t.length;for(var i=0;i<r;i++)n+='<option value="'+t[i].payload.sport_id+'">'+t[i].payload.sport_name+"</option>";e.html(n)},setupSportListView:function(){function r(){t.render(),e.$el.find("#sports-info").html(t.el);var n={payload:[]},r=t.collection;if(r.length){for(i=0;i<r.length;i++)n.payload[i]=r.at(i).get("payload");var s=b.to_html(e.selectSportTemplate,n);e.$el.find("#sports-info").prepend(s)}else e.$el.find("#sports-info").html("")}var e=this,t=new l({collection:this.sports}),n=this.addChildView(t);this.childViews.sportListView=t,this.callbacks.add(function(){n()}),g("teamsports:fetch").subscribe(r)},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},getName:function(){var e=this.model.get("payload").org_name;return this.model.get("payload").complevels_obj.complevel_name&&(e+=" | "+this.model.get("payload").complevels_obj.complevel_name),this.model.get("payload").org_sport_link_obj.sport.sport_name&&(e+=" | "+this.model.get("payload").org_sport_link_obj.sport.sport_name),this.model.get("payload").seasons_obj.season_name&&(e+=" | "+this.model.get("payload").seasons_obj.season_name),this.model.get("payload").year&&(e+=" | "+this.model.get("payload").year),e},openEditPopup:function(){if(!this.checkForUser()){routing.trigger("showSignup");return}var e={height:"500px",width:"500px",html:'<div id="editTeamForm"></div>',title:"Edit Organization Info"};routing.trigger("common-popup-open",e),this.drawEditTeamForm()},drawEditTeamForm:function(){var e=this,t=e.model.get("payload").org_sport_link_obj.org,n=t.locations,r=new v({orgname:{form_values:{defaultValue:t.name,post_to_server:!0,serverDbField:"name",serverKey:"name"},type:"Text",fieldClass:"",attr:{placeholder:"Event Name","class":"txt-org-name"},showLable:!0,label:"Organization Name"},Location:{form_values:{defaultValue:n.full_address,serverKey:"locations_id",post_to_server:!0,serverDbField:"locations_id"},longitude:n.lon,latitude:n.lat,locationId:n.id,type:"Location",label:"Location",validators:[{type:"required",message:'Please select location and click the "Verify Address" button'}]},users_id:{form_values:{serverKey:e.users_id,post_to_server:!0,value:e.user_id},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Save Changes"},showLable:!1,onSubmit:function(n){var r=i.commit();if(r)for(var s in r){var o=w("*[name="+s+"]"),u=o.position();o.parents(".common-modal #modalBody").animate({scrollTop:u.top},"500",function(){o.addClass("focus-error-animation"),setTimeout(function(){o.removeClass("focus-error-animation")},2e3)});break}else{if(e.formValues)var f=e.formValues.getFormValues();else var f=i.getValue();var f=e.formValues.getFormValues(),l=e,c=new a({id:t.id});console.log(c),c.set({locations_id:f.locations_id,name:f.name}),c.save({}),w.when(c.request).done(function(t){e.updateHeaderData(l.model.id),routing.trigger("common-popup-close")}),w.when(c.request).fail(function(t){var n=JSON.parse(t.responseText),r=n.exec_data.error_array;e.formValues.showServersErrors(r)})}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel","class":"cancel-btn"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},w("#editTeamForm")),i=r.form;this.formValues=r.formValues},updateHeaderData:function(e){var t=this;t.model.id=e,t.model.fetch(),w.when(t.model.request).done(function(){t.render()})},childViews:{},render:function(e,t,n){document.title=this.getName(),f.prototype.render.call(this,e,t,n)}}),r}),define("team/views/add-media",["require","text!media/templates/add-media.html","profile/models/addmedia","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=r._;return n=s.extend({template:t,tagName:"div",id:"add-media",events:{"click #addPhoto":"openAddImagePopup","click #addVideo":"openAddvideoPopup","click #addGame":"openAddGamePopup","mouseover a":"showText","mouseout a":"showicon"},showText:function(e){$(e.target).parent().find("span").removeClass("hide")},showicon:function(e){$(e.target).parent().find("span").addClass("hide")},setOptions:function(e){if(!this.model)throw new Error("ProfileAddMediaView expects option with model property.");this.model.userid=e.userid},afterRender:function(){var e=this;$ele=this.$el.find(".character-limit-h"),$ele.each(function(){e.adJustFontDynamically($(this))})},openAddGamePopup:function(){routing.trigger("add-game",this.model.userid)},openAddImagePopup:function(e){var t=$("#sports-h").val(),n=$("#team-h").val(),r="/api/team/addimage/"+n,r="/api/team/addimage/"+n,i={sports_id:t};routing.trigger("add-image",r,i)},openAddvideoPopup:function(e){var t="/api/user/addvideo/"+this.model.id;Channel("add-video").publish(t)}}),n}),define("text!sportorg/templates/competitorteam-item.html",[],function(){return'\r\n{{#payload}}\r\n    <h3>{{name}}</h3>\r\n    <img src="{{picture}}" alt="{{name}}"/><br/>\r\n    {{sport}}<br/>\r\n    {{complevel}}<br/>\r\n    {{season}}<br/>\r\n    <br/><br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/competitorteam-item",["vendor","views","utils","text!sportorg/templates/competitorteam-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"team",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/competitorteam-list",["facade","views","utils","sportorg/views/competitorteam-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"team-list",name:"Team List",tagName:"ul",_tagName:"li",_className:"team",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CompetitorTeamListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/views/commentof-list",["facade","utils","site/views/comment-list"],function(e,t,n){var r;return r=n.extend({name:"team Commentof List",setupFormView:function(){}}),r}),define("team/views/commenton-form",["require","text!site/templates/comment-form.html","profile/models/commentonform","site/views/comment-form","models/base","views"],function(e,t,n,r,i){var s,o=e("views"),u=o.BaseView;return s=u.extend({initialize:function(e){this.$el.unbind(),_.bindAll(this),this.setOptions(),u.prototype.initialize.call(this,e)},el:"#comment_div",template:t,name:"Comment Form",events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox"},setOptions:function(e){if(!this.collection)throw new Error("ProfileCommentOnFormView expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(){var e=this.$el.find(".add-comment-form-h");console.log(e),e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")},refreshComments:function(e){this.$("#new-comment").val("")},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=this.model.get("id");var s=new i(r);s.url=function(){return debug.log(n),_.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/comment/add/":"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.trigger("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return u.prototype.render.call(this),this.input=this.$("#new-comment"),this.collection.length||$(".add-comment-h").trigger("click"),this}}),s}),define("team/views/commenton-list",["facade","utils","site/views/comment-list","team/views/commenton-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),e.name&&(this.name=e.name),this.options.collection=this.collection,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function i(e){console.log("Comments callback",e.user_pic_small),t.model=e,t.render()}function s(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){i(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){s(e)})}}),s}),define("text!sportorg/templates/roster-item.html",[],function(){return'\r\n{{#payload}}\r\n    <img src="{{user_picture}}" alt="{{name}}"/><br/>\r\n    {{name}} \'{{grad_year}}<br/>\r\n    {{sport_name}}<br/>\r\n    {{position}}<br/>\r\n    {{team_name}}<br/>\r\n    {{num_votes}} Votes<br/>\r\n    {{num_followers}} Followers<br/>\r\n{{/payload}}\r\n\r\n'}),define("sportorg/views/roster-item",["vendor","views","utils","text!sportorg/templates/roster-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"roster",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this}}),i}),define("sportorg/views/roster-list",["facade","views","utils","sportorg/views/roster-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"roster-list",name:"Roster List",tagName:"ul",_tagName:"li",_className:"roster",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("RosterListView expected options.collection.");u.bindAll(this),this.addSubscribers()}}),i}),define("team/models/addvideo",["facade","media/models/video","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/addvideo/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/addvideo?team_id="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamaddvideo:fetch").publish(e)}}),r}),define("team/views/add-video",["require","team/models/addvideo","media/views/add-video"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("TeamAddVideoView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/video-list",["facade","utils","media/views/video-list","team/views/add-video"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("teamaddvideo:fetch").subscribe(i)}}),i}),define("team/models/addimage",["facade","media/models/image","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/addimage/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/addimage?team_id="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamaddimage:fetch").publish(e)}}),r}),define("team/views/add-image",["require","team/models/addimage","media/views/add-image"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("AddImageView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/image-list",["facade","utils","media/views/image-list","team/views/add-image"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupAddView:function(){function i(n){t.model=n,t.render(),e.$el.append(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),s("teamaddimage:fetch").subscribe(i)}}),i}),define("team/models/commentform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/team/comments/"+this.id+"/"+this.sport_id+"/"+this.complevel_id+"/"+this.season_id:"/api/team/comments/"+this.id+"?id1="+this.id+"&sport_id="+this.sport_id+"&complevel_id="+this.complevel_id+"&season_id="+this.season_id},initialize:function(e,n){t.prototype.initialize.call(e,n),this.sport_id=e.sport_id,this.complevel_id=e.complevel_id,this.season_id=e.season_id},fetchSuccess:function(e,n){t.prototype.fetchSuccess.call(this,e,n),s("teamcommentform:fetch").publish(e)}}),r}),define("team/views/comment-form",["require","team/models/commentform","site/views/comment-form"],function(e,t,n){var r;return r=n.extend({setOptions:function(e){if(!this.collection)throw new Error("CommentFormView expected options.collection.");this.model||(this.model=new t({id:this.collection.id,sport_id:this.collection.sport_id,complevel_id:this.collection.complevel_id,season_id:this.collection.season_id}),this.model.fetch())}}),r}),define("team/views/comment-list",["facade","utils","site/views/comment-list","team/views/comment-form"],function(e,t,n,r){var i,s=t.lib.Channel;return i=n.extend({setupFormView:function(){function i(n){t.model=n,t.render(),e.$el.prepend(t.el)}var e=this,t=new r({collection:this.collection}),n=this.addChildView(t);this.callbacks.add(function(){n()}),s("teamcommentform:fetch").subscribe(i)}}),i}),define("text!team/templates/menu.html",[],function(){return'<div id="sports-info">\r\n	<div class="sports-h drop-down-main-outer"></div>\r\n	<div class="season-h drop-down-main-outer"></div>\r\n	<div class="team-h drop-down-main-outer"></div>\r\n</div>\r\n'}),define("team/views/menu",["require","text!team/templates/menu.html","text!team/templates/sport-select.html","team/models/basics","facade","views","utils","vendor","team/collections/sports","team/views/sport-list","usercontrol/dropdown/view/dropdown","team/collections/seasonteams","team/collections/complevels"],function(e,t,n){var r=e("facade"),s=e("views"),o=e("team/models/basics"),u=s.SectionView,a=e("team/views/sport-list"),f=e("team/collections/sports"),l=e("usercontrol/dropdown/view/dropdown"),c=e("team/collections/seasonteams"),h=e("team/collections/complevels"),p=e("utils"),d=p.lib.Channel,v=e("vendor"),m=v.Mustache,g=r.$,y=r._;return u.extend({template:t,selectSportTemplate:n,events:{},initialize:function(e){this.headerView=e.headerView,u.prototype.initialize.call(this,e),this.initSportList()},selectSport:function(e){self.select_sport=self.$("#select-sport");var t=this.select_sport.val()},updateHeaderData:function(e){this.model.id!=e&&this.headerView.updateHeaderData(e)},getTeam:function(){var e=this;this.season=new c,this.season.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.season.sport_id=g("#sports-h").val(),this.season.complevel_id=g("#season-h").val(),this.season.fetch(),g.when(this.season.request).done(function(){var t={};t.records=e.season.toJSON(),t.recordId="id",t.recordValue="season_label";var n=new l({data:t,title:"Team",elementId:"team-h",destination:".team-h",selectedValue:e.model.id,targetView:e,callback:function(t){e.updateHeaderData(g("#team-h").val()),e.showAllTeamData()}})})},showAllTeamData:function(){routing.trigger("refresh-teampage",g("#sports-h").val(),g("#team-h").val(),this.season.id)},getComplevels:function(){var e=this;this.complevel=new h,this.complevel.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.complevel.sport_id=g("#sports-h").val(),this.complevel.fetch(),g.when(this.complevel.request).done(function(){var t={};t.records=e.complevel.toJSON(),t.recordId="complevel_id",t.recordValue="complevel_name";var n=new l({data:t,title:"Season",elementId:"season-h",destination:".season-h",selectedValue:e.model.get("payload").complevels_obj.complevel_id,targetView:e,callback:function(t){e.getTeam()}})})},initSportList:function(){var e=this;this.sports=new f,this.sports.id=this.model.get("payload").org_sport_link_obj.orgs_id,this.sports.fetch(),g.when(this.sports.request).done(function(){var t={};t.records=e.sports.toJSON(),t.recordId="sport_id",t.recordValue="sport_name";var n=new l({data:t,elementId:"sports-h",title:"Sport",selectedValue:e.model.get("payload").org_sport_link_obj.sports_id,destination:".sports-h",targetView:e,callback:function(t){e.getComplevels()}})})},insertOption:function(e,t){var n="",r=t.length;for(var i=0;i<r;i++)n+='<option value="'+t[i].payload.sport_id+'">'+t[i].payload.sport_name+"</option>";e.html(n)},setupSportListView:function(){function r(){t.render(),e.$el.find("#sports-info").html(t.el);var n={payload:[]},r=t.collection;if(r.length){for(i=0;i<r.length;i++)n.payload[i]=r.at(i).get("payload");var s=m.to_html(e.selectSportTemplate,n);e.$el.find("#sports-info").prepend(s)}else e.$el.find("#sports-info").html("")}var e=this,t=new a({collection:this.sports}),n=this.addChildView(t);this.childViews.sportListView=t,this.callbacks.add(function(){n()}),d("teamsports:fetch").subscribe(r)},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},childViews:{},render:function(e,t,n){u.prototype.render.call(this,e,t,n)}})}),define("team",["require","text!team/templates/layout.html","votes/views/vote","facade","controller","models","views","utils","team/models/basics","team/models/addmedia","team/collections/upcoming_schedules","team/collections/recent_schedules","team/collections/competitor_teams","team/collections/rosters","team/collections/videos","team/collections/images","team/collections/comments","profile/collections/commentsof","team/collections/commentson","team/collections/orgs","team/collections/fans","team/views/header","team/views/add-media","sportorg/views/competitorteam-list","team/views/commentof-list","team/views/commenton-list","sportorg/views/roster-list","team/views/video-list","team/views/image-list","team/views/comment-list","team/views/menu","media/models/image","schedules/views/schedule-list","roster/views/roster","profile/views/fans-image-list","common/views/add-media-buttons","text!common/templates/add-media-buttons.html","text!common/templates/add-fans-buttons.html","text!common/templates/add-games-buttons.html","votes/views/vote"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("team/models/basics"),l=e("team/models/addmedia"),c=e("team/collections/upcoming_schedules"),h=e("team/collections/recent_schedules"),p=e("team/collections/competitor_teams"),d=e("team/collections/orgs"),v=e("team/collections/videos"),m=e("team/collections/images"),g=e("team/collections/fans"),y=e("team/collections/comments"),b=e("profile/collections/commentsof"),w=e("team/collections/commentson"),E=e("team/views/header"),S=e("team/views/add-media"),x=e("schedules/views/schedule-list"),T=e("sportorg/views/competitorteam-list"),N=e("team/views/video-list"),C=e("team/views/image-list"),k=e("sportorg/views/teamroster-list"),L=e("team/views/comment-list"),A=e("team/views/commentof-list"),O=e("team/views/commenton-list"),M=e("profile/views/fans-image-list"),_=e("team/views/menu"),D=e("roster/views/roster"),P=e("media/models/image"),H=e("votes/views/vote"),B=e("common/views/add-media-buttons"),j=e("text!common/templates/add-media-buttons.html"),F=e("text!common/templates/add-fans-buttons.html"),I=e("text!common/templates/add-games-buttons.html"),q=u.LayoutView,R=i.$,U=i._,z=a.debug,W=a.lib.Channel,X=["/pages/team/team.css"];return r=s.extend({initialize:function(e){var t=this;return W("load:css").publish(X),U.bindAll(t),this.scheme=[],this.handleOptions(e),e.params&&this.setParamsArray(e.params),this.init(),this},handleOptions:function(e){this.id=e.teamId,this.userId=e.userId},init:function(){this.setupLayout().render(),this.createData(),this.handleDeferreds()},createData:function(){function t(t,n,r){if(e.ajaxCalls&&e.ajaxCalls.length){for(var i in e.ajaxCalls)console.error("here"),e.ajaxCalls[i].abort();e.ajaxCalls=[]}e.refreshPage(),e.games=new d,e.games.id=n,e.games.sport_id=t,e.games.targetElement="#games_div",e.ajaxCalls.push(e.games.fetch()),e.images=new m,e.images.team_id=n,e.images.sport_id=t,e.images.targetElement="#image-wrap",e.ajaxCalls.push(e.images.fetch()),e.fans=new g,e.fans.id=n,e.fans.sport_id=t,e.fans.targetElement="#fans-div",e.ajaxCalls.push(e.fans.fetch());var s=e.basics.get("payload").enttypes_id;e.commentson=new w,e.commentson.subject_entity_type=s,e.commentson.savePath="/team/addcomment/"+n,e.commentson.id=n,e.commentson.targetElement="#comment_div",e.ajaxCalls.push(e.commentson.fetch()),e.handleDeferredsDynamic()}this.basics=new f({id:this.id}),this.basics.targetElement="#main",this.basics.fetch(),this.addmedia=new l,this.addmedia.id=this.id;var e=this;e.ajaxCalls=[],W("new-fan","unique").subscribe(this.refreshFansPage),routing.on("refresh-teampage",function(e,n,r){t(e,n,r)})},refreshFansPage:function(){var e,t=this;this.fansListView&&(R(this.fansListView.destination).html(""),e=R.inArray(this.fansListView,this.scheme),~e&&this.scheme.splice(e,1),this.fans=new g,this.fans.id=this.id,this.fans.sport_id=R("#sports-h").val(),this.fans.targetElement="#fans-div",this.ajaxCalls.push(this.fans.fetch()),R.when(this.fans.request).done(function(e){t.setupFansListView()}))},reloadFans:function(){this.refreshFansPage()},handleDeferreds:function(){var e=this;R.when(this.basics.request).done(function(){e.setupHeaderView(),e.setupRosterView(),e.userId&&e.setUpVoteView()})},setupCommentOfListView:function(){var e;e=new A({collection:this.commentsof,destination:".commentsoff-outer-box-h",name:"team comments off view"})},deleteOldView:function(e){var t=this.scheme.length;for(var n=0;n<t;n++)this.scheme[n].name==e&&this.scheme[n].remove()},setupRosterView:function(e,t){if(!e&&!t)var n=this.basics.get("payload"),e=n.id,t=n.org_sport_link_obj.org.name;this.oldRosterViewName&&this.deleteOldView(this.oldRosterViewName),this.oldRosterViewName="roster images"+Math.random();var r,s=i.Backbone.Collection.extend({});r=new D({model:new s,team_id:e,entityId:this.basics.get("payload").enttypes_id,team_name:t,controllerObject:this,name:this.oldRosterViewName,destination:"#roster-wrap",teamName:this.basics.get("payload").team_name}),this.scheme.push(r),this.layout.render()},setupCommentOnListView:function(){this.commentOnListView=new O({collection:this.commentson,destination:".commentson-outer-box-h",name:"team comments on view "}),this.scheme.push(this.commentOnListView),this.layout.render()},showVote:function(){var e;this.votesView&&(R(this.votesView.destination).unbind().html(""),e=R.inArray(this.votesView,this.scheme),~e&&this.scheme.splice(e,1),this.setUpVoteView())},refreshPage:function(){var e;this.commentOnListView&&(this.commentOnListView.unbind().remove(),R(this.commentOnListView.destination).unbind().html(""),e=R.inArray(this.commentOnListView,this.scheme),~e&&this.scheme.splice(e,1)),this.gamesView&&(R(this.gamesView.destination).html(""),e=R.inArray(this.gamesView,this.scheme),~e&&this.scheme.splice(e,1)),this.fansListView&&(R(this.fansListView.destination).html(""),e=R.inArray(this.fansListView,this.scheme),~e&&this.scheme.splice(e,1)),this.imageListView&&(R(this.imageListView.destination).html(""),e=R.inArray(this.imageListView,this.scheme),~e&&this.scheme.splice(e,1))},handleDeferredsDynamic:function(){var e=this;R.when(e.commentson.request).done(function(){e.setupCommentOnListView()}),R.when(e.games.request).done(function(){e.setupGameView()}),R.when(e.fans.request).done(function(t){e.setupFansListView()}),R.when(this.images.request).done(function(){e.setupImages()})},setupFansListView:function(){this.addmedia.teamName=this.basics.get("payload").team_name,this.addmedia.setData();var e=new B({target:".fans-add-icons-h",heading:"FANS",template:F,controllerObject:this,collection:this.fans,model:this.addmedia,teamName:this.addmedia.teamName,inviteData:{invite_type:"follow",subject_id:this.basics.get("payload").id,enttypes_id:this.basics.get("payload").enttypes_id}});this.fansListView=new M({collection:this.fans,destination:"#fans-div",controllerObject:this,pageName:"team",target_id:this.id,data:this.basics.toJSON(),name:"fansView",teamName:this.addmedia.teamName}),this.scheme.push(this.fansListView),this.layout.render()},setupHeaderView:function(){var e,t=this;e=new E({model:this.basics,name:"Header",controllerObject:t,destination:"#main-header"});var n=new _({model:this.basics,name:"Menu View",headerView:e,controllerObject:t,destination:"#menu-container"});this.scheme.push(n),this.scheme.push(e),this.layout.render()},setupAddMediaView:function(e){var t;this.addMediaView&&(R(this.addMediaView.destination).html(""),t=R.inArray(this.addMediaView,this.scheme),~t&&this.scheme.splice(t,1)),this.addmedia.teamName=this.basics.get("payload").team_name,this.addmedia.setData(),this.addMediaView=new S({model:this.addmedia,team_id:this.basics.id,name:"Add_Media",destination:e}),this.scheme.push(this.addMediaView),this.layout.render()},setUpVoteView:function(){this.votesView=new H({model:this.basics,id:this.id,destination:"#votes-area-h",name:"votes_view"}),this.scheme.push(this.votesView),this.layout.render()},setupUpcomingSchedules:function(){var e;e=TeamScheduleListView.extend({name:"Upcoming_Schedule_List"}),this.upcomingScheduleListView=new e({collection:this.upcoming_schedules,destination:"#upcoming-schedule",name:"upcoming_schedule"}),this.scheme.push(this.upcomingScheduleListView),this.layout.render()},setupRecentSchedules:function(){var e;e=TeamScheduleListView.extend({name:"Recent_Schedule_List"}),this.recentScheduleListView=new e({collection:this.recent_schedules,destination:"#recent-schedule",name:"recent_schedule"}),this.scheme.push(this.recentScheduleListView),this.layout.render()},getOrgData:function(){var e,t=this;this.gamesView&&(R(this.gamesView.destination).html(""),e=R.inArray(this.gamesView,this.scheme),~e&&this.scheme.splice(e,1)),t.games.fetch(),R.when(t.games.request).done(function(){t.setupGameView()})},setupGameView:function(){var e=this.basics.get("payload");this.addmedia.teamName=this.basics.get("payload").team_name,this.addmedia.setData();var t=new B({target:".games-add-icons-h",heading:"GAMES",template:I,model:this.addmedia,teamName:this.addmedia.teamName});if(e.org_sport_link_obj.sport.sport_type_id!="2"){R(".game-green-heading").removeClass("hide");var n=x.extend({tagName:"div"});this.gamesView=new n({teams_id:this.id,controller:this,collection:this.games,destination:"#games_div",teamRecords:!0,teamName:this.addmedia.teamName}),this.scheme.push(this.gamesView),this.layout.render()}},setupCompetitorTeams:function(){this.competitorTeamListView=new T({collection:this.competitor_teams,destination:"#competitor-teams",name:"competitor_teams"}),this.scheme.push(this.competitorTeamListView),this.layout.render()},setupRosters:function(){this.rosterListView=new k({collection:this.rosters,destination:"#roster-wrap",name:"roster_wrap"}),this.scheme.push(this.rosterListView),this.layout.render()},setupVideos:function(){this.videoListView=new N({collection:this.videos,destination:"#video-wrap",name:"video_wrap"}),this.scheme.push(this.videoListView),this.layout.render()},initVoteView:function(){var e=new n({name:"vote View",destination:"#votes-area-h",model:this.basics,userId:this.id});this.scheme.push(e),this.layout.render()},setupImages:function(e){var t=this;this.addmedia.teamName=this.basics.get("payload").team_name,this.addmedia.setData();var n=new B({target:".media-add-icons-h",heading:"PHOTO/VIDEO",template:j,page_base:"team",ent_id:t.id,sports_id:R("#sports-h").val(),controllerObject:t,model:t.addmedia,teamName:this.addmedia.teamName});routing.off("image-upload-success"),routing.on("image-upload-success",function(e){t.updateImages(e)}),routing.off("setup-add-icons"),routing.on("setup-add-icons",function(e){t.setupAddMediaView(e)}),this.imageListView=new C({collection:this.images,destination:"#image-wrap",target_id:this.id,target_url:"/api/team/addimage/",sport_id:R("#sports-h").val(),name:"image_wrap ",user_id:this.userId,media_id:this.media_id,pageName:"team",triggerItem:"setup-add-icons",teamName:t.addmedia.teamName}),this.scheme.push(this.imageListView),this.layout.render()},reloadImages:function(){var e=this,t;this.imageListView&&(R(this.imageListView.destination).html(""),t=R.inArray(this.imageListView,this.scheme),~t&&this.scheme.splice(t,1)),e.images.fetch(),R.when(e.images.request).done(function(){e.setupImages()})},updateImages:function(e){var t=new P;t.processItemFromPayload(e),t.selectImageType(this.imageListView.imagetype),this.imageListView.collection.add(t),this.imageListView.allData&&this.imageListView.allData.push(t.toJSON()),this.imageListView.collection.length==1&&this.reloadImages()},setupComments:function(){this.commentListView=new L({collection:this.comments,destination:"#comment-wrap",name:"comment_wrap"}),this.scheme.push(this.commentListView),this.layout.render()},setupLayout:function(){var e;return e=new q({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout}}),r}),define("text!profilesetting/templates/layout.html",[],function(){return'<div class="span12 main-container">\r\n	<div id="main-header-prof-setting" class="profile-header"></div>\r\n\r\n	<!-- Basic Info Section Starts-->\r\n	<div class="row-fluid" id="section-basics-prof-setting"></div>\r\n	<!-- Basic Info Section Ends-->\r\n\r\n	<!-- Team Info Section Starts-->\r\n	<div class="row-fluid section-teams-prof-setting">\r\n\r\n\r\n		<!--Club Info Section Starts-->\r\n		<div id="section-club-prof-setting" class="row-fluid sub-section-prof-setting">\r\n			<div id="content-club-prof-setting">\r\n			</div>\r\n			<br/>\r\n\r\n		</div>\r\n		<!--Club Info Section Ends-->\r\n\r\n\r\n		<!-- High School Section Starts-->\r\n		<div id="section-school-prof-setting" class="row-fluid sub-section-prof-setting">\r\n\r\n			<div id="content-school-prof-setting">\r\n			</div>\r\n			<br/>\r\n\r\n		</div>\r\n		<!-- High School Section Ends-->\r\n\r\n\r\n\r\n		<!--Individual Sports Section Starts-->\r\n		<div id="section-individual-prof-setting">\r\n\r\n		</div>\r\n		<!--Individual Sports Section Ends-->\r\n	</div>\r\n	<!-- Team Info Section Ends-->\r\n\r\n	<div id="main-footer-prof-setting">\r\n\r\n	</div>\r\n</div>\r\n'}),define("profilesetting/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("text!profilesetting/templates/basic_info_header.html",[],function(){return'{{#payload}}\r\n<div class="span4 profile-image">\r\n	<img id="img-profile-prof-setting" src="{{user_picture_obj.types.large_thumb.url}}" />\r\n	<a href="javascript:void(0);" id="change_user_pic">Change User Picture</a>\r\n</div>\r\n<div class="two-column-form mt20" id="user_profile_data"></div>\r\n{{/payload}}\r\n\r\n	<!--div id="edit_profile_info_section">\r\n		<div>\r\n			<span>Name: </span>\r\n			<input type="text" id="txt_user_name" model-property="name" value="{{name}}" />\r\n		</div>\r\n		<div>\r\n			<span>Height (in):</span>\r\n			<input type="text" id="txt_user_height" model-property="height_in" value="{{height_in}}" />\r\n		</div>\r\n		<div>\r\n			<span>Weight (lbs)</span>\r\n			<input type="text" id="txt_user_weight" model-property="weight_lb" value="{{weight_lb}}" />\r\n		</div>\r\n		<div style="font-size: .8em; font-weight: bolder;">\r\n			Change Password\r\n		</div>\r\n		<div>\r\n			<span>New</span>\r\n			<input type="password" id="txt_new_password" model-property="password" placeholder="New Password" />\r\n		</div>\r\n		<div>\r\n			<span>Again</span>\r\n			<input type="password" id="txt_re_new_password" model-property="re_password" placeholder="New Password Again" />\r\n		</div>\r\n		<a href="javascript:void(0);" class="resume_button" id="save_user_data">Save</a>\r\n	</div-->'}),define("text!profilesetting/templates/basic_info_header_edit.html",[],function(){return'{{#payload}}\r\n		<div id="edit_profile_info_section">\r\n			<div><span>Name: </span><input type="text" id="txt_user_name" model-property="name" value="{{name}}" /></div>\r\n			<div><span>Height (in):</span><input type="text" id="txt_user_height" model-property="height_in" value="{{height_in}}" /></div>\r\n			<div><span>Weight (lbs)</span><input type="text" id="txt_user_weight" model-property="weight_lb" value="{{weight_lb}}" /></div>\r\n			<div style="font-size: .8em; font-weight: bolder;">Change Password</div>\r\n			<!--<div><span>Current</span><input type="password" id="txt_current_password" model-property="current_password"  placeholder="Current Password" /></div>-->\r\n\r\n			<div><span>New</span><input type="password" id="txt_new_password" model-property="password" placeholder="New Password" /></div>\r\n			<div><span>Again</span><input type="password" id="txt_re_new_password" model-property="re_password" placeholder="New Password Again" /></div>\r\n			<a href="javascript:void(0);" class="resume_button" id="save_user_data">Save</a>\r\n		</div>\r\n{{/payload}}'}),define("text!profilesetting/templates/basic_info_header_completed.html",[],function(){return'{{#payload}}\r\n	<h2 id="user_name">{{first_name}} {{last_name}}</h2>\r\n	<p id="user_height">\r\n		{{#height_in}} {{height_in}} INCHES{{/height_in}}\r\n	</p>\r\n	<p id="user_weight">\r\n		{{#weight_lb}}{{weight_lb}} LBS{{/weight_lb}}\r\n	</p>\r\n	<div class="resume_button" id="edit_profile_info">Edit Basic User Info</div>\r\n\r\n{{/payload}}'}),define("text!usercontrols/imagecropper/templates/layout.html",[],function(){return'<iframe id="cropper_iframe"></iframe>'}),define("usercontrols/imagecropper/imagecropper",["require","text!usercontrols/imagecropper/templates/layout.html","facade","controller","views"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("views"),o=e("utils"),u=r.$,a=r._,f=o.lib.Channel,l=s.LayoutView;return n=i.extend({cssArr:["/usercontrols/imagecropper/imagecropper.css"],events:{"click button.close":"alertsomething"},initialize:function(e){console.log("init");var t=this;f("load:css").publish(this.cssArr),a.bindAll(this),console.log(e),this.image_o=e.image_o?e.image_o:"",this.image_e=e.image_e?e.image_e:"",this.modelHTML='<div id="modalPopup" class="modal imagecropper hide fade model-popup-h"><div class="modal-header"><span>Athletez Profile Pic Editor</span><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></div><div class="modal-body page-content-h"></div></div>',this.setupLayout().render(),this.handleDeferreds()},handleDeferreds:function(){},setupLayout:function(){var e=this;this.scheme=[];var t="/vendor/plugins/iedit2/index.html?vh=500&vw=500&sx=0&sy=0&sz=100&t=Profile%20Picture&edit=";this.image_e!=""&&(t+="&edit="+this.image_e),this.image_o!=""&&(t+="&o="+this.image_o);var n={};return n.width="100%",n.height="100%",n.title="Change your Athletez Photo",n.html='<iframe src="'+t+'" id="cropper_iframe" style="width:100%;height:100%;margin:0;"></iframe>',n.id="change-userpic-modal",n.addClass=["noBorder"],routing.trigger("common-popup-open",n),u("#"+n.id+" .close").bind("click",function(){e.notifyUpdate()}),this.layout},notifyUpdate:function(){f("userpic-changed").publish()}}),n}),define("profilesetting/views/basic_info",["require","text!profilesetting/templates/basic_info_header.html","text!profilesetting/templates/basic_info_header_edit.html","text!profilesetting/templates/basic_info_header_completed.html","profilesetting/models/basic_info","facade","views","utils","vendor","usercontrols/imagecropper/imagecropper","component/forms"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("profilesetting/models/basic_info"),a=o.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=s.$,d=e("usercontrols/imagecropper/imagecropper"),v=e("component/forms");return i=a.extend({id:"basic_info",template:t,events:{"click .btn-prof-setting-h":"initialize","click #edit_profile_info":"editProfile","click #change_user_pic":"changeUserpic","click #save_user_data":"saveProfileBasics"},initialize:function(e){e.name&&a.prototype.initialize.call(this,e),this.initBasicView()},render:function(){a.prototype.render.call(this)},generateForm:function(){var e=this,t=new v({name:{form_values:{post_to_server:!0,serverKey:"name",serverDbField:"name",value:e.basicInfoModel.get("payload").name},type:"Text",attr:{placeholder:"Name","class":""},label:"Name"},Height:{form_values:{post_to_server:!0,serverKey:"height_in",serverDbField:"height",value:e.basicInfoModel.get("payload").height_in},type:"Text",attr:{placeholder:"Height","class":""},label:"Height (in)"},Weight:{form_values:{post_to_server:!0,serverKey:"weight_lb",serverDbField:"weight",value:e.basicInfoModel.get("payload").weight_lb},type:"Text",attr:{placeholder:"Weight","class":""},label:"Weight (lbs)"},Password:{form_values:{post_to_server:!0,serverKey:"password",serverDbField:"password"},type:"Password",attr:{placeholder:"New Passord","class":""},label:"New"},Again:{form_values:{post_to_server:!0,serverKey:"re_password",serverDbField:"re_password"},type:"Password",attr:{placeholder:"New Password Again"},label:"Again"},submit:{type:"Submit",fieldClass:"button-field",form_values:{post_to_server:!1},attr:{value:"Save","class":"resume_button"},showLable:!1,onSubmit:function(t){var r=n.commit();if(r)for(var i in r);else{if(e.formValues)var s=e.formValues.getFormValues();else var s=n.getValue();var s=e.formValues.getFormValues();e.saveProfileBasics(s)}}}},p("#user_profile_data")),n=t.form;this.formValues=t.formValues},initBasicView:function(){var e=this;this.basicInfoModel=new u,this.basicInfoModel.fetch(),p.when(this.basicInfoModel.request).done(function(){e.basicInfoModel.set("id",e.basicInfoModel.get("payload").id),e.setupBasicView(),e.generateForm()})},setupBasicView:function(){console.log("called");var e=this,t=h.to_html(e.template,this.basicInfoModel.toJSON());p("#section-basics-prof-setting").html(t),p("#change_user_pic").bind("click",function(){e.changeUserpic()}),p("#edit_profile_info").bind("click",function(){e.editProfile()}),p("#save_user_data").bind("click",function(){e.saveProfileBasics()})},setOptions:function(e){if(!this.model)throw new Error("HeaderView expects option with model property.")},editProfile:function(){p("#user_profile_data").html(""),this.generateForm()},saveProfileBasics:function(e){var t=this,n={};e?n=e:p("div#user_profile_data").find("input").each(function(){n[p(this).attr("model-property")]=p(this).val()}),this.basicInfoModel.save(n,{success:function(){var e=h.to_html(r,t.basicInfoModel.toJSON());p("div#user_profile_data").html(e),p("#edit_profile_info").bind("click",function(){t.editProfile()})},error:function(e,n){var r=JSON.parse(n.responseText),i=r.exec_data.error_array;t.formValues.showServersErrors(i)}})},changeUserpic:function(){var e=this.basicInfoModel.get("payload");l("userpic-changed").subscribe(function(){t.initBasicView()});var t=this,n=new d({image_o:e.user_picture_obj.pre_crop_url,image_e:e.user_picture_obj.image_path})}}),i}),define("text!profilesetting/templates/highschool.html",[],function(){return'<div class="row-fluid">\r\n	<span class="green-left-heading">School Teams</span>\r\n</div>\r\n<div id="btn-Add-School" class="clearfix div-add-dotted">\r\n	+ Add a school\r\n</div>\r\n<div id="section-Add-Sports-school" class="displayNone add-org-fields">\r\n	<div>\r\n		<span class="span2">What State?</span>\r\n		<input type="text" id="txt-school-state" placeholder="Just Start Typing"/>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n\r\n	<div>\r\n		<span class="span2">What School?</span>\r\n		<input type="text" id="txt-school-school" placeholder="Just Start Typing" disabled="disabled"/>\r\n		<a class="add-school-h" href="javascript: void(0);">Couldn\'t Find your School?</a>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n	<div class="div-sports-wrapper displayNone">\r\n		<div id="def-school-sports-section" class="school-sports-section">\r\n\r\n		</div>\r\n		<!--<span class="floatLeft"><a href="javascript:void(0)" class=" well-small btn-add-sports" >Add Sports</a> </span>-->\r\n	</div>\r\n<!-- <span class="floatRight"><a href="javascript:void(0)" class=" well-small btn-primary btn-finish-addsports" >Finish</a> </span> -->\r\n</div>\r\n<!--SCHOOL LISTING SECTION HERE-->\r\n<!--lIST-->\r\n<div class="row-fluid section-team-list-detail">\r\n\r\n</div>\r\n\r\n<!--lIST-->\r\n'}),define("text!profilesetting/templates/club.html",[],function(){return'<div class="row-fluid">\r\n	<span class="green-left-heading">Club Teams and Affiliations</span>\r\n</div>\r\n<div id="btn-Add-club" class="div-add-dotted">\r\n	+ Add a Club\r\n</div>\r\n<div id="section-Add-Sports-club" class="displayNone add-org-fields">\r\n<div>\r\n	<span class="span2">What State?</span>\r\n	<input type="text" id="txt-club-state" placeholder="Just Start Typing" tabindex="0"/>\r\n	<p class="field-error"></p>\r\n	<p class="field-message"></p>\r\n</div>\r\n\r\n<div>\r\n	<span class="span2">Club Name</span>\r\n	<input type="text" id="txt-club-club" placeholder="Just Start Typing" disabled="disabled"/>\r\n	<a class="add-club-h" href="javascript: void(0);">Couldn\'t Find your Club?</a>\r\n	<p class="field-error"></p>\r\n	<p class="field-message"></p>\r\n</div>\r\n<div class="div-sports-wrapper displayNone">\r\n	<div id="def-club-sports-section" class="school-sports-section">\r\n\r\n	</div>\r\n	<!--<span class="floatLeft"><a href="javascript:void(0)" class="btn-add-sports" >Add Sports</a> </span>-->\r\n</div>\r\n<!--<span class="floatRight"><a href="javascript:void(0)" class=" well-small btn-primary" >Save</a> </span> -->\r\n</div>\r\n<!--CLUBs LISTING SECTION HERE-->\r\n<!--lIST-->\r\n<div class="row-fluid section-team-list-detail-club">\r\n\r\n</div>\r\n'}),define("text!profilesetting/templates/sportslevel.html",[],function(){return'<div class="section-sportslevel">\r\n	<div class="select-sports-outer-h">\r\n		<span class="span2">What Sport?</span>\r\n		<!-- class="ddl-school-sports"-->\r\n		<select class="ddl-sports" orgsid="{{orgsId}}" tabindex="0">\r\n			<option value="">Select Sport</option>\r\n			{{#sports}}\r\n			<option value="{{sport_id}}">{{sport_name}}</option>\r\n			{{/sports}}\r\n		</select>\r\n\r\n		<p class="field-error"></p>\r\n\r\n		<p class="field-message"></p>\r\n\r\n		<span><a href="javascript:void(0)" class="btn-Remove-Sport" tabindex="0">Remove</a> </span>\r\n	</div>\r\n\r\n	<div class="clearfix inner-section">\r\n		<div class="sub-section-prof-setting">\r\n			<div>\r\n\r\n				<div class="spn-black-heading spn-sport-name">\r\n				</div>\r\n				<!--class="div-school-sports-level"-->\r\n				<div class="div-sports-level"></div>\r\n\r\n			</div>\r\n			<div class="">\r\n				<!--<span class="floatLeft"><a href="javascript:void(0)" class="btn-add-level" orgsid="{{orgsId}}" tabindex="0">Add Level</a> </span>-->\r\n				<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Cancel</a> </span>\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>'}),define("text!profilesetting/templates/level.html",[],function(){return'<div class="div-levels seasons-records">\r\n	{{#sport}}\r\n		<div class="org-sport-list-header">\r\n			<div class="sport-name"><img src="{{icon}}" />{{sports_name}}</div>\r\n		</div>\r\n	{{/sport}}\r\n	<div class="well-small span12">\r\n		<!-- class="ddl-school-complevel"-->\r\n		<select class="ddl-complevel" orgsid="{{orgsId}}" sportsid="{{sportsId}}">\r\n			<option value="">Select Level</option>\r\n			{{#levels}}\r\n			<option value="{{complevel_id}}">{{complevel_name}}</option>\r\n			{{/levels}}\r\n		</select>\r\n		<p class="field-error"></p>\r\n		<p class="field-message"></p>\r\n	</div>\r\n	<!-- id="div-school-seasons"-->\r\n	<div class="div-seasons complevels-wrapper displayNone">\r\n		<div class="arrow-container">\r\n			<a href="javascript:void(0)" class="down arrow up-arrow-h" title="up">&uarr;</a>\r\n		</div>\r\n		<div class="complevels-container">		\r\n			<div class="complevels-inner">\r\n				{{#Data}}\r\n					<div class="season-array">\r\n						<div class="year-label">{{year}}</div>\r\n						{{#seasons}}\r\n							<span class="single-season">\r\n								<input type="checkbox" class="chkSeasons chkSeasons-{{season_id}}-{{year}}" seasonId = \'{{season_id}}\' year=\'{{year}}\' orgsid="{{orgsId}}" sportsid="{{sportsId}}"/>\r\n								<label>&nbsp;{{season_name}} </label>\r\n								<!--<a href="javascript:void(0)" class="btnOpenPositions displayNone" disabled="disabled" >Positions main</a>-->\r\n							</span>\r\n						{{/seasons}}\r\n					</div>\r\n				{{/Data}}\r\n			</div>\r\n		</div>\r\n		<div class="arrow-container">\r\n			<a href="javascript:void(0)" class="down arrow down-arrow-h" title="down">&darr;</a>\r\n		</div>\r\n\r\n	</div>\r\n	\r\n	<!--	Modal Section to display positions	-->\r\n	<!--modal-school-positions-->\r\n<div class="modal hide fade position-modal modal-positions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n<div class="modal-header">\r\n<button type="button" class="close btn-Close-Positions" data-dismiss="modal" aria-hidden="true">×</button>\r\n<h3 id="myModalLabel">Positions</h3>\r\n</div>\r\n<div class="modal-body modal-position-body">\r\n	\r\n</div>\r\n<div class="modal-footer">\r\n<button class="btn btn-Close-Positions" data-dismiss="modal" aria-hidden="true">Finish</button>\r\n<!--<button class="btn btn-primary btn-Save-Positions">Finish</button> -->\r\n</div>\r\n</div>\r\n</div>\r\n'}),define("profilesetting/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("profilesetting/collections/schools",["facade","utils","sportorg/collections/orgs","sportorg/models/org"],function(e,t,n,r){var i;return i=n.extend({fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("profilesetting/collections/sports",["facade","sportorg/collections/sports_listall"],function(e,t){var n=t.extend({});return n}),define("text!profilesetting/templates/teamlist.html",[],function(){return'{{#orgs}}\r\n	<div class="div-sports-wrapper"  orgsId="{{org_id}}">\r\n		<div class="school-sports-section"></div>\r\n	</div>\r\n	<div class="org-sport-list">\r\n		<div class="org-sport-list-header">\r\n			<div class="org-name">{{org_name}}, {{city}}, {{state}}</div>\r\n			{{^single_sport_id}}\r\n			<div class="add-sport"><a class="btn-add-sports" href="javascript:void(0)" orgsId="{{org_id}}">Add Sport</a></div>\r\n			{{/single_sport_id}}\r\n		</div>\r\n		{{#sports}}\r\n\r\n			<div class="org-sport-list-header">\r\n				<div class="sport-name"><img src="{{icon}}" />{{sports_name}} - <a href="javascript:void(0)" class="edit-team"  orgsId="{{org_id}}" sportId="{{sports_id}}">Edit</a></div>\r\n			</div>\r\n\r\n			<div>\r\n				{{#complevels}}\r\n					{{#seasons}}\r\n				<a href="/#!team/{{team_id}}"><div class="season-list">\r\n						<span>{{complevel}}</span>\r\n						<span>{{season}} {{year}}</span>\r\n						<span>\r\n							{{#positions}}<span class="position-listing">{{name}}</span>{{/positions}}\r\n							{{^positions}}No Positions&nbsp;{{/positions}}\r\n						</span>\r\n				</div></a>\r\n					{{/seasons}}\r\n\r\n				{{/complevels}}\r\n			</div>\r\n\r\n\r\n		{{/sports}}</div>\r\n{{/orgs}}'}),define("profilesetting/collections/teams",["facade","utils","sportorg/collections/teams","sportorg/models/team"],function(e,t,n,r){var i;return i=n.extend({url:function(){var e=this;return testpath?testpath+" /api/user/orgs/"+e.user_id+"?groupby=complevel "+"&time="+(new Date).getTime():" /api/user/orgs/"+e.user_id+"?groupby=complevel&org_type="+e.org_type+"&time="+(new Date).getTime()},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},data:{user_id:self.user_id,sports_club:self.sports_club}}),i}),define("profilesetting/views/teams",["require","text!profilesetting/templates/teamlist.html","facade","views","utils","vendor","profilesetting/collections/teams"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("profilesetting/collections/teams"),p=o.extend({template:t,controls:{},messages:{dataNotExist:"You don't have any teams registered yet.  Why not do that now?",optionsMissing:"HeaderView expects option with model property."},initialize:function(e){var t=this;t.setOptions(e),t.render()},setOptions:function(e){var t=this;if(!e.user_id&&!e.destination)throw new Error("Parameters missing for Seasons View");this.destination=e.destination,this.user_id=e.user_id,this.sports_club=e.sports_club,this.el=e.destination,this.org_type=e.org_type},bindEvents:function(){},GetData:function(){var e=this,t={user_id:e.user_id,sports_club:this.sports_club},n=new h(t);n.user_id=e.user_id,n.sports_club=this.sports_club,n.org_type=this.org_type,e.teamFetchRequest=e.abortRequest(e.teamFetchRequest);var r=n.fetch();e.teamFetchRequest.push(r),c.when(n.request).done(function(){if(n.isError())return;var t=n.toJSON();if(t.length){var r=[];for(var i=0;i<t.length;i++)r.push(t[i].payload);console.error(r),e.Teams=t;var s=l.to_html(e.template,{orgs:r});c(e.el).html(s)}else c(e.el).html(e.messages.dataNotExist)})},render:function(){var e=this;e.GetData()}});return p}),define("profilesetting/models/complevel",["facade","sportorg/models/complevel"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/org/basics/"+this.orgs_id+"?id1="+this.orgs_id)},fetchSuccess:function(e,t){}}),n}),define("text!profilesetting/templates/season-item.html",[],function(){return'<div class="span12 well-small">\r\n	<a href="javascript:void(0)" class="down arrow">&uarr;</a>\r\n</div>\r\n{{#Data}}\r\n<div class="span12">\r\n	<span class="span3"><strong>{{year}}</strong></span>\r\n	{{#seasons}}\r\n	<span class="span3">\r\n		<input type="checkbox" class="chkSeasons" year=\'{{year}}\' seasonId = \'{{season_id}}\' />\r\n		<label>&nbsp;{{season_name}} </label>\r\n		<a href="javascript:void(0)" class="btnOpenPositions">Positions</a>\r\n		 </span>\r\n	{{/seasons}}\r\n</div>\r\n{{/Data}}\r\n<div class="span12 well-small">\r\n	<a href="javascript:void(0)" class="down arrow">&darr;</a>\r\n</div>'}),define("profilesetting/views/seasons",["require","text!profilesetting/templates/season-item.html","facade","views","utils","vendor","profilesetting/models/complevel"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,r=o.extend({template:t,events:{},controls:{chkSeasons:".chkSeasons"},messages:{dataNotExist:"You don't have any teams registered yet.  Why not do that now?",optionsMissing:"HeaderView expects option with model property."},properties:{show_prev_year:2},initialize:function(e){n=this,n.setOptions(e),n.render()},setOptions:function(e){if(!e.orgs_id||!e.user_id||!e.sport_id||!e.complevel_id)throw new Error("Parameters missing for Seasons View");this.destination=e.destination,this.collection=e.collection,this.sport_id=e.sports_id,this.org_id=e.orgs_id,this.user_id=e.user_id,this.complevel_id=e.complevel_id,this.el=e.destination,this.properties.show_prev_year=e.show_prev_year||this.properties.show_prev_year},bindEvents:function(){},GetData:function(e){var t=[],r=(new Date).getFullYear();for(var i=n.properties.show_prev_year;i>=0;i--){var s={year:r,seasons:e};t.push(s),r--}return{Data:t}},render:function(){var e=l.to_html(n.template,n.GetData(this.collection));c(n.destination).html(e)}});return r}),define("text!profilesetting/templates/positions.html",[],function(){return'{{#Data}}\r\n<span id="pos-{{id}}" class="span3 spn-position-title_h" positionId=\'{{id}}\'>{{name}} </span>\r\n{{/Data}}\r\n'}),define("sportorg/models/position",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,sport_name:null,stattab_id:0,stattab_name:null,stattab_classname:null},desc:"Position information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/positions",["facade","collections","sportorg/models/position","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null){for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}}),s}),define("profilesetting/collections/positions",["facade","collections","sportorg/collections/positions","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return testpath?testpath+"/api/org/basics/":(this.orgs_id==undefined,"/api/sport/positions/"+this.sport_id+"?id1="+this.sport_id)}}),i}),define("profilesetting/views/positions",["require","text!profilesetting/templates/positions.html","facade","views","utils","vendor","profilesetting/collections/positions"],function(e,t){var n,r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=e("profilesetting/collections/positions"),c=f.Mustache,h=i.$,r=o.extend({template:t,events:{},controls:{spnPositionTitle:".spn-position-title_h",divLevels:".div-levels",btnPositions:".btnOpenPositions",btnClose:".btn-Close-Positions"},messages:{},properties:{},initialize:function(e){n=this,n.setOptions(e),n.BindPositions(),n.bindEvents()},bindEvents:function(){},MarkPosition:function(e){h(e).hasClass("active")?h(e).addClass("active"):h(e).removeClass("active")},setOptions:function(e){if(!e.sport_id)throw new Error("Sport_id is missing for Positions View",e);this.destination=e.destination,this.sport_id=e.sport_id,this.el=e.destination,this.target=e.target},BindPositions:function(){if(n.sport_id){var e=new l;e.sport_id=n.sport_id,e.fetch(),h.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();n.positions=[];if(t!=null&&t.length){n.positions=[];for(var r in t)n.positions.push(t[r].payload)}else n.positions=[];n.render()})}},render:function(){var e=c.to_html(n.template,{Data:n.positions||[]});h(n.destination).html(e),n.positions!=null&&n.positions.length>0?h(n.destination).parents(n.controls.divLevels).find(n.controls.btnPositions).fadeIn():h(n.destination).parents(n.controls.divLevels).find(n.controls.btnPositions).fadeOut()}});return r}),define("profilesetting/models/team",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"team_id",url:function(){this.orgs_id==undefined;if(this.type=="add")return"/api/user/addteam/"+this.user_id;if(this.type=="delete")return"/api/user/team/"+this.user_id}}),n}),define("profilesetting/models/position",["facade","sportorg/models/position"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"position_id",url:function(){return this.orgs_id==undefined,this.type=="save"?"/api/user/position/"+this.user_id+"?time="+(new Date).getTime():(+(new Date).getTime(),this.type=="delete"?"/api/user/position/"+this.user_id+"?user_id="+this.user_id+"?time="+(new Date).getTime():"/api/user/position/"+this.user_id+"?time="+(new Date).getTime())}}),n}),define("profilesetting/views/org",["require","text!profilesetting/templates/highschool.html","text!profilesetting/templates/club.html","text!profilesetting/templates/sportslevel.html","text!profilesetting/templates/level.html","facade","views","utils","vendor","profilesetting/collections/states","profilesetting/collections/schools","profilesetting/collections/sports","profilesetting/views/teams","profilesetting/models/complevel","profilesetting/views/seasons","profilesetting/views/positions","profilesetting/models/team","profilesetting/models/position"],function(e,t,n,r,i){var s,o,u=e("facade"),a=e("views"),f=a.SectionView,l=e("utils"),c=l.lib.Channel,h=e("vendor"),p=h.Mustache,d=u.$,v=e("profilesetting/collections/states"),m=e("profilesetting/collections/schools"),g=e("profilesetting/collections/sports"),y=e("profilesetting/models/complevel"),b=e("profilesetting/views/seasons"),w=e("profilesetting/views/positions"),E=e("profilesetting/views/teams"),S=e("profilesetting/models/team"),x=e("profilesetting/models/position");return o=f.extend({events:{"keyup #txt-school-state":"keyupState","blur #txt-school-state":"changeState","keyup #txt-school-school":"keyupSchool","blur #txt-school-school":"changeSchool","keyup #txt-club-state":"keyupState","blur #txt-club-state":"changeState","keyup #txt-club-club":"keyupSchool","blur #txt-club-club":"changeSchool","change .ddl-sports":"changeSports","change .ddl-complevel":"changeCompLevel","change .chkSeasons":"AddSportsItem","click .btn-add-level":"AddLevel","click .spn-position-title_h":"MarkPosition","click .btn-add-sports":"AddSports","click .btn-Remove-Sport":"RemoveSports","click #btn-Add-School":"SetUpAddSchool","click #btn-Add-club":"SetUpAddSchool","click .delete-team":"DeleteTeam","click .btn-Save-Positions":"SavePositions","click .btn-Close-Positions":"ClosePositions","click .btn-Finish-Sports":"FinishSports","click .edit-team":"EditTeam","click .btnOpenPositions":"displayPositionPopup","click .add-school-h":"openAddHighSchoolPopup","click .add-club-h":"openAddClubPopup","click .up-arrow-h":"levelUpArrow","click .down-arrow-h":"levelDownArrow"},messages:{dataNotExist:"You don't have any teams registered yet.  Why not do that now?",optionsMissing:"HeaderView expects option with model property.",selectSport:"Please select sport",selectState:"Please insert state",selectSchool:"Please insert School",SelectLevel:"Plesae Select Comp Level"},properties:{show_prev_year:30},states:[],schools:[],initialize:function(e){e.type&&e.type=="school"?(this.type="school",this.controls={txtStates:"#txt-school-state",txtSchools:"#txt-school-school",content:"#content-school-prof-setting",fieldMessage:".field-message",fieldError:".field-error",ddlSports:".ddl-sports",ddlComplevel:".ddl-complevel",modalPosition:".modal-positions",modalPositionBody:".modal-position-body",modalPositionsTitle:".spn-position-title_h",divSportsNameHeading:".spn-sport-name",divMainSportsSection:"#def-school-sports-section",divLevels:".div-sports-level",divSeasons:".div-seasons",divsportsLevel:".section-sportslevel",divSubLevels:".div-levels",divSchoolSportsSection:".school-sports-section",divSportsWrapper:".div-sports-wrapper",btnRemoveSports:".btn-Remove-Sport",divTeamListDetail:".section-team-list-detail",divAddSportSection:"#section-Add-Sports-school",btnAddSports:".btn-add-sports",btnClosePositions:".btn-Close-Positions",btnFinishSports:".btn-Finish-Sports",btnOpenPositions:".btnOpenPositions",chkSeasons:".chkSeasons",btnAddLevel:".btn-add-level"},this.template=t):(this.type="club",this.controls={txtStates:"#txt-club-state",txtSchools:"#txt-club-club",content:"#content-club-prof-setting",fieldMessage:".field-message",fieldError:".field-error",ddlSports:".ddl-sports",ddlComplevel:".ddl-complevel",modalPosition:".modal-positions",modalPositionBody:".modal-position-body",modalPositionsTitle:".spn-position-title_h",divSportsNameHeading:".spn-sport-name",divMainSportsSection:"#def-club-sports-section",divLevels:".div-sports-level",divSeasons:".div-seasons",divsportsLevel:".section-sportslevel",divSubLevels:".div-levels",divSchoolSportsSection:".school-sports-section",divSportsWrapper:".div-sports-wrapper",btnRemoveSports:".btn-Remove-Sport",divTeamListDetail:".section-team-list-detail-club",divAddSportSection:"#section-Add-Sports-club",btnAddSports:".btn-add-sports",btnClosePositions:".btn-Close-Positions",btnFinishSports:".btn-Finish-Sports",btnOpenPositions:".btnOpenPositions",chkSeasons:".chkSeasons",btnAddLevel:".btn-add-level"},this.template=n),f.prototype.initialize.call(this,e),_self=this,_self.setOptions(e),this.init()},openAddHighSchoolPopup:function(){var e=this;routing.trigger("add-school-init","","","school",e,function(t){console.log(t),e.$el.find(e.controls.txtSchools).val(t.name),e.$el.find(e.controls.txtStates).val(t.locationState.name),e.states_id="",e.orgs_id="",e.states_id=t.locationState.id,e.$(e.controls.txtSchools).removeAttr("disabled"),e.orgs_id=t.org_id,e.$el.find(e.controls.divMainSportsSection).find(e.controls.ddlSports).length<1&&e.fillSports(e.orgs_id,e.controls.divMainSportsSection),e.$el.find(".add-school-h").hide()})},init:function(){var e=this;e.setupView(),e.SetUpTeamsView()},render:function(){var e=this;f.prototype.render.call(this)},setupView:function(){},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender},keyupState:function(e){var t=this,n=d(e.target).val(),r=[],i=t.isValidAutoCompleteKey(e);if(n!="")if(i==1){t.$(e.target).parents(t.controls.divAddSportSection).find(t.controls.txtSchools).attr("disabled","disabled").val(""),t.RemoveSportsSection();var s=new v;s.state_name=n,console.log("State Request Abort Request Function AddGame/Main.js"),t.stateFetchRequest=t.stateFetchRequest||[],t.stateFetchRequest.push(t.cityFetchRequest||[]),t.stateFetchRequest.push(t.schoolFetchRequest||[]),t.stateFetchRequest=t.abortRequest(t.stateFetchRequest),d(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();t.stateFetchRequest.push(o),d.when(s.request).done(function(){if(s.isError())return;var e=s.toJSON();e==null||e.length<1?t.$el.find(t.controls.txtStates).parent().find(t.controls.fieldMessage).html(t.messages.dataNotExist).stop().fadeIn():t.$el.find(t.controls.txtStates).parent().find(t.controls.fieldMessage).html("").fadeOut(),t.states=[];for(var n in e)t.states.push(e[n].payload);t.states.forEach(function(e,t){r.push(e.name)});try{t.$el.find(t.controls.txtStates).autocomplete("destroy")}catch(i){}t.$el.find(t.controls.txtStates).autocomplete({source:r}),t.$el.find(t.controls.txtStates).trigger("keydown")})}else t.changeState(e)},changeState:function(e){var t=this,n=d(e.target).val(),r=!1;t.states_id="",t.states.forEach(function(e,i){e["name"]==n&&(r=!0,t.states_id=e.id,t.$(t.controls.txtSchools).removeAttr("disabled"))}),r||(t.states_id=0,t.$(t.controls.txtSchools).attr("disabled","disabled"))},keyupSchool:function(e){var t=this,n=d(e.target).val(),r=[],i=t.isValidAutoCompleteKey(e);if(n!=""&&i==1){t.RemoveSportsSection();var s=new m;s.sports_club=t.type=="school"?0:1,s.states_id=t.states_id,s.org_name=n,console.log("School Request Abort Request Function"),t.schoolFetchRequest=t.abortRequest(t.schoolFetchRequest),d(e.target).addClass("ui-autocomplete-loading"),d(e.target).removeAttr("data-id");var o=s.fetch();t.schoolFetchRequest.push(o),d.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();n==null||n.length<1?t.$el.find(t.controls.txtSchools).parent().find(t.controls.fieldMessage).html(t.messages.dataNotExist).stop().fadeIn():t.$el.find(t.controls.txtSchools).parent().find(t.controls.fieldMessage).html("").stop().fadeOut(),t.schools=[];for(var i in n)t.schools.push(n[i].payload);t.schools.forEach(function(e,t){r.push({id:e.id,value:e.org_name,city:e.city})});try{t.$el.find(t.controls.txtSchools).autocomplete("destroy")}catch(o){}d(e.target).autocomplete({source:r,select:function(t,n){console.error(t),setTimeout(function(){d(e.target).val(n.item.value),d(e.target).attr("data-id",n.item.id),d(e.target).trigger("blur")},100)}}).data("ui-autocomplete")._renderItem=function(e,t){return d("<li>").append("<a>"+t.value+"<br><span class='sub-label'>"+t.city+"</span></a>").appendTo(e)},d(e.target).trigger("keydown")})}else t.RemoveSportsSection(),t.changeSchool(e)},changeSchool:function(e){var t=this,n,r=t.schools.length,i=t.$(e.target).attr("data-id");t.orgs_id=0;for(n=0;n<r;n++)if(t.schools[n]["id"]==i){t.orgs_id=t.schools[n].org_id;var s=t.schools[n].single_sport_id;t.$el.find(t.controls.divMainSportsSection).find(t.controls.ddlSports).length<1&&t.fillSports(t.orgs_id,t.controls.divMainSportsSection,s);break}},openAddClubPopup:function(e){var t=d(e.target).parent().find("input#txt-club-club").val(),n=this;routing.trigger("add-school-init","","","club",n,function(e){console.log("RESULT",e),n.$el.find(n.controls.txtSchools).val(e.name),n.$el.find(n.controls.txtSchools).attr("data-id",e.org_id),n.$el.find(n.controls.txtStates).val(e.locationState.name),n.$el.find(n.controls.divSportsWrapper).css({"background-color":"rgb(255, 223, 223)"}),n.states_id="",n.orgs_id="",n.states_id=e.locationState.id,n.$(n.controls.txtSchools).removeAttr("disabled"),n.orgs_id=e.org_id,n.$el.find(n.controls.divMainSportsSection).find(n.controls.ddlSports).length<1&&n.fillSports(n.orgs_id,n.controls.divMainSportsSection,e.single_sport_id);var t=n.$el.parents().find(d("#btn-Add-club")),r=t.position();t.parents(document).animate({scrollTop:r.top},"1000"),n.$el.find(".add-club-h").hide()},t)},RemoveSportsSection:function(){var e=this;e.$el.find(e.controls.divMainSportsSection).html("")},fillSports:function(e,t,n){var r=this;if(r.sports&&r.sports.length>0)r.SetupSportsView(e,t,n);else{var i=new g;i.sport_type=this.type=="club"?0:1,i.sport_type_id=i.sport_type,i.male=1,i.female=0,r.gender=="male"?i.male=1:r.gender=="famale"&&(i.female=0),i.fetch(),d.when(i.request).done(function(){if(i.isError())return;var s=i.toJSON();(s==null||s.length<1)&&r.$el.find(r.controls.ddlSports).parent().find(r.controls.fieldMessage).html(r.messages.dataNotExist).stop().fadeIn(),r.sports=[];for(var o in s)r.sports.push(s[o].payload);r.sort(r.sports,"sport_name",!1),r.SetupSportsView(e,t,n)})}},changeSports:function(e){var t=this;console.log("SPORTS",t.sports);var n=d(e.target).val(),r=d(e.target).attr("orgsid");console.log("Event Target Sports List",d(e.target),n,r);if(n!=0&&n!=null&&n!=""&&r&&r!=0&&r!=null&&r!=""){t.sport_id=n;var i=t.$(e.target).parents(t.controls.divsportsLevel).find(t.controls.divLevels);console.log("CALLED",i),i.html(""),t.$(e.target).parents(t.controls.divsportsLevel).find(t.controls.btnAddLevel).attr("sportid",n),t.fillCompLevel(r,i,n)}else t.sport_id=0},SetupSportsView:function(e,t,n){var i=this,s=p.to_html(r,{sports:i.sports,orgsId:e});i.$(t).append(s),n&&i.$(t).find(".section-sportslevel .select-sports-outer-h").hide(),d(t).parents(i.controls.divSportsWrapper).find(i.controls.btnAddSports).attr("orgsid",e),n&&i.$(t).find(".ddl-sports").val(n).trigger("change"),d(t).parents(i.controls.divSportsWrapper).fadeIn()},findSportById:function(e){var t=this;if(!(t.sports&&t.sports.length<1))return 0;for(var n=0;n<t.sports.length;n++)if(t.sports[n].id==e)return t.sports[n]},fillCompLevel:function(e,t,n){var r=this;r.compLevel_id=undefined;if(e&&e>0){var i=new y;i.orgs_id=e,r.compFetchRequest=r.abortRequest(r.compFetchRequest);var s=i.fetch();r.compFetchRequest.push(s),d.when(i.request).done(function(){if(i.isError())return;var s=i.toJSON();r.compLevel=[];if(s!=null&&s.payload!=null||s.payload.complevels!=null&&s.payload.complevels.length){r.seasons=s.payload.seasons||[];for(var o in s.payload.complevels)r.compLevel.push(s.payload.complevels[o]);var u=r.findSportById(n);u||(u=n),r.SetUpCompLevelView(e,t,u)}})}else d(t).html("")},changeCompLevel:function(e){var t=this,n=d(e.target).val();t.compLevel_id=0;for(var r in t.compLevel)if(t.compLevel[r].complevel_id==n){t.compLevel_id=n,t.$(e.target).attr("disabled","disabled"),t.$(e.target).parents(t.controls.divSubLevels).find(t.controls.divSeasons).fadeIn();return}t.$(e.target).parents(t.controls.divSubLevels).find(t.controls.divSeasons).fadeOut()},SetUpCompLevelView:function(e,t,n){var r=this,s=n.sports_id;s||(s=n);var o=r.GetSeasonsData(r.seasons,e,s);console.log(o);var u=p.to_html(i,{levels:r.compLevel,Data:o,sport:n});r.$(t).append(u);var a=r.$(t).find(r.controls.modalPositionBody);r.fillPositions(s,a)},levelUpArrow:function(e){var t=this,n=d(e.currentTarget).parents(".complevels-wrapper"),r=n.find(".complevels-container").scrollTop(),i=n.find(".complevels-container").height();if(r>i)var s=r-i;else var s=0;n.find(".complevels-container").animate({scrollTop:s})},levelDownArrow:function(e){var t=this,n=d(e.currentTarget).parents(".complevels-wrapper"),r=n.find(".complevels-container").scrollTop(),i=r+n.find(".complevels-container").height();n.find(".complevels-container").animate({scrollTop:i})},GetSeasonsData:function(e,t,n){var r=this,i=[],s=(new Date).getFullYear();for(var o=r.properties.show_prev_year;o>=0;o--){var u={year:s,seasons:e,orgsId:t,sportsId:n};i.push(u),s--}return i},fillPositions:function(e,t){var n=this;console.log("fillpositions",e,t),e?(console.log("sport_id",e,"destination",t),this.positionView=new w({name:"settings-high-school-positions",destination:t,sport_id:e}),n.$el.find(n.controls.ddlSports).parent().find(n.controls.fieldError).html("").fadeOut()):n.$el.find(n.controls.ddlSports).parent().find(n.controls.fieldError).html(n.messages.selectSport).stop().fadeIn()},displayPositionPopup:function(e){var t=this;t.clickedPositionTarget=d(e.target);if(d(e.target).parent().find(t.controls.chkSeasons).is(":checked")){var n=d(e.target).attr("teamid");console.log(d(e.target).parents(t.controls.divSubLevels).find(t.controls.modalPositionsTitle));if(d(e.target).parents(t.controls.divSubLevels).find(t.controls.modalPositionsTitle).length>0){t.$(e.target).parents(t.controls.divSubLevels).find(t.controls.modalPositionsTitle).attr("teamid",n).removeClass("active");var r=d(e.target).attr("positions");console.log("ids",r);if(r){var i=r.split(",");d.each(i,function(n,r){t.$(e.target).parents(t.controls.divSubLevels).find("#pos-"+r).addClass("active")})}t.$(e.target).parents(t.controls.divSubLevels).find(t.controls.modalPosition).modal("show")}else alert("No Positions exists for the sport")}else alert("Select Season")},MarkPosition:function(e){var t=this,n=t.$(e.target),r=d(e.target).attr("teamid"),i=d(e.target).attr("positionId"),s={id1:t.user_id,user_id:t.user_id,positions_id:i,teams_id:r};if(n.hasClass("active")){s.position_id=i;var o=new x(s);o.user_id=t.user_id,o.type="delete",o.destroy({data:s}),d.when(o.request).done(function(){n.removeClass("active"),t.updatePositionButtonNumber(r,!1)})}else{var o=new x(s);o.user_id=t.user_id,o.type="save",o.save(),d.when(o.request).done(function(){n.addClass("active"),t.updatePositionButtonNumber(r,!0)})}},AddLevel:function(e){var t=this,n=t.$(e.target).parents(t.controls.divsportsLevel).find(t.controls.divLevels),r=d(e.target).attr("orgsid"),i=d(e.target).attr("sportid");r&&r!=0&&r!=null&&r!=""?(console.log("destination add level function",n),t.fillCompLevel(r,n,i)):console.error("Orgs Id is ",r)},AddSports:function(e){var t=this,n=t.$(e.target).attr("orgsid"),r=d(t.controls.divSportsWrapper+'[orgsId="'+n+'"] '+t.controls.divSchoolSportsSection);n&&n!=0&&n!=null&&n!=""&&(t.fillSports(n,r),d(r).parents(t.controls.divSportsWrapper).fadeIn())},RemoveSports:function(e){var t=this;t.$(e.target).parents(t.controls.divsportsLevel).remove()},SetUpTeamsView:function(){var e=this;console.log("Highschool teams view Set Up Teams View",e.type),this.teamsView=new E({user_id:e.user_id,destination:e.controls.divTeamListDetail,sports_club:e.type=="school"?0:1,org_type:e.type})},SetUpAddSchool:function(){var e=this;e.$el.find(e.controls.divAddSportSection).fadeIn()},AddSportsItem:function(e){var t=this;t.$el.find(t.controls.btnFinishSports).html("Finish");if(d(e.target).is(":checked")&&d(e.target).attr("seasonid")&&d(e.target).attr("year")){var n=d(e.target).attr("orgsid"),r=d(e.target).parents(t.controls.divSubLevels).find(t.controls.ddlComplevel).val();if(n&&n!=0&&n!=null&&n!=""&&r&&r!=0&&r!=null&&r!=""){var i={orgs_id:n,teams_id:0,id1:t.user_id,user_id:t.user_id,sports_id:d(e.target).attr("sportsid"),complevels_id:r,seasons_id:d(e.target).attr("seasonid"),year:d(e.target).attr("year")},s=new S(i);s.type="add",s.user_id=t.user_id,s.save(),d.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();if(n!=null&&n.payload!=null||n.payload.id!=null)d(e.target).attr("teamid",n.payload.id),console.log(n.payload.seasons_obj),t.insertPositionsButton(d(e.target),n.payload.seasons_obj,n.payload.year,n.payload.id)})}else{var o=d(e.target).parents(t.controls.divLevels).find(t.controls.ddlComplevel);d(o).parent().find(t.controls.fieldError).html(t.messages.SelectLevel).stop().fadeIn(),d(e.target).parent().find(t.controls.btnOpenPositions).attr("disabled","disabled")}}else!d(e.target).is(":checked")&&d(e.target).attr("teamid")&&t.DeleteTeam(e)},DeleteTeam:function(e){var t=this,n=d(e.target).attr("teamid");if(n){var r={};r.user_id=t.user_id,r.team_id=n;var i=new S(r);i.user_id=t.user_id,i.team_id=n,i.type="delete",i.destroy({data:{user_id:t.user_id,teams_id:n},processData:!0,success:function(){d(e.target).removeAttr("teamid"),d(e.target).parent().find(t.controls.btnOpenPositions).attr("disabled","disabled")}})}},FinishSports:function(){console.log("Current state of view",this);var e=this;e.ClearAddNewForm(),e.init()},ClearAddNewForm:function(){var e=this;e.RemoveSportsSection(),e.$(e.controls.txtStates).val(""),e.states_id=undefined,e.$(e.controls.txtSchools).attr("disabled","disabled").val(""),e.orgs_id=undefined,e.type=="club"?e.$el.find(".add-club-h").show():e.$el.find(".add-school-h").show(),e.$el.find(e.controls.divAddSportSection).fadeOut()},EditTeam:function(e){var t=this;console.log("Event",e.target);var n=d(e.target).attr("orgsId"),r=d(e.target).attr("sportId"),i=d(e.target).parent(),s='<div class="section-sportslevel"><div class="div-sports-level"></div>';s+='<a tabindex="0" orgsid="'+n+'" class="btn-add-level" href="javascript:void(0)">Add Level</a>',s+='<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Finish</a> </span>',s+="</div>",d(i).html(s);var o=d(i).find(t.controls.divLevels);d.each(t.teamsView.Teams,function(e,i){n==i.payload.org_id&&d.each(i.payload.sports,function(e,i){if(i.sports_id==r){t.SetUpEditTeamView(n,o,r,i);return}})})},SetUpEditTeamView:function(e,t,n,r){var i=this;i.compLevel_id=undefined;if(e&&e>0){var s=new y;s.orgs_id=e,s.fetch(),console.log("Complevel Model Request Abort Request Function"),i.compLevelFetchRequest=i.abortRequest(i.compLevelFetchRequest),i.compLevelFetchRequest=s.fetch(),d.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();i.compLevel=[];if(n!=null&&n.payload!=null||n.payload.complevels!=null&&n.payload.complevels.length){i.seasons=n.payload.seasons||[];for(var o in n.payload.complevels)i.compLevel.push(n.payload.complevels[o]);d.each(r.complevels,function(n,s){i.SetUpCompLevelView(e,t,r);var o=i.$(t).find(i.controls.divSubLevels);if(o[n]){var u=i.$(o[n]).find(i.controls.ddlComplevel);d(u).val(s.complevels_id).attr("disabled","disabled"),d(o[n]).find(i.controls.divSeasons).fadeIn(),d.each(s.seasons,function(e,t){d(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).attr("checked","checked").attr("teamid",t.team_id),i.insertPositionsButton(d(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year),t)})}})}}),i.$(t).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",n)}},insertPositionsButton:function(e,t,n,r){console.log(t),t.positions||(t.positions=[]),t.seasons_id||(t.seasons_id=t.season_id),t.year&&(n=t.year),t.team_id&&(r=t.team_id),console.log(_self.controls.btnOpenPositions+'[teamid="'+r+'"]',d(_self.controls.btnOpenPositions+'[teamid="'+r+'"]')),d(e).parent().find(_self.controls.btnOpenPositions+'[teamid="'+r+'"]').length?d(e).parent().find(_self.controls.btnOpenPositions+'[teamid="'+r+'"]').removeAttr("disabled","disabled"):d(e).parent().append('<a href="javascript:void(0)" id="season-positions-'+t.seasons_id+"-"+n+'" class="btnOpenPositions btn" >Positions ('+t.positions.length+")</a>"),d(e).parent().find(_self.controls.btnOpenPositions).attr("teamid",r),d(e).parent().find(_self.controls.btnOpenPositions).attr("data-number-positions",t.positions.length);var i="";t.positions&&d.each(t.positions,function(e,t){t&&(i+=t.id+",")}),d(e).parent().find(_self.controls.btnOpenPositions).attr("positions",i)},updatePositionButtonNumber:function(e,t){var n=d(_self.controls.btnOpenPositions+'[teamid="'+e+'"]'),r=n.data("number-positions"),i=t?r+1:r-1;n.data("number-positions",i).html("Positions ("+i+")")},ClosePositions:function(e){var t=this;if(t.clickedPositionTarget){var n=d(e.target).parents(t.controls.modalPosition).find(t.controls.modalPositionsTitle),r="";n.each(function(){d(this).hasClass("active")&&(r+=d(this).attr("positionid")+",")}),d(t.clickedPositionTarget).attr("positions",r),t.clickedPositionTarget=undefined}}}),o}),define("profilesetting/views/club",["require","text!profilesetting/templates/club.html","text!profilesetting/templates/sportslevel.html","text!profilesetting/templates/level.html","facade","views","utils","vendor","profilesetting/collections/states","profilesetting/collections/schools","profilesetting/collections/sports","profilesetting/views/teams","profilesetting/models/complevel","profilesetting/views/seasons","profilesetting/views/positions","profilesetting/models/team","profilesetting/models/position"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/states"),v=e("profilesetting/collections/schools"),m=e("profilesetting/collections/sports"),g=e("profilesetting/models/complevel"),y=e("profilesetting/views/seasons"),b=e("profilesetting/views/positions"),w=e("profilesetting/views/teams"),E=e("profilesetting/models/team"),S=e("profilesetting/models/position"),s=a.extend({template:t,events:{"keyup #txt-club-state":"keyupState","blur #txt-club-state":"changeState","keyup #txt-club-club":"keyupSchool","blur #txt-club-club":"changeSchool","change .ddl-sports":"changeSports","change .ddl-complevel":"changeCompLevel","change .chkSeasons":"AddSportsItem","click .btn-add-level":"AddLevel","click .spn-position-title_h":"MarkPosition","click .btn-add-sports":"AddSports","click .btn-Remove-Sport":"RemoveSports","click #btn-Add-club":"SetUpAddSchool","click .delete-team":"DeleteTeam","click .btn-Save-Positions":"SavePositions","click .btn-Close-Positions":"ClosePositions","click .btn-Finish-Sports":"FinishSports","click .edit-team":"EditTeam","click .btnOpenPositions":"displayPositionPopup","click .add-club-h":"openAddClubPopup","click .up-arrow-h":"levelUpArrow","click .down-arrow-h":"levelDownArrow"},controls:{txtStates:"#txt-club-state",txtSchools:"#txt-club-club",content:"#content-club-prof-setting",fieldMessage:".field-message",fieldError:".field-error",ddlSports:".ddl-sports",ddlComplevel:".ddl-complevel",modalPosition:".modal-positions",modalPositionBody:".modal-position-body",modalPositionsTitle:".spn-position-title_h",divSportsNameHeading:".spn-sport-name",divMainSportsSection:"#def-club-sports-section",divLevels:".div-sports-level",divSeasons:".div-seasons",divsportsLevel:".section-sportslevel",divSubLevels:".div-levels",divSchoolSportsSection:".school-sports-section",divSportsWrapper:".div-sports-wrapper",btnRemoveSports:".btn-Remove-Sport",divTeamListDetail:".section-team-list-detail-club",divAddSportSection:"#section-Add-Sports-club",btnAddSports:".btn-add-sports",btnClosePositions:".btn-Close-Positions",btnFinishSports:".btn-Finish-Sports",btnOpenPositions:".btnOpenPositions",chkSeasons:".chkSeasons",btnAddLevel:".btn-add-level"},messages:{dataNotExist:'No teams set up yet.  Click "Add a Club" to link up with your club teams.',optionsMissing:"HeaderView expects option with model property.",selectSport:"Please select sport",selectState:"Please insert state",selectSchool:"Please insert Club",SelectLevel:"Plesae Select Comp Level"},properties:{show_prev_year:30},states:[],schools:[],initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},levelUpArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=t.find(".complevels-container").height();if(n>r)var i=n-r;else var i=0;t.find(".complevels-container").animate({scrollTop:i})},levelDownArrow:function(e){var t=p(e.currentTarget).parents(".complevels-wrapper"),n=t.find(".complevels-container").scrollTop(),r=n+t.find(".complevels-container").height();t.find(".complevels-container").animate({scrollTop:r})},openAddClubPopup:function(){var e=this;routing.trigger("add-school-init","","","club",e,function(t){e.$el.find(e.controls.txtSchools).val(t.name),e.$el.find(e.controls.txtStates).val(t.locationState.name),e.states_id="",e.orgs_id="",e.states_id=t.locationState.id,e.$(i.controls.txtSchools).removeAttr("disabled"),e.orgs_id=t.org_id,e.$el.find(e.controls.divMainSportsSection).find(e.controls.ddlSports).length<1&&i.fillSports(e.orgs_id,e.controls.divMainSportsSection),e.$el.find(".add-club-h").hide()})},init:function(){i.setupView(),i.SetUpTeamsView()},render:function(){var e=this;a.prototype.render.call(this)},setupView:function(){},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender},keyupState:function(e){var t=p(i.controls.txtStates).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!="")if(r==1){i.$(i.controls.txtSchools).attr("disabled","disabled").val(""),i.RemoveSportsSection();var s=new d;s.state_name=t,console.log("State Request Abort Request Function AddGame/Main.js"),i.stateFetchRequest=i.stateFetchRequest||[],i.stateFetchRequest.push(i.cityFetchRequest||[]),i.stateFetchRequest.push(i.schoolFetchRequest||[]),i.stateFetchRequest=i.abortRequest(i.stateFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.stateFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var e=s.toJSON();e==null||e.length<1?i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtStates).parent().find(i.controls.fieldMessage).html("").fadeOut(),i.states=[];for(var t in e)i.states.push(e[t].payload);i.states.forEach(function(e,t){n.push(e.name)});try{i.$el.find(i.controls.txtStates).autocomplete("destroy")}catch(r){}i.$el.find(i.controls.txtStates).autocomplete({source:n}),i.$el.find(i.controls.txtStates).trigger("keydown")})}else i.changeState(e)},changeState:function(e){var t=p(e.target).val(),n=!1;i.states_id="",i.states.forEach(function(e,r){e["name"]==t&&(n=!0,i.states_id=e.id,i.$el.find(i.controls.txtSchools).removeAttr("disabled"))}),n||(i.states_id=0,i.$el.find(i.controls.txtSchools).attr("disabled","disabled").val(""))},keyupSchool:function(e){var t=p(e.target).val(),n=[],r=i.isValidAutoCompleteKey(e);if(t!=""&&r==1){i.RemoveSportsSection();var s=new v;s.sports_club=1,s.states_id=i.states_id,s.org_name=t,console.log("School Request Abort Request Function"),i.schoolFetchRequest=i.abortRequest(i.schoolFetchRequest),p(e.target).addClass("ui-autocomplete-loading");var o=s.fetch();i.schoolFetchRequest.push(o),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn():i.$el.find(i.controls.txtSchools).parent().find(i.controls.fieldMessage).html("").stop().fadeOut(),i.schools=[];for(var r in t)i.schools.push(t[r].payload);i.schools.forEach(function(e,t){n.push(e.org_name)});try{i.$el.find(i.controls.txtSchools).autocomplete("destroy")}catch(o){}p(e.target).autocomplete({source:n}),i.$el.find(i.controls.txtSchools).trigger("keydown")})}else i.RemoveSportsSection(),i.changeSchool(e)},changeSchool:function(e){var t=this.$(e.target).val();i.orgs_id=0,i.schools.forEach(function(e,n){e["org_name"]==t&&(i.orgs_id=e.org_id,i.$el.find(i.controls.divMainSportsSection).find(i.controls.ddlSports).length<1&&i.fillSports(i.orgs_id,i.controls.divMainSportsSection))})},RemoveSportsSection:function(){i.$el.find(i.controls.divMainSportsSection).html("")},fillSports:function(e,t){if(i.sports&&i.sports.length>0)i.SetupSportsView(e,t);else{var n=new m;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,i.gender=="male"?n.male=1:i.gender=="famale"&&(n.female=0),n.fetch(),p.when(n.request).done(function(){if(n.isError())return;var r=n.toJSON();(r==null||r.length<1)&&i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldMessage).html(i.messages.dataNotExist).stop().fadeIn(),i.sports=[];for(var s in r)i.sports.push(r[s].payload);i.sort(i.sports,"sport_name",!1),i.SetupSportsView(e,t)})}},changeSports:function(e){console.log("SPORTS",i.sports);var t=p(e.target).val(),n=p(e.target).attr("orgsid");console.log("Event Target Sports List",p(e.target),t,n);if(t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){i.sport_id=t;var r=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels);console.log("CALLED",r),r.html(""),i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",t),i.fillCompLevel(n,r,t)}else i.sport_id=0},SetupSportsView:function(e,t){var r=h.to_html(n,{sports:i.sports,orgsId:e});i.$(t).append(r),p(t).parents(i.controls.divSportsWrapper).find(i.controls.btnAddSports).attr("orgsid",e),p(t).parents(i.controls.divSportsWrapper).fadeIn()},findSportById:function(e){if(i.sports.length<1)return 0;for(var t=0;t<i.sports.length;t++)if(i.sports[t].id==e)return i.sports[t]},fillCompLevel:function(e,t,n){i.compLevel_id=undefined;if(e&&e>0){var r=new g;r.orgs_id=e,console.log("Complevels Request Abort Request Function"),i.compFetchRequest=i.abortRequest(i.compFetchRequest);var s=r.fetch();i.compFetchRequest.push(s),p.when(r.request).done(function(){if(r.isError())return;var s=r.toJSON();i.compLevel=[];if(s!=null&&s.payload!=null||s.payload.complevels!=null&&s.payload.complevels.length){i.seasons=s.payload.seasons||[];for(var o in s.payload.complevels)i.compLevel.push(s.payload.complevels[o]);var u=i.findSportById(n);i.SetUpCompLevelView(e,t,u)}})}else p(t).html("")},changeCompLevel:function(e){var t=p(e.target).val();i.compLevel_id=0;for(var n in i.compLevel)if(i.compLevel[n].complevel_id==t){i.compLevel_id=t,i.$(e.target).attr("disabled","disabled"),i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeIn();return}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.divSeasons).fadeOut()},SetUpCompLevelView:function(e,t,n){var s=n.sports_id,o=i.GetSeasonsData(i.seasons,e,s),u=h.to_html(r,{levels:i.compLevel,Data:o,sport:n});i.$(t).append(u);var a=i.$(t).find(i.controls.modalPositionBody);i.fillPositions(s,a)},GetSeasonsData:function(e,t,n){var r=[],s=(new Date).getFullYear();for(var o=i.properties.show_prev_year;o>=0;o--){var u={year:s,seasons:e,orgsId:t,sportsId:n};r.push(u),s--}return r},fillPositions:function(e,t){e?(this.positionView=new b({name:"settings-club-positions",destination:t,sport_id:e}),i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html("").fadeOut()):i.$el.find(i.controls.ddlSports).parent().find(i.controls.fieldError).html(i.messages.selectSport).stop().fadeIn()},displayPositionPopup:function(e){alert("test"),i.clickedPositionTarget=p(e.target);var t=p(e.target).attr("teamid");if(p(e.target).parent().find(i.controls.chkSeasons).is(":checked"))if(p(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).length>0){i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPositionsTitle).attr("teamid",t).removeClass("active");var n=p(e.target).attr("positions");if(n){var r=n.split(",");p.each(r,function(t,n){i.$(e.target).parents(i.controls.divSubLevels).find("#pos-"+n).addClass("active")})}i.$(e.target).parents(i.controls.divSubLevels).find(i.controls.modalPosition).modal("show")}else alert("No Positions exists for the sport");else alert("Select Season")},MarkPosition:function(e){var t=i.$(e.target),n=p(e.target).attr("teamid"),r=p(e.target).attr("positionId"),s={id1:i.user_id,user_id:i.user_id,positions_id:r,teams_id:n};if(t.hasClass("active")){s.position_id=r;var o=new S(s);o.user_id=i.user_id,o.type="delete",o.destroy({data:s}),p.when(o.request).done(function(){t.removeClass("active")})}else{var o=new S(s);o.user_id=i.user_id,t.addClass("active"),o.type="save",o.save()}},AddLevel:function(e){var t=i.$(e.target).parents(i.controls.divsportsLevel).find(i.controls.divLevels),n=p(e.target).attr("orgsid"),r=p(e.target).attr("sportid");n&&n!=0&&n!=null&&n!=""?i.fillCompLevel(n,t,r):console.error("Orgs Id is ",n)},AddSports:function(e){var t=i.$(e.target).attr("orgsid"),n=p(i.controls.divSportsWrapper+'[orgsId="'+t+'"] '+i.controls.divSchoolSportsSection);t&&t!=0&&t!=null&&t!=""&&(i.fillSports(t,n),p(n).parents(i.controls.divSportsWrapper).fadeIn())},RemoveSports:function(e){i.$(e.target).parents(i.controls.divsportsLevel).remove()},SetUpTeamsView:function(){this.teamsView=new w({user_id:i.user_id,destination:i.controls.divTeamListDetail,sports_club:1,org_type:"club"})},SetUpAddSchool:function(){i.$el.find(i.controls.divAddSportSection).fadeIn()},AddSportsItem:function(e){if(p(e.target).is(":checked")&&p(e.target).attr("seasonid")&&p(e.target).attr("year")){var t=p(e.target).attr("orgsid"),n=p(e.target).parents(i.controls.divSubLevels).find(i.controls.ddlComplevel).val();if(t&&t!=0&&t!=null&&t!=""&&n&&n!=0&&n!=null&&n!=""){var r={orgs_id:t,teams_id:0,id1:i.user_id,user_id:i.user_id,sports_id:p(e.target).attr("sportsid"),complevels_id:n,seasons_id:p(e.target).attr("seasonid"),year:p(e.target).attr("year")},s=new E(r);s.type="add",s.user_id=i.user_id,s.save(),p.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();if(t!=null&&t.payload!=null||t.payload.id!=null)p(e.target).attr("teamid",t.payload.team_id),p(e.target).parent().find(i.controls.btnOpenPositions).attr("teamid",t.payload.id).removeAttr("disabled")})}else{console.error("OrgsId & ComplevelIds are",t,n);var o=p(e.target).parents(i.controls.divLevels).find(i.controls.ddlComplevel);p(o).parent().find(i.controls.fieldError).html(i.messages.SelectLevel).stop().fadeIn(),p(e.target).parent().find(i.controls.btnOpenPositions).attr("disabled","disabled")}}else!p(e.target).is(":checked")&&p(e.target).attr("teamid")&&i.DeleteTeam(e)},DeleteTeam:function(e){var t=p(e.target).attr("teamid");if(t){var n={};n.user_id=i.user_id,n.team_id=t;var r=new E(n);r.user_id=i.user_id,r.team_id=t,r.type="delete",r.destroy({data:{user_id:i.user_id,teams_id:t},processData:!0,success:function(){p(e.target).removeAttr("teamid"),p(e.target).parent().find(i.controls.btnOpenPositions).removeAttr("teamid").removeAttr("positions").attr("disabled","disabled")}})}},FinishSports:function(){i.ClearAddNewForm(),i.init()},ClearAddNewForm:function(){i.RemoveSportsSection(),i.$(i.controls.txtStates).val(""),i.states_id=undefined,i.$(i.controls.txtSchools).attr("disabled","disabled").val(""),i.orgs_id=undefined,i.$el.find(i.controls.divAddSportSection).fadeOut(),i.$el.find(".add-club-h").show()},EditTeam:function(e){console.log("self.teamsView.Teams",i.teamsView.Teams);var t=p(e.target).attr("orgsId"),n=p(e.target).attr("sportId"),r=p(e.target).parent(),s='<div class="section-sportslevel"><div class="div-sports-level"></div>';s+='<a tabindex="0" orgsid="'+t+'" class="btn-add-level" href="javascript:void(0)">Add Level</a>',s+='<span class="floatRight"><a href="javascript:void(0)" class="common-btn common-btn-direction btn-Finish-Sports" tabindex="0">Finish</a> </span>',s+="</div>",p(r).html(s);var o=p(r).find(i.controls.divLevels);p.each(i.teamsView.Teams,function(e,s){console.log("team",s),t==s.payload.org_id&&p.each(s.payload.sports,function(e,s){console.log("sport",s);if(s.sports_id==n){i.SetUpEditTeamView(t,r,n,s);return}})})},SetUpEditTeamView:function(e,t,n,r){i.compLevel_id=undefined;if(e&&e>0){var s=new g;s.orgs_id=e,console.log("Complevel Model Request Abort Request Function"),i.compLevelFetchRequest=i.abortRequest(i.compLevelFetchRequest),i.compLevelFetchRequest=s.fetch(),p.when(s.request).done(function(){if(s.isError())return;var n=s.toJSON();i.compLevel=[];if(n!=null&&n.payload!=null||n.payload.complevels!=null&&n.payload.complevels.length){i.seasons=n.payload.seasons||[];for(var o in n.payload.complevels)i.compLevel.push(n.payload.complevels[o]);p.each(r.complevels,function(n,s){i.SetUpCompLevelView(e,t,r);var o=i.$(t).find(i.controls.divSubLevels);if(o[n]){var u=i.$(o[n]).find(i.controls.ddlComplevel);p(u).val(s.complevels_id).attr("disabled","disabled"),p(o[n]).find(i.controls.divSeasons).fadeIn(),p.each(s.seasons,function(e,t){p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).attr("checked","checked").attr("teamid",t.team_id),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("teamid",t.team_id);var r="";t.positions&&p.each(t.positions,function(e,t){t&&(r+=t.id+",")}),p(o[n]).find(".chkSeasons-"+t.seasons_id+"-"+t.year).parent().find(i.controls.btnOpenPositions).attr("positions",r)})}})}}),i.$(t).parents(i.controls.divsportsLevel).find(i.controls.btnAddLevel).attr("sportid",n)}},ClosePositions:function(e){if(i.clickedPositionTarget){var t=p(e.target).parents(i.controls.modalPosition).find(i.controls.modalPositionsTitle),n="";t.each(function(){p(this).hasClass("active")&&(n+=p(this).attr("positionid")+",")}),p(i.clickedPositionTarget).attr("positions",n),i.clickedPositionTarget=undefined}}});return s}),define("profilesetting/models/high_school",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!profilesetting/templates/individualsports.html",[],function(){return'<div class="sub-section-prof-setting">\r\n\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Individual Sports</span>\r\n	</div>\r\n	<span style="padding:10px 50px 10px 50px; font-weight: bold; font-size:.9em; display: block;">Individual sports are sports that you participate in without a team.&nbsp;&nbsp;An easy way to understand it is when you go to a Meet / Event and dominate, did YOU win, or did your TEAM win?  If you won, chances are you want to choose your sport below.\r\n		Another question you can ask, is "Can you compete in an event for this sport without a team?".<br/><br/>\r\n		There are gray areas like boxing gyms or MMA gyms where you belong to and compete for a gym, but it\'s you that wins the fight and it\'s two people competing, not two teams.&nbsp;&nbsp;We\'re working on building support for that, but now, use the individual sport section to add the sport to your profile.<br/><br/>\r\n	If you are dealing with a team sport, go to the sections above to select your team.&nbsp;&nbsp;There is a section for school-based teams and one for club-based teams.&nbsp;&nbsp;If you can\'t find it in the auto-complete search, you can add a new one.&nbsp;&nbsp;If you find this confusing, please don\'t hesitate to send an email to weare@athletez.com</span>\r\n	<div class="section-individual-sports">\r\n		<div class="org-sport-list">\r\n			<div class="org-sport-list-header">\r\n				<div class="org-name">Select The Sports you Participate in</div>\r\n			</div>\r\n			<div class="sports-list-individial-sports"></div>\r\n		</div>\r\n	</div>\r\n</div>'}),define("text!profilesetting/templates/sportscheckbox.html",[],function(){return'{{#sports}}\r\n<div>\r\n	<div class="org-sport-list-header">\r\n		<div class="sport-name">\r\n			<input type="checkbox" id="chk-ind-{{sport_id}}" class="chk-single" sportid="{{sport_id}}" />\r\n			<img src="{{icon}}" alt="{{sports_name}}" />\r\n			{{sports_name}}\r\n			<span class="alert alert-danger displayNone error_h"></span>\r\n			<span class="alert alert-success displayNone success_h"></span>\r\n		</div>\r\n	</div>\r\n</div>\r\n{{/sports}}'}),define("text!profilesetting/templates/sportitem.html",[],function(){return'<div class="span12">\r\n	Users Sports\r\n</div>\r\n{{#sports}}\r\n<div class="span12">\r\n<span class="span3">\r\n			<label>{{sport_name}}</label></span>\r\n			<span class="span3">\r\n				\r\n				<a href="javascript:void(0)" class="delete-individualsport" sportid="{{sport_id}}">Delete</a>\r\n				</span>\r\n</div>\r\n{{/sports}}'}),define("profilesetting/collections/individualsports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({sport_type:1,male:1,female:0,url:function(){if(testpath)return testpath+"/api/user/sports";if(this.type=="get")return"/api/user/sports/"+this.user_id+"?team_type=individual"},data:{sports_id:this.sports_id}}),i}),define("profilesetting/models/sport",["facade","sportorg/models/sport"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"user_id",url:function(){this.orgs_id==undefined;if(this.type=="save")return"/api/user/addsport/"+this.user_id;if(this.type=="delete")return"/api/user/sport/"+this.user_id}}),n}),define("profilesetting/views/individuals",["require","text!profilesetting/templates/individualsports.html","text!profilesetting/templates/sportscheckbox.html","text!profilesetting/templates/sportitem.html","facade","views","utils","vendor","profilesetting/collections/individualsports","sportorg/collections/sports_listall","profilesetting/models/sport"],function(e,t,n,r){var i,s,o=e("facade"),u=e("views"),a=u.SectionView,f=e("utils"),l=f.lib.Channel,c=e("vendor"),h=c.Mustache,p=o.$,d=e("profilesetting/collections/individualsports"),v=e("profilesetting/models/sport"),m=e("sportorg/collections/sports_listall"),s=a.extend({template:t,events:{"change .select-all":"CheckAll","change .chk-single":"CheckSingle","click .delete-individualsport":"DeleteSport"},controls:{content:"#section-individual-prof-setting",sportslist:".sports-list-individial-sports",btnSave:".btn-Save-Individual-Sports",chkAll:".select-all",chkSingle:".chk-single",userSportsList:".sports-list-user-individual-sports"},messages:{dataNotExist:"Couldn't find any matches",optionsMissing:"HeaderView expects option with model property."},initialize:function(e){a.prototype.initialize.call(this,e),i=this,i.setOptions(e),this.init()},init:function(){i.setupSportsView()},render:function(){a.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id,this.gender=e.gender,this.destination=e.destination},setUpUsersSports:function(){console.log("setUpSportsView Individual View");var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(r,{sports:i.sports});console.log("Users Own Sports",i.sports),i.$(i.controls.userSportsList).html(s)})},setUpUsersSportsCheck:function(){var e=new d;e.user_id=i.user_id,e.male=1,e.female=0,e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var n in t)t[n].payload.team_type=="individual"&&i.sports.push(t[n].payload);i.sort(i.sports,"sport_name",!1),p.each(i.sports,function(e,t){i.$el.find("#chk-ind-"+t.sport_id).attr("checked","checked")})})},setupSportsView:function(){console.log("setUpSportsView Individual View");var e=new m;console.log(e),e.user_id=i.user_id,e.sport_type_id=2,i.gender=="male"?e.male=1:i.gender=="famale"&&(e.female=0),e.type="get",e.fetch(),p.when(e.request).done(function(){if(e.isError())return;var t=e.toJSON();if(t==null||t.length<1)return;i.sports=[];for(var r in t)i.sports.push(t[r].payload);i.sort(i.sports,"sport_name",!1);var s=h.to_html(n,{sports:i.sports});i.$(i.controls.sportslist).html(s),i.setUpUsersSportsCheck()})},SaveSport:function(e){console.log("Save Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n=new v;n.user_id=i.user_id,n.sports_id=t,n.type="save",console.log("Save Model Request Abort Request Function"),i.sportsModelFetchRequest=i.abortRequest(i.sportsModelFetchRequest),i.compLevelFetchRequest=n.save({sports_id:t}),p.when(n.request).done(function(){var t=p(e.currentTarget).parent().find(".success_h");t.removeClass("displayNone").html("Sport Added Successfully."),setTimeout(function(){t.addClass("displayNone").html("")},3e3),i.setUpUsersSportsCheck()})}},DeleteSport:function(e){console.log("Delete Sport");var t=p(e.target).attr("sportid");console.log(t);if(t){var n={user_id:i.user_id,sports_id:t},r=new v(n);r.user_id=i.user_id,r.type="delete",r.destroy({data:n,processData:!0,success:function(){var t=p(e.currentTarget).parent().find(".success_h");t.removeClass("displayNone").html("Sport Removed Successfully."),setTimeout(function(){t.addClass("displayNone").html("")},3e3),i.setUpUsersSportsCheck()}})}},CheckAll:function(e){p(e.target).is(":checked")?i.$(i.controls.chkSingle).attr("checked","checked"):i.$(i.controls.chkSingle).removeAttr("checked","checked")},CheckSingle:function(e){p(e.target).is(":checked")?i.SaveSport(e):i.DeleteSport(e)}});return s}),define("profilesetting",["require","text!profilesetting/templates/layout.html","facade","controller","models","views","utils","profilesetting/models/basic_info","profilesetting/views/basic_info","profilesetting/views/org","profilesetting/views/club","profilesetting/models/high_school","profilesetting/views/individuals"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("profilesetting/models/basic_info"),d=e("profilesetting/views/basic_info"),v=e("profilesetting/views/org"),m=e("profilesetting/views/club"),g=e("profilesetting/views/individuals"),y=e("profilesetting/models/high_school"),b=e("profilesetting/collections/individualsports");return n=i.extend({cssArr:["/pages/profilesetting/profilesettings.css"],initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),this.scheme=[],e.id&&(this.id=e.id,this.init()),this},init:function(){this.setupLayout().render(),this.setupView(),this.handleDeferreds()},setupLayout:function(){var e;return this.layout?this.layout:(e=new h({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.layout)},setupView:function(){var e=this;this.basicInfoModel=new p,this.basicInfoModel.id=e.id,this.basicInfoModel.fetch(),a.when(this.basicInfoModel.request).done(function(){var t=e.basicInfoModel.toJSON();e.gender=t.payload.gender,e.setUpBasicView(),e.addHighSchool(),e.SetUpClubView(),e.setUpIndividualView()})},setUpBasicView:function(){this.basicView=new d({id:self.id})},addHighSchool:function(){var e=this,t=new y;t.set("type","School"),this.schoolView=new v({model:t,name:"settings-high-school",destination:"#content-school-prof-setting",user_id:e.id,type:"school",gender:e.gender}),this.scheme.push(this.schoolView),this.layout.render()},setUpIndividualView:function(){var e=this;this.individualSportsView=new g({model:new b({user_id:e.id}),name:"settings-individual-sports",destination:"#section-individual-prof-setting",user_id:e.id,gender:e.gender}),this.scheme.push(this.individualSportsView),this.layout.render()},SetUpClubView:function(){var e=this,t=new y;t.set("type","Club"),this.clubView=new v({model:t,name:"settings-club",type:"club",destination:"#content-club-prof-setting",user_id:e.id,gender:e.gender}),this.scheme.push(this.clubView),this.layout.render()}}),n}),define("text!userresume/templates/layout.html",[],function(){return'<div class="main-container" style="margin : auto">\r\n	<!-- Basic Info Section Starts-->\r\n	<div id="section-basics-prof-setting" style=""></div>\r\n	<!-- Basic Info Section Ends-->\r\n\r\n<!-- Sent Resume Section Starts\r\n	<div id="section-sent-resume">\r\n\r\n	</div>-->\r\n<!-- Sent Resume Section Ends -->\r\n\r\n<!-- Rd Tree Section Starts -->\r\n	<div id="section-RD-Tree">\r\n		\r\n	</div>\r\n<!-- Rd Tree Section Ends -->\r\n\r\n<!-- Academic Gpa Section Starts\r\n	<div id="section-academic">\r\n		\r\n	</div>\r\n<!-- Academic Gpa Section Ends -->\r\n\r\n<!-- User Awards Section Starts\r\n	<div id="section-awards">\r\n		\r\n	</div>\r\n<!-- User Awards Section Ends -->\r\n\r\n<!-- User References Section Starts\r\n	<div id="section-references">\r\n		\r\n	</div>\r\n<!-- User Reference Section Ends -->\r\n\r\n<!-- User Contacts Section Starts\r\n	<div id="section-contacts">\r\n		\r\n	</div>\r\n<!-- User Contacts Section Ends -->\r\n\r\n\r\n	<div id="main-footer-prof-setting">\r\n	</div>\r\n</div>\r\n'}),define("text!userresume/templates/sentresume.html",[],function(){return'<div class="row-fluid sub-section-prof-setting well well-large">\r\n<div class="row-fluid">\r\n	<span class="spn-black-heading  well-small">Sent Resumes</span>\r\n</div>\r\n<div id="btn-Add-Resume" class="clearfix div-add-dotted well-small">\r\n	+ Send Resume\r\n</div>\r\n<table class="row-fluid">\r\n	<tr>\r\n		<th>Id</th>\r\n		<th>Sports Id</th>\r\n		<th>Users Id</th>\r\n		<th>College Coach Id</th>\r\n	</tr>\r\n	{{#resumes}}\r\n	<tr>\r\n		<td>{{id}}</td>\r\n		<td>{{sports_id}}</td>\r\n		<td>{{users_id}}</td>\r\n		<td>{{college_coach_id}}</td>\r\n	</tr>\r\n	{{/resumes}}\r\n</table>\r\n</div>'}),define("text!userresume/templates/basic_info_header.html",[],function(){return'{{#payload}}\r\n<div class="span3">\r\n	<img id="img-profile-prof-setting" src="{{user_picture}}" />\r\n</div>\r\n<div class="span6">\r\n	<h2>{{name}}</h2>\r\n	<p>\r\n		{{user_height}} INCHES\r\n	</p>\r\n	<p>\r\n		{{user_weight}} LBS\r\n	</p>\r\n</div>\r\n{{/payload}}'}),define("text!userresume/templates/rdtree.html",[],function(){return'<div class="sub-section-prof-setting">\r\n<div class="row-fluid">\r\n	<span class="green-left-heading">Personal Bests</span>\r\n</div>\r\n<div id="container-rdtree" class="row-fluid inset-data-entry">\r\n	{{#rdtrees}}\r\n	<div class="section-rdtree-items_h">\r\n		<div><span class="standard-subsection-header" style="margin-top:15px;">{{title}}</span></div>\r\n		{{#data}}\r\n			<div class="rd-entry">\r\n				<span>{{#icon}}<img src="{{icon}}" />{{/icon}}{{name}}</span>\r\n				<span>\r\n					<input type="text" class="txtRdTrees_h" treeId="{{id}}" value="{{val}}" resumeDataId="{{resumeDataId}}"/>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					\r\n				</span>\r\n			</div>\r\n		{{/data}}\r\n		<!--<a href="javascript:void(0)" class="resume_button btn-Finish-RdTree_h displayNone">FINISH</a>-->\r\n	</div>\r\n	{{/rdtrees}}\r\n</div>\r\n</div>'}),define("text!userresume/templates/academic.html",[],function(){return'<div class="sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Academic</span>\r\n	</div>\r\n	<div class="inset-data-entry">\r\n		<div id="container-academic-gpa"></div>\r\n		<div id="container-StandardizedTest"></div>\r\n		<div id="container-ApTest"></div>\r\n	</div>\r\n</div>'}),define("text!userresume/templates/awards.html",[],function(){return'<div class="row-fluid sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">Awards</span>\r\n	</div>\r\n\r\n	<div class="inset-data-entry section-new-award">\r\n		<div class="div-add-dotted well-small btn-Add-award_h" testids="{{TestIds}}">\r\n			+ Add an Award\r\n		</div>\r\n		<div class="section-new-controls displayNone">\r\n			<div class="clearfix row-fluid">\r\n				<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span>\r\n					<select class="ddl-sports-awards_h"></select>\r\n				</span>\r\n				<span>\r\n					<input type="text" class="txtAwards_h txt_name_h" placeholder="Award Name" value="{{name}}"/>\r\n				</span>\r\n				<span>\r\n					<input type="text" class="txtAwards_h txt_year_h" placeholder="Year Awarded" value="{{year}}"/>\r\n				</span>\r\n				</div>\r\n				<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span>\r\n					<textarea class="txtAwards_h txt_description_h" placeholder="Description">{{description}}</textarea>\r\n				</span>\r\n				</div>\r\n			</div>\r\n			<div style="width: 100%; padding:5px; margin: 0;">\r\n				<span class=""><a href="javascript:void(0)" class="resume_button btn-Save_award_h" >Save</a> <a href="javascript:void(0)" class="resume_button btn-Cancel-New">Cancel</a> <span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n			</div>\r\n		</div>\r\n		<br/>\r\n	</div>\r\n	<div id="section-list-awards" class="row-fluid">\r\n\r\n	</div>\r\n</div>'}),define("text!userresume/templates/contact.html",[],function(){return"<div>Contact</div>"}),define("text!userresume/templates/references.html",[],function(){return'<div class="row-fluid sub-section-prof-setting">\r\n	<div class="row-fluid">\r\n		<span class="green-left-heading">References</span>\r\n	</div>\r\n\r\n	<div class="inset-data-entry section-new-reference">\r\n		<div class="div-add-dotted well-small btn-Add-reference_h" testids="{{TestIds}}">\r\n			+ Add an Reference\r\n		</div>\r\n		<div class="well section-new-controls displayNone">\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Sport:</span>\r\n				<span class=""> <select class="ddl-sports-references_h"></select> </span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Name:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_name_h" value="{{name}}"/>\r\n				</span>\r\n			</div>\r\n\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Description:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_description_h" value="{{description}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Email:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_email_h" value="{{year}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Relationship:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_relation_h" value="{{year}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="reference-labels">Phone:</span>\r\n				<span class="">\r\n					<input type="text" class="txtReferences_h txt_phone_h" value="{{description}}"/>\r\n				</span>\r\n			</div>\r\n			<div class="clearfix row-fluid">\r\n				<span class="span12"> <a href="javascript:void(0)" class="resume_button btn-Save_reference_h" >Save</a> <a href="javascript:void(0)" class="resume_button btn-Cancel-New">Cancel</a> <span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n			</div>\r\n		</div>\r\n		<br/>\r\n	</div>\r\n	<div id="section-list-references" class="row-fluid">\r\n\r\n	</div>\r\n</div>'}),define("user/models/resume",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/resume",["facade","user/models/resume"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/rdtree",["facade","user/models/rdtree"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,resume_data_id:this.resume_data_id,user_value:this.user_value},processData:!0,url:function(){return this.action=="save"?"api/resumedataval/add/"+this.treeId+"?id1="+this.treeId:this.action=="update"?"api/resumedataval/basics/"+this.treeId+"?id1="+this.treeId:this.action=="delete"?"api/user/gpa/"+this.user_id+"?id1="+this.user_id:"api/user/addgpa/"+this.user_id+"?id1="+this.user_id},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){console.log("Show Error Message Rdtree.js Model",e),$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/gpa",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="delete"?"api/user/gpa/"+this.user_id+"?id1="+this.user_id:"api/user/addgpa/"+this.user_id+"?id1="+this.user_id},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/award",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="update"?"api/awards/basics/"+this.award_id+"?id1="+this.award_id:this.action=="save"?"api/awards/add/":(this.action=="delete","api/awards/base/"+this.award_id+"?id1="+this.award_id)},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/models/contact",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("userresume/models/reference",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"id1",processData:!0,url:function(){return this.action=="update"?"api/references/basics/"+this.reference_id+"?id1="+this.reference_id:this.action=="save"?"api/references/add/":(this.action=="delete","api/references/base/"+this.reference_id+"?id1="+this.reference_id)},showSuccessMessage:function(e){$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("user/collections/resumes",["facade","collections","user/models/resume","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/sentresumes",["facade","collections","user/collections/resumes","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/sent_resume/"+this.user_id:(this.user_id==undefined,"api/user/sent_resumes/"+this.user_id+"?id1="+this.user_id)}});return i}),define("userresume/views/sentresumeview",["require","text!userresume/templates/sentresume.html","facade","views","utils","vendor","userresume/collections/sentresumes"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/sentresumes"),h=s.extend({template:t,events:{},controls:{},messages:{dataNotExist:"Data Not Exists For Resumes."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},render:function(){var e=this;s.prototype.render.call(this)},setupView:function(){var e=this,t={user_id:e.user_id},n=new c(t);n.user_id=e.user_id,n.fetch(),l.when(n.request).done(function(){if(n.isError())return;var t=n.toJSON();if(t.length){var r=[];l.each(t,function(e,t){r.push(t.payload)}),e.Resumes=t;var i=f.to_html(e.template,{resumes:r});l(e.el).html(i)}else l(e.el).html(e.messages.dataNotExist)})}});return h}),define("user/collections/rdtree",["facade","collections","user/models/rdtree","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/rdtree",["facade","collections","user/collections/rdtree","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/rdtree/"+this.user_id:(this.user_id==undefined,"api/user/rdtree/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){var r={title:t.payload.name},i=[];for(var s in t.payload.data){var o=t.payload.data[s],u={name:o.name,id:o.id,type:o.type,val:o.val||"",resumeDataId:o.resume_data_id,icon:o.icon||null};i.push(u)}r.data=i,n.push(r)}),n}});return i}),define("userresume/views/rdtree",["require","text!userresume/templates/rdtree.html","facade","views","utils","vendor","userresume/collections/rdtree","userresume/models/rdtree"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/rdtree"),h=e("userresume/models/rdtree"),p=s.extend({template:t,events:{"click .btn-edit-rdtree_h":"MarkEdit","click .txtRdTrees_h":"MakeEdit","click .btn-Finish-RdTree_h":"FinishEdit","blur .txtRdTrees_h":"SaveResumeData"},controls:{btnEditRdTree:".btn-edit-rdtree_h",btnFinishRdTree:".btn-Finish-RdTree_h",sectionRdTreeItems:".section-rdtree-items_h",txtRdTree:".txtRdTrees_h"},messages:{dataNotExist:"Data Not Exists For RD Trees."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},setupView:function(){var e=this,t={user_id:e.user_id},n=new c(t);n.user_id=e.user_id,n.fetch(),l.when(n.request).done(function(){if(n.isError())return;e.Tree=n.parseAsRequired(),console.log("d",e.Tree);var t=f.to_html(e.template,{rdtrees:e.Tree});l(e.el).html(t)})},MarkEdit:function(e){console.log(e),l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).removeAttr("disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnFinishRdTree).fadeIn()},MarkEdit:function(e){console.log(e),l(e.target).fadeOut(),l(e.target).removeAttr("disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnFinishRdTree).fadeIn()},FinishEdit:function(e){l(e.target).fadeOut(),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.txtRdTree).attr("disabled","disabled"),l(e.target).parents(n.controls.sectionRdTreeItems).find(n.controls.btnEditRdTree).fadeIn()},SaveResumeData:function(e){var t=l(e.target).attr("treeId"),r=l(e.target).attr("resumeDataId"),i=l(e.target).val(),s={treeId:t,user_id:n.user_id,resume_data_id:r,user_value:i},o=new h(s);o.treeId=t,o.user_id=n.user_id,o.target=l(e.target),t>0?(o.action="update",o.save({id1:t})):(o.action="save",o.save()),l.when(o.request).done(function(t){var n=l(e.currentTarget).parents(".rd-entry").find(".success_h");n.removeClass("displayNone").html("Updated Successfully."),console.log("response",t),t.payload!=null&&t.payload.id>0&&(console.log(t.payload),l(e.target).attr("treeId",t.payload.id)),l('.txtRdTrees_h[resumedataid="'+t.payload.resume_data_id+'"]').val(t.payload.user_value),l(e.target).parent().find(".error_h").html("").fadeOut(),setTimeout(function(){n.addClass("displayNone").html("")},3e3)})}});return p}),define("text!userresume/templates/gpa.html",[],function(){return'<span class="standard-subsection-header">GPA</span>\r\n<div class="div-add-dotted well-small btn-Add-gpa" testids="{{TestIds}}">\r\n	+ Add a Gpa\r\n</div>\r\n<div class="section-Add-Gpa displayNone">\r\n	<div class="alert alert-danger displayNone error_h"></div>\r\n	<span class="span5">Year : \r\n		<select class="txtGpaYear_h">\r\n			<option value="">Select</option>\r\n			<option value="Senior">Senior</option>\r\n			<option value="Junior">Junior</option>\r\n			<option value="">Sophomore</option>\r\n			<option value="Freshman">Freshman</option>\r\n		</select>\r\n		</span>\r\n	<span class="span5">Score : <input type="text" class="txtGpaScore_h"/></span>\r\n	<p ><button class="resume_button btn-Save-Gpa">Save</button></p>\r\n</div>\r\n<a href="javascript:void(0)" id="edit-gpa-btn" class="edit edit-gpa displayNone"></a>\r\n{{#data}}\r\n			<div class="row-fluid">\r\n				<span class="span3">{{year}}</span>\r\n				<span class="span9">\r\n					<input type="text" class="txtGpa_h" year="{{year}}" gpaId="{{id}}" value="{{gpa}}" disabled="disabled"/>\r\n					<a href="javascript:void(0)" class="remove btn-delete-gpa" year="{{year}}"></a>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					</span>\r\n					\r\n			</div>\r\n		{{/data}}\r\n		<button class="resume_button btn-finish-gpa_h displayNone">Finish</button>'}),define("text!userresume/templates/test.html",[],function(){return'<span class="standard-subsection-header">{{Test_Type}} Tests</span>\r\n<div class="clearfix ">\r\n<div class="div-add-dotted well-small btn-Add-test" testids="{{TestIds}}">\r\n	+ Add a Test\r\n</div>\r\n<div class="section-modal-academic-tests_h"> </div>\r\n</div>\r\n\r\n<div class="section-test-topics_h">\r\n	\r\n</div>'}),define("text!userresume/templates/testtopics.html",[],function(){return'\r\n{{#data}}\r\n			<div class="row-fluid item-test-topic_h item-test-{{id}}">\r\n				<div>\r\n				<span class="span3"><h4>{{testname}} :</h4></span> <span class="span3"><a href="javascript:void(0)" class="edit edit-test"></a></span>\r\n				<span class="span9">\r\n					{{#topics}}\r\n					<div class="row-fluid">\r\n						<span class="span3">{{name}}</span>\r\n						<span class="span9"><input type="text" class="txtTestScore_h" testId="{{id}}" topicId="{{topicid}}" initial="{{score}}" value="{{score}}" disabled="disabled"/>\r\n<a href="javascript:void(0)" class="remove btn-delete-test_h" testId="{{id}}" topicId="{{topicid}}"></a>\r\n							<span class="alert alert-danger displayNone error_h"></span> <span class="alert alert-success displayNone success_h"></span>\r\n						</span>\r\n					</div>\r\n					 {{/topics}}\r\n				</span>\r\n				</div>\r\n				<div>\r\n					</div>\r\n					<a href="javascript:void(0)" class="btn btn-primary btn-finish-test-topic_h displayNone" >Finish</a>\r\n				</div>\r\n			</div>\r\n		 {{/data}}'}),define("text!userresume/templates/testlist.html",[],function(){return'<div class="modal hide fade tests-modal_h" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n<div class="modal-header">\r\n<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n<h3 id="myModalLabel">Add a Test ({{Test_Type}})</h3>\r\n</div>\r\n<div class="modal-body  well">\r\n	{{#data}}\r\n	<div class="row-fluid">\r\n		<span class="span3">\r\n		<input type="checkbox" class="chk-test-{{type}}_h chk-{{id}}" testid="{{id}}" /> </span> &nbsp;\r\n		<span class="span3"> {{testname}} </span>\r\n	</div>\r\n		{{/data}}\r\n</div>\r\n<div class="modal-footer">\r\n<button class="btn" data-dismiss="modal" aria-hidden="true">Finish</button>\r\n<!--<button class="btn btn-primary btn-Save-Positions">Finish</button> -->\r\n</div>\r\n</div>'}),define("user/collections/gpa",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/gpa",["facade","collections","user/collections/gpa","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/gpa/"+this.user_id:(this.user_id==undefined,"api/user/gpa/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload;n.push({gpa:r.gpa,year:r.year})}}),n}});return i}),define("user/collections/tests",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("userresume/collections/tests",["facade","collections","user/collections/tests","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/tests/"+this.user_id:(this.user_id==undefined,"api/user/tests/"+this.user_id+"?id1="+this.user_id+"&standardized="+(this.includeStandard||0)+"&ap="+(this.includeAp||0))},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:r.id,testname:r.name,type:r.test_type,topics:[]};for(var s in r.topics)i.topics.push({topicid:s,name:r.topics[s].name,score:r.topics[s].score==0?"":r.topics[s].score});n.push(i)}}),n}});return i}),define("userresume/collections/academictests",["facade","collections","user/collections/tests","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/academictest/listall/"+this.user_id:(this.user_id==undefined,"api/academictest/listall/0?id1="+this.user_id+"&standardized="+(this.includeStandard||0)+"&ap="+(this.includeAp||0))},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:r.id,testname:r.name,type:r.test_type,topics:[]};if(r.topics!=null)for(var s in r.topics)i.topics.push({topicid:s,name:r.topics[s].name,score:r.topics[s].score||""});n.push(i)}}),n}});return i}),define("userresume/models/test",["facade","user/models/common"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"academics_tests_topics_id",data:{user_id:this.user_id,year:this.year},processData:!0,url:function(){return this.action=="update"?"api/user/testscore/"+this.users_id+"?id1="+this.users_id:this.action=="save"?"api/user/addtestscore/"+this.users_id+"?id1="+this.users_id:this.action=="delete"?"api/user/testscore/"+this.users_id+"?id1="+this.users_id:"api/user/addtestscore/"},showSuccessMessage:function(e){console.log("showSuccessMessage test"),$(this.target).parent().find(".success_h").html(e).fadeIn(),$(this.target).parent().find(".error_h").html("").fadeOut()},showErrorMessage:function(e){$(this.target).parent().find(".success_h").html("").fadeOut(),$(this.target).parent().find(".error_h").html(e).fadeIn()}}),n}),define("userresume/views/academic",["require","text!userresume/templates/academic.html","text!userresume/templates/gpa.html","text!userresume/templates/test.html","text!userresume/templates/testtopics.html","text!userresume/templates/testlist.html","facade","views","utils","vendor","userresume/collections/gpa","userresume/collections/tests","userresume/collections/academictests","userresume/models/gpa","userresume/models/test"],function(e,t,n,r,i,s){var o,u=e("facade"),a=e("views"),f=a.SectionView,l=e("utils"),c=l.lib.Channel,h=e("vendor"),p=h.Mustache,d=u.$,v=e("userresume/collections/gpa"),m=e("userresume/collections/tests"),g=e("userresume/collections/academictests"),y=e("userresume/models/gpa"),b=e("userresume/models/test"),w=f.extend({events:{"click .edit-gpa":"EditGpa","click .edit-test":"EditTest","click .btn-Add-test":"OpenTestPopUp","change .chk-test-Standardized_h":"AddStandardTest","change .chk-test-AP_h":"AddAPTest","click .btn-finish-test-topic_h":"FinishTest","click .btn-finish-gpa_h":"FinishGpa","blur .txtGpa_h":"SaveGpa","click .btn-delete-gpa":"DeleteGpa","click .btn-Add-gpa":"AddGpa","click .btn-Save-Gpa":"SaveNewGpa","blur .txtTestScore_h":"SaveTestScore","click .btn-delete-test_h":"DeleteTestScore"},controls:{BtnFinishTestTopics:".btn-finish-test-topic_h",BtnEditTest:".edit-test",BtnFinishGpa:".btn-finish-gpa_h",BtnEditGpa:".edit-gpa",BtnSaveGpa:".btn-Save-Gpa",ContainerGpa:"#container-academic-gpa",ContainerStandard:"#container-StandardizedTest",ContainerAP:"#container-ApTest",SectionModalTests:".section-modal-academic-tests_h",SectionTestTopics:".section-test-topics_h",ItemTestTopic:".item-test-topic_h",SectionAddGpa:".section-Add-Gpa",TxtScore:".txtTestScore_h",ModalBox:".tests-modal_h",TxtGpa:".txtGpa_h",TxtGpaYear:".txtGpaYear_h",TxtGpaScore:".txtGpaScore_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistGPA:"No GPAs entered yet.",dataNotExistTests:"No Tests entered yet.",YearScoreIsRequired:"Year And Score Are Required.",MandatoryFieldsTest:"Please enter a score."},initialize:function(e){f.prototype.initialize.call(this,e),o=this,o.setOptions(e),this.init()},render:function(){f.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){o.setupView()},setupView:function(){o.setUpMainView(),o.setUpGpaView(),o.setUpStandardTestView(),o.setUpAPTestView()},setUpMainView:function(){d(o.el).html(o.template)},setUpGpaView:function(){var e={user_id:o.user_id},t=new v(e);t.user_id=o.user_id,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.gpa=t.parseAsRequired();var e=p.to_html(n,{data:o.gpa}),r=d(o.el).find(o.controls.ContainerGpa);r.html(e),parseInt(t.models.length)>0?r.find("a#edit-gpa-btn").css("visibility","visible"):r.find("a#edit-gpa-btn").css("visibility","hidden")})},EditGpa:function(e){d(e.target).parent().find(o.controls.TxtGpa).removeAttr("disabled"),d(e.target).parent().find(o.controls.BtnFinishGpa).fadeIn(),d(e.target).fadeOut()},SaveGpa:function(e){var t=d(e.target).attr("year"),n=d(e.target).val(),r={user_id:o.user_id,gpa:n,year:t},i=new y(r);i.user_id=o.user_id,i.target=d(e.target),i.save()},DeleteGpa:function(e){var t=d(e.target).attr("year"),n={user_id:o.user_id,year:t,id1:1},r=new y(n);r.user_id=o.user_id,r.id1=1,r.action="delete",r.target=d(e.target),r.idAttribute="year",r.destroy({data:{user_id:o.user_id,year:t},success:function(){o.setUpGpaView()}}),d.when(r.request).done(function(){d(e.target).parent().find(o.controls.TxtGpa).val("")})},FinishGpa:function(e){d(e.target).parent().find(o.controls.TxtGpa).attr("disabled","disabled"),d(e.target).parent().find(o.controls.BtnEditGpa).fadeIn(),d(e.target).fadeOut()},AddGpa:function(e){o.$(o.controls.SectionAddGpa).fadeIn().css("display","inline-block")},SaveNewGpa:function(e){var t=o.$(o.controls.SectionAddGpa).find(o.controls.TxtGpaYear).val(),n=o.$(o.controls.SectionAddGpa).find(o.controls.TxtGpaScore).val();if(t==""||n=="")o.$(o.controls.SectionAddGpa).find(o.controls.lblError).html(o.messages.YearScoreIsRequired).fadeIn();else{o.$(o.controls.SectionAddGpa).find(o.controls.lblError).html("").fadeOut();var r={user_id:o.user_id,gpa:n,year:t},i=new y(r);i.user_id=o.user_id,i.target=d(e.target).parent(),i.save(),d.when(i.request).done(function(){o.setUpGpaView()})}},setUpStandardTestView:function(){var e={user_id:o.user_id},t=new m(e);t.user_id=o.user_id,t.includeStandard=1,t.includeAp=0,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.standardTests=t.parseAsRequired();var e="";d.each(o.standardTests,function(t,n){e+=n.id+","});var n=p.to_html(r,{Test_Type:"Standardized",TestIds:e});d(o.el).find(o.controls.ContainerStandard).html(n);var s=p.to_html(i,{Test_Type:"Standardized",data:o.standardTests});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionTestTopics).html(s),o.setUpStandardTestListAllView()})},setUpStandardTestListAllView:function(){var e={user_id:o.user_id},t=new g(e);t.user_id=o.user_id,t.includeStandard=1,t.includeAp=0,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.standardTestsListAll=t.parseAsRequired();if(o.standardTestsListAll.length>0){var e=p.to_html(s,{Test_Type:"Standardized",data:o.standardTestsListAll});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionModalTests).html(e)}else o.$el(o.controls.ContainerStandard).find(o.controls.SectionModalTests).html(o.messages.dataNotExistTests)})},AddStandardTest:function(e){var t=d(e.target).attr("testid");if(d(e.target).is(":checked")){var n=[];d.each(o.standardTestsListAll,function(e,r){r.id==t&&n.push(r)});var r=p.to_html(i,{Test_Type:"Standardized",data:n});d(o.el).find(o.controls.ContainerStandard).find(o.controls.SectionTestTopics).append(r)}else d(o.el).find(o.controls.ContainerStandard).find(".item-test-"+t).remove()},setUpAPTestView:function(){var e={user_id:o.user_id},t=new m(e);t.user_id=o.user_id,t.includeStandard=0,t.includeAp=1,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.apTests=t.parseAsRequired();var e="";d.each(o.apTests,function(t,n){e+=n.id+","});var n=p.to_html(r,{Test_Type:"AP",TestIds:e});d(o.el).find(o.controls.ContainerAP).html(n);var s=p.to_html(i,{Test_Type:"AP",data:o.apTests});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionTestTopics).html(s),o.setUpAPTestListAllView()})},setUpAPTestListAllView:function(){var e={user_id:o.user_id},t=new g(e);t.user_id=o.user_id,t.includeStandard=0,t.includeAp=1,t.fetch(),d.when(t.request).done(function(){if(t.isError())return;o.apTestsListAll=t.parseAsRequired();if(o.apTestsListAll.length>0){var e=p.to_html(s,{Test_Type:"AP",data:o.apTestsListAll});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionModalTests).html(e)}else d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionModalTests).html(o.messages.dataNotExistTests)})},AddAPTest:function(e){var t=d(e.target).attr("testid");if(d(e.target).is(":checked")){var n=[];d.each(o.apTestsListAll,function(e,r){r.id==t&&n.push(r)});var r=p.to_html(i,{Test_Type:"Standardized",data:n});d(o.el).find(o.controls.ContainerAP).find(o.controls.SectionTestTopics).append(r)}else d(o.el).find(o.controls.ContainerAP).find(".item-test-"+t).remove()},EditTest:function(e){d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.TxtScore).removeAttr("disabled"),d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.BtnFinishTestTopics).fadeIn(),d(e.target).fadeOut()},FinishTest:function(e){d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.TxtScore).attr("disabled","disabled"),d(e.target).parents(o.controls.ItemTestTopic).find(o.controls.BtnEditTest).fadeIn(),d(e.target).fadeOut()},OpenTestPopUp:function(e){var t=d(e.target).attr("testids"),n=t.split(",");d.each(n,function(t,n){o.$(e.target).parent().find(o.controls.ModalBox).find(".chk-"+n).attr("checked","checked")}),o.$(e.target).parent().find(o.controls.ModalBox).modal("show")},SaveTestScore:function(e){var t=d(e.target).attr("topicId"),n=d(e.target).val(),r=d(e.target).attr("initial"),i="save";if(d.trim(n)==""){d(e.target).parent().find(o.controls.lblError).html(o.messages.MandatoryFieldsTest).fadeIn();return}d(e.target).parent().find(o.controls.lblError).html("").fadeOut();var s={id1:o.user_id,academics_topics_id:t,score:n,users_id:o.user_id};r!=""&&(i="update",s.academics_tests_topics_id=t);var u=d(e.target).attr("testscoreid"),a=new b(s);a.users_id=o.user_id,a.action=i,a.target=d(e.target),a.save({success:function(){}}),d.when(a.request).done(function(){d(e.target).attr("initial",n)})},DeleteTestScore:function(e){var t=d(e.target).attr("topicid"),n={users_id:o.user_id,id1:1,academics_tests_topics_id:t},r=new b(n);r.users_id=o.user_id,r.id1=o.user_id,r.academics_tests_topics_id=t,r.action="delete",r.target=d(e.target),r.destroy({data:{users_id:o.user_id,academics_tests_topics_id:t},success:function(){d(e.target).val("").attr("initial","")}}),d.when(r.request).done(function(){d(e.target).parent().find(o.controls.TxtScore).val("")})}});return w}),define("text!userresume/templates/listAwards.html",[],function(){return'{{#data}}\r\n	<div class="section-rdtree-items_h inset-data-entry">\r\n		<div class="row-fluid awards-sports-header"><span class="standard-subsection-header">{{#icon}}<img src="{{icon}}" />{{/icon}}{{sports_name}}</span></div>\r\n		{{#awards}}\r\n		<div class="section-new-award" style="background-color: #eeeeee; border-bottom: 1px solid #ccc;">\r\n			<div class="row-fluid section-new-controls">\r\n				<span class=""><span class="award-labels">Award Name:</span> <input type="text" class="txtAwards_h txt_name_h" value="{{name}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Year Awarded:</span> <input type="text" class="year txtAwards_h txt_year_h" value="{{year}}" disabled="disabled"/></span>\r\n				<span>\r\n					<a href="javascript:void(0)" class="edit edit_award_h"></a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Update_award_h displayNone" sportid="{{sports_id}}" awardid="{{id}}">Save</a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Cancel-Existing_award_h displayNone">Cancel</a>\r\n					<a href="javascript:void(0)" class="remove btn-remove_award_h" awardid="{{id}}"></a>\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n\r\n				</span>\r\n\r\n				<span><textarea style="width:90%;" type="text" class="txtAwards_h txt_description_h" disabled="disabled">{{description}}</textarea></span>\r\n\r\n			</div>\r\n		</div>	\r\n		{{/awards}}\r\n	</div>\r\n	{{/data}}'}),define("user/collections/awards",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("userresume/collections/awards",["facade","collections","user/collections/awards","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/awards/"+this.user_id:(this.user_id==undefined,"api/user/awards/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={sports_id:r.id,sports_name:r.name,icon:r.icon,awards:[]};$.each(r.awards,function(e,t){i.awards.push({id:t.id,name:t.name,description:t.description,year:t.year})}),n.push(i)}}),n}});return i}),define("userresume/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({sport_type:1,male:1,female:0,url:function(){return testpath?testpath+"/api/sport/listall":(this.gender==undefined,"/api/sport/listall/?sport_type="+this.sport_type+"&male="+this.male+"&female="+this.female+"&sport_type_id="+this.sport_type_id)}}),i}),define("userresume/views/awards",["require","text!userresume/templates/awards.html","text!userresume/templates/listAwards.html","facade","views","utils","vendor","userresume/collections/awards","userresume/collections/sports","userresume/models/award"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("userresume/collections/awards"),p=e("userresume/collections/sports"),d=e("userresume/models/award"),v=o.extend({template:t,events:{"click .btn-Add-award_h":"AddNewAward","click .btn-Save_award_h":"SaveNewAward","click .btn-Update_award_h":"UpdateAward","click .btn-Cancel-New":"CancelNew","click .btn-Cancel-Existing_award_h":"CancelExisting","click .btn-remove_award_h":"RemoveAward","click .edit_award_h":"EditAward"},controls:{listContainer:"#section-list-awards",newAwardContainer:".section-new-award",newAwardControls:".section-new-controls",btnAddAwardsExisting:".btn-Add-Existing",btnAddNew:".btn-Add",btnCancelExisting:".btn-Cancel-Existing_award_h",btnRemoveExisting:".btn-remove_award_h",btnUpdateAwardExisting:".btn-Update_award_h",btnEditAward:".edit_award_h",ddlSports:".ddl-sports-awards_h",newControls:".txtAwards_h",txtName:".txt_name_h",txtDescription:".txt_description_h",txtYear:".txt_year_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistAwards:"No Awards Entered Yet.",MandatoryFields:"All fields are mandatory."},initialize:function(e){o.prototype.initialize.call(this,e),r=this,r.setOptions(e),this.init()},render:function(){o.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){r.setupView()},setupView:function(){r.setUpMainView(),r.setUpListView()},setUpMainView:function(){var e=l.to_html(r.template,{});c(r.el).html(e)},setUpListView:function(){var e={user_id:r.user_id},t=new h(e);t.user_id=r.user_id,t.fetch(),c.when(t.request).done(function(){if(t.isError())return;r.awards=t.parseAsRequired();if(r.awards.length>0){var e=l.to_html(n,{data:r.awards});c(r.el).find(r.controls.listContainer).html(e)}else c(r.el).find(r.controls.listContainer).html(r.messages.dataNotExistAwards)})},ClearControls:function(e){console.log(c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls)),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newControls).val(""),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls).fadeOut()},AddNewAward:function(e){r.ClearControls(e);var t=c(e.target).parents(r.controls.newAwardContainer).find(r.controls.ddlSports);c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls).fadeIn();if(r.sports&&r.sports.length>0){r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport");return}var n=new p;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,r.gender=="male"?n.male=1:r.gender=="famale"&&(n.female=0),n.fetch(),c.when(n.request).done(function(){if(n.isError())return;var e=n.toJSON();(e==null||e.length<1)&&r.$(r.controls.ddlSports).parent().find(r.controls.fieldMessage).html(r.messages.dataNotExist).stop().fadeIn(),r.sports=[];for(var i in e)r.sports.push(e[i].payload);r.sort(r.sports,"sport_name",!1),r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport")})},AddExistingAward:function(){console.log("Add Existing")},SaveAward:function(e,t){var n=c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newAwardControls),i=c(e.target).attr("sportid")||n.find(r.controls.ddlSports).val(),s=n.find(r.controls.txtName).val(),o=n.find(r.controls.txtYear).val(),u=n.find(r.controls.txtDescription).val();if(i==""||i<1||c.trim(s)==""||c.trim(u)==""||c.trim(o)==""){n.find(r.controls.lblError).html(r.messages.MandatoryFields).fadeIn();return}n.find(r.controls.lblError).html("").fadeOut();var a={description:u,name:s,sports_id:i,year:o,users_id:r.user_id},f=0;t=="update"&&(f=c(e.target).attr("awardid"),a.id1=c(e.target).attr("awardid"));var l=new d(a);l.users_id=r.user_id,l.award_id=f,l.action=t,l.target=c(e.target),l.save(),c.when(l.request).done(function(){r.ClearControls(e),r.setUpListView()})},SaveNewAward:function(e){r.SaveAward(e,"save")},EditAward:function(e){c(e.target).parents(r.controls.newAwardContainer).find(r.controls.newControls).removeAttr("disabled"),c(e.target).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnUpdateAwardExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnCancelExisting).fadeIn()},UpdateAward:function(e){r.SaveAward(e,"update")},CancelNew:function(e){r.ClearControls(e)},CancelExisting:function(e){c(e.target).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnUpdateAwardExisting).fadeOut(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnEditAward).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find("textarea, input").attr("disabled","disabled")},RemoveAward:function(e){var t=c(e.target).attr("awardid"),n={id1:t,award_id:t,users_id:r.user_id},i=new d(n);i.id1=t,i.users_id=r.user_id,i.award_id=t,i.action="delete",i.target=c(e.target),i.destroy({success:function(){r.setUpListView()}})}});return v}),define("user/collections/contacts",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}});return i}),define("userresume/collections/contacts",["facade","collections","user/collections/contacts","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/contact/"+this.user_id:(this.user_id==undefined,"api/user/contact/"+this.user_id+"?id1="+this.user_id)},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload;n.push({gpa:r.gpa,year:r.year})}}),n}});return i}),define("userresume/views/contacts",["require","text!userresume/templates/contact.html","facade","views","utils","vendor","userresume/collections/contacts"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("userresume/collections/contacts"),h=s.extend({template:t,events:{},controls:{},messages:{dataNotExistContacts:"No Contacts."},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){n.setupView()},setupView:function(){n.setUpMainView(),n.setUpListView()},setUpMainView:function(){},setUpListView:function(){var e=this,n={user_id:e.user_id},r=new c(n);r.user_id=e.user_id,r.fetch(),l.when(r.request).done(function(){if(r.isError())return;e.contacts=r.parseAsRequired();if(e.contacts.length>0){var n=f.to_html(t,{data:e.contacts});l(e.el).find(e.el).html(n)}else l(e.el).find(e.controls.ContainerGpa).html(e.messages.dataNotExistContacts)})}});return h}),define("text!userresume/templates/listReferences.html",[],function(){return'\r\n{{#data}}\r\n<div class="section-rdtree-items_h inset-data-entry">\r\n	<div class="row-fluid awards-sports-header"><span class="standard-subsection-header">{{#icon}}<img src="{{icon}}" />{{/icon}}{{sports_name}}</span></div>\r\n\r\n		{{#references}}\r\n		<div class="section-new-reference"  style="background-color: #eeeeee; border-bottom: 1px solid #ccc; padding-bottom: 10px;">\r\n			<div class="row-fluid section-new-controls">\r\n\r\n				<span class=""><span class="award-labels">Reference Name:</span> <input type="text" class="txtReferences_h txt_name_h" value="{{name}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Relationship:</span> <input type="text" class="txtReferences_h txt_relation_h" value="{{relation}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Phone:</span> <input type="text" class="txtReferences_h txt_phone_h" value="{{phone}}" disabled="disabled"/></span>\r\n				<span class=""><span class="award-labels">Email:</span> <input type="text" class="txtReferences_h txt_email_h" value="{{email}}" disabled="disabled"/></span>\r\n				<span><textarea style="width:90%;" type="text" class="txtReferences_h txt_description_h" disabled="disabled">{{description}}</textarea></span>\r\n				<br />\r\n				<span class="">\r\n					<a href="javascript:void(0)" class="edit edit_reference_h"></a><a href="javascript:void(0)" class="remove btn-remove_reference_h" referenceid="{{id}}"></a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Update_reference_h displayNone" sportid="{{sports_id}}" referenceid="{{id}}">Save</a>\r\n					<a href="javascript:void(0)" class="resume_button btn-Cancel-Existing_reference_h displayNone">Cancel</a>\r\n\r\n					<span class="alert alert-danger displayNone error_h"></span>\r\n					<span class="alert alert-success displayNone success_h"></span>\r\n					\r\n				</span>\r\n				</div>\r\n		</div>	\r\n		{{/references}}\r\n	</div>\r\n	{{/data}}'}),define("user/collections/references",["facade","collections","user/models/common","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=r[i];s.sports_id=i;var o=new n;o.id=Math.ceil(Math.random()*1e5),o.set("payload",s),o.set("desc",t.desc),o.set("exec_data",t.exec_data),e.push(o)}e.deferred.resolve(t)}});return i}),define("userresume/collections/references",["facade","collections","user/collections/references","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel,i=n.extend({url:function(){return testpath?testpath+"/api/user/references/"+this.user_id:"api/user/references/"+this.user_id+"?id1="+this.user_id},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return console.log("models References",t),t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={sports_id:r.id,sports_name:r.name,icon:r.icon,references:[]};$.each(r.references,function(e,t){i.references.push({id:t.id,name:t.name,description:t.long_description,relation:t.relation,email:t.email,phone:t.phone})}),n.push(i)}}),console.log("del",n),n}});return i}),define("userresume/views/references",["require","text!userresume/templates/references.html","text!userresume/templates/listReferences.html","facade","views","utils","vendor","userresume/collections/references","userresume/collections/sports","userresume/models/reference"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=s.SectionView,u=e("utils"),a=u.lib.Channel,f=e("vendor"),l=f.Mustache,c=i.$,h=e("userresume/collections/references"),p=e("userresume/collections/sports"),d=e("userresume/models/reference"),v=o.extend({template:t,events:{"click .btn-Add-reference_h":"AddNewReference","click .btn-Save_reference_h":"SaveNewReference","click .btn-Update_reference_h":"UpdateReference","click .btn-Cancel-New":"CancelNew","click .btn-Cancel-Existing_reference_h":"CancelExisting","click .btn-remove_reference_h":"RemoveReference","click .edit_reference_h":"EditReference"},controls:{listContainer:"#section-list-references",newReferenceContainer:".section-new-reference",newReferenceControls:".section-new-controls",btnAddReferencesExisting:".btn-Add-Existing",btnAddNew:".btn-Add",btnCancelExisting:".btn-Cancel-Existing_reference_h",btnRemoveExisting:".btn-remove_reference_h",btnUpdateReferenceExisting:".btn-Update_reference_h",btnEditReference:".edit_reference_h",ddlSports:".ddl-sports-references_h",newControls:".txtReferences_h",txtName:".txt_name_h",txtDescription:".txt_description_h",txtYear:".txt_year_h",txtEmail:".txt_email_h",txtPhone:".txt_phone_h",txtRelation:".txt_relation_h",lblError:".error_h",lblSuccess:".success_h"},messages:{dataNotExistReferences:"No References entered yet.",MandatoryFields:"All Fields are Mandatory."},initialize:function(e){o.prototype.initialize.call(this,e),r=this,r.setOptions(e),this.init()},render:function(){o.prototype.render.call(this)},setOptions:function(e){this.user_id=e.user_id},init:function(){r.setupView()},setupView:function(){r.setUpMainView(),r.setUpListView()},setUpMainView:function(){var e=l.to_html(r.template,{});c(r.el).html(e)},setUpListView:function(){var e={user_id:r.user_id},t=new h(e);t.user_id=r.user_id,t.fetch(),c.when(t.request).done(function(){if(t.isError())return;r.references=t.parseAsRequired();if(r.references.length>0){var e=l.to_html(n,{data:r.references});c(r.el).find(r.controls.listContainer).html(e)}else c(r.el).find(r.controls.listContainer).html(r.messages.dataNotExistReferences)})},ClearControls:function(e){c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newControls).val(""),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls).fadeOut()},AddNewReference:function(e){r.ClearControls(e);var t=c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.ddlSports);c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls).fadeIn();if(r.sports&&r.sports.length>0){r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport");return}var n=new p;n.sport_type=1,n.sport_type_id=1,n.male=1,n.female=0,r.gender=="male"?n.male=1:r.gender=="famale"&&(n.female=0),n.fetch(),c.when(n.request).done(function(){if(n.isError())return;var e=n.toJSON();(e==null||e.length<1)&&r.$(r.controls.ddlSports).parent().find(r.controls.fieldMessage).html(r.messages.dataNotExist).stop().fadeIn(),r.sports=[];for(var i in e)r.sports.push(e[i].payload);r.sort(r.sports,"sport_name",!1),r.setDropdownOptions(r.sports,"sport_name","sport_id",t,"Select Sport")})},AddExistingReference:function(){console.log("Add Existing")},SaveReference:function(e,t){var n=c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newReferenceControls),i=c(e.target).attr("sportid")||n.find(r.controls.ddlSports).val(),s=n.find(r.controls.txtName).val(),o=n.find(r.controls.txtDescription).val(),u=n.find(r.controls.txtRelation).val(),a=n.find(r.controls.txtEmail).val(),f=n.find(r.controls.txtPhone).val();if(i==""||i<1||c.trim(s)==""||c.trim(f)==""){n.find(r.controls.lblError).html(r.messages.MandatoryFields).fadeIn();return}n.find(r.controls.lblError).html("").fadeOut();var l={users_id:r.user_id,sports_id:i,name:s,relation:u,email:a,phone:f,long_description:o},h=0;t=="update"&&(h=c(e.target).attr("referenceid"),l.id1=c(e.target).attr("referenceid"));var p=new d(l);p.users_id=r.user_id,p.reference_id=h,p.action=t,p.target=c(e.target),p.save(),c.when(p.request).done(function(){r.ClearControls(e),r.setUpListView()})},SaveNewReference:function(e){r.SaveReference(e,"save")},EditReference:function(e){c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.newControls).removeAttr("disabled"),c(e.target).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnUpdateReferenceExisting).fadeIn(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnCancelExisting).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeOut()},UpdateReference:function(e){r.SaveReference(e,"update")},CancelNew:function(e){r.ClearControls(e)},CancelExisting:function(e){c(e.target).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnUpdateReferenceExisting).fadeOut(),c(e.target).parents(r.controls.newReferenceContainer).find(r.controls.btnEditReference).fadeIn(),c(e.target).parents(r.controls.newAwardContainer).find(r.controls.btnRemoveExisting).fadeIn()},RemoveReference:function(e){var t=c(e.target).attr("referenceid"),n={id1:t,reference_id:t,users_id:r.user_id},i=new d(n);i.id1=t,i.users_id=r.user_id,i.reference_id=t,i.action="delete",i.target=c(e.target),i.destroy({success:function(){r.setUpListView()}})}});return v}),define("userresume",["require","text!userresume/templates/layout.html","text!userresume/templates/sentresume.html","text!userresume/templates/basic_info_header.html","text!userresume/templates/rdtree.html","text!userresume/templates/academic.html","text!userresume/templates/awards.html","text!userresume/templates/contact.html","text!userresume/templates/references.html","facade","controller","models","views","utils","profilesetting/models/basic_info","userresume/models/resume","userresume/models/rdtree","userresume/models/gpa","userresume/models/award","userresume/models/contact","userresume/models/reference","profilesetting/views/basic_info","userresume/views/sentresumeview","userresume/views/rdtree","userresume/views/academic","userresume/views/awards","userresume/views/contacts","userresume/views/references"],function(e,t,n,r,i,s,o,u,a){var f,l=e("facade"),c=e("controller"),h=e("models"),p=e("views"),d=e("utils"),v=l.$,m=l._,g=d.debug,y=d.lib.Channel,b=p.LayoutView,w=e("profilesetting/models/basic_info"),E=e("userresume/models/resume"),S=e("userresume/models/rdtree"),x=e("userresume/models/gpa"),T=e("userresume/models/award"),N=e("userresume/models/contact"),C=e("userresume/models/reference"),k=e("profilesetting/views/basic_info"),L=e("userresume/views/sentresumeview"),A=e("userresume/views/rdtree"),O=e("userresume/views/academic"),M=e("userresume/views/awards"),_=e("userresume/views/contacts"),D=e("userresume/views/references"),f=c.extend({cssArr:["/pages/profilesetting/profilesettings.css"],events:{},initialize:function(e){return y("load:css").publish(this.cssArr),m.bindAll(this),this.scheme=[],e.id&&(this.id=e.id,this.init()),this},init:function(){this.setupLayout().render(),this.setupView(),this.handleDeferreds()},setupLayout:function(){var e;if(this.layout)return this.layout;var e=new b({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"});return this.layout=e,this.layout},setupView:function(){var e=this;this.basicInfoModel=new w,this.basicInfoModel.id=e.id,this.basicInfoModel.fetch(),v.when(this.basicInfoModel.request).done(function(){var t=e.basicInfoModel.toJSON();e.gender=t.payload.gender,e.setUpBasicView(),e.setUpSentResumeView(),e.setUpRdTreeView()})},setUpBasicView:function(){var e=this;this.basicView=new k({model:new w,template:r,name:"basic-info",destination:"#section-basics-prof-setting",user_id:e.id,id:e.id}),this.scheme.push(this.basicView)},setUpSentResumeView:function(){var e=this;this.sentResumeView=new L({model:new E,template:n,name:"sent-resume",destination:"#section-sent-resume",user_id:e.id,id:e.id}),this.scheme.push(this.sentResumeView),this.layout.render()},setUpRdTreeView:function(){var e=this;this.rdTreeView=new A({model:new S,template:i,name:"rd-tree",destination:"#section-RD-Tree",user_id:e.id}),this.scheme.push(this.rdTreeView),this.layout.render()},setUpAcademicView:function(){var e=this;this.academicView=new O({model:new x,template:s,name:"resume-academic",destination:"#section-academic",user_id:e.id}),this.scheme.push(this.academicView),this.layout.render()},setUpAwardsView:function(){var e=this;this.awardsView=new M({model:new T,template:o,name:"resume-awards",destination:"#section-awards",user_id:e.id}),this.scheme.push(this.awardsView),this.layout.render()},setUpContactsView:function(){var e=this;this.contactsView=new _({model:new N,template:u,name:"resume-contacts",destination:"#section-contacts",user_id:e.id}),this.scheme.push(this.contactsView),this.layout.render()},setUpReferenceView:function(){var e=this;this.referenceView=new D({model:new C,template:a,name:"resume-references",destination:"#section-references",user_id:e.id}),this.scheme.push(this.referenceView),this.layout.render()}});return f}),define("site/models/phrase",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("packages/site/collections/phrases",["facade","collections","site/models/phrase","utils","controller"],function(e,t,n,r,i){var s,o=t.BaseCollection,u=t.ApplicationStates;return _=e._,Channel=r.lib.Channel,s=o.extend({model:n,url:function(){return base_url+"api/phrase/listall"},saveToLocalStorage:function(e){var t=i.prototype.appStates;t&&(t.add({name:"phrases",data:this.toJSON(),storage:"localStorage",expires:new Date(Date.now()+3154e5)}),t.save("phrases"))},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.saveToLocalStorage(e)}}),s}),define("usercontrols/tag/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return"/api/sport/listall/"}}),i}),define("usercontrols/tag/tag",["require","text!usercontrols/tag/templates/layout.html","facade","controller","models","views","usercontrols/tag/models/basic_info","usercontrols/tag/collections/sports","usercontrols/tag/views/main"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("usercontrols/tag/models/basic_info"),d=e("usercontrols/tag/views/main"),n=i.extend({cssArr:["/usercontrols/tag/tag.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.gender&&(this.gender=e.gender),this.init(),this},init:function(){this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){console.log("Set Up Layout Tag");if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setUpMainView:function(){console.log("Set Up Main View Tag"),c("tag-team-success").subscribe(this.tagFunction);var e=this;this.tagView=new d({model:new p,template:t,name:"tag-main",destination:"#main",user_id:e.id,channel:"tag-team-success"}),this.scheme.push(this.tagView),this.layout.render()},tagFunction:function(e){alert(JSON.stringify(e))}});return n}),define("text!usercontrols/addgame/templates/layout.html",[],function(){return'<div class="add-game-container-h"></div>\r\n<!--div class="add-game-container-h"></div>\r\n	<div class="well-large container_add_game">\r\n<div class="clear"></div>\r\n	<div class="section-Add-Sports_h">\r\n		<div class="section-game-date_h floatLeft">\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" placeholder="Time" maxlength="5" />\r\n			\r\n			<span class="spn-ddl-time-period_h"></span>		\r\n			<div class="clear"></div>\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n		<div class="clear"></div>\r\n	<div class="clear"></div>\r\n		<div class="row-fluid section-game-sports_h">\r\n<span class="span-ddl-sports_h">\r\n				</span>\r\n			<div class="clear"></div>	\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n<div class="clear"></div>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-game-teams_h team-one_h displayNone">\r\n		<div class="clear"></div>\r\n		Select Team 1 :\r\n			<div class="clear"></div>\r\n			<span class="span_ddl_team_h span_ddl_team_one_h"></span>\r\n		<a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a>\r\n		<div class="section-new-team_h">\r\n			<input type="text"class="txt txt-game-team_h displayNone" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score : \r\n			<input type="text" class="txt-score-team_h" />\r\n		</div>\r\n		<div class="section-game-radio_h">			\r\n			Home &nbsp;<input type="radio" name="rdo-team1_h" value="home" class="rdo-game-location_h rdo-game-location-one-home_h" team="one"> &nbsp;&nbsp;\r\n			Away &nbsp;<input type="radio" name="rdo-team1_h" value="away" class="rdo-game-location_h" team="one">\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n	<div class="section-individual-game_h displayNone">\r\n		<input type="text"class="txt-individual-game_h" placeholder="Enter Game" />\r\n		<span class="indicator_h"></span>\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-individual-location_h displayNone" placeholder="Enter Location Id"  />\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n			<div class="clear"></div>\r\n\r\n	</div>\r\n\r\n	<div class="section-game-teams_h team-two_h displayNone">\r\n		<div class="clear"></div>\r\n		Select Team 2 :\r\n			<div class="clear"></div>\r\n		<div class="section-new-team_h">\r\n			<input type="text"class="txt-game-team_h" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score :\r\n			<input type="text" class="txt-score-team_h"/>\r\n		</div>\r\n		<div class="section-game-radio_h">\r\n			Home &nbsp;<input type="radio" name="rdo-team2_h" value="home" class="rdo-game-location_h rdo-game-location-two-home_h"  team="two"> &nbsp;&nbsp;\r\n			Away  &nbsp;<input type="radio" name="rdo-team2_h" value="away" class="rdo-game-location_h"   team="two">			\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n	<div class="section-main-location_h displayNone">\r\n		<div class="location-view-h">&nbsp;</div>\r\n		<input type="hidden" class="txt-game-location-id_h displayNone"/>\r\n		<div class="div-game-location_h"></div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div>\r\n\r\n	</div>\r\n	<div class="clear"></div>\r\n\r\n</div-->\r\n'}),define("user/models/basic_info",["facade","user/models/basics"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("usercontrols/addgame/collections/teams",["facade","collections","sportorg/collections/teams","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.team_name&&(e+="&searchtext="+encodeURIComponent(this.team_name)),this.states_id&&(e+="&states_id="+this.states_id),this.cities_id&&(e+="&cities_id="+this.cities_id),this.sports_id&&(e+="&sports_id="+this.sports_id),this.seasons_id&&(e+="&seasons_id="+this.seasons_id),this.year&&(e+="&year="+this.year),this.complevels_id&&(e+="&complevels_id="+this.complevels_id),"/api/team/search?limit=5"+e}}),i}),define("usercontrols/addgame/collections/teams_user",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){return"/api/user/teams/"+this.user_id+"?sport_id="+this.sports_id},parseAsRequired:function(){var e=this,t=e.toJSON(),n=[];return t.length&&$.each(t,function(e,t){if(t!=null&&t.payload!=null){var r=t.payload,i={id:null,fulladdress:""};r&&r.org_sport_link_obj&&r.org_sport_link_obj.org&&r.org_sport_link_obj.org.locations&&(i=r.org_sport_link_obj.org.locations);var s={team_id:r.id,team_name:r.team_name,location_id:i.id,location_name:i.full_address};n.push(s)}}),n},AppendItem:function(e){var t=this,n=t.toJSON(),r={payload:e};return n.push(r),n}}),i}),define("usercontrols/addgame/collections/games_search",["facade","collections","sportorg/collections/games","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({url:function(){var e="";return this.game_name&&(e+="searchtext="+this.game_name),this.sports_id&&(e+="&sports_id="+this.sports_id),"/api/game/search?"+e}}),i}),define("usercontrols/addgame/collections/orgs",["facade","collections","sportorg/collections/orgs","utils"],function(e,t,n){var r;return r=n.extend({}),r}),define("usercontrols/addgame/models/team",["facade","sportorg/models/team"],function(e,t){var n,r=e._,i=e.Backbone;return n=t.extend({parseAsRequired:function(e){var t=this,n={};if(e!=null&&e.payload!=null){var r=e.payload,i={id:null,fulladdress:""},s={id:null,sport_name:""};r&&r.org_sport_link_obj&&(r.org_sport_link_obj.org&&r.org_sport_link_obj.org.locations&&(i=r.org_sport_link_obj.org.locations),r.org_sport_link_obj.sport&&(s=r.org_sport_link_obj.sport)),console.log(r),n={team_id:r.id,team_name:r.team_name,location_id:i.id,location_name:i.full_address,sports_name:s.sport_name,sports_id:s.id,complevels_id:r.complevels_id,seasons_id:r.seasons_id,year:r.year,states_id:r.org_sport_link_obj.org.states_id,sports_club:r.org_sport_link_obj.org.sports_club,single_sport_id:r.org_sport_link_obj.org.single_sport_id}}return n}}),n}),define("usercontrols/addgame/models/team_add",["facade","sportorg/models/team"],function(e,t){var n,r=e._;return n=t.extend({url:function(){var e="";return this.games_id&&(e+="?games_id="+this.games_id),"/api/team/game/"+this.teams_id+e}}),n}),define("usercontrols/addgame/models/game",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"game_id",url:function(){return"/api/game/add/"+this.game_id}}),n}),define("usercontrols/addgame/models/uslgamelink",["facade","sportorg/models/game"],function(e,t){var n,r=e._;return n=t.extend({idAttribute:"game_id",url:function(){return"/api/uslgamelink/add/"}}),n}),define("text!usercontrols/addgame/templates/orgchoose.html",[],function(){return'<div class="org-list-title">No Teams Matched, but we did find the following organizations.  Click one of these organzations to add a(n)\r\n	<%=seasoninfo.complevel %> <%=seasoninfo.season %> <%= seasoninfo.year %> team.</div>\r\n<ul id="choose-org">\r\n	<% _.each(data,function(val,index){ %>\r\n		<li class="add-team-to-org-h" data-id="<%= val.id %>" data-club-name="<%= val.name %>">\r\n			<span class="org-name"><%= val.name %></span>\r\n			<span class="org-location"><%= val.locations.full_address %></span>\r\n		</li>\r\n	<% }); %>\r\n	<li class="add-team-to-new-org-h">\r\n		<span class="org-name">Nope, none of these match</span>\r\n		<span class="org-location">Click here to create <%= user_text %> <%=seasoninfo.complevel %> <%=seasoninfo.season %> <%= seasoninfo.year %></span>\r\n	</li>\r\n</ul>'}),define("usercontrols/addgame/models/org_addteam",["require","facade","usercontrols/addgame/models/team"],function(e){var t,n=e("facade"),r=n._,i=e("usercontrols/addgame/models/team");return t=i.extend({url:function(){return"/api/team/add"}}),t}),define("usercontrols/addgame/views/orgchoose",["require","text!usercontrols/addgame/templates/orgchoose.html","usercontrols/addgame/models/org_addteam","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=e("usercontrols/addgame/models/org_addteam"),c=r.$,h=i.BaseView,p=r.Backbone,d;return p.View.extend({template:t,events:{"click li.add-team-to-org-h":"addTeamToOrg","click li.add-team-to-new-org-h":"addTeamToNewOrg"},initialize:function(e){d=this,console.log("ORG CHOOSE VIEW",e),d.setOptions(e),d.render()},addTeamToNewOrg:function(e){e.stopPropagation(),e.preventDefault(),this.createNewOrgCallback&&_.isFunction(this.createNewOrgCallback)&&this.createNewOrgCallback()&&this.destroy_view()},addTeamToOrg:function(e){e.stopPropagation(),e.preventDefault();var t=c(e.currentTarget).data("id"),n=this,r=new l({orgs_id:t,complevels_id:this.seasoninfo.complevels_id,seasons_id:this.seasoninfo.seasons_id,year:this.seasoninfo.year,sports_id:this.seasoninfo.sports_id});r.save(),c.when(r.request).done(function(e){n.newTeamAddedCallback&&_.isFunction(n.newTeamAddedCallback)&&n.newTeamAddedCallback(r)&&n.destroy_view()})},render:function(){var e=_.template(this.template,{data:this.data,seasoninfo:this.seasoninfo,user_text:this.user_text});this.$el.html(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},destroy_view:function(){this.undelegateEvents(),this.$el.removeData().unbind(),this.remove(),p.View.prototype.remove.call(this)}})}),define("text!usercontrols/location/templates/get-view-location.html",[],function(){return'<textarea placeholder="Address" class="location-h address-h" rows="3" cols="25"></textarea>\r\n<span class="address-error hide address-error-status-h"></span>\r\n<a href="javascript: void(0);" class="verify-address-h">Verify Address</a>\r\n <div id="map-canvas-h" style="width: 90%; height: 300px; margin-top: 40px; display: none;"></div>\r\n'}),define("usercontrol/location/views/get-view-location",["require","text!usercontrols/location/templates/get-view-location.html","facade","views","utils","vendor","usercontrols/location/models/verify-adress"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=e("usercontrols/location/models/verify-adress"),l=a.Mustache,c=r.$,h=i.BaseView,p=r.Backbone,d;return p.View.extend({template:t,events:{"click .verify-address-h":"verifyAddress","blur .address-h":"verifyAddress"},initialize:function(e){d=this,d.location={},e.callback&&(this.callback=e.callback),d.location.latitude=!_.isUndefined(e)&&!_.isUndefined(e.latitude)?e.latitude:undefined,d.location.longitude=!_.isUndefined(e)&&!_.isUndefined(e.longitude)?e.longitude:undefined,d.setOptions(e),d.render()},intializeMap:function(){},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new f,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),e.callback(""),c.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id;if(e.locationId){e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.latitude=e.adressModel.get("payload").lat,e.location.latitude=e.adressModel.get("payload").lon,e.$el.find(".set-address-h").removeClass("link-disabled"),e.callback(e.locationId);if(e.map){var t=new google.maps.LatLng(e.adressModel.get("payload").lat,e.adressModel.get("payload").lon);e.marker.setPosition(t),e.map.panTo(t)}else e.createMap()}})},createMap:function(){var e=this,t=new google.maps.LatLng(e.location.latitude,e.location.latitude),n={zoom:13,center:t,scaleControl:!0,zoomControl:!0,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};this.$el.find("#map-canvas-h").show(),this.map=new google.maps.Map(document.getElementById("map-canvas-h"),n),this.marker=new google.maps.Marker({position:t,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=l.to_html(e.template,{location:e.locaion});return c(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("usercontrol/addgame/models/opponent",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{name:""}),url:function(){return"/api/team/addopponent/"+this.id}}),n}),define("usercontrols/addgame/views/main",["require","text!usercontrols/addgame/templates/layout.html","facade","views","utils","vendor","sportorg/collections/sports_listall","location/collections/states","usercontrols/addgame/collections/teams","location/collections/cities","usercontrols/addgame/collections/teams_user","usercontrols/addgame/collections/teams","usercontrols/addgame/collections/games_search","usercontrols/addgame/collections/orgs","usercontrols/addgame/models/team","usercontrols/addgame/models/team_add","usercontrols/addgame/models/game","usercontrols/addgame/models/uslgamelink","usercontrols/addgame/views/orgchoose","usercontrol/dropdown/view/dropdown","usercontrol/location/views/get-view-location","usercontrol/addgame/models/opponent","component/forms"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/addgame/collections/teams_user"),m=e("usercontrols/addgame/collections/teams"),g=e("usercontrols/addgame/models/team"),y=e("usercontrols/addgame/models/team_add"),b=e("usercontrols/addgame/models/game"),w=e("usercontrols/addgame/collections/games_search"),E=e("usercontrol/dropdown/view/dropdown"),S=e("usercontrol/location/views/get-view-location"),x=e("component/forms"),T=e("usercontrol/addgame/models/opponent"),N=e("usercontrols/addgame/collections/orgs"),C=e("usercontrols/addgame/views/orgchoose"),k=e("usercontrols/addgame/models/uslgamelink"),L=s.extend({template:t,gameData:{},teams:[],events:{"change .ddl-game-sports_h":"changeSport","keyup .txt-game-state_h":"keyupState","blur .txt-game-state_h":"changeState","keyup .txt-game-city_h":"keyupCity","blur .txt-game-city_h":"changeCity","keyup .txt-game-team_h":"keyupTeam","blur .txt-game-team_h":"changeTeam","keyup .txt-individual-game_h":"keyupIndividualGame","blur .txt-individual-game_h":"changeindividualGame","change .ddl-game-userteams_h":"changeUserTeam","click .btn-new-team-game_h":"showAddTeam","click .btn-ddl-team-game_h":"showDdlTeam","click .rdo-game-location_h":"showLocation","click .btn-game-Finish_h":"finishGame","change .txt-game-date_h":"CheckTeamControlsVisibility","click .btn-game-individual-Create_h":"createIndividualEvent","click .btn-game-individual-Finish_h":"goThereIndividualGame"},controls:{sectionAddSports:".section-Add-Sports_h",sectionDate:".section-game-date_h",txtGameDate:".txt-game-date_h",txtGameTime:".txt-game-time_h",spnTimePeriod:".spn-ddl-time-period_h",ddlTimePeriod:".ddl-time-period_h",spnSports:".span-ddl-sports_h",ddlSports:".ddl-game-sports_h",sectionTeams:".section-game-teams_h",ddlUserTeams:".ddl-game-userteams_h",spanddlteam:".span_ddl_team_h",spanddlteamtwo:".span_ddl_team_two_h",spanddlteamone:".span_ddl_team_one_h",btnNewTeam:".btn-new-team-game_h",btnDdlTem:".btn-ddl-team-game_h",sectionNewTeam:".section-new-team_h",txtState:".txt-game-state_h",txtCity:".txt-game-city_h",txtTeam:".txt-game-team_h",txtScore:".txt-score-team_h",btnFinish:".btn-game-Finish_h",sectionTeamOne:".team-one_h",sectionTeamTwo:".team-two_h",sectionScore:".section-score_h",sectionRadio:".section-game-radio_h",rdoTeamOne:".rdo-game-location-one-home_h",rdoTeamTwo:".rdo-game-location-two-home_h",rdoLocation:".rdo-game-location_h",sectionMainLocation:".section-main-location_h",sectionLocation:".div-game-location_h",txtLocationId:".txt-game-location-id_h",sectionIndividual:".section-individual-game_h",txtIndividualGame:".txt-individual-game_h",btnIndividualFinish:".btn-game-individual-Finish_h",txtIndividualLocation:".txt-individual-location_h",btnIndividualGameCreate:".btn-game-individual-Create_h",fieldMessage:".field-message_h",secSports:".section-game-sports_h",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnTimePeriodData:"hdn_time-period_h",hdnTimePeriod:"#hdn_time-period_h",indicator:".indicator_h"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",sportId:"sportid",locationId:"locationid",gameId:"gameid"},inlineTemplates:{},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},tags:{individual:"individual",team:"team",rgxTime:/^(0?[1-9]|1[012])(:[0-5]\d)$/,rgxTimeWhole:/^(0?[1-9]|1[012])$/},initialize:function(e){s.prototype.initialize.call(this,e),n=this,this.teams_id=e.teams_id,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this);var e=this,t=new x({date:{form_values:{post_to_server:!1,serverKey:"game_date",serverDbField:"gameDay",objectValuesToUpdate:["game_datetime"],getValue:function(){return this.$el.val()}},fieldClass:"date-picker-field",type:"Text",attr:{placeholder:"Enter Date","class":"txt-game-date_h txtDate"},showLable:!1,label:"Date",bindDatePicker:!0,changeEvent:function(){var e=new Date(this.getValue()),t=new Date;e!=null&&t>=e?l(".txt-score-team-h").removeClass("hidden"):l(".txt-score-team-h").addClass("hidden").val("")}},time:{form_values:{post_to_server:!1,serverDbField:"gameTime",serverKey:"game_time",objectValuesToUpdate:["game_datetime"]},type:"Text",fieldClass:"time-picker-field",attr:{placeholder:"Time","class":"txt-game-time_h hasDatepicker txtTime"},showLable:!1,label:"Time",validators:[{type:"required",message:"Please enter a time"},/^(0?[1-9]|1[012])(:[0-5]\d)?$/]},Day_light:{type:"DropDown",fieldClass:"ampm-field",form_values:{post_to_server:!1,serverKey:"game_ampm",objectValuesToUpdate:["game_datetime"],data:{records:[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],recordId:"name",recordValue:"value",selectedValue:"PM"},elementId:e.controls.hdnTimePeriodData,callback:function(e){}},showLable:!1,label:""},game_datetime:{type:"Hidden",form_values:{serverDbField:"game_datetime",valueBindings:["date","time","Day_light"],serverKey:"game_datetime",post_to_server:!0}},Select_Team_1:{type:"AutoComplete",label:"Select Team 1",form_values:{keyNameInPayload:"team_name",showElements:["team_1"],serverKey:"teamOneId",serverDbField:"teams_id",defaultValue:"",field_width:"80%",request_fields:[{key:"states_id",value:e.states_id},{key:"sports_id",value:function(){return e.sports_id}},{key:"team_name",value:function(e){return e.$el.val()}}],source_collection:m,request_finished:function(){},automaticFetch:!0,automaticFetchFn:function(t){var r=new g;r.id=e.team_id,r.fetchSuccess=function(e,i){var s=r.parseAsRequired(i);n.complevels_id=s.complevels_id,n.states_id=s.states_id,n.sports_club=s.sports_club,n.seasons_id=s.seasons_id,n.year=s.year,n.teamOneModel=r,t.setValue(s.team_id,s.team_name),l(n.destination).find("input[name=team_1]").attr("teamId",s.team_id)},r.fetch()},callback:function(e,t){l("input[name=team_1]").attr("teamId",e),n.complevels_id=t.full_return.complevels_id,n.seasons_id=t.full_return.seasons_id,n.year=t.full_return.year,l(n.destination).find("input[name=team_1]").attr("teamId",e)},afterSetValue:function(e){e=="show"?l("input[name=team_1]").parents(".field-row").removeClass("hide"):l("input[name=team_1]").parents(".field-row").addClass("hide")}},validators:[{type:"required",message:"Please select Team 2."}]},score_1:{form_values:{serverKey:"",field_width:"70px"},type:"Text",attr:{placeholder:"Score","class":"txt-score-team-h hidden"},showLable:!1,label:"Score 1"},team_1:{form_values:{serverKey:"teamOne"},type:"Radio",options:["Home","Away"],attr:{team:"one"},hideElement:!0,showLable:!1,label:"Team 1",onClickFn:function(t){var r=t?l(t.target).val():"away",i=0;if(r=="Home")i=l(t.target).attr(n.attributes.teamId);else{var s=l(n.destination).find("input[name=team_1]:checked, input[name=team_2]:checked");s.each(function(){r=l(this).val(),r=="Home"&&!i&&(i=l(this).attr(n.attributes.teamId))})}if(i){var o=new g;o.id=i,o.fetchSuccess=function(n,r){var i=o.parseAsRequired(r);e.location_id=i.location_id||0;var s=l(t.target).parents("form");s.find(".address-h").val(i.location_name).trigger("blur"),s.find(".verify-address-h").val(i.location_name).trigger("click")},o.fetch()}else l(t.target).parents("form").find(".address-h").val("").trigger("blur")}},Select_Team_2:{type:"AutoComplete",label:"Select Team 2",form_values:{keyNameInPayload:"team_name",serverKey:"teamTwoId",showElements:["team_2"],serverDbField:"teams_id",field_width:"400px",request_fields:[{key:"states_id",value:e.states_id},{key:"sports_id",value:function(){return e.sports_id}},{key:"complevels_id",value:function(){return e.complevels_id>0?e.complevels_id:!1}},{key:"seasons_id",value:function(){return e.seasons_id>0?e.seasons_id:!1}},{key:"year",value:function(){return e.year>0?e.year:!1}},{key:"team_name",value:function(e){return e.$el.val()}}],source_collection:m,request_finished:function(){},noResultsCallback:function(t){console.log("No Results Callback");var n=this,r=function(e){l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_team_2").remove(),l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_org").remove(),l('input[name="Select_Team_2"]').parent().find("span.indicator-h").removeClass("invalid").addClass("valid"),l('input[name="Select_Team_2"]').val(e.get("payload").team_name),l('input[name="Select_Team_2"]').attr("data-id",e.get("payload").id),n.callback(e.get("payload").id),n.afterSetValue("show")},i=function(){if(!confirm("This will add "+t+" "+e.teamOneModel.get("payload").complevels_obj.complevel_name+" "+e.teamOneModel.get("payload").org_sport_link_obj.sport.sport_name+" "+e.teamOneModel.get("payload").seasons_obj.season_name+" "+e.teamOneModel.get("payload").year+".  Continue?"))return!1;var n=new T({id:e.team_id,name:t});n.save(),l.when(n.request).done(function(e){return r(n),!0})},s=new N;s.org_name=t,s.states_id=e.states_id,s.sports_club=e.sports_club,s.single_sport_id=e.teamOneModel.get("payload").org_sport_link_obj.org.single_sport_id,s.fetch(),l.when(s.request).done(function(n){console.log(e.teamOneModel);if(n.payload&&n.payload.length){l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_org").length||l('input[name="Select_Team_2"]').parent().append('<div id="dynamic_add_org"></div>'),l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_team_2").remove();var s=new C({el:l("div#dynamic_add_org"),user_text:t,data:n.payload,seasoninfo:{complevel:e.teamOneModel.get("payload").complevels_obj.complevel_name,complevels_id:e.teamOneModel.get("payload").complevels_id,seasons_id:e.teamOneModel.get("payload").seasons_id,season:e.teamOneModel.get("payload").seasons_obj.season_name,year:e.teamOneModel.get("payload").year,sports_id:e.sports_id},createNewOrgCallback:i,newTeamAddedCallback:r})}else{l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_org").remove();var o='The <b>"'+t+'"</b> team isn\'t in our database.  Want to <a id="add_team_2-h">add it?</a>';l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_team_2").length?l('input[name="Select_Team_2"]').parent().find("div#dynamic_add_team_2").html(o):l('input[name="Select_Team_2"]').parent().append('<div id="dynamic_add_team_2">'+o+"</div>"),setTimeout(function(){l("a#add_team_2-h").on("click",i)},0)}})},callback:function(e){l("input[name=team_2]").attr("teamId",e)},afterSetValue:function(e){console.error(e),e=="show"?l("input[name=team_2]").parents(".field-row").removeClass("hide"):l("input[name=team_2]").parents(".field-row").addClass("hide")}},validators:[{type:"required",message:"Please select Team 2."}]},score_2:{form_values:{serverKey:"",field_width:"70px"},type:"Text",attr:{placeholder:"Score","class":"txt-score-team-h hidden"},showLable:!1,label:"Score 2"},team_2:{form_values:{serverKey:""},type:"Radio",options:["Home","Away"],showLable:!1,hideElement:!0,label:"Team 2",onClickFn:function(t){var r=t?l(t.target).val():"away",i=0;if(r=="Home")i=l(t.target).attr(n.attributes.teamId);else{var s=l(n.destination).find("input[name=team_1]:checked, input[name=team_2]:checked");s.each(function(){r=l(this).val(),r=="Home"&&(i=l(this).attr("teamId"))})}if(i){var o=new g;o.id=i,o.fetchSuccess=function(n,r){var i=o.parseAsRequired(r);e.location_id=i.location_id||0;var s=l(t.target).parents("form");s.find(".address-h").val(i.location_name).trigger("blur"),s.find(".verify-address-h").val(i.location_name).trigger("click")},o.fetch()}else l(t.target).parents("form").find(".address-h").val("").trigger("blur")}},Location:{form_values:{serverKey:"locations_id",post_to_server:!0,serverDbField:"locations_id"},type:"Location",label:"Location",validators:[{type:"required",message:"Please select location."}]},users_id:{form_values:{serverKey:e.users_id,post_to_server:!0,value:e.user_id},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Create"},showLable:!1,onSubmit:function(t){var n=r.commit();if(n)for(var i in n){var s=l("*[name="+i+"]"),o=s.position();s.parents(".common-modal #modalBody").animate({scrollTop:o.top},"500",function(){s.addClass("focus-error-animation"),setTimeout(function(){s.removeClass("focus-error-animation")},2e3)});break}else{if(e.formValues)var u=e.formValues.getFormValues();else var u=r.getValue();var u=e.formValues.getFormValues(),a=e,f={game_datetime:u.game_datetime,game_location:u.locations_id,teamOneId:u.teamOneId,teamTwoId:u.teamTwoId,sports_id:u.sports_id,users_id:a.user_id},c=new b(f);c.save({}),l.when(c.request).fail(function(t){var n=JSON.parse(t.responseText),r=n.exec_data.error_array;e.formValues.showServersErrors(r)}),l.when(c.request).done(function(e){if(e!=null&&e.payload!=null){a.game_id=e.payload.id;var t=l(a.destination).find("input[value=Home]").is(":checked"),n={game_datetime:u.game_datetime,games_id:a.game_id,home_team:t||!1,locations_id:u.locations_id,score:u.score_1,users_id:a.user_id},r=new y(n),i=!1,s=!1;r.teams_id=u.teamOneId,r.save();var o=function(){i&&s&&routing.trigger(a.channel,e)};l.when(r.request).done(function(){i=!0,o()});var f={game_datetime:u.game_datetime,games_id:a.game_id,home_team:t||!1,locations_id:u.locations_id,score:u.score_2,users_id:a.user_id};t=l(a.destination).find(a.controls.rdoTeamTwo).is(":checked");var c=new y(f);c.teams_id=u.teamTwoId,c.save(),a.gameData={type:a.tags.team,game_datetime:u.game_datetime,team_id_one:u.teamOneId,team_id_two:u.teamTwoId,sports_id:u.sports_id,games_id:a.game_id,users_id:a.user_id},l.when(c.request).done(function(){s=!0,o()})}})}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},this.$el.find(".add-game-container-h")),r=t.form;this.formValues=t.formValues},afterRender:function(){var e=this,t=new S({callback:function(t){var n=t!=""?!0:!1;e.$el.find(".btn-game-Finish_h").attr("disable",n),e.$el.find(".txt-game-location-id_h").val(t)}});this.$el.find(".location-view-h").html(t.el)},setOptions:function(e){this.user_id=e.user_id;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null,this.team_id=e.teams_id||null},init:function(){n.setupView()},setupView:function(){n.setUpMainView();if(n.team_id){var e=new g;e.id=n.team_id,e.fetchSuccess=function(t,r){var i=e.parseAsRequired(r);n.team=i,n.sports_id=i.sports_id||null,n.fillSports()},e.fetch()}else n.fillSports()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e)},fillSports:function(){var e=new h;e.processResult=function(t){var r=e.ParseForDropdown();n.SetupSportsView(r)},e.fetch()},SetupSportsView:function(e){n.sports=e;var t={};t.records=n.sports,t.recordId="id",t.recordValue="custom_name";var r=new E({data:t,title:"Select Sport",elementId:n.controls.hdnSportsIdData,destination:n.controls.spnSports,targetView:n,selectedValue:n.sports_id||null,callback:function(e){n.changeSport(e)}})},changeSport:function(e){if(e&&e!=0){l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).fadeIn(),l(n.destination).find("input").attr(n.attributes.sportId,e);var t=n.getTeamType(e);t&&n.fillTeams(e)}else l(n.destination).find(n.controls.btnFinish).fadeOut(),l(n.destination).find(n.controls.sectionTeams).fadeOut(),l(n.destination).find("input").removeAttr(n.attributes.stateId);n.CheckTeamControlsVisibility()},setFirstTeam:function(e){console.log("setFirstTeam");var t=!1;if(n.team_id){for(var r in n.teams)n.teams[r].payload.id==n.team_id&&(t=!0);if(!t)if(n.team)n.setSelectedTeam(n.team);else{var i=new g;i.id=n.team_id,i.fetchSuccess=function(e,t){var r=i.parseAsRequired(t);n.team=r,n.setSelectedTeam(r)},i.fetch()}n.CheckTeamControlsVisibility()}},setSelectedTeam:function(e){console.log("setSelectedTeam");if(e){console.log("data",e);var t=e.team_name,r=e.team_id;l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,r),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.spanddlteamone).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).hide(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).val(t).show(),l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.indicator).addClass("valid").removeClass("invalid").show()}},fillTeams:function(e){var t=new v;t.user_id=n.user_id,t.sports_id=e,t.processResult=function(e){var r={team_name:"Team Not Found",id:-1},i=t.AppendItem(r);n.setUpUserTeams(i)};var r=t.fetch()},setUpUserTeams:function(e){n.teams=e||[],n.setFirstTeam(n.team_id);var t={};t.records=n.teams,t.recordId="id",t.recordValue="team_name";var r=new E({data:t,elementId:"hdn_team_id",targetView:n,destination:n.controls.spanddlteamone,selectedValue:n.team_id||null,callback:function(e){n.changeUserTeamOne(e)}})},changeUserTeamOne:function(e){console.log("result1",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamOne).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamOne).find("input:checked").removeAttr("checked"),n.showLocation())},changeUserTeamTwo:function(e){console.log("result",e),e=="-1"?l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).trigger("click"):(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.btnNewTeam).show(),l(n.destination).find(n.controls.sectionTeamTwo).find("input").attr(n.attributes.teamId,e),l(n.destination).find(n.controls.sectionTeamTwo).find("input:checked").removeAttr("checked"),n.showLocation())},showAddTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.spanddlteam).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).show(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},showDdlTeam:function(e){l(e.target).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).val("").hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.ddlUserTeams).val("").show(),l(e.target).parents(n.controls.sectionTeams).find("input:checked").removeAttr("checked"),n.showLocation()},keyupState:function(e){var t=l(e.target).val(),r=[];if(t!="")if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.stateId),n.CheckTeamControlsVisibility();var i=new p;i.state_name=l(e.target).val(),console.log("State Request Abort Request Function AddGame/Main.js"),n.stateFetchRequest=n.stateFetchRequest||[],n.stateFetchRequest.push(n.cityFetchRequest||[]),n.stateFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.stateFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.stateFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.states=[];for(var s in t)n.states.push(t[s].payload);n.states.forEach(function(e,t){r.push(e.name)});try{l(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else n.changeState(e)},changeState:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.stateId);var r=!1;n.states_id="",n.states&&n.states.forEach(function(i,s){i["name"]==t&&(r=!0,n.states_id=i.id,l(e.target).attr(n.attributes.stateId,n.states_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).attr(n.attributes.stateId,n.states_id).fadeIn(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).attr(n.attributes.stateId,n.states_id).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide())}),r||(n.states_id=0,l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtTeam).removeAttr(n.attributes.stateId).fadeOut(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).hide(),l(e.target).parents(n.controls.sectionTeams).find(n.controls.txtCity).removeAttr(n.attributes.stateId).fadeOut()),n.CheckTeamControlsVisibility()},keyupCity:function(e){var t=l(e.target).val(),r=[];if(t.length>2)if(n.isValidAutoCompleteKey(e)==1){l(e.target).removeAttr(n.attributes.cityId),n.CheckTeamControlsVisibility();var i=new d;i.states_id=n.states_id,i.city_name=l(e.target).val(),n.cityFetchRequest=n.cityFetchRequest||[],n.cityFetchRequest.push(n.teamFetchRequest||[]),l(e.target).addClass("ui-autocomplete-loading"),n.cityFetchRequest=n.abortRequest(n.stateFetchRequest);var s=i.fetch();n.cityFetchRequest.push(s),l.when(i.request).done(function(){if(i.isError())return;var t=i.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut(),n.cities=[];for(var s in t)n.cities.push(t[s]);n.cities.forEach(function(e,t){r.push(e.city)});try{n.$(e.target).autocomplete("destroy")}catch(o){}n.$(e.target).autocomplete({source:r}),n.$(e.target).trigger("keydown")})}else n.changeCity(e)},changeCity:function(e){var t=l(e.target).val();l(e.target).removeAttr(n.attributes.cityId);var r=!1;n.city_id="",n.cities&&n.cities.forEach(function(i,s){i["city"]==t&&(r=!0,n.city_id=i.id,l(e.target).attr(n.attributes.cityId,n.city_id))}),r||(n.city_id=0),n.CheckTeamControlsVisibility()},keyupTeam:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility();var s=new m;s.states_id=l(e.target).attr(n.attributes.stateId),s.city_id=l(e.target).attr(n.attributes.cityId),s.sports_id=l(e.target).attr(n.attributes.sportId),s.team_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.TeamFetchRequest=n.abortRequest(n.TeamFetchRequest);var o=s.fetch();n.TeamFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.$(e.target).parent().find(n.controls.fieldMessage).html(n.messages.dataNotExist).stop().fadeIn():n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.teams=[];for(var i in t)n.teams.push(t[i].payload);n.teams.forEach(function(e,t){r.push(e.team_name)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show(),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeTeam(e)},changeTeam:function(e){var t=l(e.target).val(),r=!1;n.team_id=0,n.teams&&n.teams.forEach(function(i,s){var o=i.team_name;o==t&&(r=!0,n.team_id=i.id,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())});if(n.team){var i=n.team.team_name,s=n.team.team_id;i==t&&(r=!0,n.team_id=s,l(e.target).parents(n.controls.sectionTeams).find("input").attr(n.attributes.teamId,n.team_id),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).removeClass("invalid").addClass("valid").show())}r||(l(e.target).parents(n.controls.sectionTeams).find("input").removeAttr(n.attributes.teamId),l(e.target).parents(n.controls.sectionTeams).find(n.controls.indicator).addClass("invalid").removeClass("valid").show()),n.CheckTeamControlsVisibility()},keyupIndividualGame:function(e){var t=l(e.target).val(),r=[],i=n.isValidAutoCompleteKey(e);if(t!=""&&i==1&&t.length>2){l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility();var s=new w;s.game_name=t,l(e.target).addClass("ui-autocomplete-loading"),n.individualGameFetchRequest=n.abortRequest(n.individualGameFetchRequest);var o=s.fetch();n.individualGameFetchRequest.push(o),l.when(s.request).done(function(){if(s.isError())return;var t=s.toJSON();t==null||t.length<1?n.eventNotFound(e):n.$(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),n.individualGames=[];for(var i in t)n.individualGames.push(t[i].payload);n.individualGames.forEach(function(e,t){var n=e.event_name+" "+e.game_name;r.push(n)});try{n.$(e.target).autocomplete("destroy")}catch(o){}l(e.target).autocomplete({source:r}),l(e.target).trigger("keydown")})}else l(e.target).removeAttr(n.attributes.gameId),n.CheckTeamControlsVisibility(),n.isEnterKey(e)&&n.changeIndividualGame(e)},changeIndividualGame:function(e,t){var r=l(e.target).val(),i=!1;n.individual_game_id=0,n.individualGames&&n.individualGames.forEach(function(t,s){var o=t.event_name+" "+t.game_name;o==r&&(i=!0,n.individual_game_id=t.id,l(e.target).attr(n.attributes.gameId,n.individual_game_id))}),i?n.eventFound(e):n.eventNotFound(e),n.CheckTeamControlsVisibility()},eventNotFound:function(e){l(n.destination).find(n.controls.btnIndividualGameCreate).show(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(e.target).parent().find(n.controls.fieldMessage).html("").stop().fadeOut(),l(e.target).removeAttr(n.attributes.gameId)},eventFound:function(e){l(n.destination).find(n.controls.btnIndividualGameCreate).hide(),l(n.destination).find(n.controls.btnIndividualFinish).show(),l(e.target).parent().find(n.controls.fieldMessage).html(n.messages.gameFound).fadeIn()},createIndividualEvent:function(e){var t=!0,r="",i=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),s=l(n.destination).find(n.controls.txtGameTime).val(),o=l(n.destination).find(n.controls.hdnTimePeriod).val(),u=n.location_id||l(n.controls.txtLocationId).val()||0,a=l(n.destination).find(n.controls.txtIndividualGame).val(),f=l(n.destination).find(n.controls.hdnSportsId).val();f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),t=!1);if(!i||!s)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),this.focusOnErrorField(".section-Add-Sports_h"),t=!1;else{var c=s.match(n.tags.rgxTime)||s.match(n.tags.rgxTimeWhole);console.log("orginal date",i),console.log("orginal time",s),console.log("timeZone",o);if(!c)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),t=!1;else{l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut();try{var h=s.split(":");h&&(console.log(h),o!="PM"&&h[0]!="12"&&i.setHours(h[0]),h.length>1&&i.setMinutes(h[1]),o=="PM"&&i.addHours(12))}catch(p){}}console.log("new date",i)}u||(r+=n.messages.selectLocation,t=!1),l.trim(a)==""&&(r+="<br/>"+n.messages.enterEventName,t=!1);if(t){var d=i;l(e.target).parent().find(n.controls.fieldMessage).html("").fadeOut();var v={game_datetime:d,locations_id:u,event_name:a,sports_id:f,users_id:n.user_id},m=new b(v);m.save({}),l.when(m.request).done(function(e){n.game_id=e.payload.id,n.gameData={game_datetime:d,games_id:n.game_id,event_name:a,locations_id:u,sports_id:f,users_id:n.user_id},routing.trigger(n.channel,n.gameData)})}else l(e.target).parent().find(n.controls.fieldMessage).html(r).fadeIn()},goThereIndividualGame:function(e){var t=l(n.destination).find(n.controls.hdnSportsId).val(),r={users_id:n.user_id,sports_id:t,games_id:n.individual_game_id},i=new k(r);i.save(),l.when(i.request).done(function(e){n.goThereSuccess(e)})},goThereSuccess:function(e){if(e&&e.payload!=null){var t=e.payload.game;t&&(n.gameData={type:n.tags.individual,game_datetime:t.gameDay,event_name:t.event_name,game_location:t.game_location,games_id:t.id,sports_id:e.payload.usl?e.payload.usl.sports_id:null,users_id:n.user_id},routing.trigger(n.channel,e))}},CheckTeamControlsVisibility:function(){var e=l(n.destination).find(n.controls.hdnSportsId).val();if(e&&e!=""&&e!=0){var t=n.getTeamType(e);if(!t)l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionIndividual).show();else{var r=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),i=new Date;r!=null&&i>=r?l(n.destination).find(n.controls.sectionScore).show():(l(n.destination).find(n.controls.sectionScore).hide(),l(n.destination).find(n.controls.txtScore).val("")),l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controlsbtnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).show(),l(n.destination).find(n.controls.btnFinish).show(),l(n.destination).find(n.controls.sectionMainLocation).show()}}else l(n.destination).find(n.controls.sectionIndividual).hide(),l(n.destination).find(n.controls.btnIndividualFinish).hide(),l(n.destination).find(n.controls.sectionTeams).hide(),l(n.destination).find(n.controls.btnFinish).hide(),l(n.destination).find(n.controls.sectionMainLocation).hide();e=l(n.destination).find(n.controls.txtTeam).attr(n.attributes.teamId),e&&e!=""&&e!=0?l(n.destination).find(n.controls.btnTeamDone).show():l(n.destination).find(n.controls.btnTeamDone).hide()},getTeamType:function(e){if(e&&e!=""&&e!=0){var t=!0;console.log("getteamtype",e);for(var r in n.sports)n.sports[r].payload.id==e&&(console.log("payload",n.sports[r].payload),n.sports[r].payload.team_type=="Individual"&&(t=!1));return t}return!1},showLocation:function(e){l(n.destination).find(n.controls.sectionMainLocation).show();var t=0,r=e?l(e.target).val():"away";if(r=="home")t=l(e.target).attr(n.attributes.teamId);else{var i=l(n.destination).find(n.controls.rdoLocation+":checked");i.each(function(){r=l(this).val(),r=="home"&&(t=l(this).attr(n.attributes.teamId))})}if(t){var s=new g;s.id=t,s.fetchSuccess=function(e,t){var r=s.parseAsRequired(t);n.setLocation(r)},s.fetch()}else l(n.destination).find(n.controls.txtLocationId).val("").fadeIn(),n.clearLocation()},setLocation:function(e){e.location_id?(n.location_id=e.location_id||0,l(n.destination).find(n.controls.txtLocationId).val("").fadeOut(),l(".address-h").val(e.location_name),l(".txt-game-location-id_h").val(e.location_id),l(".verify-address-h").trigger("click")):l(n.destination).find(n.controls.txtLocationId).val("").fadeIn()},clearLocation:function(){l(".address-h").val(""),l(".txt-game-location-id_h").val("")},formatDate:function(e,t,n){var r=l.datepicker.formatDate("yy-mm-dd",e);try{var i=t.split(":");return console.log(i),i.length==1&&(t+=":00"),t+=" "+n,r+=" "+t,r}catch(s){return!1}},finishGame:function(){l(n.destination).find(n.controls.fieldMessage).html("").hide();var e=!0,t=l(n.destination).find(n.controls.txtGameDate).datepicker("getDate"),r=l(n.destination).find(n.controls.txtGameTime).val(),i=l(n.destination).find(n.controls.hdnTimePeriod).val(),s=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtTeam).attr(n.attributes.teamId),o=l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.txtScore).val(),u=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtTeam).attr(n.attributes.teamId),a=l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.txtScore).val(),f=l(n.destination).find(n.controls.hdnSportsId).val(),c=n.location_id||l(n.controls.txtLocationId).val()||0;f||(l(n.destination).find(n.controls.secSports).find(n.controls.fieldMessage).html(n.messages.selectSport).fadeIn(),e=!1);if(!t||!r)l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectDateAndTime).fadeIn(),e=!1;else{var h=r.match(n.tags.rgxTime)||r.match(n.tags.rgxTimeWhole);console.log("orginal date",t),console.log("orginal time",r),console.log("ampm",i),h?(l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html("").fadeOut(),t=this.formatDate(t,r,i),t||(e=!1)):(console.log("NOT VALID"),l(n.destination).find(n.controls.sectionDate).find(n.controls.fieldMessage).html(n.messages.selectValidTime).fadeIn(),e=!1)}console.log("new date",t),c||(l(n.destination).find(n.controls.sectionMainLocation).find(n.controls.fieldMessage).html(n.messages.selectLocation).fadeIn(),e=!1),s>0||(l(n.destination).find(n.controls.sectionTeamOne).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1),u>0||(l(n.destination).find(n.controls.sectionTeamTwo).find(n.controls.fieldMessage).html(n.messages.selectTeam).fadeIn(),e=!1);if(e){var p=t,d={game_datetime:p,locations_id:c,teamOneId:s,teamTwoId:u,sports_id:f,users_id:n.user_id},v=new b(d);v.save({}),l.when(v.request).done(function(e){console.log(e);if(e!=null&&e.payload!=null){n.game_id=e.payload.id;var t=l(n.destination).find(n.controls.rdoTeamOne).is(":checked"),r={game_datetime:p,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:o,users_id:n.user_id},i=new y(r);i.teams_id=s,i.save();var c={game_datetime:p,games_id:n.game_id,home_team:t||!1,locations_id:n.location_id,score:a,users_id:n.user_id};t=l(n.destination).find(n.controls.rdoTeamTwo).is(":checked");var h=new y(c);h.teams_id=u,h.save(),n.gameData={type:n.tags.team,game_datetime:p,games_id:n.game_id,team_id_one:s,team_id_two:u,sports_id:f,users_id:n.user_id},routing.trigger(n.channel,e)}})}}});return L}),define("usercontrols/addgame/addgame",["require","text!usercontrols/addgame/templates/layout.html","facade","controller","models","views","user/models/basic_info","usercontrols/addgame/views/main","jquery.slimscroll"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("user/models/basic_info"),d=e("usercontrols/addgame/views/main"),n=i.extend({cssArr:["/usercontrols/addgame/addgame.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.sports_id&&(this.sports_id=e.sports_id),e.teams_id&&(this.teams_id=e.teams_id),e.user_id&&(this.user_id=e.user_id),this.callback=e.callback,e.popup&&(this.popup=!0,this.modelHTML='<div id="addGamePopup"></div>'),e.gender&&(this.gender=e.gender),this.init(),this},init:function(){this.popup?this.setupPopupLayout().render():this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setupPopupLayout:function(){var e;this.scheme=[];var e=new h({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e,this.modelBoxId="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);var t={};return t.height="500px",t.width="500px",t.title="Add Game",t.id=this.modelBoxId,routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;routing.off("add-game-success"),routing.on("add-game-success",function(t){e.addGameFunction(t)});var n=this,r="#"+this.modelBoxId+" #modalBody";this.addGameView=new d({model:new p,template:t,name:"add-game-main",destination:r,user_id:n.user_id,channel:"add-game-success",sports_id:this.sports_id,teams_id:this.teams_id}),this.scheme.push(this.addGameView),this.layout.render()},addGameFunction:function(e){this.callback&&this.callback(e)}});return n}),define("text!usercontrols/photo-player/templates/comments.html",[],function(){return'\r\n\r\n{{#payload}}\r\n<div class="photo-player-coment"> \r\n	<div class="user-photo">\r\n		<img src="{{base_url}}{{poster_picture}}" alt="{{poster}}" />\r\n	</div> \r\n    <div class="content">\r\n    	<!--span class="comment-date">{{poster}} {{comment_date}}</span-->\r\n    	<span class="user-comment">{{user.first_name}} </span>\r\n    	<p class="comment-text">{{{comment}}}</p>\r\n    </div>\r\n</div>\r\n{{/payload}}\r\n\r\n\r\n\r\n'}),define("usercontrols/photo-player/collections/comments",["facade","site/collections/comments","utils"],function(e,t,n){var r;return r=t.extend({url:function(){return testpath?testpath+"/media/comments/"+this.id:"/api/media/comments/"+this.id}}),r}),define("text!usercontrols/photo-player/templates/player.html",[],function(){return'<div class="image-bg">\r\n	<div class="image-controls">\r\n		<ul class="image-actions">\r\n			<li><a href="javascript: void(0);" class="photo-player-tag-photo-h" title="tag photo">Tag Photo</a></li>\r\n			<li><a href="javascript: void(0);" class="photo-player-tag-myself-h" title="tag my self">Tag Myself</a></li>\r\n			<li><a href="javascript: void(0);" class="photo-player-vote-h" title="vote">Vote <span class="votes-num-h"></span></a></li>\r\n			<li class="icon-parent"><a href="javascript: void(0);" class="player-share share-on-h" data-share="facebook" title="share on facebook"></a></li>\r\n			<li class="icon-parent"><a href="javascript: void(0);" class="player-share share-on-h" data-share="twitter" title="share on twitter"></a></li>\r\n			<li class="icon-parent"><a href="javascript: void(0);" class="player-share share-on-h" data-share="gplus" title="share on google plus"></a></li>\r\n			<li class="icon-parent"><a href="javascript: void(0);" class="player-share share-on-h" data-share="tumbler" title="share on tumbler"></a></li>\r\n		</ul>\r\n		\r\n		<div class="closer">\r\n			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\r\n		</div>\r\n\r\n	</div>\r\n	<div id="video_container" class="hidden"><span>Loading Video...</span></div>\r\n	<div class="loading_image"><img src="" class="photo-player-main-image large-image-h" /></div>\r\n\r\n	<div class="thumbs-outer">\r\n		<div class="thumbs-header">\r\n			<span class="pull-left">All photos (<span class="total-image-count-h">102</span>)</span>\r\n			<a href="javascript:void(0)" class="toggle-thumbs-h pull-right" title="close">X</a>\r\n		</div>\r\n		<div class="thumbs-inner">\r\n			<ul class="images-list thumb-image-list-h"></ul>\r\n		</div>\r\n	</div>\r\n	\r\n	<div class="bottom-line-container">\r\n		<span class="image-message-h image-message"></span>\r\n		<a href="javascript: void(0)" class="photo-player-arrow photo-player-icons left-arrow-photoplayer back-arrow-h"></a>\r\n		<a href="javascript: void(0);" class="show-thumbs photo-player-icons toggle-thumbs-h"></a>\r\n		<a href="javascript: void(0)" class="photo-player-icons photo-player-arrow right-arrow-photoplayer next-arrow-h"></a>\r\n		<span class="count-of-images"><span class="current-image-number-count-h">17</span> of <span class="total-image-count-h">102</span></span>\r\n	</div>\r\n	\r\n</div>\r\n'}),define("text!usercontrols/photo-player/templates/image-thumbs.html",[],function(){return'{{#data}}\r\n<li>\r\n	<a href="javascript: void(0);" class="thumb-link-h" data-index="{{_index}}" title="thumb">\r\n			<img style="{{#styles}}{{property}} : {{value}}; {{/styles}}" src="{{_thumbnail}}" alt="{{_thumbnail}}"/>\r\n	</a>\r\n</li>{{/data}}'}),typeof jwplayer=="undefined"&&(jwplayer=function(e){if(jwplayer.api)return jwplayer.api.selectPlayer(e)},jwplayer.version="6.0.2813",jwplayer.vid=document.createElement("video"),jwplayer.audio=document.createElement("audio"),jwplayer.source=document.createElement("source"),function(e){function a(e){if(!u.exists(e))return;var t=e.indexOf("://"),n=e.indexOf("?");return t>0&&(n<0||n>t)}function l(e){return function(){return f(e)}}var t=document,n=window,r=navigator,i="undefined",s="string",o="object",u=e.utils=function(){};u.exists=function(e){switch(typeof e){case s:return e.length>0;case o:return e!==null;case i:return!1}return!0},u.styleDimension=function(e){return e+(e.toString().indexOf("%")>0?"":"px")},u.getAbsolutePath=function(e,n){u.exists(n)||(n=t.location.href);if(!u.exists(e))return undefined;if(a(e))return e;var r=n.substring(0,n.indexOf("://")+3),i=n.substring(r.length,n.indexOf("/",r.length+1)),s;if(e.indexOf("/")===0)s=e.split("/");else{var o=n.split("?")[0];o=o.substring(r.length+i.length+1,o.lastIndexOf("/")),s=o.split("/").concat(e.split("/"))}var f=[];for(var l=0;l<s.length;l++){if(!s[l]||!u.exists(s[l])||s[l]==".")continue;s[l]==".."?f.pop():f.push(s[l])}return r+i+"/"+f.join("/")},u.extend=function(){var e=u.extend.arguments;if(e.length>1){for(var t=1;t<e.length;t++)for(var n in e[t])try{u.exists(e[t][n])&&(e[0][n]=e[t][n])}catch(r){}return e[0]}return null},u.log=function(e,t){typeof console!=i&&typeof console.log!=i&&(t?console.log(e,t):console.log(e))};var f=u.userAgentMatch=function(e){var t=r.userAgent.toLowerCase();return t.match(e)!==null};u.isIE=l(/msie/i),u.isFF=l(/firefox/i),u.isIOS=l(/iP(hone|ad|od)/i),u.isIPod=l(/iP(hone|od)/i),u.isIPad=l(/iPad/i),u.isAndroid=function(e){return e?f(new RegExp("android.*"+e,"i")):f(/android/i)},u.isMobile=function(){return u.isIOS()||u.isAndroid()},u.saveCookie=function(e,n){t.cookie="jwplayer."+e+"="+n+"; path=/"},u.getCookies=function(){var e={},n=t.cookie.split("; ");for(var r=0;r<n.length;r++){var i=n[r].split("=");i[0].indexOf("jwplayer.")==0&&(e[i[0].substring(9,i[0].length)]=i[1])}return e},u.typeOf=function(e){var t=typeof e;return t==="object"?e?e instanceof Array?"array":t:"null":t},u.translateEventResponse=function(t,n){var r=u.extend({},n);t==e.events.JWPLAYER_FULLSCREEN&&!r.fullscreen?(r.fullscreen=r.message=="true"?!0:!1,delete r.message):typeof r.data==o?(r=u.extend(r,r.data),delete r.data):typeof r.metadata==o&&u.deepReplaceKeyName(r.metadata,["__dot__","__spc__","__dsh__"],["."," ","-"]);var i=["position","duration","offset"];for(var s in i)r[i[s]]&&(r[i[s]]=Math.round(r[i[s]]*1e3)/1e3);return r},u.flashVersion=function(){if(u.isAndroid())return 0;var e=r.plugins,t;if(e!=i){t=e["Shockwave Flash"];if(t)return parseInt(t.description.replace(/\D+(\d+)\..*/,"$1"))}if(typeof n.ActiveXObject!=i)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t)return parseInt(t.GetVariable("$version").split(" ")[1].split(",")[0])}catch(s){}return 0},u.getScriptPath=function(e){var n=t.getElementsByTagName("script");for(var r=0;r<n.length;r++){var i=n[r].src;if(i&&i.indexOf(e)>=0)return i.substr(0,i.indexOf(e))}return""},u.deepReplaceKeyName=function(t,n,r){switch(e.utils.typeOf(t)){case"array":for(var i=0;i<t.length;i++)t[i]=e.utils.deepReplaceKeyName(t[i],n,r);break;case o:for(var s in t){var u,a;if(n instanceof Array&&r instanceof Array){if(n.length!=r.length)continue;u=n,a=r}else u=[n],a=[r];var f=s;for(var i=0;i<u.length;i++)f=f.replace(new RegExp(n[i],"g"),r[i]);t[f]=e.utils.deepReplaceKeyName(t[s],n,r),s!=f&&delete t[s]}}return t};var c=u.pluginPathType={ABSOLUTE:0,RELATIVE:1,CDN:2};u.getPluginPathType=function(e){if(typeof e!=s)return;e=e.split("?")[0];var t=e.indexOf("://");if(t>0)return c.ABSOLUTE;var n=e.indexOf("/"),r=u.extension(e);return t<0&&n<0&&(!r||!isNaN(r))?c.CDN:c.RELATIVE},u.getPluginName=function(e){return e.replace(/^(.*\/)?([^-]*)-?.*\.(swf|js)$/,"$2")},u.getPluginVersion=function(e){return e.replace(/[^-]*-?([^\.]*).*$/,"$1")},u.isYouTube=function(e){return e.indexOf("youtube.com")>-1||e.indexOf("youtu.be")>-1},u.isRtmp=function(e,t){return e.indexOf("rtmp")==0||t=="rtmp"},u.foreach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n)},u.isHTTPS=function(){return n.location.href.indexOf("https")==0}}(jwplayer),function(e){var t="video/",n="audio/",r="image",i="mp4",s="webm",o="ogg",u="aac",a="mp3",f="vorbis",l={mp4:t+i,vorbis:n+o,ogg:t+o,webm:t+s,aac:n+i,mp3:n+a,hls:"application/vnd.apple.mpegurl"},c={mp4:l[i],f4v:l[i],m4v:l[i],mov:l[i],m4a:l[u],f4a:l[u],aac:l[u],mp3:l[a],ogv:l[o],ogg:l[f],oga:l[f],webm:l[s],m3u8:l.hls},t="video",h={flv:t,f4v:t,mov:t,m4a:t,m4v:t,mp4:t,aac:t,mp3:"sound",smil:"rtmp",m3u8:"hls"},p=e.extensionmap={};for(var d in c)p[d]={html5:c[d]};for(d in h)p[d]||(p[d]={}),p[d].flash=h[d];p.types=l,p.mimeType=function(e){for(var t in l)if(l[t]==e)return t},p.extType=function(e){return p.mimeType(c[e])}}(jwplayer.utils),function(e){var t=e.loaderstatus={NEW:0,LOADING:1,ERROR:2,COMPLETE:3},n=document;e.scriptloader=function(r){function u(e){i=t.ERROR,o.sendEvent(s.ERROR)}function f(e){i=t.COMPLETE,o.sendEvent(s.COMPLETE)}var i=t.NEW,s=jwplayer.events,o=new s.eventdispatcher;e.extend(this,o),this.load=function(){var o=e.scriptloader.loaders[r];if(!(!o||o.getStatus()!=t.NEW&&o.getStatus()!=t.LOADING)){o.addEventListener(s.ERROR,u),o.addEventListener(s.COMPLETE,f);return}e.scriptloader.loaders[r]=this;if(i==t.NEW){i=t.LOADING;var l=n.createElement("script");l.addEventListener?(l.onload=f,l.onerror=u):l.readyState&&(l.onreadystatechange=function(){(l.readyState=="loaded"||l.readyState=="complete")&&f()}),n.getElementsByTagName("head")[0].appendChild(l),l.src=r}},this.getStatus=function(){return i}},e.scriptloader.loaders={}}(jwplayer.utils),function(e){e.trim=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},e.pad=function(e,t,n){n||(n="0");while(e.length<t)e=n+e;return e},e.xmlAttribute=function(e,t){for(var n=0;n<e.attributes.length;n++)if(e.attributes[n].name&&e.attributes[n].name.toLowerCase()==t.toLowerCase())return e.attributes[n].value.toString();return""},e.jsonToString=function(t){var n=n||{};if(n&&n.stringify)return n.stringify(t);var r=typeof t;if(r=="object"&&t!==null){var i=[],s=t&&t.constructor==Array;for(var o in t){var u=t[o];switch(typeof u){case"string":u='"'+u.replace(/"/g,'\\"')+'"';break;case"object":e.exists(u)&&(u=e.jsonToString(u))}s?typeof u!="function"&&i.push(String(u)):typeof u!="function"&&i.push('"'+o+'":'+String(u))}return s?"["+String(i)+"]":"{"+String(i)+"}"}if(r!="string")return String(t);t='"'+t.replace(/"/g,'\\"')+'"'},e.extension=function(e){if(!e||e.substr(0,4)=="rtmp")return"";e=e.substring(e.lastIndexOf("/")+1,e.length).split("?")[0].split("#")[0];if(e.lastIndexOf(".")>-1)return e.substr(e.lastIndexOf(".")+1,e.length).toLowerCase()},e.stringToColor=function(e){return e=e.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2"),e.length==3&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)}}(jwplayer.utils),function(e){var t="invalid",n="36QXq4W@GSBV^teR";e.key=function(r){function u(n){e.exists(n)||(n="");try{n=f(n);var r=n.split("/");i=r[0],i?e.key.valid.indexOf(i)<0&&(i=t):i="free",s=r[1],r[2]&&parseInt(r[2])>0&&(o=new Date,o.setTime(String(r[2])))}catch(u){i=t}}function f(t){return e.tea.decrypt(t,n)}var i,s,o;this.edition=function(){return o&&o.getTime()<(new Date).getTime()?t:i},this.token=function(){return s},u(r)},e.key.valid=["free","pro"]}(jwplayer.utils),function(e){e.key.valid=["premium","ads"]}(jwplayer.utils),function(e){var t=e.tea={};t.encrypt=function(e,i){if(e.length==0)return"";var s=t.strToLongs(r.encode(e));s.length<=1&&(s[1]=0);var o=t.strToLongs(r.encode(i).slice(0,16)),u=s.length,f=s[u-1],l=s[0],h=2654435769,p,v,m=Math.floor(6+52/u),g=0;while(m-->0){g+=h,v=g>>>2&3;for(var y=0;y<u;y++)l=s[(y+1)%u],p=(f>>>5^l<<2)+(l>>>3^f<<4)^(g^l)+(o[y&3^v]^f),f=s[y]+=p}var b=t.longsToStr(s);return n.encode(b)},t.decrypt=function(e,i){if(e.length==0)return"";var s=t.strToLongs(n.decode(e)),o=t.strToLongs(r.encode(i).slice(0,16)),u=s.length,f=s[u-1],l=s[0],h=2654435769,p,v,m=Math.floor(6+52/u),g=m*h;while(g!=0){v=g>>>2&3;for(var y=u-1;y>=0;y--)f=s[y>0?y-1:u-1],p=(f>>>5^l<<2)+(l>>>3^f<<4)^(g^l)+(o[y&3^v]^f),l=s[y]-=p;g-=h}var b=t.longsToStr(s);return b=b.replace(/\0+$/,""),r.decode(b)},t.strToLongs=function(e){var t=new Array(Math.ceil(e.length/4));for(var n=0;n<t.length;n++)t[n]=e.charCodeAt(n*4)+(e.charCodeAt(n*4+1)<<8)+(e.charCodeAt(n*4+2)<<16)+(e.charCodeAt(n*4+3)<<24);return t},t.longsToStr=function(e){var t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=String.fromCharCode(e[n]&255,e[n]>>>8&255,e[n]>>>16&255,e[n]>>>24&255);return t.join("")};var n={};n.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n.encode=function(e,t){t=typeof t=="undefined"?!1:t;var i,s,o,u,f,l,c,h,p=[],v="",m,g,y,b=n.code;g=t?r.encode(e):e,m=g.length%3;if(m>0)while(m++<3)v+="=",g+="\0";for(m=0;m<g.length;m+=3)i=g.charCodeAt(m),s=g.charCodeAt(m+1),o=g.charCodeAt(m+2),u=i<<16|s<<8|o,f=u>>18&63,l=u>>12&63,c=u>>6&63,h=u&63,p[m/3]=b.charAt(f)+b.charAt(l)+b.charAt(c)+b.charAt(h);return y=p.join(""),y=y.slice(0,y.length-v.length)+v,y},n.decode=function(e,t){t=typeof t=="undefined"?!1:t;var i,s,o,u,f,l,c,h,p=[],v,m,g=n.code;m=t?r.decode(e):e;for(var y=0;y<m.length;y+=4)u=g.indexOf(m.charAt(y)),f=g.indexOf(m.charAt(y+1)),l=g.indexOf(m.charAt(y+2)),c=g.indexOf(m.charAt(y+3)),h=u<<18|f<<12|l<<6|c,i=h>>>16&255,s=h>>>8&255,o=h&255,p[y/4]=String.fromCharCode(i,s,o),c==64&&(p[y/4]=String.fromCharCode(i,s)),l==64&&(p[y/4]=String.fromCharCode(i));return v=p.join(""),t?r.decode(v):v};var r={};r.encode=function(e){var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|t&63)});return t=t.replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|t&63)}),t},r.decode=function(e){var t=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&15)<<12|(e.charCodeAt(1)&63)<<6|e.charCodeAt(2)&63;return String.fromCharCode(t)});return t=t.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(t)}),t}}(jwplayer.utils),function(e){e.events={COMPLETE:"COMPLETE",ERROR:"ERROR",API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_MEDIA_LEVELS:"jwplayerMediaLevels",JWPLAYER_MEDIA_LEVEL_CHANGED:"jwplayerMediaLevelChanged",JWPLAYER_CAPTIONS_CHANGED:"jwplayerCaptionsChanged",JWPLAYER_CAPTIONS_LIST:"jwplayerCaptionsList",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",state:{BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_PLAYLIST_COMPLETE:"jwplayerPlaylistComplete",JWPLAYER_DISPLAY_CLICK:"jwplayerViewClick",JWPLAYER_CONTROLS:"jwplayerViewControls",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed"}}(jwplayer),function(e){var t=jwplayer.utils;e.eventdispatcher=function(e,n){var r=e,i=n,s,o;this.resetEventListeners=function(){s={},o=[]},this.resetEventListeners(),this.addEventListener=function(e,n,r){try{t.exists(s[e])||(s[e]=[]),t.typeOf(n)=="string"&&(n=(new Function("return "+n))()),s[e].push({listener:n,count:r})}catch(i){t.log("error",i)}return!1},this.removeEventListener=function(e,n){if(!s[e])return;try{for(var r=0;r<s[e].length;r++)if(s[e][r].listener.toString()==n.toString()){s[e].splice(r,1);break}}catch(i){t.log("error",i)}return!1},this.addGlobalListener=function(e,n){try{t.typeOf(e)=="string"&&(e=(new Function("return "+e))()),o.push({listener:e,count:n})}catch(r){t.log("error",r)}return!1},this.removeGlobalListener=function(e){if(!e)return;try{for(var n=0;n<o.length;n++)if(o[n].listener.toString()==e.toString()){o.splice(n,1);break}}catch(r){t.log("error",r)}return!1},this.sendEvent=function(e,n){t.exists(n)||(n={}),t.extend(n,{id:r,version:jwplayer.version,type:e}),i&&t.log(e,n);if(t.typeOf(s[e])!="undefined")for(var u=0;u<s[e].length;u++){try{s[e][u].listener(n)}catch(a){t.log("There was an error while handling a listener: "+a.toString(),s[e][u].listener)}s[e][u]&&(s[e][u].count===1?delete s[e][u]:s[e][u].count>0&&(s[e][u].count=s[e][u].count-1))}var l;for(l=0;l<o.length;l++){try{o[l].listener(n)}catch(a){t.log("There was an error while handling a listener: "+a.toString(),o[l].listener)}o[l]&&(o[l].count===1?delete o[l]:o[l].count>0&&(o[l].count=o[l].count-1))}}}}(jwplayer.events),function(e){var t={},n={};e.plugins=function(){},e.plugins.loadPlugins=function(r,i){return n[r]=new e.plugins.pluginloader(new e.plugins.model(t),i),n[r]},e.plugins.registerPlugin=function(n,r,i,s){var o=e.utils.getPluginName(n);t[o]||(t[o]=new e.plugins.plugin(n)),t[o].registerPlugin(n,r,i,s)}}(jwplayer),function(e){e.plugins.model=function(t){this.addPlugin=function(n){var r=e.utils.getPluginName(n);return t[r]||(t[r]=new e.plugins.plugin(n)),t[r]},this.getPlugins=function(){return t}}}(jwplayer),function(e){var t=jwplayer.utils,n=jwplayer.events,r="undefined";e.pluginmodes={FLASH:0,JAVASCRIPT:1,HYBRID:2},e.plugin=function(i){function p(){switch(t.getPluginPathType(i)){case t.pluginPathType.ABSOLUTE:return i;case t.pluginPathType.RELATIVE:return t.getAbsolutePath(i,window.location.href)}}function v(e){l=setTimeout(function(){s=t.loaderstatus.COMPLETE,h.sendEvent(n.COMPLETE)},1e3)}function m(e){s=t.loaderstatus.ERROR,h.sendEvent(n.ERROR)}var s=t.loaderstatus.NEW,o,u,f,l,h=new n.eventdispatcher;t.extend(this,h),this.load=function(){if(s==t.loaderstatus.NEW){if(i.lastIndexOf(".swf")>0){o=i,s=t.loaderstatus.COMPLETE,h.sendEvent(n.COMPLETE);return}if(t.getPluginPathType(i)==t.pluginPathType.CDN){s=t.loaderstatus.COMPLETE,h.sendEvent(n.COMPLETE);return}s=t.loaderstatus.LOADING;var e=new t.scriptloader(p());e.addEventListener(n.COMPLETE,v),e.addEventListener(n.ERROR,m),e.load()}},this.registerPlugin=function(e,r,i,p){l&&(clearTimeout(l),l=undefined),f=r,i&&p?(o=p,u=i):typeof i=="string"?o=i:typeof i=="function"?u=i:!i&&!p&&(o=e),s=t.loaderstatus.COMPLETE,h.sendEvent(n.COMPLETE)},this.getStatus=function(){return s},this.getPluginName=function(){return t.getPluginName(i)},this.getFlashPath=function(){if(o)switch(t.getPluginPathType(o)){case t.pluginPathType.ABSOLUTE:return o;case t.pluginPathType.RELATIVE:if(i.lastIndexOf(".swf")>0)return t.getAbsolutePath(o,window.location.href);return t.getAbsolutePath(o,p())}return null},this.getJS=function(){return u},this.getTarget=function(){return f},this.getPluginmode=function(){if(typeof o!=r&&typeof u!=r)return e.pluginmodes.HYBRID;if(typeof o!=r)return e.pluginmodes.FLASH;if(typeof u!=r)return e.pluginmodes.JAVASCRIPT},this.getNewInstance=function(e,t,n){return new u(e,t,n)},this.getURL=function(){return i}}}(jwplayer.plugins),function(e){var t=e.utils,n=e.events;e.plugins.pluginloader=function(r,i){function d(){f?p.sendEvent(n.ERROR,{message:l}):u||(u=!0,s=t.loaderstatus.COMPLETE,p.sendEvent(n.COMPLETE))}function v(){h||d();if(!u&&!f){var n=0,i=r.getPlugins();for(var s in h){var o=t.getPluginName(s),c=i[o],p=c.getJS(),v=c.getTarget(),m=c.getStatus();m==t.loaderstatus.LOADING||m==t.loaderstatus.NEW?n++:p&&(!v||parseFloat(v)>parseFloat(e.version))&&(f=!0,l="Incompatible player version",d())}n==0&&d()}}var s=t.loaderstatus.NEW,o=!1,u=!1,f=!1,l,h=i,p=new n.eventdispatcher;t.extend(this,p),this.setupPlugins=function(e,n,i){var s={length:0,plugins:{}},o={length:0,plugins:{}},u=r.getPlugins();for(var f in n.plugins){var l=t.getPluginName(f),c=u[l],h=c.getFlashPath(),p=c.getJS(),d=c.getURL();h&&(s.plugins[h]=t.extend({},n.plugins[f]),s.plugins[h].pluginmode=c.getPluginmode(),s.length++);if(p&&n.plugins&&n.plugins[d]){var v=document.createElement("div");v.id=e.id+"_"+l,v.style.position="absolute",v.style.top=0,v.style.zIndex=o.length+10,o.plugins[l]=c.getNewInstance(e,t.extend({},n.plugins[d]),v),o.length++,e.onReady(i(o.plugins[l],v,!0)),e.onResize(i(o.plugins[l],v))}}return e.plugins=o.plugins,s},this.load=function(){if(t.exists(i)&&t.typeOf(i)!="object"){v();return}s=t.loaderstatus.LOADING,o=!0;for(var e in i)if(t.exists(e)){var u=r.addPlugin(e);u.addEventListener(n.COMPLETE,v),u.addEventListener(n.ERROR,m)}var f=r.getPlugins();for(e in f)f[e].load();o=!1,v()};var m=this.pluginFailed=function(e){f||(f=!0,l="File not found",d())};this.getStatus=function(){return s}}}(jwplayer),function(e){e.playlist=function(t){var n=[];if(e.utils.typeOf(t)=="array")for(var r=0;r<t.length;r++)n.push(new e.playlist.item(t[r]));else n.push(new e.playlist.item(t));return n}}(jwplayer),function(e){var t=e.item=function(n){var r=jwplayer.utils.extend({},t.defaults,n);r.sources.length==0&&(r.sources=[new e.source(r)]);for(var i=0;i<r.sources.length;i++)r.sources[i]=new e.source(r.sources[i]);return r};t.defaults={description:"",image:"",mediaid:"",title:"",tags:"",duration:-1,sources:[]}}(jwplayer.playlist),function(e){var t=undefined,n=jwplayer.utils,r={file:t,label:t,bitrate:t,width:t,height:t,type:t};e.source=function(e){var t=n.extend({},r);for(var i in r)n.exists(e[i])&&(t[i]=e[i],delete e[i]);return t.type&&t.type.indexOf("/")>0&&(t.type=n.extensionmap.mimeType(t.type)),t}}(jwplayer.playlist),function(e){var t=e.utils,n=e.events,r=document,i=e.embed=function(s){function m(e,t){for(var n in t)typeof e[n]=="function"&&e[n].call(e,t[n])}function g(){if(t.typeOf(o.playlist)=="array"&&o.playlist.length<2)if(o.playlist.length==0||!o.playlist[0].sources||o.playlist[0].sources.length==0){S();return}if(v.getStatus()==t.loaderstatus.COMPLETE){for(var e=0;e<o.modes.length;e++)if(o.modes[e].type&&i[o.modes[e].type]){var r=o.modes[e].config,f=t.extend({},r?i.config.addConfig(o,r):o),l=new i[o.modes[e].type](u,o.modes[e],f,v,s);if(l.supportsConfig())return l.addEventListener(n.ERROR,w),l.embed(),m(s,f.events),s}o.fallback?(t.log("No suitable players found and fallback enabled"),new i.download(u,o,S)):(t.log("No suitable players found and fallback disabled"),y())}}function y(){u.parentNode.replaceChild(f,u)}function w(e){x(u,p+e.message)}function E(e){x(u,"Could not load plugins: "+e.message)}function S(){x(u,p+"No playable sources found")}function x(e,n){if(!o.fallback)return;var r=e.style;r.backgroundColor="#000",r.color="#FFF",r.width=t.styleDimension(o.width),r.height=t.styleDimension(o.height),r.display="table",r.opacity=1;var i=document.createElement("p"),s=i.style;s.verticalAlign="middle",s.textAlign="center",s.display="table-cell",s.font="15px/20px Arial, Helvetica, sans-serif",i.innerHTML=n.replace(":",":<br>"),e.innerHTML="",e.appendChild(i)}var o=new i.config(s.config),u,f,l=o.width,h=o.height,p="Error loading player: ",v=e.plugins.loadPlugins(s.id,o.plugins);return o.id=s.id,f=r.getElementById(s.id),u=r.createElement("div"),u.id=f.id,u.style.width=l.toString().indexOf("%")>0?l:l+"px",u.style.height=h.toString().indexOf("%")>0?h:h+"px",f.parentNode.replaceChild(u,f),e.embed.errorScreen=x,v.addEventListener(n.COMPLETE,g),v.addEventListener(n.ERROR,E),v.load(),s}}(jwplayer),function(e){function o(e){if(!e.playlist){var t={};for(var n in r.defaults)u(e,t,n);if(!t.sources)if(e.levels)t.sources=e.levels,delete e.levels;else{var i={};u(e,i,"file"),u(e,i,"type"),t.sources=i.file?[i]:[]}e.playlist=[t]}else for(var s=0;s<e.playlist.length;s++)e.playlist[s]=new r(e.playlist[s])}function u(e,n,r){t.exists(e[r])&&(n[r]=e[r],delete e[r])}var t=e.utils,n=e.embed,r=e.playlist.item,i=undefined,s=n.config=function(e){function n(e,t,n){for(var r=0;r<e.length;r++){var i=e[r].type;e[r].src||(e[r].src=n[i]?n[i]:t+"jwplayer."+i+(i=="flash"?".swf":".js"))}}var r={fallback:!0,height:270,primary:"html5",width:480,base:i},s={html5:{type:"html5"},flash:{type:"flash"}},u=t.extend(r,e);return u.base||(u.base=t.getScriptPath("jwplayer.js")),u.modes||(u.modes=u.primary=="flash"?[s.flash,s.html5]:[s.html5,s.flash]),u.listbar&&(u.playlistsize=u.listbar.size,u.playlistposition=u.listbar.position),n(u.modes,u.base,{html5:u.html5player,flash:u.flashplayer}),o(u),u};s.addConfig=function(e,n){return o(n),t.extend(e,n)}}(jwplayer),function(e){var t=e.embed,n=e.utils,r=document,i="pointer",s="none",o="block",u="100%",a="relative",f="absolute";t.download=function(t,i,l){function E(){var t,r,i,s,o=h.playlist,u,a,s,f=["mp4","aac","mp3"];if(!o||!o.length)return;u=o[0],a=u.sources;for(s=0;s<a.length;s++){var c=a[s],p=c.type?c.type:n.extensionmap.extType(n.extension(c.file));if(c.file){for(s in f)p==f[s]?(t=c.file,r=u.image):n.isYouTube(c.file)&&(i=c.file);if(t||i)continue}}t?(g=t,y=r,w.prefix&&(n.isHTTPS()&&(w.prefix=w.prefix.replace("http://","https://ssl.")),w.prefix+=e.version.split(/\W/).splice(0,2).join("/")),S(),T()):i?C(i):l()}function S(){t&&(p=N("a","display",t),N("div","icon",p),N("div","logo",p),g&&p.setAttribute("href",n.getAbsolutePath(g)))}function x(e,t){var n=r.querySelectorAll(e);for(var i=0;i<n.length;i++)for(var s in t)n[i].style[s]=t[s]}function T(){var e="#"+t.id+" .jwdownload";t.style.width="",t.style.height="",x(e+"display",{width:n.styleDimension(Math.max(320,v)),height:n.styleDimension(Math.max(180,m)),background:"black center no-repeat "+(y?"url("+y+")":""),backgroundSize:"contain",position:a,border:s,display:o}),x(e+"display div",{position:f,width:u,height:u}),x(e+"logo",{top:w.margin+"px",right:w.margin+"px",background:"top right no-repeat url("+w.prefix+w.file+")"}),x(e+"icon",{background:"center no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgNJREFUeNrs28lqwkAYB/CZqNVDDj2r6FN41QeIy8Fe+gj6BL275Q08u9FbT8ZdwVfotSBYEPUkxFOoks4EKiJdaDuTjMn3wWBO0V/+sySR8SNSqVRKIR8qaXHkzlqS9jCfzzWcTCYp9hF5o+59sVjsiRzcegSckFzcjT+ruN80TeSlAjCAAXzdJSGPFXRpAAMYwACGZQkSdhG4WCzehMNhqV6vG6vVSrirKVEw66YoSqDb7cqlUilE8JjHd/y1MQefVzqdDmiaJpfLZWHgXMHn8F6vJ1cqlVAkEsGuAn83J4gAd2RZymQygX6/L1erVQt+9ZPWb+CDwcCC2zXGJaewl/DhcHhK3DVj+KfKZrMWvFarcYNLomAv4aPRSFZVlTlcSPA5fDweW/BoNIqFnKV53JvncjkLns/n/cLdS+92O7RYLLgsKfv9/t8XlDn4eDyiw+HA9Jyz2eyt0+kY2+3WFC5hluej0Ha7zQQq9PPwdDq1Et1sNsx/nFBgCqWJ8oAK1aUptNVqcYWewE4nahfU0YQnk4ntUEfGMIU2m01HoLaCKbTRaDgKtaVLk9tBYaBcE/6Artdr4RZ5TB6/dC+9iIe/WgAMYADDpAUJAxjAAAYwgGFZgoS/AtNNTF7Z2bL0BYPBV3Jw5xFwwWcYxgtBP5OkE8i9G7aWGOOCruvauwADALMLMEbKf4SdAAAAAElFTkSuQmCC)"})}function N(e,t,n){var i=r.createElement(e);return t&&(i.className="jwdownload"+t),n&&n.appendChild(i),i}function C(e){var n=N("embed","",t);n.src="http://www.youtube.com/v/"+/v[=\/](\w*)|\/(\w+)$|^(\w+)$/i.exec(e).slice(1).join(""),n.type="application/x-shockwave-flash",n.width=v,n.height=m}var h=n.extend({},i),p,v=h.width?h.width:480,m=h.height?h.height:320,g,y,w=i.logo?i.logo:{prefix:"http://p.jwpcdn.com/",file:"logo.png",margin:10};E()}}(jwplayer),function(e){var t=e.utils,n=e.events,r={},i=e.embed.flash=function(i,s,o,u,f){function p(e,t,n){var r=document.createElement("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function v(e,t,n){return function(r){try{n&&document.getElementById(f.id+"_wrapper").appendChild(t);var i=document.getElementById(f.id).getPluginConfig("display");typeof e.resize=="function"&&e.resize(i.width,i.height),t.style.left=i.x,t.style.top=i.h}catch(s){}}}function m(e){if(!e)return{};var t={};for(var n in e){var r=e[n];for(var i in r)t[n+"."+i]=r[i]}return t}function g(e){if(!e)return{};var n={},r=[];for(var i in e){var s=t.getPluginName(i),o=e[i];r.push(i);for(var u in o)n[s+"."+u]=o[u]}return n.plugins=r.join(","),n}function y(e){var n={};for(var r in e)typeof e[r]=="object"?n[r]="[[JSON]]"+t.jsonToString(e[r]):n[r]=e[r];return n}function w(e,n){if(t.isYouTube(e))return!0;if(t.isRtmp(e,n))return!0;if(n=="hls")return!0;var r=t.extensionmap[n?n:t.extension(e)];return r?!!r.flash:!1}var l=new e.events.eventdispatcher,h=t.flashVersion();t.extend(this,l),this.embed=function(){o.id=f.id;if(h<10)return l.sendEvent(n.ERROR,{message:"Flash version must be 10.0 or greater"}),!1;var e,c=t.extend({},o);i.id+"_wrapper"==i.parentNode.id?e=document.getElementById(i.id+"_wrapper"):(e=document.createElement("div"),e.id=i.id+"_wrapper",e.style.position="relative",e.style.width=t.styleDimension(c.width),e.style.height=t.styleDimension(c.height),i.parentNode.replaceChild(e,i),e.appendChild(i));var m=u.setupPlugins(f,c,v);m.length>0?t.extend(c,g(m.plugins)):delete c.plugins,typeof c["dock.position"]!="undefined"&&c["dock.position"].toString().toLowerCase()=="false"&&(c.dock=c["dock.position"],delete c["dock.position"]);var w=t.getCookies();for(var E in w)typeof c[E]=="undefined"&&(c[E]=w[E]);var S="#000000",x,T=c.wmode?c.wmode:c.height&&c.height<=40?"transparent":"opaque",N=["height","width","modes","events","primary","base","fallback"];for(var C=0;C<N.length;C++)delete c[N[C]];var L=window.location.pathname.split("/");L.splice(L.length-1,1),L=L.join("/"),c.base=L+"/",r[i.id]=y(c);if(t.isIE()){var A='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" " width="100%" height="100%" id="'+i.id+'" name="'+i.id+'" tabindex=0"">';A+='<param name="movie" value="'+s.src+'">',A+='<param name="allowfullscreen" value="true">',A+='<param name="allowscriptaccess" value="always">',A+='<param name="seamlesstabbing" value="true">',A+='<param name="wmode" value="'+T+'">',A+='<param name="bgcolor" value="'+S+'">',A+="</object>",i.outerHTML=A,x=document.getElementById(i.id)}else{var O=document.createElement("object");O.setAttribute("type","application/x-shockwave-flash"),O.setAttribute("data",s.src),O.setAttribute("width","100%"),O.setAttribute("height","100%"),O.setAttribute("bgcolor",S),O.setAttribute("id",i.id),O.setAttribute("name",i.id),O.setAttribute("tabindex",0),p(O,"allowfullscreen","true"),p(O,"allowscriptaccess","always"),p(O,"seamlesstabbing","true"),p(O,"wmode",T),i.parentNode.replaceChild(O,i),x=O}f.container=x,f.setPlayer(x,"flash")},this.supportsConfig=function(){if(h){if(!o)return!0;try{var e=o.playlist[0],t=e.sources;if(typeof t=="undefined")return!0;for(var n=0;n<t.length;n++)if(t[n].file&&w(t[n].file,t[n].type))return!0}catch(r){return!1}}return!1}};i.getVars=function(e){return r[e]}}(jwplayer),function(e){var t=e.utils,n=t.extensionmap,r=e.events;e.embed.html5=function(i,s,o,u,f){function p(e,t,n){return function(r){try{var s=document.querySelector("#"+i.id+" .jwmain");n&&s.appendChild(t),typeof e.resize=="function"&&(e.resize(s.clientWidth,s.clientHeight),setTimeout(function(){e.resize(s.clientWidth,s.clientHeight)},400)),t.left=s.style.left,t.top=s.style.top}catch(o){}}}function v(e){l.sendEvent(e.type,{message:"HTML5 player not found"})}function m(e,r){if(navigator.userAgent.match(/BlackBerry/i)!==null)return!1;if(t.isRtmp(e,r))return!1;var i=n[r?r:t.extension(e)];return i?i.flash&&!i.html5?!1:g(i.html5):!1}function g(t){var n=e.vid;if(!t)return!0;try{return n.canPlayType(t)?!0:!1}catch(r){return!1}}var l=this,h=new r.eventdispatcher;t.extend(l,h),l.embed=function(){if(e.html5){u.setupPlugins(f,o,p),i.innerHTML="";var n=e.utils.extend({},o),h=new e.html5.player(n);f.container=document.getElementById(f.id),f.setPlayer(h,"html5")}else{var m=new t.scriptloader(s.src);m.addEventListener(r.ERROR,v),m.addEventListener(r.COMPLETE,l.embed),m.load()}},l.supportsConfig=function(){if(!!e.vid.canPlayType)try{if(t.typeOf(o.playlist)=="string")return!0;var n=o.playlist[0].sources;for(var r=0;r<n.length;r++){var i=n[r].file,s=n[r].type;if(m(i,s))return!0}}catch(u){return!1}return!1}}}(jwplayer),function(e){var t=e.embed,n=e.utils,r=n.extend(function(r){var i=r.config,s=i.plugins,o=i.analytics,u=(n.isHTTPS()?"https://ssl.":"http://")+"p.jwpcdn.com/"+e.version.replace(/(\d+)\.(\d+).*/,"$1/$2")+"/jwpsrv.js";return delete i.key,e.key&&(i.key=e.key),delete i.analytics,s=s?s:{},s[u]=o?o:{},i.plugins=s,new t(r)},t);e.embed=r}(jwplayer),function(e){var t=e.embed,n=e.utils.extend(function(e){var n=e.config,r=n.plugins?n.plugins:{};return delete r.sharing,delete r.related,n.sharing&&(r.sharing=n.sharing),n.related&&(r.related=n.related),n.ga&&(r.ga=n.ga),n.plugins=r,new t(e)},t);e.embed=n}(jwplayer),function(e){var t=[],n=e.utils,r=e.events,i=r.state,s=document,o=e.api=function(t){function N(e,t){return function(n){return t(e,n)}}function C(e){y=[],o.destroyPlayer(e.id)}function k(e,t){return c[e]||(c[e]=[],_(r.JWPLAYER_PLAYER_STATE,L(e))),c[e].push(t),u}function L(e){return function(t){var n=t.newstate,r=t.oldstate;if(n==e){var i=c[n];if(i)for(var s=0;s<i.length;s++)typeof i[s]=="function"&&i[s].call(this,{oldstate:r,newstate:n})}}}function A(e,t,n){return h[e]||(h[e]={}),h[e][t]||(h[e][t]=[],_(t,O(e,t))),h[e][t].push(n),u}function O(e,t){return function(n){if(e==n.component){var r=h[e][t];if(r)for(var i=0;i<r.length;i++)typeof r[i]=="function"&&r[i].call(this,n)}}}function M(e,t){try{e.jwAddEventListener(t,'function(dat) { jwplayer("'+u.id+'").dispatchEvent("'+t+'", dat); }')}catch(r){n.log("Could not add internal listener")}}function _(e,t){return l[e]||(l[e]=[],v&&m&&M(v,e)),l[e].push(t),u}function D(){if(m){var e=arguments[0],t=[];for(var n=1;n<arguments.length;n++)t.push(arguments[n]);if(typeof v!="undefined"&&typeof v[e]=="function")switch(t.length){case 4:return v[e](t[0],t[1],t[2],t[3]);case 3:return v[e](t[0],t[1],t[2]);case 2:return v[e](t[0],t[1]);case 1:return v[e](t[0]);default:return v[e]()}return null}y.push(arguments)}function P(e,t,n){var r=[];t||(t=0),n||(n=e.length-1);for(var i=t;i<=n;i++)r.push(e[i]);return r}var u=this,l={},c={},h={},p=[],v=undefined,m=!1,y=[],w=undefined,E={},S={};u.container=t,u.id=t.id,u.getBuffer=function(){return D("jwGetBuffer")},u.getContainer=function(){return u.container},u.addButton=function(e,t,r,i){try{S[i]=r;var s="jwplayer('"+u.id+"').callback('"+i+"')";D("jwDockAddButton",e,t,s,i)}catch(o){n.log("Could not add dock button"+o.message)}},u.removeButton=function(e){D("jwDockRemoveButton",e)},u.callback=function(e){S[e]&&S[e]()},u.getDuration=function(){return D("jwGetDuration")},u.getFullscreen=function(){return D("jwGetFullscreen")},u.getStretching=function(){return D("jwGetStretching")},u.getHeight=function(){return D("jwGetHeight")},u.getLockState=function(){return D("jwGetLockState")},u.getMeta=function(){return u.getItemMeta()},u.getMute=function(){return D("jwGetMute")},u.getPlaylist=function(){var e=D("jwGetPlaylist");u.renderingMode=="flash"&&n.deepReplaceKeyName(e,["__dot__","__spc__","__dsh__"],["."," ","-"]);for(var t=0;t<e.length;t++)n.exists(e[t].index)||(e[t].index=t);return e},u.getPlaylistItem=function(e){return n.exists(e)||(e=u.getCurrentItem()),u.getPlaylist()[e]},u.getPosition=function(){return D("jwGetPosition")},u.getRenderingMode=function(){return u.renderingMode},u.getState=function(){return D("jwGetState")},u.getVolume=function(){return D("jwGetVolume")},u.getWidth=function(){return D("jwGetWidth")},u.setFullscreen=function(e){return n.exists(e)?D("jwSetFullscreen",e):D("jwSetFullscreen",!D("jwGetFullscreen")),u},u.setStretching=function(e){return D("jwSetStretching",e),u},u.setMute=function(e){return n.exists(e)?D("jwSetMute",e):D("jwSetMute",!D("jwGetMute")),u},u.lock=function(){return u},u.unlock=function(){return u},u.load=function(e){return D("jwLoad",e),u},u.playlistItem=function(e){return D("jwPlaylistItem",parseInt(e)),u},u.playlistPrev=function(){return D("jwPlaylistPrev"),u},u.playlistNext=function(){return D("jwPlaylistNext"),u},u.resize=function(e,t){if(u.renderingMode=="html5")v.jwResize(e,t);else{var r=s.getElementById(u.id+"_wrapper");r&&(r.style.width=n.styleDimension(e),r.style.height=n.styleDimension(t))}return u},u.play=function(e){return typeof e=="undefined"?(e=u.getState(),e==i.PLAYING||e==i.BUFFERING?D("jwPause"):D("jwPlay")):D("jwPlay",e),u},u.pause=function(e){return typeof e=="undefined"?(e=u.getState(),e==i.PLAYING||e==i.BUFFERING?D("jwPause"):D("jwPlay")):D("jwPause",e),u},u.stop=function(){return D("jwStop"),u},u.seek=function(e){return D("jwSeek",e),u},u.setVolume=function(e){return D("jwSetVolume",e),u},u.loadInstream=function(e,t){return w=new o.instream(this,v,e,t),w},u.getQualityLevels=function(){return D("jwGetQualityLevels")},u.getCurrentQuality=function(){return D("jwGetCurrentQuality")},u.setCurrentQuality=function(e){D("jwSetCurrentQuality",e)},u.getCaptionsList=function(){return D("jwGetCaptionsList")},u.getCurrentCaptions=function(){return D("jwGetCurrentCaptions")},u.setCurrentCaptions=function(e){D("jwSetCurrentCaptions",e)},u.getControls=function(){return D("jwGetControls")},u.getSafeRegion=function(){return D("jwGetSafeRegion")},u.setControls=function(e){D("jwSetControls",e)};var x={onBufferChange:r.JWPLAYER_MEDIA_BUFFER,onBufferFull:r.JWPLAYER_MEDIA_BUFFER_FULL,onError:r.JWPLAYER_ERROR,onFullscreen:r.JWPLAYER_FULLSCREEN,onMeta:r.JWPLAYER_MEDIA_META,onMute:r.JWPLAYER_MEDIA_MUTE,onPlaylist:r.JWPLAYER_PLAYLIST_LOADED,onPlaylistItem:r.JWPLAYER_PLAYLIST_ITEM,onPlaylistComplete:r.JWPLAYER_PLAYLIST_COMPLETE,onReady:r.API_READY,onResize:r.JWPLAYER_RESIZE,onComplete:r.JWPLAYER_MEDIA_COMPLETE,onSeek:r.JWPLAYER_MEDIA_SEEK,onTime:r.JWPLAYER_MEDIA_TIME,onVolume:r.JWPLAYER_MEDIA_VOLUME,onBeforePlay:r.JWPLAYER_MEDIA_BEFOREPLAY,onBeforeComplete:r.JWPLAYER_MEDIA_BEFORECOMPLETE,onDisplayClick:r.JWPLAYER_DISPLAY_CLICK,onControls:r.JWPLAYER_CONTROLS,onQualityLevels:r.JWPLAYER_MEDIA_LEVELS,onQualityChange:r.JWPLAYER_MEDIA_LEVEL_CHANGED,onCaptionsList:r.JWPLAYER_CAPTIONS_LIST,onCaptionsChange:r.JWPLAYER_CAPTIONS_CHANGED};n.foreach(x,function(e){u[e]=N(x[e],_)});var T={onBuffer:i.BUFFERING,onPause:i.PAUSED,onPlay:i.PLAYING,onIdle:i.IDLE};return n.foreach(T,function(e){u[e]=N(T[e],k)}),u.remove=function(){if(!m)throw"Cannot call remove() before player is ready";C(this)},u.setup=function(t){if(e.embed){C(u);var n=e(u.id);return n.config=t,new e.embed(n)}return u},u.registerPlugin=function(t,n,r,i){e.plugins.registerPlugin(t,n,r,i)},u.setPlayer=function(e,t){v=e,u.renderingMode=t},u.detachMedia=function(){if(u.renderingMode=="html5")return D("jwDetachMedia")},u.attachMedia=function(){if(u.renderingMode=="html5")return D("jwAttachMedia")},u.dispatchEvent=function(e){if(l[e]){var t=n.translateEventResponse(e,arguments[1]);for(var r=0;r<l[e].length;r++)typeof l[e][r]=="function"&&l[e][r].call(this,t)}},u.dispatchInstreamEvent=function(e){w&&w.dispatchEvent(e,arguments)},u.playerReady=function(e){m=!0,v||u.setPlayer(s.getElementById(e.id)),u.container=s.getElementById(u.id),n.foreach(l,function(e){M(v,e)}),_(r.JWPLAYER_PLAYLIST_ITEM,function(e){E={}}),_(r.JWPLAYER_MEDIA_META,function(e){n.extend(E,e.metadata)}),u.dispatchEvent(r.API_READY);while(y.length>0)D.apply(this,y.shift())},u.getItemMeta=function(){return E},u.getCurrentItem=function(){return D("jwGetPlaylistIndex")},u};o.selectPlayer=function(e){var r;n.exists(e)||(e=0),e.nodeType?r=e:typeof e=="string"&&(r=s.getElementById(e));if(r){var i=o.playerById(r.id);return i?i:o.addPlayer(new o(r))}return typeof e=="number"?t[e]:null},o.playerById=function(e){for(var n=0;n<t.length;n++)if(t[n].id==e)return t[n];return null},o.addPlayer=function(e){for(var n=0;n<t.length;n++)if(t[n]==e)return e;return t.push(e),e},o.destroyPlayer=function(e){var r=-1,i;for(var o=0;o<t.length;o++)if(t[o].id==e){r=o,i=t[o];continue}if(r>=0){var u=i.id,f=s.getElementById(u+(i.renderingMode=="flash"?"_wrapper":""));n.clearCss&&n.clearCss("#"+u);if(f){var l=s.createElement("div");l.id=u,f.parentNode.replaceChild(l,f)}t.splice(r,1)}return null},e.playerReady=function(t){var n=e.api.playerById(t.id);n?n.playerReady(t):e.api.selectPlayer(t.id).playerReady(t)}}(jwplayer),function(e){var t=e.events,n=t.state;e.api.instream=function(e,r,i,s){function d(){o.callInternal("jwLoadInstream",i,s)}function v(e,t){u.jwInstreamAddEventListener(t,'function(dat) { jwplayer("'+o.id+'").dispatchInstreamEvent("'+t+'", dat); }')}function m(e,t){return h[e]||(h[e]=[],v(u,e)),h[e].push(t),this}function g(e,n){return p[e]||(p[e]=[],m(t.JWPLAYER_PLAYER_STATE,y(e))),p[e].push(n),this}function y(e){return function(t){var n=t.newstate,r=t.oldstate;if(n==e){var i=p[n];if(i)for(var s=0;s<i.length;s++)typeof i[s]=="function"&&i[s].call(this,{oldstate:r,newstate:n,type:t.type})}}}var o=e,u=r,f=i,l=s,h={},p={};this.dispatchEvent=function(e,t){if(h[e]){var n=_utils.translateEventResponse(e,t[1]);for(var r=0;r<h[e].length;r++)typeof h[e][r]=="function"&&h[e][r].call(this,n)}},this.onError=function(e){return m(t.JWPLAYER_ERROR,e)},this.onFullscreen=function(e){return m(t.JWPLAYER_FULLSCREEN,e)},this.onMeta=function(e){return m(t.JWPLAYER_MEDIA_META,e)},this.onMute=function(e){return m(t.JWPLAYER_MEDIA_MUTE,e)},this.onComplete=function(e){return m(t.JWPLAYER_MEDIA_COMPLETE,e)},this.onSeek=function(e){return m(t.JWPLAYER_MEDIA_SEEK,e)},this.onTime=function(e){return m(t.JWPLAYER_MEDIA_TIME,e)},this.onVolume=function(e){return m(t.JWPLAYER_MEDIA_VOLUME,e)},this.onBuffer=function(e){return g(n.BUFFERING,e)},this.onPause=function(e){return g(n.PAUSED,e)},this.onPlay=function(e){return g(n.PLAYING,e)},this.onIdle=function(e){return g(n.IDLE,e)},this.onInstreamClick=function(e){return m(t.JWPLAYER_INSTREAM_CLICK,e)},this.onInstreamDestroyed=function(e){return m(t.JWPLAYER_INSTREAM_DESTROYED,e)},this.play=function(e){u.jwInstreamPlay(e)},this.pause=function(e){u.jwInstreamPause(e)},this.seek=function(e){u.jwInstreamSeek(e)},this.destroy=function(){u.jwInstreamDestroy()},this.getState=function(){return u.jwInstreamGetState()},this.getDuration=function(){return u.jwInstreamGetDuration()},this.getPosition=function(){return u.jwInstreamGetPosition()},d()}}(jwplayer)),function(e){var t=e;e=function(e){var n=t(e);return n?n:{registerPlugin:function(e,n,r,i){t.plugins.registerPlugin(e,n,r)}}},t.utils.extend(e,t),function(e){var t="ga",n=function(n,r,i){function u(){return typeof o.trackingobject=="string"?window[o.trackingobject]:o.trackingobject}function a(e,t){if(e==undefined)return"";if(t!=undefined&&e[t]!=undefined&&e[t].length>0)return t=="file"?h(e[t]):e[t];if(e.file==undefined){if(e.sources)return f(e.sources);if(e.levels)return f(e.levels)}return e.file!=undefined?e.file:""}function f(e){var t=[],n;for(n=e.length-1;n>=0;n--)e[n].file&&t.push(e[n].file);return t.sort(),h(t[0])}function l(e){var t=e.indexOf("://"),n=e.indexOf("?");return t>0&&(n<0||n>t)}function h(e,t){if(l(e))return e;t||(t=document.location.href);var n=t.substring(0,t.indexOf("://")+3),r=t.substring(n.length,t.indexOf("/",n.length+1)),i;if(e.indexOf("/")===0)i=e.split("/");else{var s=t.split("?")[0];s=s.substring(n.length+r.length+1,s.lastIndexOf("/")),i=s.split("/").concat(e.split("/"))}var o=[];for(var u=0;u<i.length;u++)!!i[u]&&i[u]!="."&&(i[u]==".."?o.pop():o.push(i[u]));return n+r+"/"+o.join("/")}function p(){var e=!1,t="",r=!1,i;n.onPlaylistItem(function(s){e=!0,o.pageURL=window.top==window?window.location.href:document.referrer,o.currentItem={},i=n.getPlaylistItem(s.index),o.currentItem.mediaID=t,t=a(i,o.idstring),o.currentItem.hidden=r,i["ova.hidden"]?r=!0:r=!1}),n.onIdle(function(t){e=!0}),n.onPlay(function(n){e&&(e=!1,o.currentItem.mediaID=t,o.currentItem.hidden=r,d("JW Player Video Plays"))}),n.onComplete(function(e){d("JW Player Video Completes")})}function d(e){var t="Not tracked";o.currentItem.hidden?o.currentItem.hidden&&(t+=" - current item is hidden"):typeof u()._trackEvent!="undefined"?(t="Tracked Synchronously",m(e,o.currentItem.mediaID,o.pageURL)):typeof u().push!="undefined"&&(t="Tracked Asynchronously",v(e,o.currentItem.mediaID,o.pageURL)),g(t,{Category:e,Action:o.currentItem.mediaID,Label:o.pageURL})}function v(e,t,n){u().push(["_trackEvent",e,t,n])}function m(e,t,n){u()._trackEvent(e,t,n)}function g(n,r){o.debug&&e.utils.log(t+": "+n,r)}var s={trackingobject:"_gaq",idstring:"file"},o=e.utils.extend({},s,r);g("Initializing");if(typeof o.trackingobject=="string"&&typeof window[o.trackingobject]=="undefined"){g("Could not setup because trackingobject is not defined.");return}p()};e().registerPlugin(t,"6.0",n)}(e),function(e){var t=function(t,n,r){function y(e){n.onclick=="play"?(t.load(e),t.play()):window.top.location=e.link}function b(e){n.oncomplete!==!1&&setTimeout(w,50)}function w(e){t.getState()=="IDLE"&&g()}function E(e){e==u?console.log("RELATED: Failed to load "+e):console.log("RELATED: "+e),f.innerHTML="",a.innerHTML="No related videos found",o[4]=200,o[5]=0,O(o[2],o[3])}function S(e){setTimeout(x,200),r.style.opacity=0,t.setControls(!0)}function x(){r.style.visibility="hidden"}function T(e){l=!1,u=undefined,h=[],f.innerHTML="",S();var r=t.getPlaylist()[e.index];n.file&&(n.file.indexOf("MEDIAID")>0&&r.mediaid?u=n.file.replace("MEDIAID",r.mediaid):n.file.indexOf("MEDIAID")==-1&&(u=n.file)),t.addButton(m,"Related Videos",g,"related")}function N(){l=!0,u?e.utils.ajax(u,C,E):E("No related videos file found")}function C(e){var t=[];try{t=window.jwplayer.html5.parsers.rssparser.parse(e.responseXML.firstChild)}catch(r){console.log(r),E("This feed is not valid XML and/or RSS.");return}for(var i=0;i<t.length;i++)t[i].image&&t[i].title&&(n.onclick=="play"&&t[i].sources[0].file||n.onclick!="play"&&t[i].link)&&h.push(t[i]);k()}function k(){f.innerHTML="";if(h!==undefined&&h.length){var t=0,n=0;o[4]=0,o[5]=0;for(var r=0;r<h.length;r++){var i=e.related.thumb(o[0],o[1],h[r],y);f.appendChild(i),M(i,{left:(o[0]+10)*t+"px",top:(o[1]+10)*n+"px"}),o[4]=Math.max(o[4],o[0]*(t+1)+10*t),o[5]=Math.max(o[5],o[1]*(n+1)+10*n);if((o[0]+10)*(t+2)>o[2]){if((o[1]+10)*(n+2)>o[3]-80)break;n++,t=0}else t++}A("Related Videos"),O(o[2],o[3])}else E("RSS feed has 0 entries that contain title,link and image.")}function L(){if(t.getRenderingMode()=="flash")return;t.onPlaylistItem(T),t.onComplete(b),M(r,d),r.onclick=S,s=document.createElement("div"),M(s,p),M(s,{background:"transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNp8kUEOABEMRXUysXQnJ5k5GidxAmcxsbQxmiAlLUlD/df6UDnn1KK2eJQwUOtMAlwQ7TXG+B1ukxv5hRDRHT1ph5EFSRgN9tPh0E2drO6Xo7E8xk2TGKPSWi9NSilLPi2FEI6WrLV+FjAwe2ksAg4e3TgNCyoHS1bx4z4JxtH3hsXvF2AAnU9uUtSy19QAAAAASUVORK5CYII=)"}),s.onclick=S,r.appendChild(s),a=document.createElement("div"),A("Related Videos"),M(a,v),r.appendChild(a),f=document.createElement("div"),r.appendChild(f),M(f,{position:"absolute"})}function A(e){n.heading?a.innerHTML=n.heading:a.innerHTML=e}function O(e,t){M(r,{height:t+"px",width:e+"px"}),M(s,{left:e-32+"px"}),M(f,{left:Math.round(e/2-o[4]/2)+"px",top:Math.round(t/2-o[5]/2)+"px"}),M(a,{left:Math.round(e/2-o[4]/2)+"px",width:o[4]+"px",top:Math.round(t/2-o[5]/2-30)+"px"})}function M(e,t){for(var n in t)e.style[n]=t[n]}var i,s,o,u,a,f,l,h,p={cursor:"pointer",position:"absolute",left:"120px",top:"20px",margin:"0px",padding:"0px",display:"block",width:"12px",height:"12px"},d={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADICAYAAAAp8ov1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEdJREFUeNpilpSUvMHEwMDwn+k/EEBY+LkwFgMuCWINwDCPVB30cBoDaTpgBMMoQU2CkYkRCCAsNC6pEgyUGoBHYvA6DSDAAOnHjLU15EHNAAAAAElFTkSuQmCC)",backgroundRepeat:"no-repeat",backgroundSize:"100% 100%",opacity:0,webkitTransition:"opacity 150ms linear",MozTransition:"opacity 150ms linear",msTransition:"opacity 150ms linear",transition:"opacity 150ms linear",cursor:"pointer",visibility:"hidden"},v={position:"absolute",border:"none",color:"#FFF",display:"block",font:"15px Arial",overflow:"hidden",width:"240px",margin:"0 0 0 0",textAlign:"center",textTransform:"none",padding:"0 0 0 0"},m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALVJREFUeNqsVMERhCAMzNmAJVgaJWAHlGIJluB1YAnYASXEwOVmctzCR3YmOia7a4IgkQEzO4nI/zg0amSuoxqSnCVOiSTh87Op7cZgrzReNafVkL79N/nJB9BVaDRz2DETMFu4jQWYpjK+rkMAy7B1DDfAz9NEUsIMCLFjGBvfgV/lIgAEpg5amuGG07ddoLk6fhcaOd8nLa5A9O4YotpavIZvm+Eb++HRc/DoPfw5eOtxCzAABeIMZWrWSG0AAAAASUVORK5CYII=",g=function(){t.pause(!0),r.style.visibility="visible",r.style.opacity=1,t.setControls(!1),l==0&&N()};t.onReady(L),t.onPlay(S),this.resize=function(e,n){if(t.getRenderingMode()=="flash")return;o=[140,90,e,n,200,0],M(s,{left:e-32+"px"}),k()}};e().registerPlugin("related","6.0",t)}(e),function(e){if(e.related)return;e.related={},e.related.thumb=function(e,t,n,r){function l(e){d(i,{webkitBoxShadow:"0 0 4px #FFF",MozBoxShadow:"0 0 4px #FFF",msBoxShadow:"0 0 4px #FFF",boxShadow:"0 0 4px #FFF"}),d(a,{color:"#FFF"})}function c(e){d(i,{webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000"}),d(a,{color:"#CCC"})}function h(e){r(n)}function p(){i=document.createElement("div"),i.onclick=h,i.onmouseout=c,i.onmouseover=l,d(i,s),d(i,{backgroundImage:"url("+n.image+")",width:e-2+"px",height:t-2+"px"}),o=document.createElement("img"),o.setAttribute("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAABGCAYAAABL0p+yAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAACF9JREFUeNrsXYtO20gUtccWILoIFgS0IKDQAoUusEBBS///c6IQqwIJoqAdT/z2PO487NjJvZIJNxBnYE7u48yxx/9+9PWCEOL5vs+O+HuhH3+fPOcnzyl9Ep8nPwfhPU/i1xV+XvOn75s9L/Tzx3zs0/eR+tnY8/FwfXZ+kT89Vzqe9G+c/r2A8ZD0/arjkYxPOp7qXObnIjwf9Cg6d35o2Ds9BmHxRKXJVvnFx3QCMj8HoxwMKbBVk0+4wK5NttQHgrEABp8UPjAp0AsTkE1izSecD15hElW+8P0lj+n7p/9P3vikwK7Mla/y87nSBN4fegzpOV5jJwyCoBKZ9MAommzloyjqEc5kC31RlFX5kKjrK8AgGZ8QjNXIIwcjOMpVo3Ap6laBzQ8SNaAD5jA2IPgmCfAG9HXj4g/CIrCqqbYc5UQD9hVgsABjEfhKMGpEIgswlic5PxfJokHFTya/6kujnBYYFFEZEnU1wagR9eI0+0yPEX3tB+8X4ClYI+U2DsZq/ecIjOk/O32/ul+s88RgFEZhk5TrHIwAcBIxGIFR74UeEX1tpPpFsxTMmfz8ky9qYAp1HdfnROEC+KQ+AUSiki+rpzh1FNfXTLktglEUdUt+YW7LPil/8IhWkzFK6rs3aEEoTcFyMHD+AE0wQrpZcdQV+LXuWu7Lu1lRlJOkYOnkE/4HURp1+d2s0NfoZqH1oAJ4cX03TCLe2NO0kNAIqAQfB4zcbtaku4V0r6UOzITa4Ly/KCprp1wVGCDg1AMjr6Fx0c1qUivvSVMReRYWBoRoDhhIrTQCRnueTZpypSlY3M3CqQ07Dq/a3WY+mEN0Qq2UaBRbYxFQRCA7o1a0GwhFai0V+SKS1STlWgK9RTDqNRBAqoU+7/ncJkNIo9gDENLdzrqbhRLKgkhgRigbdLNgDtFVNytb3ZCDERj1lDSKNQADKRjUYAR1t8putgFCGdxNmoARSiibjEcMRtNu1oBQBtMoTlKwiGqpURc6dV4J0C5TriWhbA1GCfWiAUZ5nQdvaGxSLifqadMobiKgDqGsmmSnS21mYJR2sxqEMoxaEVAtEGpFVedJga6XciWEshWN4qQG9B1EOSNC2WppSxV1Ad2sorsV11mVyfZFvizqVsdnSygTALBLUc8JjeIuBTtMudarG5pg7LM8SkUoy31IPZjPTQI8pzSK4y7YjVYPRijry6Oa1eoZ8my6qxuWWj1DQnlCj0ZoFDcAtNLqFf2OaPVMRAkgrR4w5XZHq/dOj0ZpFPsmhCdGcCKPklAXHdTqma8mmKRgt/IoTnf7Qo+Izm3kddzqcqwOyaOqEzSf8ijoeABg9PwR/TIMw/DN64nJ5VgtglHd0MC0ei6A3h2tHohqieu7YRzxKPDGXs8sLAKp+1o929UNS60emNBuXquX1HeDpaWlyOux5SkYrBJpSKunSyg71+qZy6NU4zG58kyyhvsnjnjLy8uv3hzYNAXPUB4F5xRno9XTJ5Rt5FrCBofRKPS5AQXe2Jsjq6dg68sidVc39LR6XZVHyTlE1bXUAjDSNEu/PFN/tLKy8uHNoRVSsIFWz3hpC6rVK/ouo24HtXp+6XUv9Hej1dXVyJtzy1JwtZt1Tij3UaunkEeZavVEKZc+jugzw09/fXrzFsRCEhCFPKrhi7+dyKNIZ7R6BvIoRqPQ5yIKvLG3YBYWU9zMtXpObosh4Bgbl0fppdy4voubirW1tchbYAsDElho9YBpsUmtnsllkaArz3QJZZhWz0tolPX19VcPbZqCXcujzC/+7opWzzmhPKF+DLwBBd4YYVeNgBqrG+CLv53Lo4DdrEN5lK1Wj61WEP85bi42NjY+EG4cAJY+qb3T6jm+E4GCWtGQRzE1yt+bmxFCTEnDkI5q9aAp10yrJ5JHcX0ooe2TUVzfbW5tviG0wF1wYKEaMetmtQnlLmn1KgCP6zv6OqZG2drawvrOJAI2qdXrvzxKGHWZGmV7exvTrPVaMHCtVny9rwt5lOXqRktavaSbHe7s7CCN4i4Fq7V67d6JQMIxNnhbDKEihqVZxt8NdnZ3Mc26T8GOL/5uVKtnurqh0OrxtXvsop6YRtn9/BlplHZSsGOtnpDQVmv13F/8Db4SjdEoX/a+YH032xQsoC56Jo/S0OoxGmVvbw9plFZTsPVGLS2B0dlGLaUaMruoZ39/H+u7WURAkYq43Y1a2tHqFYAdq40HBwcHmGZnXQM2K48y36hFBUbDjVoYjXJweIg0SjdScOBUq9dNeVScZj1GoxweHWGa7WQEnKFWr8HVjYxGOfp6hDRKJwEYEMuNWhTCgdls1MJolOPjY6zv+hIB3Wj12pNH8XwvoVFOTk6QRulNDZjwgO52DWpIqyfeNSijUU6+fcP6rn8pOKhr9WxSLkCrZyqPqvhMjfL99BTTbP9TcF+0en52b5TTszOkUeZmJaT78qhJArzB2fkZptn5ioBBl3cNSm4x64/Of5wjjTK/EbD9jVoUYGQ0yo+LC6zvFqEG7MpGLaka5eLyEmmUxUvBwO7WvVYvo1Euf/7E+m5Rm5AZyKNofecN/rm6wjS76BGwTa1eem+Uq+srpFHQch7QhTxKckPxCT0Do1Gubq4xzaIpeEAAGIEpN1OjXN/cII2CJucBHSpSGI3y7+0t1ndolilYA4wpjXJ7d4c0CppuCjau/ybx9lBxxLu7v8f6Ds00BWvLo5ga5f7hF6ZZNNsICN81iIkCPH/46/EBaRQ0ewD6NUU0t5vN1CgPj4+YZtEcRsA0BUs2PI536qHAQxoFrYEaMCC8bpbRKP89PWF9h9Z8BCxcB8w2PH76/RtpFLS2uuDk3ijEjyjwsL5Da9X+F2AAdhpbcs9KP5oAAAAASUVORK5CYII="),d(o,u),d(o,{width:e-2+"px",height:t-20+"px"}),i.appendChild(o),a=document.createElement("div"),a.innerHTML=n.title,d(a,f);var r=Math.ceil(n.title.length*6/e);return d(a,{width:e-10+"px",top:t-8-r*16+"px"}),i.appendChild(a),i}function d(e,t){for(var n in t)e.style[n]=t[n]}var i,s={webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000",backgroundColor:"#000",backgroundSize:"cover",position:"absolute",textDecoration:"none",display:"block",margin:"0 0 0 0",padding:"0 0 0 0",overflow:"hidden"},o,u={psition:"absolute",left:"0px",top:"0px",border:"none",margin:"0 0 0 0",padding:"0 0 0 0"},a,f={backgroundColor:"rgba(0,0,0,0.8)",left:"0px",position:"absolute",border:"none",color:"#CCC",display:"block",font:"11px Arial",margin:"0 0 0 0",textAlign:"center",textDecoration:"none",textTransform:"none",padding:"5px"};return p()}}(e),function(e){var t=function(t,n,r){function g(e){var t=a+encodeURIComponent(h);return window.open(t,"_blank"),window.focus(),!1}function y(e){e.target==r&&(setTimeout(b,200),r.style.opacity=0,t.setControls(!0))}function b(){r.style.visibility="hidden"}function w(e){setTimeout(b,200),r.style.opacity=0,t.setControls(!0);var o=t.getPlaylist()[e.index];i=undefined,n.code&&(n.code.indexOf("MEDIAID")>0&&o.mediaid?i=n.code.replace("MEDIAID",o.mediaid):n.code.indexOf("MEDIAID")==-1&&(i=n.code)),i&&i.substr(0,3)=="%3C"&&(i=decodeURIComponent(i)),h=window.location.toString(),window.top!=window&&(h=document.referrer),n.link&&(n.link.indexOf("MEDIAID")>0&&o.mediaid?h=n.link.replace("MEDIAID",o.mediaid):n.link.indexOf("MEDIAID")==-1&&(h=n.link)),f&&(s.setText(i),p.setText(h),i?(N(s.getDiv(),{left:"0px",top:"30px",display:"block"}),N(p.getDiv(),{left:"0px",top:"72px"}),N(u,{left:"80px",top:"114px"}),N(d,{left:"120px",top:"114px"}),N(m,{left:"160px",top:"114px"})):(N(s.getDiv(),{display:"none"}),N(p.getDiv(),{left:"0px",top:"30px"}),N(u,{left:"80px",top:"72px"}),N(d,{left:"120px",top:"72px"}),N(m,{left:"160px",top:"72px"})),E())}function E(){N(r,{width:o[0]+"px",height:o[1]+"px",backgroundPosition:o[0]-32+"px 18px,center center"}),s.resize(o[0]),p.resize(o[0]);var e=Math.round(o[0]/2-s.getWidth()/2),t=Math.round(o[1]/2-50);i&&(t-=20),N(f,{left:e+"px",top:t+"px"})}function S(){if(t.getRenderingMode()=="flash")return;t.onPlaylistItem(w),t.addButton("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMxJREFUeNpiYCAR/P//nx+I1/9HgP0gMQYyDKr/jwn2k2PQfSwG/WchwQB/IBUAxAp4FQHxfCDuB2J9JHF9qNj7//jBe5DieCwSIM3nsYiDAjkfi8HxjGDTGBgE8PjqAhAvAGFGRsaPUJfKA6kEqPwGoPhFBjzORfEmIcCERw4UqB9Iic75BAJyPtQrILX20HSUj5EIoSkVZth7qJfssaSX9egxBbOAGNfG40qAMNdSI1ugZA0mIs3awEAtgMOL8eQYpI9mWD+yPECAAQD6jshl3zhTjgAAAABJRU5ErkJggg==","Share Video",function(){T()},"share"),r.style.visibility="hidden",r.onclick=y,x()}function x(){N(r,{backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNp8kUEOABEMRXUysXQnJ5k5GidxAmcxsbQxmiAlLUlD/df6UDnn1KK2eJQwUOtMAlwQ7TXG+B1ukxv5hRDRHT1ph5EFSRgN9tPh0E2drO6Xo7E8xk2TGKPSWi9NSilLPi2FEI6WrLV+FjAwe2ksAg4e3TgNCyoHS1bx4z4JxtH3hsXvF2AAnU9uUtSy19QAAAAASUVORK5CYII=),url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADICAYAAAAp8ov1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEdJREFUeNpilpSUvMHEwMDwn+k/EEBY+LkwFgMuCWINwDCPVB30cBoDaTpgBMMoQU2CkYkRCCAsNC6pEgyUGoBHYvA6DSDAAOnHjLU15EHNAAAAAElFTkSuQmCC)",backgroundPosition:"right top,center center",backgroundRepeat:"no-repeat,no-repeat",backgroundSize:"auto auto,100% 100%",opacity:0,webkitTransition:"opacity 150ms linear",mozTransition:"opacity 150ms linear",msTransition:"opacity 150ms linear",oTransition:"opacity 150ms linear",transition:"opacity 150ms linear",cursor:"pointer"}),f=document.createElement("div"),r.appendChild(f),N(f,{cursor:"default",position:"absolute",border:"none",width:"320px"}),l=document.createElement("div"),typeof n.heading=="string"?l.innerHTML=n.heading:l.innerHTML="Share Video",N(l,{position:"absolute",border:"none",color:"#FFF",display:"block",font:"15px Arial",overflow:"hidden",width:"230px",height:"20px",left:"80px",margin:"0 0 0 0",textTransform:"none",textShadow:"#000 1px 1px 0",padding:"0 0 0 0"}),f.appendChild(l),s=new e.sharing.row("Embed code"),f.appendChild(s.getDiv()),p=new e.sharing.row("Video link"),f.appendChild(p.getDiv()),u=e.sharing.shortcut("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAARlJREFUeNpiTKzdzEAbwPL/PwPtjP4/FF3NQDOj/5Hl7O9fv3//9v3d63fIgipaKqiu/key0UATFSW5jSzVUyIskcWjKzZS5GqgY4Nc1VMjrDCl0Iwi2WhVWX6s5mIxmtTEpyYrgEvqP7qrSQzrZKTw/fP336odV24+/HD17musKYS0OGRiZERoZma68fDDlTuvqZn44ODS7VeUZvQndx5gFX98+z6cLaOiQE5Yn91SSlDcN28VNQOEmumaBKMpKVSBZsETzJJtVzDTNVGmuGUuhzB2TY9ETohwceonPjzaaWk0GYUqSrnxb0Bc/ePrV0qMxqOdRUVVmhKj8Whn+fXjFyVG49HORLMKfYgazUKqhtCytUSqBAgwAPLTpnqcD79pAAAAAElFTkSuQmCC","Facebook",g),f.appendChild(u),d=e.sharing.shortcut("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAcpJREFUeNpiXPX1OwNtABMDzQDL/380M/ofAw2N/j8UwxqHoy9cuN3Ttpzh2w8GLo6M3AAbWz2Sjf6LI0D6J25hEJJhEGZi+P9v9oJ9lra6pIc1Dlf/5RFjYGSEslnZb995rqwsSaqrcQAODmSeID/XX9LTNY7kx8aGzBMR4f/17x91XM3Izo7MjU+fgUURF2tOqpuOhjRpYc3AiuJqRkVNLGr+/5+x9MSkpmASswyqq3GBv2xSuEzAndFRwxoX4GHHaQLLX1x5hpWdGHPbfRR//yfV1eworj6WiSU3/vn/78b37z///MNhNC6z2VBcfeTDZzJKvn/EpJDTt18bqwqTmK5xJT52lNy49szj/4yMXOysQLacGCcnGwsFGZ2NFZn3T1xh9ZknDH//gDi/fjL8Belj52bxsZAzUODHVahid7akAOfL76hScmpoan79/rnx8kt9eT7SUkiEEsvE24wE6hE2tv9c3P8YfpCWrlWEfrvJ8Ox6RcB0MXaGv/+/kxbWT379jpb/oSvIufgZw6ufOM2tVv7z7DfpjYWrX77LcP6Zo8PBwYjd7T/+/7/45SsuE4CuxlcKP/n5E4gGX43+j1bNEFq6GiDAAP9eqmJ8yUAWAAAAAElFTkSuQmCC","Twitter",C),f.appendChild(d),m=e.sharing.shortcut("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA9pJREFUeNqslllLa0EMxzvTqnVfaF9cUBRFBDf02e/pt3F/EtxAEEEUxA0fxF1Pa/2d82/jOL334cINeJqZJP9JMknG3Orq6t3dXbVa/fpPBBSAwLrb29uBgYFKRrmA8vm8GFT5eu8xy/0mdCQNTWq1Wltb2/39vQPx4+PDOYdSpGrGti9j439ELpf3PzqgtbS0eJxvbW2VR1I10PAk7UtNxhLJxNWcmcAUCgVgfblcXltbIwTD4kv4BhSmhWDFi7EgfN4jU6LBBbBUKnkWy8vLLAjBHJFTOqCx8ysbtm+eUgboF4vF9fV1ADnGg4LLQkdgqmEesMHL6MaijCkPgAAFA6x7fX1lN0mS9/f3w8PDlZWVz8/P3F8oKhvMLTJEGxsb8/PzOEoC5FAqY4HLU1NTiGFCg/B+olsl49rBHMPp6emOjg4lFpGn+Ezc19c3OTlJUNRMmJYwCc1BYIgJhp2dnVY5KbQcrGZEjvr7+ycmJnSrVjCqFrtkta54QhQuhvBA60ivHnMZwaghu7q6RkdHMdBtcA0Cko51M1/SitrY2Bh5AM6kSUY+aZBrENlob2/HgDIyAx2gr6mhgFoxI4lE8p2qSolF9vslvqenB4/wfWtri2OkQ0zKIF/ShQgF1EgxIu0bk0IrzFrWS0lSMe+6u7tJyMjIyObmJkBhNoSLiJhQUxAWuqXBRx5BOpkvSYcBYnt7m/ClCcOSTQ4GN6u/2FaO168xHLg6WSnq7e0ltKGhoZ2dHQInOTDDw8OIwFUVhKM+dN9dX19nnQN6LRrB8PQnjfD4+AjW1dUVm4ODg1jRAcfHx3Nzc2FziqxF06cgGjfGHB0dMRCY5syAl5cXNQKW+Kvu3d3dnZmZCdvHJnha2mElKjNiwF1aWnp+fmYHPSpX1Q1TKOQ54+3tbXFxEd/DlMJUKvVCcApT53xlgxH+5ORkYWEB4+bnJsoA2d/f38f38BmqD3HOt6JhzRdcBhhJkC/6UgZqd8UnHhGJinxX+frGhKtZ0ZyenuIvBio1lVHWAuncsY7QbJMCY5n7xFAVrFJOX4/Ly0s45fHs7Ax/wbU3UEnQ7UUvskj1p8s4ODgYHx+3BKZeCxpcDufetPxXwhBzQLRMT1Vo5+fns7OziKM8WKMaNaZNXU1PaJaBCuaAAFWfIfxdXFxwxQ8PD1aCclzXJSwrTU2bsNp0b/Qkxzw9PQEFYPofBD/UP/3W/KyEbflHHn/tDsJ9xgMPrKcb9b6EvaNCtNFMsFFtaWnRhC8GUAQNbGFvb895Vy6VaVzVo3mtZfO/egKVyL6mj083NzfAfgswACBs40J0KAZ5AAAAAElFTkSuQmCC","Email",k),f.appendChild(m)}function T(){t.getState()=="PLAYING"&&t.pause(),r.style.visibility="visible",r.style.opacity=1,t.setControls(!1)}function N(e,t){for(var n in t)e.style[n]=t[n]}function C(e){var t=v+encodeURIComponent(h);return window.open(t,"_blank"),window.focus(),!1}function k(e){var t="mailto:?body="+encodeURIComponent(h);return window.open(t,"_blank"),window.focus(),!1}var i,s,o,u,a="http://www.facebook.com/sharer/sharer.php?u=",f,l,h,p,d,v="http://twitter.com/intent/tweet?url=",m;this.resize=function(e,n){if(t.getRenderingMode()=="flash"||!f)return;o=[e,n],E()},t.onReady(S)};e().registerPlugin("sharing","6.0",t),e.sharing={}}(e),function(e){e.sharing.row=function(e){function c(){t=document.createElement("div"),v(t,n),s=document.createElement("label"),s.innerHTML=e,t.appendChild(s),v(s,o),r=document.createElement("input"),r.setAttribute("type","text");try{document.createEvent("TouchEvent")}catch(f){r.setAttribute("readonly","readonly")}v(r,i),t.appendChild(r),u=document.createElement("button"),u.innerHTML="Select",u.onclick=d,u.onmouseover=h,u.onmouseout=p,v(u,a),t.appendChild(u)}function h(){v(r,f),v(u,f)}function p(){v(r,l),v(u,l)}function d(){r.select()}function v(e,t){for(var n in t)e.style[n]=t[n]}var t,n={border:"none",position:"absolute",left:"0px",width:"312px",height:"30px",margin:"0 0 0 0",padding:"0 0 0 0"},r,i={position:"absolute",left:"80px",top:"0px",font:"11px Arial",webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",oBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000",padding:"0px 5px",background:"#FFF",width:"190px",height:"28px",margin:"0 0 0 0",border:"none"},s,o={border:"none",color:"#FFF",display:"block",font:"12px Arial",overflow:"hidden",width:"74px",position:"absolute",top:"10px",left:"0px",textAlign:"right",textTransform:"none",padding:"0 0 0 0"},u,a={position:"absolute",left:"275px",background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAcCAIAAAAvP0KbAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAB5JREFUeNpisre3Z/r37x8c////H4VPjjgeMYAAAwBV/1FjCd0OtgAAAABJRU5ErkJggg==)",backgroundSize:"100% 100%",color:"#FFF",font:"11px Arial",width:"50px",height:"28px",margin:"0 0 0 0",textAlign:"center",webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",oBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000",padding:"0px 5px",border:"none",cursor:"pointer"},f={webkitBoxShadow:"0 0 4px #FFFFFF",MozBoxShadow:"0 0 4px #FFFFFF",msBoxShadow:"0 0 4px #FFFFFF",oBoxShadow:"0 0 4px #FFFFFF",boxShadow:"0 0 4px #FFFFFF"},l={webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",oBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000"};this.getDiv=function(){return t},this.setText=function(e){r.setAttribute("value",e)},this.getWidth=function(){return parseInt(u.style.left)+50},this.resize=function(e){var t=e-230;t<100?t=100:t>400&&(t=400);var n=89+t;v(r,{width:t+"px"}),v(u,{left:n+"px"})},c()}}(e),function(e){e.sharing.shortcut=function(e,t,n){function u(e){l(s,{webkitBoxShadow:"0 0 4px #FFF",MozBoxShadow:"0 0 4px #FFF",msBoxShadow:"0 0 4px #FFF",oBoxShadow:"0 0 4px #FFF",boxShadow:"0 0 4px #FFF"})}function a(e){l(s,{webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",oBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000"})}function f(){return r=document.createElement("div"),r.onclick=n,r.onmouseout=a,r.onmouseover=u,l(r,i),s=document.createElement("img"),s.setAttribute("src",e),l(s,o),r.appendChild(s),r}function l(e,t){for(var n in t)e.style[n]=t[n]}var r,i={cursor:"pointer",position:"absolute",border:"none",color:"#FFF",display:"block",font:"11px/18px Arial,sans-serif",margin:"0 0 0 0",textAlign:"left",textDecoration:"none",textTransform:"none",padding:"0 0 0 10px",width:"30px",height:"30px"},s,o={webkitBoxShadow:"0 0 4px #000",MozBoxShadow:"0 0 4px #000",msBoxShadow:"0 0 4px #000",oBoxShadow:"0 0 4px #000",boxShadow:"0 0 4px #000",position:"absolute",left:"0px",top:"0px",width:"30px",height:"30px",margin:"0 0 0 0",padding:"0 0 0 0"};return f()}}(e)}(jwplayer),define("jwplayer",["jquery"],function(){}),function(e){jQuery.fn.extend({slimScrollHorizontal:function(t){var n={wheelStep:20,height:"auto",width:"250px",size:"7px",color:"#000",position:"bottom",distance:"1px",start:"left",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200,barZ:99,wrapperPos:"relative",wrapperBottom:"0px"},r=e.extend(n,t);return this.each(function(){function w(e,t,n){var i=e;g.css("left")=="auto"&&g.css("left","0px");if(t){i=parseInt(g.css("left"))+e*parseInt(r.wheelStep)/100*g.outerWidth();var s=d.outerWidth()-g.outerWidth();i=Math.min(Math.max(i,0),s),g.css({left:i+"px"})}f=parseInt(g.css("left"))/(d.outerWidth()-g.outerWidth()),i=f*(d[0].scrollWidth-d.outerWidth());if(n){i=e;var u=i/d[0].scrollWidth*d.outerWidth();g.css({left:u+"px"})}d.scrollLeft(i),x(),T()}function S(){a=Math.max(d.outerWidth()/d[0].scrollWidth*d.outerWidth(),h),g.css({width:a+"px"})}function x(){S(),clearTimeout(s);if(f==~~f){p=r.allowPageScroll;if(l!=f){var e=~~f==0?"left":"right";d.trigger("slimscroll",e)}}l=f;if(a>=d.outerWidth()){p=!0;return}g.stop(!0,!0).fadeIn("fast"),r.railVisible&&m.stop(!0,!0).fadeIn("fast")}function T(){r.alwaysVisible||(s=setTimeout(function(){(!r.disableFadeOut||!t)&&!n&&!i&&(g.fadeOut("slow"),m.fadeOut("slow"))},1e3))}var t,n,i,s,u,a,f,l,c="<div></div>",h=30,p=!1,d=e(this);if(d.parent().hasClass("slimScrollDiv")){scroll&&(g=d.parent().find(".slimScrollBar"),m=d.parent().find(".slimScrollRail"),w(d.scrollLeft()+parseInt(scroll),!1,!0));return}var v=e(c).addClass(r.wrapperClass).css({position:r.wrapperPos,bottom:r.wrapperBottom,overflow:"hidden",width:r.width,height:r.height});d.css({overflow:"hidden",width:r.width,height:r.height});var m=e(c).addClass(r.railClass).css({width:"100%",height:r.size,position:"absolute",bottom:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.size,background:r.railColor,opacity:r.railOpacity,zIndex:90}),g=e(c).addClass(r.barClass).css({background:r.color,height:r.size,position:"absolute",bottom:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.size,BorderRadius:r.size,MozBorderRadius:r.size,WebkitBorderRadius:r.size,zIndex:r.barZ}),y=r.position=="top"?{top:r.distance}:{bottom:r.distance};m.css(y),g.css(y),d.wrap(v),d.parent().append(g),d.parent().append(m),g.draggable({axis:"x",containment:"parent",start:function(){i=!0},stop:function(){i=!1,T()},drag:function(t){w(0,e(this).position().left,!1)}}),m.hover(function(){x()},function(){T()}),g.hover(function(){n=!0},function(){n=!1}),d.hover(function(){t=!0,x(),T()},function(){t=!1,T()}),d.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(u=e.originalEvent.touches[0].pageX)}),d.bind("touchmove",function(e){e.originalEvent.preventDefault();if(e.originalEvent.touches.length){var t=(u-e.originalEvent.touches[0].pageX)/r.touchScrollStep;w(t,!0)}});var b=function(e){if(!t)return;var e=e||window.event,n=0;e.wheelDelta&&(n=-e.wheelDelta/120),e.detail&&(n=e.detail/3),w(n,!0),e.preventDefault&&!p&&e.preventDefault(),p||(e.returnValue=!1)},E=function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",b,!1),this.addEventListener("mousewheel",b,!1)):document.attachEvent("onmousewheel",b)};E(),S(),r.start=="right"?(g.css({left:d.outerWidth()-g.outerWidth()}),w(0,!0)):typeof r.start=="object"&&(w(e(r.start).position().left,null,!0),r.alwaysVisible||g.hide())}),this}}),jQuery.fn.extend({slimscrollHorizontal:jQuery.fn.slimScrollHorizontal})}(jQuery),define("jquery.slimscroll.hor",function(){}),define("media/models/tag",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/ent/addtag/"}}),n}),define("usercontrols/photo-player/models/tag-myself",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/ent/addtag/"+this.user_id}}),n}),define("component/share",["require","facade","views","utils","vendor"],function(e){var t={gplus:"https://plus.google.com/share",twitter:"http://twitter.com/home",tumbler:"http://www.tumblr.com/share/photo/"},n={gplus:"Gplud_share",twitter:"Twitter_share",tumbler:"Tumblr_share"};return function(e){var r=this,i=function(){e&&s()},s=function(){var t=o();t&&window.open(t,n[e.type],"menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},o=function(){var n=t&&e.type&&t[e.type]?t[e.type]:undefined;switch(e.type){case"twitter":n=n+"?status="+u();break;case"gplus":n=n+"?url="+u();break;case"tumbler":n=n+"?caption="+e.caption+"&source="+encodeURIComponent(e.image)}return n},u=function(){return encodeURIComponent(window.location.protocol+"//"+window.location.host+"/"+e.link+"/")};i()}}),define("usercontrols/photo-player/views/main",["require","text!usercontrols/photo-player/templates/player.html","text!usercontrols/photo-player/templates/image-thumbs.html","text!usercontrols/tag/templates/layout.html","facade","views","utils","vendor","votes/models/vote","jwplayer","jqueryui","jquery.slimscroll.hor","usercontrols/tag/models/basic_info","usercontrols/tag/views/main","media/models/tag","usercontrols/photo-player/models/tag-myself","component/fb","component/share"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=o.SectionView,a=e("utils"),f=a.lib.Channel,l=e("vendor"),c=e("usercontrols/tag/views/main"),h=e("usercontrols/tag/models/basic_info"),p=l.Mustache,d=s.$,v=e("votes/models/vote"),m=e("media/models/tag"),g=e("usercontrols/photo-player/models/tag-myself");FbComponent=e("component/fb"),ShareComponent=e("component/share"),jwplayer.key="yXOw2TpDcCoCnbWyVSCoEYA4tepkpjiVEtLEfSBIfZQ=";var y=u.extend({template:t,thumbTemplate:n,events:{"click .back-arrow-h":"backButton","click .next-arrow-h":"nextButton","click .thumb-link-h":"changeImage","click .photo-player-vote-h":"vote","click .share-on-h":"shareOn","click .photo-player-tag-photo-h":"setUpTagPhotoView","click .photo-player-tag-myself-h":"TagMyself","click .toggle-thumbs-h":"toggleThumbsSection"},initialize:function(e){var t=this;this.collection=e.collection,this.setOptions(e),this.id=e.id,this.pageId=e.pageId,this.pageName=e.pageName,this.user_id=e.user_id,this.index=e.index,this.mediaId=e.mediaId,this.json=this.model.toJSON();var n=this.json.payload;for(var r in n)if(n[r].media_id==this.mediaId){this.index=r;break}this.index||(this.index=0),u.prototype.initialize.call(this,e),this.setUpMainView(),this.render(),this.initThumbsSection(),this.loadImage(!0),this.updateAllImagesCount(),f("tag-image-success-photo").empty(),f("tag-image-success-photo").subscribe(this.tagFunction)},toggleThumbsSection:function(e){this.$el.find(".thumbs-outer").css("display")=="none"?(d(".loading_image, .photo-player-right-area, .bottom-line-container").addClass("minimizeOpacity"),this.$el.find(".thumbs-outer").slideDown()):(this.$el.find(".thumbs-outer").slideUp(),d(".loading_image, .photo-player-right-area, .bottom-line-container").removeClass("minimizeOpacity"))},updateAllImagesCount:function(){this.$el.find(".total-image-count-h").text(this.json.payload.length)},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},vote:function(e){var t=this,n=function(){var n=new v;if(d(e.currentTarget).hasClass("voted"))return;n.userId=t.json.payload[t.index].id,n.entity_id=t.json.payload[t.index].enttypes_id,n.set({subject_type_id:n.entity_id,subject_id:n.userId}),n.save(),d.when(n.request).done(function(){t.$el.find(".photo-player-vote-h").addClass("voted");var e=t.$el.find(".votes-num-h"),n=e.text();n==""?e.html("(1)").show():e.html("("+(n+1)+")").show(),e.parents("li").addClass("link-disabled")})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n()})},shareOn:function(e){var t=d(e.currentTarget).data("share");t&&_.isFunction(this[t])&&this[t]()},getLink:function(e){var t;return this.pageName=="profile"?t="#!"+this.pageName+e.userId+e.sportId+e.mediaId:t="#!"+this.pageName+e.pageId+e.mediaId,console.log(t),t},twitter:function(){var e=this,t=this.getShareData(),n=function(){var n={link:e.getLink(t),name:t.User.name+" - "+t.Sport.sport_name,caption:"Athletez.com",image:t.record.image_path,description:"",title:"",type:"twitter"};new ShareComponent(n)};e.checkForUser()?n():routing.trigger("showSignup",function(e){n()})},gplus:function(){var e=this,t=this.getShareData(),n=function(){var e={link:"?enttypes_id="+t.record.enttypes_id+"&id="+t.record.id,name:t.User.name+" - "+t.Sport.sport_name,caption:"Athletez.com",image:t.record.image_path,description:"",title:"",type:"gplus"};new ShareComponent(e)};e.checkForUser()?n():routing.trigger("showSignup",function(e){n()})},tumbler:function(){var e=this,t=this.getShareData(),n=function(){var e={link:"?enttypes_id="+t.record.enttypes_id+"&id="+t.record.id,name:t.User.name+" - "+t.Sport.sport_name,caption:"Athletez.com",image:t.record.image_path,description:"",title:"",type:"tumbler"};new ShareComponent(e)};e.checkForUser()?n():routing.trigger("showSignup",function(e){n()})},getShareData:function(){var e=this.json.payload[this.index];return{record:e,userId:this.user_id?"/"+this.user_id:"",pageId:this.pageId?"/"+this.pageId:"",User:this.getUserForMedia(),Sport:this.getSportForMedia(),sportId:e.media_obj.sports_id?"/sport/"+e.media_obj.sports_id:"",mediaId:e.media_id?"/media/"+e.media_id:""}},facebook:function(){var e=this,t=this.getShareData(),n=this.getLink(t),r=t.User.name+" - "+t.Sport.sport_name,i="Athletez.com",s=t.record.image_path,o="",u=function(){var e=new FbComponent;e.shareOnFacebook({method:"feed",name:r,link:n,picture:s,caption:i,description:o,success:function(){alert("Shared successfully.")},error:function(){alert("Not Shared successfully.")}})};e.checkForUser()?u():routing.trigger("showSignup",function(e){u()})},getUserForMedia:function(){return this.json.payload[this.index].media_obj.users_obj},getSportForMedia:function(){return this.json.payload[this.index].media_obj.sports_obj},changeImage:function(e){var t=d(e.currentTarget);this.index=t.attr("data-index"),this.loadImage()},backButton:function(e){this.index>0&&(this.index--,this.loadImage())},nextButton:function(e){console.log("next"),this.index<this.json.payload.length&&(this.index++,this.loadImage())},changeThumbPosition:function(){var e=this.$el.find(".thumb-image-list-h"),t=this.$el.find(".selected-photo-thumb"),n=t.position(),r=e.position(),i=e.width(),s=0,o=this.$el.find(".thumbs-outer"),u=o.width();if(n.left<0)s=n.left+r.left;else if(n.left+t.width()>u)s=n.left-u,s+=r.left<0?-r.left:-r.left,s+=t.width()+20;else{var a=r.left<0?-r.left:r.left;s=+a-t.width()}s&&this.$el.find(".thumbs-outer").animate({scrollLeft:s+"px"},400)},initThumbsSection:function(){var e=this,t=this.json.payload.length,n={},r=null;n.data=[];for(var i=0;i<t;i++){var s=this.json.payload[i],o={_enttypes_id:s.enttypes_id,_id:s.id,_index:i};switch(s.enttypes_id){case"23":typeof s.standard_thumb=="object"?(r=s.standard_thumb,o._thumbnail=r.url):o._thumbnail=s.thumbs,o._label=s.media.name,o._link="javascript: void(0);",s.media.hasOwnProperty("is_owner")&&(show_edit=s.media.is_owner);break;case"21":o._label=s.media_obj.name,o._link="javascript: void(0);",typeof s.types=="object"&&(typeof s.types.standard_thumb=="object"?(r=s.types.standard_thumb,o._thumbnail=r.url):typeof s.types.small_thumb=="object"?(r=s.types.large_thumb,o._thumbnail=r.url):typeof s.types.large_thumb=="object"?(r=s.types.large_thumb,o._thumbnail=r.url):typeof s.types.original=="object"&&(r=s.types.original,o._thumbnail=r.url)),s.media_obj.hasOwnProperty("is_owner")&&(show_edit=s.media_obj.is_owner);break;case"1":typeof s.user_picture_obj=="object"&&typeof s.user_picture_obj.types=="object"&&(typeof s.user_picture_obj.types.standard_thumb=="object"?(r=s.user_picture_obj.types.standard_thumb,o._thumbnail=r.url):typeof s.user_picture_obj.types.large_thumb=="object"?(r=s.user_picture_obj.types.large_thumb,o._thumbnail=r.url):typeof s.user_picture_obj.types.original=="object"&&(r=s.user_picture_obj.types.original,o._thumbnail=r.url)),o._label=s.label,o._sublabel="Coming Soon",o._link="/#!profile/"+s.id,s.hasOwnProperty("is_owner")&&(show_edit=s.is_owner);break;case"8":o._detailclass="game",o._thumbnail=s.game_picture!==null?s.game_picture.types.small_thumb.url:"http://lorempixel.com/output/sports-q-c-440-440-4.jpg",r=s.game_picture!==null?s.game_picture.types.small_thumb:{height:440,width:440,url:"http://cdn.athletez.com/resources/icons/game/square_game.png"},o._label=s.game_day,o._link="/#!game/"+s.id;var u="",a=s.teams.length,f=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};for(var i=0;i<a;i++)u+="<span>",u+=f(s.teams[i].team_name),u+="</span>",i+1<s.teams.length&&(u+=" VS. ");s.hasOwnProperty("is_owner")&&(show_edit=s.is_owner),o._sublabel=u}if(r!="undefined"&&r!=null){var l=r.width/110,c=r.height/110;r.width=parseInt(r.width),r.height=parseInt(r.height);var h=r.width>r.height?-(r.width/c-110)/2:-(r.height/l-110)/2;h>0&&(h=0),o.styles={},r.width>r.height?o.styles=[{property:"min-width",value:r.width/c+"px"},{property:"left",value:h+"px"}]:o.styles=[{property:"min-height",value:r.height/l+"px"},{property:"top",value:h+"px"}]}n.data.push(o)}this.id=o?o._id:undefined;var d=p.to_html(this.thumbTemplate,n);this.$el.find(".thumb-image-list-h").html(d)},thumbScroll:function(){},loadImage:function(e){var t=d("div#video_container"),n=d("div.loading_image");t.hasClass("hidden")||t.addClass("hidden"),n.hasClass("hidden")&&n.removeClass("hidden");var r=this,i=this.json.payload[r.index],s={_enttypes_id:i.enttypes_id,_id:i.id,_media_id:i.media_id,_currentIndex:r.index};i.has_voted?this.$el.find(".photo-player-vote-h").parent().addClass("link-disabled"):this.$el.find(".photo-player-vote-h").parent().removeClass("link-disabled"),i.num_votes?this.$el.find(".votes-num-h").html("("+i.num_votes+")").show():this.$el.find(".votes-num-h").hide(),console.error(i),r.$el.find(".current-image-number-count-h").text(parseInt(r.index)+1),r.index>=this.json.payload.length-1?this.$el.find(".next-arrow-h").addClass("disable-arrow-link"):this.$el.find(".next-arrow-h").removeClass("disable-arrow-link"),r.index==0?this.$el.find(".back-arrow-h").addClass("disable-arrow-link"):this.$el.find(".back-arrow-h").removeClass("disable-arrow-link");var o;switch(i.enttypes_id){case"23":this.setupVideo(i),s._thumbnail=i.thumbs,s._label=i.media.name,s._link="javascript: void(0);";break;case"21":typeof i.types=="object"&&i.types.large_format&&(o=i.types.large_format),s._label=i.media_obj.name,s._link="javascript: void(0);";break;case"1":typeof i.user_picture_obj=="object"&&(s._thumbnail=i.user_picture_obj.types.large_thumb.url),s._label=i.label,s._sublabel="Coming Soon",s._link="/#!profile/"+i.id,i.hasOwnProperty("is_owner")&&(show_edit=i.is_owner);break;case"8":s._detailclass="game",s._thumbnail=i.game_picture!==null?i.game_picture.types.large_thumb.url:"http://lorempixel.com/output/sports-q-c-440-440-4.jpg",s._label=i.game_day,s._link="/#!game/"+i.id;var u="",a=i.teams.length,f=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};for(var l=0;l<a;l++)u+="<span>",u+=f(i.teams[l].team_name),u+="</span>",l+1<i.teams.length&&(u+=" VS. ");i.hasOwnProperty("is_owner")&&(show_edit=i.is_owner),s._sublabel=u}s&&s._label&&r.$el.find(".image-message-h").text(s._label);if(o!="undefined"&&o!=null){var c=this,h=this.$el.find("div.loading_image");h.css("opacity","0");function p(e){var t=e.data.self,n=e.data.image_object,r=parseInt(t.$el.height())*.8,i=parseInt(n.height)>=380?parseInt(n.height):380;if(n.width>n.height||n.width==n.height){var s=r<i?60:(r-i)/2;e.data.el.css({"max-width":"100%",top:s+"px"})}else if(r>i){var s=(r-i)/2;e.data.el.css({"max-height":r+"px",top:s+"px"})}else e.data.el.css({"max-height":r+"px",top:"0px"});e.data.el.css("opacity","100"),e.data.el.find(".large-image-h").off("load")}h.find(".large-image-h").attr("data-id",s._media_id),h.find(".large-image-h").attr("src",o.url).on("load",{el:h,self:this,image_object:o},p)}this.$el.find(".thumb-image-list-h li").removeClass("selected-photo-thumb"),this.$el.find(".thumb-link-h[data-index="+this.index+"]").parents("li").addClass("selected-photo-thumb");var v=i.media_obj&&i.media_obj.users_id?i.media_obj.users_id:undefined;routing.trigger("photo-player-section-reload",s._enttypes_id,s._media_id,v);if(this.loadFirstTime){var m=window.location.hash;m.match(/\/media\/(.*)[0-9]\//i)?m=m.replace(/\/media\/(.*)[0-9]\//i,"/media/"+s._media_id+"/"):m.match(/\/media\/(.*)[0-9]/i)?m=m.replace(/\/media\/(.*)[0-9]/i,"/media/"+s._media_id):m=m+"/media/"+s._media_id,routing.navigate(m,{trigger:!1})}else this.loadFirstTime=!0},setupVideo:function(e){function n(){var n=jwplayer(t.playerId),r=t.$el,i={},s=[];for(var o=0;o<e.video_type.length;o++){console.log(e.video_type[o]);var u;u={file:e.video_type[o].meta_details.url},s.push(u)}i.playlist=[{image:e.thumbs,mediaid:e.media.name,sources:s}],i.title=e.media.name,i.primary="html5",i.duration=e.video_type[0].meta_details.duration_in_ms*1e3,i.modes=[{type:"html5",src:"http://s3.amazonaws.com/mikewbucket/jw/jwplayer.html5.js"},{type:"flash",src:"http://s3.amazonaws.com/mikewbucket/jw/jwplayer.flash.swf"}],i.skin="http://s3.amazonaws.com/mikewbucket/jw/skins/glow.xml",i.height=r.height()*.8,i.width=r.width(),n.setup(i)}var t=this,r=setInterval(function(){var e=d("#jw_container");e.length||(d("div.image-bg div.loading_image").addClass("hidden"),d("div#video_container").removeClass("hidden")),t.playerId&&d("#"+t.playerId).remove(),t.playerId="jw-container-"+Math.floor(Math.random()*90+10);var i=d("<div></div>").attr("id",t.playerId);d("div#video_container").append(i).removeClass("hidden"),d("#"+t.playerId).css("z-index","9999"),console.log("Set CSS",d("#"+t.playerId).css("z-index","9999")),clearInterval(r),n()},500)},showImage:function(e){e.find("div.loading_image").css("opacity","100")},setOptions:function(e){this.userId=e.user_id||null,this.sportsId=e.sports_id||null,this.scheme=e.scheme,this.layout=e.layout},setUpMainView:function(){var e=this,t=p.to_html(e.template,{});d(e.$el).html(t)},setUpTagPhotoView:function(){var e=this,t=this.json.payload[this.index],n=null,i=null,s=null;t&&t.media_obj&&(i=t.media_obj.sports_id||null,s=t.media_obj.users_id||null,n=t.media_obj.is_owner||null);var o=function(){e.tagViewPhoto=new c({model:new h,template:r,name:"tag-image "+(new Date).toString(),destination:"#image-tagging-photo",user_id:s,sports_id:i,is_owner:n,channel:"tag-image-success-photo"}),e.scheme.push(this.tagViewPhoto),e.layout.render()};e.checkForUser()?o():routing.trigger("showSignup",function(e){o()})},tagFunction:function(e){var t=this,n=e||{},r={media_id:this.json.payload[this.index].media_id,tag_array:JSON.stringify(n)},i=new m(r);i.save(),d.when(i.request).done(function(){t.setUpTagViewSection()})},setUpTagViewSection:function(){var e=this,t=this.json.payload[e.index],n={_enttypes_id:t.enttypes_id,_id:t.id,_media_id:t.media_id,_currentIndex:e.index,_uploader:t.media_obj.user_obj};routing.trigger("tags-fetch-new-form-data",n._enttypes_id,n._media_id,t)},TagMyself:function(e){var t=this,n={1:[this.getUserId()]},r={media_id:this.json.payload[this.index].media_id,tag_array:JSON.stringify(n)},i=function(){var n=new g(r);n.user_id=t.getUserId(),n.save(),d.when(n.request).done(function(){t.setUpTagViewSection(),d(e.target).parents("li").addClass("link-disabled")})};t.checkForUser()?i():routing.trigger("showSignup",function(e){i()})},getUserId:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?routing.loggedInUserId:null}});return y}),define("text!usercontrols/photo-player/templates/comment-form.html",[],function(){return'<a href="javascript: void(0);" class="add-comment-h">Comment</a>\r\n{{#payload}}\r\n<form class="add-comment-form-h" method="post" action="#">\r\n<div class="row-fluid">\r\n    <div class="field-message submit-result"></div>\r\n    <textarea id="new-comment" class="photoplayer-comment-box" class="" placeholder="Add a comment" ></textarea>\r\n    <!-- <br/> -->\r\n    <!-- <input type="button" id="comment-submit" value="Submit"/> -->\r\n</div>\r\n</form>\r\n{{/payload}}\r\n'}),define("usercontrols/photo-player/models/commentonform",["facade","site/models/comment","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/commentonform/"+this.id:"/api/user/basics/"+this.id},initialize:function(e,n){t.prototype.initialize.call(e,n)},afterFetch:function(e,n){t.prototype.fetchSuccess.call(this,e,n),routing.trigger("profilecommentonform:fetch",e)}}),r}),define("usercontrols/photo-player/views/comment-form",["require","text!usercontrols/photo-player/templates/comment-form.html","usercontrols/photo-player/models/commentonform","site/views/comment-form","models/base","views","chrome/views/header"],function(e,t,n,r,i){var s,o=e("views"),u=e("chrome/views/header"),a=o.BaseView;return s=a.extend({initialize:function(e){console.error(e),_.bindAll(this),this.setOptions(),a.prototype.initialize.call(this,e)},el:".comment-input-outer-h",template:t,events:{"click #comment-submit":"submitHandler","click .add-comment-h":"showCommentBox","keypress .photoplayer-comment-box":"addComment"},setOptions:function(e){if(!this.collection)throw new Error("comment form view expected options.collection.");this.model||(console.log("this.collection.id =",this.collection.id),this.model=new n({id:this.collection.id}),console.log(this.model.toJSON()),this.model.fetch())},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},getCaret:function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(t==null)return 0;var n=e.createTextRange(),r=n.duplicate();return n.moveToBookmark(t.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}return 0},addComment:function(e){console.error(e);if(e.keyCode==13&&e.shiftKey){var t=$(e.currentTarget).val(),n=this.getCaret(e);t=t.substring(0,n)+"\n"+t.substring(n,t.length),e.stopPropagation()}else e.which===13&&!e.shiftKey&&(e.preventDefault(),this.submitHandler(e))},submitHandler:function(e){e.preventDefault();if(!this.checkForUser()){routing.trigger("showSignup");return}this.createOnEnter(e)},showCommentBox:function(){var e=this.$el.find(".add-comment-form-h");e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")},refreshComments:function(e){this.$("#new-comment").val("")},createOnEnter:function(e){var t=this.$el.find("#new-comment").val(),n=this;n.$(".submit-result").stop().fadeOut();if(t!=""){date=new Date;var r=new Array;r.comment=t,r.comment_date=date.toDateString(),r.subject_type_id=this.collection.subject_entity_type,r.subject_id=$(".large-image-h").attr("data-id");var s=new i(r);s.url=function(){return debug.log(n),_.isUndefined(n.collection.savePath)?testpath?testpath+"/user/comment/add":"/api/media/addcomment/"+r.subject_id+"?comment="+r.comment:"api"+n.collection.savePath},s.saveSuccess=function(e,t){i.prototype.saveSuccess.call(this,e,t);var r=e.get("exec_data"),s=e.get("payload"),o=e.get("desc");r.exec_error?$(".global-alert").addClass("alert-error").html(o).stop().fadeIn():$(".global-alert").addClass("alert-info").html(o).stop().fadeIn(),s.poster=s.name,s.poster_picture=s.user_picture,s.poster_email=s.email,console.log("thisresponse = ",t),n.collection.push(e),console.log("latest collectionsx",n.collection),n.refreshComments(),routing.on("profilecommentonlist:refresh",n.collection)},s.save()}},render:function(){return a.prototype.render.call(this),this.input=this.$("#new-comment"),console.log("run here now",this.el),this}}),s}),define("usercontrols/photo-player/views/comments",["facade","utils","site/views/comment-list","usercontrols/photo-player/views/comment-form","site/collections/comments"],function(e,t,n,r,i){var s,o=e._,u=t.lib.Channel;return s=n.extend({initialize:function(e){o.bindAll(this),console.error(e),this.userId=e.userId?e.userId:undefined,this.options.collection=this.collection,this.name=e.name,this._template=e.template,n.prototype.initialize.call(this,e)},limitResults:function(){var e=this.collection,t=e.last(5),n=new i;o.each(t,function(e,t){n.push(e)}),this.collection.reset(),this.collection=n},setupFormView:function(){function s(e){console.log("Comments callback",e.user_pic_small),n.model=e,n.render()}function o(e){var t=$("#comment-list").height()+$("li.comment").height();$(".comment-outer-h").animate({scrollTop:t}),$("#comment-list li:last-child").addClass("newly-added-comment")}this.collection.id=this.userId;var e=this,t=this,n=new r({collection:this.collection}),i=this.addChildView(n);this.callbacks.add(function(){i()}),routing.off("profilecommentonform:fetch"),routing.on("profilecommentonform:fetch",function(e){s(e)}),routing.off("profilecommentonlist:refresh"),routing.on("profilecommentonlist:refresh",function(e){o(e)})}}),s}),define("usercontrol/photo-player/models/tags",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/user/basics/"+this.id}}),n}),define("usercontrols/photo-player/collections/tags",["facade","collections","utils","usercontrol/photo-player/models/tags"],function(e,t,n,r){var i,s=t.BaseCollection;return i=s.extend({model:r,url:function(){return testpath?testpath+"/media/tags/"+this.id:"/api/media/tags/"+this.id},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var i in n){var s=new r;s.id=Math.ceil(Math.random()*1e5),s.set("payload",n[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)}}),i}),define("text!usercontrol/photo-player/templates/tags.html",[],function(){return'<div class="prof-name-area"></div>\r\n<div class="tags-outer-h">\r\n	<div class="photo-detail photo-detail-h ">\r\n		<span>Tags</span>\r\n		<a href="javascript: void(0);" class="photo-player-detail-icons photo-player-detail-arrow photo-player-detail-arrow-h up-arrow-photoplayer"></a>\r\n	</div>\r\n	<ul id="tags-list"></ul>\r\n</div>\r\n<div class="clear">\r\n</div>'}),define("text!usercontrol/photo-player/templates/tag-item.html",[],function(){return'<div class="row-fluid">\r\n    <div class="tags-name">\r\n		    <div class="tag-image-container" {{#_color}}style="background-color:{{_color}}"{{/_color}}>\r\n			    {{#_thumbnail}}<img src="{{_thumbnail}}" class="tag-thumb" />{{/_thumbnail}}\r\n			    {{^_thumbnail}}<div class="tile-text">{{_noicon_text}}</div>{{/_thumbnail}}\r\n			</div>\r\n\r\n\r\n		<a href="{{_link}}" style="display: inline-block;"><span class="labelSpan">{{{_label}}}</span></a>\r\n\r\n	    {{#show_edit}}\r\n	    <div class="deleteTag" title="Delete Tag" data-enttypes-id="{{_enttypes_id}}" data-subject-id="{{_id}}">&times;</div>\r\n	    {{/show_edit}}\r\n    </div>\r\n</div>\r\n'}),define("usercontrol/photo-player/views/tags-item",["vendor","views","utils","text!usercontrol/photo-player/templates/tag-item.html","common/models/delete","common/models/entparse"],function(e,t,n,r,i){var s,o=t.BaseView,u=e.Mustache,a=require("common/models/entparse");return s=o.extend({tagName:"li",template:r,className:"tag",events:{"click .deleteTag":"deleteTag"},initialize:function(e){},filterData:function(){var e=this,t=this.model.get("payload"),n={_enttypes_id:t.enttypes_id,_id:t.id},r=!1,i=null;n.Sportsteam=null,routing&&routing.loggedInUserId&&routing.loggedInUserId==t.subject_id&&$(".photo-player-tag-myself-h").parents("li").addClass("link-disabled"),console.error(t);var s=new a({mpay:t.subject,thumb_size:44,display_width:44,display_height:44}),n=s.parsedData;console.log(n,"for testing");switch(t.subject_enttypes_id){case"8":var o="",u=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},f=t.subject.teams?t.subject.teams.length:0;for(var l=0;l<f;l++){if(l%2==1)var c="game-match-name1",h="game-score1";else var c="game-match-name",h="game-score";o+='<div class="'+c+'">',console.log(t.subject.teams[l].team_name+",score="+t.subject.teams[l].points_scored+",i="+l),o+=u(t.subject.teams[l].team_name),o+="</div>",o+='<div class="'+h+'">',o+='<span class="scoreAlign">',o+=t.subject.teams[l].points_scored!=null?t.subject.teams[l].points_scored:"&Oslash;",o+="</span>",o+="</div>"}n._label=o!=""?o:t.subject.event_name,console.log(n._label),t.hasOwnProperty("is_owner")&&(r=t.is_owner);if(!this.Sportsteam&&f){this.Sportsteam=!0;var p=t.subject.shared.season,d=p.split(" "),v='<div class="name"><span class="topalign">'+t.subject.shared.sport+'</span></div>	<div class="game"><span class="topalign">'+t.subject.shared.complevel+'</span></div><div class="season"><span class="topalign">'+d[2]+"</span></div>";$(".headerinfo").html(v)}break;case"5":n._label=t.subject.team_name}return n._enttypes_id=t.enttypes_id,n._id=t.id,console.log(n),n},render:function(){var e=this,t=this.filterData(),n=u.to_html(this.template,t);this.$el.html(n),console.log(this.$el);var r=setInterval(function(){e.$el.find(".tag-image-container").width()>0&&(e.$el.find(".tag-image-container").css({height:"33px"}),console.log(e.$el.find(".tag-image-container").width()),clearInterval(r))},200);return t.imgData.maxwidth&&this.$el.find("img.tag-thumb").css({"max-width":t.imgData.maxwidth,left:t.imgData.left}),t.imgData.maxheight&&this.$el.find("img.tag-thumbl").css({"max-height":t.imgData.maxheight,top:t.imgData.top}),this},deleteTag:function(e){var t=new i;t.subject_id=$(e.target).attr("data-subject-id"),t.enttypes_id=$(e.target).attr("data-enttypes-id"),t.removeNode=$(e.target).parents("li.tags-li"),console.log(t),t.destroyAndRemove()}}),s}),define("usercontrols/photo-player/models/tags",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"/api/user/basics/"+this.id}}),n}),define("usercontrols/photo-player/views/tags",["facade","vendor","utils","views","text!usercontrol/photo-player/templates/tags.html","usercontrol/photo-player/views/tags-item","usercontrols/photo-player/models/tags","jquery.slimscroll"],function(e,t,n,r){var i,s=e._,o=r.CollectionView,u=r.SectionView,a=t.Mustache,f=n.lib.Channel,l=require("text!usercontrol/photo-player/templates/tags.html"),c=require("usercontrol/photo-player/views/tags-item"),h=require("usercontrols/photo-player/models/tags");return CommentListAbstract=o.extend(u.prototype),i=CommentListAbstract.extend({__super__:o.prototype,listView:"#tags-list",_tagName:"li",_className:"tags-li",page:1,page_limit:5,prepend:!1,_view:c,template:l,events:{"click .see-more-h":"seeMore","click .photo-player-detail-arrow":"toggleDetail"},toggleDetail:function(e){$(e.currentTarget).hasClass("down-arrow-photoplayer")?($(e.currentTarget).removeClass("down-arrow-photoplayer"),$(e.currentTarget).addClass("up-arrow-photoplayer"),this.$el.find("#tags-list").slideDown()):($(e.currentTarget).removeClass("up-arrow-photoplayer"),$(e.currentTarget).addClass("down-arrow-photoplayer"),this.$el.find("#tags-list").slideUp())},renderTemplate:function(){var e=a.to_html(this.template);return this.$el.html(e),this},initialize:function(e){this.renderTemplate(),console.log(e);var t=this;this.name=e.name,this.collection=e.collection,this.uploader_id=e.uploader,console.log(this.collection.toJSON()),t.allData=this.collection.toArray(),t.cleardata(),t.getprofile(),$(".photo-player-right-area").slimScroll({height:"100%"}),t.seeMore(),console.log(this.collection.toJSON()),o.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CommentListView expected options.collection.");s.bindAll(this),this.addSubscribers()},seeMore:function(e){var t=this.allData.length,n=t<this.page_limit?t:this.page_limit,r=t-this.page*n,i=r+this.page_limit;r<=0&&this.$el.find(".see-more-h").hide(),this.prepend=!0,e?this.collection.add(this.allData.slice(r,i)):this.collection.reset(this.allData.slice(r,i)),this.page++,this.prepend=!1,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},getprofile:function(){var e="/api/user/basics/"+this.uploader_id;this.model.set("url",e);var t=new h({id:this.uploader_id});t.fetch({success:function(e){var t='<div class="user-photo-profile"><img src='+e.attributes.payload.user_picture_obj.image_path+' alt=""></div><div class="content-prof-sub"><span class="user-comment">Uploaded By&nbsp;</span><span class="user-comment">'+e.attributes.payload.label+"</span></div>";$(".prof-name-area").html(t)}})},cleardata:function(){$(".headerinfo").empty(),$(".teamName-area").empty(),$(".prof-name-area").empty()},childViews:{}}),i}),define("usercontrols/photo-player/photo-player",["require","text!usercontrols/photo-player/templates/comments.html","text!usercontrols/tag/templates/layout.html","facade","controller","models","views","usercontrols/photo-player/collections/comments","usercontrols/photo-player/views/main","usercontrols/photo-player/views/comments","usercontrols/photo-player/collections/tags","usercontrols/photo-player/views/tags","usercontrols/photo-player/models/tags","usercontrols/tag/views/main","usercontrols/tag/models/basic_info"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=i.$,l=i._,c=a.debug,h=a.lib.Channel,p=u.LayoutView,d=i.Backbone,v=e("usercontrols/photo-player/collections/comments"),m=e("usercontrols/photo-player/collections/tags"),g=e("usercontrols/photo-player/views/main"),y=e("usercontrols/photo-player/views/comments"),b=e("usercontrols/photo-player/views/tags"),w=e("usercontrols/photo-player/models/tags"),E=e("usercontrols/tag/views/main"),S=e("usercontrols/tag/models/basic_info"),r=s.extend({cssArr:["/usercontrols/photo-player/photoPlayer.css"],events:{},initialize:function(e){var t=this;t.startPlayer(e)},startPlayer:function(e){var t=this;h("load:css").publish(this.cssArr),l.bindAll(this),e.id&&(this.id=e.id),this.index=e.index,e.userId&&(this.userId=e.userId),this.pageId=e.pageId,e.pageName&&(this.pageName=e.pageName),e.array&&(this.collectionArray=!0),this.mediaId=e.mediaId,e._collection&&(this._collection=e._collection),f(document).off("click","#photoPlayerModal .close"),f(document).on("click","#photoPlayerModal .close",function(){var e=window.location.hash;e.match(/\/media\/(.*)/g)&&(e=e.replace(/\/media\/(.*)/g,"")),routing.navigate(e,{trigger:!1})}),this.modelHTML='<div id="photoPlayerModal" class="modal region-loader photo-frame-model hide fade model-popup-h"><div class="modal-body page-content-h"><div class="photo-player-area-h photo-player"></div><div class="photo-player-right-area"><div class="teamName-area"></div><div class="tags-area-h"></div><div class="comment-area coment-area-h"></div><div class="comment-input-outer-h comment-input-outer" class="clearfix"></div><div id="image-tagging-photo"></div></div></div></div>',routing.off("photo-player-section-reload"),routing.on("photo-player-section-reload",function(e,n,r){t.id=n,f("#image-tagging-photo").html(""),t.setUpCommentView(e,n),t.setUpTagView(e,n,r)}),routing.off("comments-fetch-new-form-data"),routing.on("comments-fetch-new-form-data",function(e,n,r){t.setUpCommentView(e,n,r)}),routing.off("tags-fetch-new-form-data"),routing.on("tags-fetch-new-form-data",function(e,n,r){t.setUpTagView(e,n,r)}),this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},checkForUser:function(){return!l.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},handleDeferreds:function(){},setupLayout:function(){this.scheme=[],f(".model-popup-h").remove(),f("body").append(this.modelHTML);var e=new p({scheme:this.scheme,destination:"#modalPopup",template:"",displayWhen:"ready"});return this.layout=e,f("#photoPlayerModal").modal("show"),this.layout},setUpMainView:function(){var e=this;if(e.collectionArray){var t=e._collection.limit,n=e._collection.offset,r=d.Collection.extend(),i=new r;e._collection.limit=undefined,e._collection.offset=0,i.url=e._collection.url,i.fetch({success:function(t){e.setupPhotoPlayerView(t)},error:function(e,t){console.error(e,t)}})}else{var s=e._collection.toJSON(),o={},r=d.Collection.extend(),i=new r;o.payload=[];for(var u in s)o.payload.push(s[u].payload);i.reset(o),e.setupPhotoPlayerView(i),console.error(i,i.toJSON())}},setupPhotoPlayerView:function(e){var t=this;f("#photoPlayerModal").removeClass("region-loader"),t._collection&&t._collection.limit&&(t._collection.limit=limit),t._collection&&t._collection.offset&&(t._collection.offset=offset);var n=new g({model:e.models[0],name:"photo player",destination:".photo-player-area-h",index:t.index,pageName:t.pageName,pageId:t.pageId,user_id:t.userId||null,sports_id:t.sports_id||null,scheme:t.scheme,layout:t.layout,mediaId:t.mediaId}),r=f(document).width(),i=r-350;f("#photoPlayerModal .photo-player-area-h").css({width:i+"px"}),t.scheme.push(n),t.layout.render()},setUpTagView:function(e,t,n){var r=this.scheme.length;for(var i=0;i<r;i++)this.scheme[i].name==this.oldTagView&&this.scheme[i].remove();var s=this;s.oldTagView="tag section"+Math.random(),f(".tags-area-h").unbind().html(""),s.tags=new m,s.tags.id=t,s.tags.targetElement=".tags-area-h",s.tags.fetch(),console.log("Looking for media obj",n),f.when(s.tags.request).done(function(){var t=new w,r=new b({collection:s.tags,userId:s.userId,name:s.oldTagView,model:t,uploader:n,entity_type_id:e,destination:".tags-area-h"});s.scheme.push(r),s.layout.render()})},setUpCommentView:function(e,n){var r=this.scheme.length;for(var i=0;i<r;i++)this.scheme[i].name==this.oldView&&this.scheme[i].remove();var s=this,o;s.oldView="comment section"+Math.random(),f(".coment-area-h, .comment-input-outer-h").unbind().html(""),s.commentson=new v,s.commentson.subject_entity_type=e,s.commentson.id=n,s.commentson.fetch(),f.when(s.commentson.request).done(function(){console.error(s.commentson),o=new y({collection:s.commentson,userId:s.userId,name:s.oldView,_template:t,destination:".coment-area-h"}),s.scheme.push(o),s.layout.render()})},setUpOthersView:function(){},setUpTagPhotoView:function(e,t){var r=this;this.tagViewPhoto=new E({model:new S,template:n,name:"tag-image "+(new Date).toString(),destination:"#image-tagging-photo",user_id:r.userId||null,sports_id:r.sports_id,channel:"tag-image-success-photo"}),r.scheme.push(this.tagViewPhoto),r.layout.render()},tagFunction:function(e){var t=this;alert(JSON.stringify(e))}});return r}),define("text!usercontrols/add-club/templates/layout.html",[],function(){return'<div class="add-club-school-outer"></div>'}),define("sportorg/models/complevel_profile",["facade","models/base"],function(e,t){var n,r=e._,i=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null,min_age:0,max_age:0},desc:"Complevel Profile information",exec_data:{exec_time:0,exec_error:!1}}),url:function(){return"/api/complevelprofile/basics/"+this.id},fetchSuccess:function(e,t){}});return i}),define("sportorg/collections/complevel_profiles",["facade","collections","utils","sportorg/models/complevel_profile"],function(e,t,n,r){var i,s=t.BaseCollection;return i=s.extend({model:r,url:function(){return console.log("called",this.model),"/api/complevelprofile/search/"},fetchSuccess:function(e,t){console.log(this.model),e.reset();var n=t.payload;for(var r in n){var i=new this.model;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){},ParseForDropdown:function(){var e=this,t=e.toJSON(),n={};console.log(t),n=[];for(var r in t){var i=[];for(var s in t[r].payload.levels)i.push(t[r].payload.levels[s].name);n.push({payload:{id:t[r].payload.id,name:i.join(", ")}})}return console.log("data",n),n}}),i}),define("usercontrol/add-club/collections/complevel",["facade","sportorg/collections/complevel_profiles","utils"],function(e,t){return t.extend({})}),define("sportorg/models/season_profile",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{id:0,name:null},desc:"Season Profile information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("sportorg/collections/season_profiles",["facade","collections","utils","sportorg/models/season_profile"],function(e,t,n,r){var i=t.BaseCollection;return i.extend({model:r,url:function(){return"/api/seasonprofile/search/"},fetchSuccess:function(e,t){console.log(this.model),e.reset();var n=t.payload;for(var r in n){var i=new this.model;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){},ParseForDropdown:function(){return this.toJSON()}})}),define("usercontrols/add-club/collections/profile",["facade","sportorg/collections/season_profiles","utils"],function(e,t,n,r){return t.extend({ParseForDropdown:function(){return this.toJSON()}})}),define("usercontrols/add-club/collections/sports",["facade","sportorg/collections/sports_listall"],function(e,t){var n=t.extend({ParseForDropdown:function(){var e=t.prototype.ParseForDropdown.call(this);return e.unshift({payload:{id:null,custom_name:"Don't use a single sport"}}),e}});return n}),define("usercontrols/add-club/views/main",["require","text!usercontrols/add-club/templates/layout.html","facade","views","utils","vendor","usercontrol/add-club/collections/complevel","usercontrols/add-club/collections/profile","sportorg/models/org","usercontrols/add-club/collections/sports","sportorg/collections/seasons","component/forms"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("sportorg/models/org"),h=e("usercontrols/add-club/collections/sports"),p=e("usercontrol/add-club/collections/complevel"),d=e("usercontrols/add-club/collections/profile"),v=e("component/forms"),m=s.extend({template:t,stateData:{},initialize:function(e){this.model=e.model,this.id=e.id,this.addType=e.addType,this.callback=e.callback,this.viewObj=e.viewObj,this.addressValid=!1,e.orgNameSoFar&&(this.orgNameSoFar=e.orgNameSoFar),s.prototype.initialize.call(this,e),this.setUpMainView(),this.render()},setUpMainView:function(){var e=this,t={};t.type=e.addType;var n=f.to_html(e.template,t);l(e.$el).html(n)},afterRender:function(){this.showAddClubForm()},showAddClubForm:function(){var e=this,t=new v({org_name:{form_values:{post_to_server:!0,serverDbField:"org_name",serverKey:"org_name",objectValuesToUpdate:[],defaultValue:e.orgNameSoFar},type:"Text",attr:{placeholder:"Organization Name","class":""},showLable:!1,label:"Organization Name",validators:[{type:"required",message:"Please enter an organization name."}]},season_profile:{type:"DropDown",showLable:!0,label:"We Compete:",form_values:{serverKey:"season_profiles_id",serverDbField:"season_profiles_id",post_to_server:!0,objectValuesToUpdate:[],source_collection:d,request_finished:function(){},data:{records:undefined,recordId:"id",recordValue:"name",selectedValue:e.sports_id},callback:function(e){}}},complevel_profile:{type:"Hidden",form_values:{serverKey:"complevel_profiles_id",post_to_server:!0,defaultValue:e.addType=="school"?1:2,request_finished:function(){},callback:function(e){}}},Sports:{type:e.addType=="school"?"Hidden":"DropDown",showLable:!0,label:"What Sport?",form_values:{serverKey:"single_sport_id",post_to_server:!0,objectValuesToUpdate:[],source_collection:h,request_finished:function(){},data:{records:undefined,recordId:"id",recordValue:"custom_name",selectedValue:e.sports_id},callback:function(e){}}},Location:{form_values:{serverKey:"locations_id",post_to_server:!0,serverDbField:"locations_id"},type:"Location",label:'Location (e.g. "UCLA" or "Santa Monica" or a full address)',validators:[{type:"required",message:"Please select location."}]},users_id:{form_values:{serverKey:e.users_id,post_to_server:!0,value:e.user_id},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Create"},showLable:!1,onSubmit:function(t){var r=n.commit();if(r)for(var i in r){var s=l("*[name="+i+"]"),o=s.position();s.parents(".common-modal #modalBody").animate({scrollTop:o.top},"500",function(){s.addClass("focus-error-animation"),setTimeout(function(){s.removeClass("focus-error-animation")},2e3)});break}else{var u=e.formValues.getFormValues(),a={complevel_profiles_id:u.complevel_profiles_id,name:u.org_name,location_id:u.locations_id,season_profiles_id:u.season_profiles_id,single_sport_id:u.single_sport_id,sports_club:e.addType=="school"?"0":"1"};console.log(a);var f=new c(a);f.save({}),l.when(f.request).done(function(){console.log(f.get("payload"));var t=f.get("payload");a.locationState=e.stateData,a.org_id=t.id,e.callback&&e.callback(a),alert("Your "+e.addType+" has been added to our database successfully.  Please continue the process by adding yourself to a specific season."),routing.trigger("common-popup-close")})}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},this.$el.find(".add-club-school-outer")),n=t.form;this.formValues=t.formValues}});return m}),define("usercontrols/add-club/add-club",["require","facade","controller","models","views","user/models/basic_info","usercontrols/add-club/views/main"],function(e){var t=e("facade"),n=e("controller"),r=e("models"),i=e("views"),s=e("utils"),o=t.$,u=t._,a=s.debug,f=s.lib.Channel,l=i.LayoutView,c=t.Backbone,h=e("user/models/basic_info"),p=e("usercontrols/add-club/views/main");return n.extend({cssArr:["/usercontrols/add-club/add-club.css"],events:{},initialize:function(e){var t=this;f("load:css").publish(this.cssArr),u.bindAll(this),e.id&&(this.id=e.id),e.index&&(this.index=e.index),e.userId&&(this.userId=e.userId),e.type&&(this.type=e.type),e.orgNameSoFar&&(this.orgNameSoFar=e.orgNameSoFar),this.viewObj=e.viewObj,this.callback=e.callback,e._collection&&(this._collection=e._collection),this.modelHTML='<div class="add-club-area-h photo-player"></div>',this.setupLayout().render(),this.setUpMainView()},setupLayout:function(){this.scheme=[];var e=new l({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e;var t={};return t.height="500px",t.width="500px",t.title=this.type=="school"?"Add School":"Add Club",routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this,t=new p({model:new h,name:"add club",destination:"#modalBody",addType:e.type,callback:e.callback,viewObj:e.viewObj,orgNameSoFar:e.orgNameSoFar});e.scheme.push(t),e.layout.render()}})}),define("text!usercontrols/location/templates/view-location.html",[],function(){return'<div id="map-canvas" style="width: 90%; height: 300px; margin-top: 40px;"></div>\r\n'}),define("usercontrols/location/views/view-location",["require","text!usercontrols/location/templates/view-location.html","facade","views","utils","vendor"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=i.BaseView,h=r.Backbone,p;return h.View.extend({template:t,events:{},initialize:function(e){p=this,p.game_id=e.game_id,p.location=e,p.selectedOptions=[],p.setOptions(e),p.render()},intializeMap:function(){console.log(p.location);var e=new google.maps.LatLng(p.location.latitude,p.location.longitude),t={zoom:13,center:e,scaleControl:!0,zoomControl:!0,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.$el.find("#map-canvas")[0],t),this.marker=new google.maps.Marker({position:e,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=f.to_html(e.template,{location:e.locaion});return l(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})}),define("text!usercontrols/addevent/templates/layout.html",[],function(){return'<div class="well-large container_add_game">\r\n	<!-- <h4>Add Game</h4> -->\r\n	<!-- <div class="green-left-heading ">DATE</div> -->\r\n<div class="clear"></div>\r\n	<div class="section-individual-game_h displayNone">\r\n		<input type="text"class="txt-individual-game_h" placeholder="Enter Event" />\r\n		<span class="indicator_h"></span>\r\n		<div class="clear"></div>\r\n		<input type="text"class="txt-individual-location_h displayNone" placeholder="Enter Location Id"  />\r\n			<div class="clear"></div>\r\n	</div>\r\n	<div class="section-Add-Sports_h">\r\n		<div class="section-game-date_h floatLeft">\r\n			<input type="text" class="txt-game-date_h txtDate" placeholder="Enter Date" readonly="readonly" />\r\n			<input type="text" class="txt-game-time_h hasDatepicker txtTime"  placeholder="Time" placeholder="Time" maxlength="5" />\r\n			\r\n			<span class="spn-ddl-time-period_h"></span>\r\n			<!-- <select class="ddl-time-period_h ddlTime">\r\n			<option value="AM">AM</option>\r\n			<option value="PM">PM</option>\r\n			</select> -->\r\n		\r\n			<div class="clear"></div>\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n		<div class="clear"></div>\r\n		<!-- <div class="row-fluid">\r\n			Select Sport:\r\n		</div> -->\r\n	<!-- <div class="green-left-heading">SPORT</div> -->\r\n	<div class="clear"></div>\r\n		<div class="row-fluid section-game-sports_h">\r\n<span class="span-ddl-sports_h">\r\n			<!-- <select class="ddl-game-sports_h"></select> -->\r\n				</span>\r\n			<div class="clear"></div>	\r\n			<span class="displayNone field-message field-message_h"></span>\r\n		</div>\r\n<div class="clear"></div>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<div class="section-game-teams_h team-one_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 1</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 1 :\r\n			<div class="clear"></div>\r\n			<span class="span_ddl_team_h span_ddl_team_one_h"></span>\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a>\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt txt-game-team_h displayNone" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n			<!-- <a href="javascript:void(0)" class="btn-ddl-team-game_h">Choose from select ?</a> -->\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score : \r\n			<input type="text" class="txt-score-team_h" />\r\n		</div>\r\n		<div class="section-game-radio_h">			\r\n			Home &nbsp;<input type="radio" name="rdo-team1_h" value="home" class="rdo-game-location_h rdo-game-location-one-home_h" team="one"> &nbsp;&nbsp;\r\n			Away &nbsp;<input type="radio" name="rdo-team1_h" value="away" class="rdo-game-location_h" team="one">\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n\r\n\r\n	<div class="section-game-teams_h team-two_h displayNone">\r\n		<!-- <div class="green-left-heading">TEAM 2</div> -->\r\n		<div class="clear"></div>\r\n		Select Team 2 :\r\n			<div class="clear"></div>\r\n			<!-- <span class="span_ddl_team_h span_ddl_team_two_h"></span> -->\r\n		<!-- <select class="ddl-game-userteams_h"></select> -->\r\n		<!-- <a href="javascript:void(0)" class="btn-new-team-game_h">Team not listed ?</a> -->\r\n		<div class="section-new-team_h">\r\n			<!-- <input type="text" class="txt-game-state_h" placeholder="Enter State" />\r\n			<input type="text" class="txt-game-city_h displayNone" placeholder="Enter City" /> -->\r\n			<input type="text"class="txt-game-team_h" placeholder="Enter Team" />\r\n			<span class="indicator_h"></span>\r\n		</div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n		<div class="clear"></div>\r\n		<div class="section-score_h">\r\n			Score :\r\n			<input type="text" class="txt-score-team_h"/>\r\n		</div>\r\n		<div class="section-game-radio_h">\r\n			Home &nbsp;<input type="radio" name="rdo-team2_h" value="home" class="rdo-game-location_h rdo-game-location-two-home_h"  team="two"> &nbsp;&nbsp;\r\n			Away  &nbsp;<input type="radio" name="rdo-team2_h" value="away" class="rdo-game-location_h"   team="two">			\r\n		</div>\r\n	</div>\r\n<div class="clear"></div>\r\n<br/>\r\n<br/>\r\n	<div class="section-main-location_h displayNone">\r\n		<!-- <div class="green-left-heading">LOCATION</div> -->\r\n		<!--div class="clear"></div>\r\n		<strong>Location : </strong>		\r\n<div class="clear"></div>\r\n		<input type="text" class="txt-game-location-id_h displayNone"-->\r\n		<div class="location-view-h">&nbsp;</div>\r\n		<input type="hidden" class="txt-game-location-id_h displayNone"/>\r\n		<div class="div-game-location_h"></div>\r\n			<div class="clear"></div>\r\n		<span class="displayNone field-message field-message_h"></span>\r\n	</div>\r\n	<div class="clear"></div>\r\n	<span class="displayNone field-message field-message_h"></span>\r\n\r\n	<div class="clear"></div>\r\n	<br/>\r\n	\r\n	<div>\r\n	<button class="btn btn-primary btn-game-Finish_h floatRight displayNone">\r\n		Create ! \r\n	</button>\r\n	</div>\r\n	<div class="clear"></div>\r\n</div>\r\n<div class="m_top_20 floatRight popup-action-button">\r\n	<button class="btn btn-primary btn-game-individual-Finish_h displayNone">\r\n			Go There !\r\n		</button>\r\n		<button class="btn btn-primary btn-game-individual-Create_h displayNone">\r\n			Create !\r\n		</button>\r\n	</div>'}),define("usercontrols/addevent/views/main",["require","text!usercontrols/addevent/templates/layout.html","facade","views","utils","vendor","sportorg/collections/sports_listall","location/collections/states","usercontrols/addgame/collections/teams","location/collections/cities","usercontrols/addgame/collections/teams_user","usercontrols/addgame/collections/teams","usercontrols/addgame/collections/games_search","usercontrols/addgame/models/team","usercontrols/addgame/models/team_add","usercontrols/addgame/models/game","usercontrols/addgame/models/uslgamelink","sportorg/models/game","usercontrol/dropdown/view/dropdown","usercontrol/location/views/get-view-location","component/forms","vendor/plugins/dateformat"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=a.Mustache,l=r.$,c=e("usercontrols/tag/models/basic_info"),h=e("sportorg/collections/sports_listall"),p=e("location/collections/states"),d=e("location/collections/cities"),v=e("usercontrols/addgame/collections/teams_user"),m=e("usercontrols/addgame/collections/teams"),g=e("usercontrols/addgame/models/team"),y=e("usercontrols/addgame/models/team_add"),b=e("usercontrols/addgame/models/game"),w=e("usercontrols/addgame/collections/games_search"),E=e("sportorg/models/game"),S=e("usercontrol/dropdown/view/dropdown"),x=e("vendor/plugins/dateformat"),T=e("component/forms"),N=e("usercontrols/addgame/models/uslgamelink");return s.extend({template:'<div class="add-event-container-h"></div>',gameData:{},teams:[],events:{"change .ddl-game-sports_h":"changeSport","keyup .txt-game-state_h":"keyupState","blur .txt-game-state_h":"changeState","keyup .txt-game-city_h":"keyupCity","blur .txt-game-city_h":"changeCity","keyup .txt-game-team_h":"keyupTeam","blur .txt-game-team_h":"changeTeam","keyup .txt-individual-game_h":"keyupIndividualGame","blur .txt-individual-game_h":"changeindividualGame","change .ddl-game-userteams_h":"changeUserTeam","click .btn-new-team-game_h":"showAddTeam","click .btn-ddl-team-game_h":"showDdlTeam","click .rdo-game-location_h":"showLocation","click .btn-game-Finish_h":"finishGame","change .txt-game-date_h":"CheckTeamControlsVisibility","click .btn-game-individual-Create_h":"createIndividualEvent","click .btn-game-individual-Finish_h":"goThereIndividualGame"},controls:{sectionAddSports:".section-Add-Sports_h",sectionDate:".section-game-date_h",txtGameDate:".txt-game-date_h",txtGameTime:".txt-game-time_h",spnTimePeriod:".spn-ddl-time-period_h",ddlTimePeriod:".ddl-time-period_h",spnSports:".span-ddl-sports_h",ddlSports:".ddl-game-sports_h",sectionTeams:".section-game-teams_h",ddlUserTeams:".ddl-game-userteams_h",spanddlteam:".span_ddl_team_h",spanddlteamtwo:".span_ddl_team_two_h",spanddlteamone:".span_ddl_team_one_h",btnNewTeam:".btn-new-team-game_h",btnDdlTem:".btn-ddl-team-game_h",sectionNewTeam:".section-new-team_h",txtState:".txt-game-state_h",txtCity:".txt-game-city_h",txtTeam:".txt-game-team_h",txtScore:".txt-score-team_h",btnFinish:".btn-game-Finish_h",sectionTeamOne:".team-one_h",sectionTeamTwo:".team-two_h",sectionScore:".section-score_h",sectionRadio:".section-game-radio_h",rdoTeamOne:".rdo-game-location-one-home_h",rdoTeamTwo:".rdo-game-location-two-home_h",rdoLocation:".rdo-game-location_h",sectionMainLocation:".section-main-location_h",sectionLocation:".div-game-location_h",txtLocationId:".txt-game-location-id_h",sectionIndividual:".section-individual-game_h",txtIndividualGame:".txt-individual-game_h",btnIndividualFinish:".btn-game-individual-Finish_h",txtIndividualLocation:".txt-individual-location_h",btnIndividualGameCreate:".btn-game-individual-Create_h",fieldMessage:".field-message_h",secSports:".section-game-sports_h",hdnSportsIdData:"hdn_sport_id",hdnSportsId:"#hdn_sport_id",hdnTimePeriodData:"hdn_time-period_h",hdnTimePeriod:"#hdn_time-period_h",indicator:".indicator_h"},attributes:{stateId:"stateid",schoolId:"schoolid",teamId:"teamid",playersId:"playerid",cityId:"cityid",sportId:"sportid",locationId:"locationid",gameId:"gameid"},inlineTemplates:{},messages:{dataNotExist:"Data does not exist . ",selectDateAndTime:"Please select date and time",selectTeam:"Please select team",selectScore:"Please enter score",selectLocation:"Please select location",selectLocationType:"Please select location type",gameFound:"Sweet ! This Event Already Exists ! ",enterEventName:"Please enter event name",selectSport:"Please select sport",selectValidTime:"Please enter valid time in format hh:mm (12 hours)"},tags:{individual:"individual",team:"team",rgxTime:/^(0?[1-9]|1[012])(:[0-5]\d)$/,rgxTimeWhole:/^(0?[1-9]|1[012])$/},initialize:function(e){s.prototype.initialize.call(this,e),n=this,n.setOptions(e),this.init()},render:function(){s.prototype.render.call(this),this.setupForm()},setupForm:function(){var e=this,t=new T({game_search:{type:"AutoComplete",label:"Event Name",form_values:{post_to_server:!0,keyNameInPayload:"event_name",subLabelInPayload:"full_date",serverKey:"event_name",serverDbField:"event_name",defaultValue:"",field_width:"80%",request_fields:[{key:"sports_id",value:function(){return e.sports_id}},{key:"game_name",value:function(e){return e.$el.val()}}],source_collection:w,request_finished:function(){console.log("request finished")},automaticFetch:!0,automaticFetchFn:function(e){console.log("auto fetch called",e)},callback:function(t,n){var r=e.$el.find(".add-event-container-h form");if(t>0){var i=new E({id:t});i.fetch(),l.when(i.request).done(function(){var e=i.get("payload").time_as_int,t=new Date(e);r.find('input[type="submit"]').val("Add Me to This Event"),r.find('input[name="games_id"]').val(i.get("payload").id),r.find('input[name="date_chooser"]').val(x(t,"mmm d, yyyy")).attr("disabled","disabled"),r.find('input[name="time_chooser"]').val(x(t,"h:MM")).attr("disabled","disabled"),r.find("textarea.location-h").html(i.get("payload").game_location).trigger("blur").attr("disabled","disabled"),r.find(".verify-address-h").trigger("click")})}else r.find('input[type="submit"]').val("Create Event"),r.find('input[name="games_id"]').val("0"),r.find('input[name="game_name"]').val(l('input[name="game_search"]').val()),r.find('input[name="date_chooser"]').removeAttr("disabled").val(""),r.find('input[name="time_chooser"]').removeAttr("disabled").val(""),r.find("textarea.location-h").removeAttr("disabled").html("")},afterSetValue:function(e){console.log("After set value called",e)}},validators:[]},date_chooser:{form_values:{post_to_server:!1,serverKey:"game_date",serverDbField:"gameDay",objectValuesToUpdate:["game_datetime"],getValue:function(){return this.$el.val()}},fieldClass:"date-picker-field",type:"Text",attr:{placeholder:"Enter Date","class":"txt-game-date_h txtDate"},showLable:!1,label:"Date",bindDatePicker:!0,changeEvent:function(){var e=new Date(this.getValue()),t=new Date;e!=null&&t>=e?l(".txt-score-team-h").removeClass("hidden"):l(".txt-score-team-h").addClass("hidden").val("")}},time_chooser:{form_values:{post_to_server:!1,serverDbField:"gameTime",serverKey:"game_time",objectValuesToUpdate:["game_datetime"]},type:"Text",fieldClass:"time-picker-field",attr:{placeholder:"Time","class":"txt-game-time_h hasDatepicker txtTime"},showLable:!1,label:"Time",validators:[{type:"required",message:"Please enter a time"},/^(0?[1-9]|1[012])(:[0-5]\d)?$/]},Day_light:{type:"DropDown",fieldClass:"ampm-field",form_values:{post_to_server:!1,serverKey:"game_ampm",objectValuesToUpdate:["game_datetime"],data:{records:[{payload:{name:"AM",value:"AM"}},{payload:{name:"PM",value:"PM"}}],recordId:"name",recordValue:"value",selectedValue:"PM"},elementId:e.controls.hdnTimePeriodData,callback:function(e){}},showLable:!1,label:""},game_datetime:{type:"Hidden",form_values:{serverDbField:"game_datetime",valueBindings:["date_chooser","time_chooser","Day_light"],serverKey:"game_datetime",post_to_server:!0}},event_location:{form_values:{serverKey:"locations_id",post_to_server:!0,serverDbField:"locations_id"},type:"Location",label:"Location",fieldClass:"location-chooser",validators:[{type:"required",message:"Please select location."}]},users_id:{form_values:{serverKey:"users_id",post_to_server:!0,value:e.user_id},type:"Hidden"},games_id:{form_values:{serverKey:"games_id",post_to_server:!0,value:0},type:"Hidden"},game_name:{form_values:{serverKey:"game_name",post_to_server:!0,value:0},type:"Hidden"},submit:{type:"Submit",fieldClass:"button-field",attr:{value:"Create Event"},showLable:!1,onSubmit:function(t){var r=n.commit();if(r)for(var i in r){var s=l("*[name="+i+"]"),o=s.position();s.parents(".common-modal #modalBody").animate({scrollTop:o.top},"500",function(){s.addClass("focus-error-animation"),setTimeout(function(){s.removeClass("focus-error-animation")},2e3)});break}else{var u=e.formValues.getFormValues(),a=e;console.log(u,a.$el.find('input[name="game_search"]'));if(u.game_name===""||u.game_name===0||u.game_name==="0")u.game_name=a.$el.find('input[name="game_search"]').val();if(u.games_id>0){c={games_id:u.games_id,sports_id:a.sports_id,users_id:a.user_id};var f=new N(c);f.save(),l.when(f.request).fail(function(t){var n=JSON.parse(t.responseText),r=n.exec_data.error_array;e.formValues.showServersErrors(r)}),l.when(f.request).done(function(e){routing.trigger(a.channel,e)})}else{console.log;var c={game_datetime:u.game_datetime,game_location:u.locations_id,games_id:u.games_id,sports_id:a.sports_id,event_name:u.game_name,users_id:a.user_id},h=new b(c);h.save({}),l.when(h.request).fail(function(t){var n=JSON.parse(t.responseText),r=n.exec_data.error_array;e.formValues.showServersErrors(r)}),l.when(h.request).done(function(e){var t=new N;t.save({games_id:e.payload.id,sports_id:a.sports_id,users_id:a.user_id},{success:function(t,n){console.log(a.channel),routing.trigger(a.channel,e)},error:function(e,t){alert("fail"),console.log(t)}})})}}}},button:{type:"Button",fieldClass:"button-field",attr:{value:"Cancel","class":"cancel-btn"},onClick:function(){routing.trigger("common-popup-close")},showLable:!1}},this.$el.find(".add-event-container-h")),n=t.form;this.formValues=t.formValues},afterRender:function(){},setOptions:function(e){this.user_id=e.user_id;if(!e.channel)throw new Error("call back channel is must for this");this.channel=e.channel,this.sports_id=e.sports_id||null},init:function(){n.setUpMainView()},setUpMainView:function(){var e=f.to_html(n.template,{});l(n.el).html(e)}})}),define("usercontrols/addevent/addevent",["require","text!usercontrols/addevent/templates/layout.html","facade","controller","models","views","user/models/basic_info","usercontrols/addevent/views/main"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("user/models/basic_info"),d=e("usercontrols/addevent/views/main"),v=i.extend({cssArr:["/usercontrols/addevent/addevent.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.sports_id&&(this.sports_id=e.sports_id),e.users_id&&(this.users_id=e.users_id),this.callback=e.callback,e.popup&&(this.popup=!0),this.init(),this},init:function(){this.popup?this.setupPopupLayout().render():this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setupPopupLayout:function(){var e;this.scheme=[];var e=new h({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e,this.modelBoxId="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);var t={};return t.height="500px",t.width="500px",t.title="Add Event",t.id=this.modelBoxId,routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;routing.off("add-event-success"),routing.on("add-event-success",function(t){e.addTeamFunction(t)});var n=this;this.addGameView=new d({model:new p,template:t,name:"add-event-main",destination:this.popup?"#"+this.modelBoxId+" #modalBody":"#main",user_id:n.users_id,channel:"add-event-success",sports_id:this.sports_id,teams_id:this.teams_id}),this.scheme.push(this.addGameView),this.layout.render()},addTeamFunction:function(e){this.callback&&(routing.trigger("common-popup-close"),this.callback(e))}});return v}),define("text!usercontrols/detection/templates/browser.html",[],function(){return'{{#old_ie}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/ie.png" /></div>\r\n	<div class="notify-text">It appears you\'re using an old version of IE ({{current_version}}).  Unfortunately our site is still in beta and we are not yet supporting versions older than IE 10.<br/><br/>If you\'re on Windows XP and are unable to upgrade to this version, please consider using Google Chrome, which is an outstanding browser that I recommend not just for this website, but for all websites.</div>\r\n	<div id="recommendations">\r\n		<span class="largeText">Here are the browsers we recommend (in order of preference)</span>\r\n		<div class="r-item"><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank"><img src="http://cdn.athletez.com/resources/img/chrome.png" /><br/>Chrome 30+</a></div>\r\n		<div class="r-item"><a href="http://support.apple.com/downloads/#safari" target="_blank"><img src="http://cdn.athletez.com/resources/img/safari.png" /><br/>Safari 5+</a> </div>\r\n		<div><a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="http://cdn.athletez.com/resources/img/ff.png" /><br/>Firefox 25+</a></div>\r\n	</div>\r\n{{/old_ie}}\r\n{{#old_ff}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/ff.png" /></div>\r\n	<div class="notify-text">It appears you\'re using an old version of Firefox ({{current_version}}).  Unfortunately our site is still in beta and we are not yet supporting versions older than Firefox 25.  Please consider using Google Chrome, which is an outstanding browser that I recommend not just for this website, but for all websites.<br/><br/>You can disregard this message and try to use the site, but annoying stuff is going to happen and it will make you angry and us embarrassed.</div>\r\n	<div id="recommendations">\r\n		<span class="largeText">Here are the browsers we recommend (in order of preference)</span>\r\n		<div class="r-item"><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank"><img src="http://cdn.athletez.com/resources/img/chrome.png" /><br/>Chrome 30+</a></div>\r\n		<div class="r-item"><a href="http://support.apple.com/downloads/#safari" target="_blank"><img src="http://cdn.athletez.com/resources/img/safari.png" /><br/>Safari 5+</a> </div>\r\n		<div><a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank"><img src="http://cdn.athletez.com/resources/img/ff.png" /><br/>Firefox 25+</a></div>\r\n	</div>\r\n{{/old_ff}}\r\n{{#mobile}}\r\n	<div class="curr-browser"><img src="http://cdn.athletez.com/resources/img/mobile.png" /></div>\r\n	<div>Looks like you\'re on a mobile browser.  Though it\'s high up on our priority list, Athletez is still in beta and we don\'t yet have support for mobile devices.  So trying to navigate on your phone will drive you insane.  If you don\'t want to go insane, maybe hold off on trying out Athletez until you get home.</div>\r\n{{/mobile}}\r\n\r\n<div style="float: left; margin: 10px;">Sorry for the inconvenience,<br/>Mike &amp; Max</div>'}),define("text!usercontrols/detection/browser.css",[],function(){return".curr-browser{\r\n    float:left;\r\n    width: 15%;\r\n}\r\n.curr-browser img{\r\n    width:100%;\r\n}\r\n.notify-text{\r\n    float: right;\r\n    width: 75%;\r\n    height: 120px;\r\n    padding: 10px;\r\n}\r\n#recommendations{\r\n    text-align: center;\r\n    display: block;\r\n    width: 100%;\r\n    float: left;\r\n    margin-top: 35px;\r\n}\r\n#recommendations span{\r\n    display: block;\r\n    font-size: 1.2em;\r\n    font-weight: bold;\r\n}\r\n#recommendations div{\r\n    display: inline-block;\r\n    width: 100px;\r\n    margin:9px;\r\n}\r\n#recommendations div img{\r\n}"}),define("browserpop/views/browser",["require","text!usercontrols/detection/templates/browser.html","text!usercontrols/detection/browser.css","facade","views","utils","vendor","browser"],function(e){var t,n=e("facade"),r=e("views"),i=r.SectionView,s=e("utils"),o=s.lib.Channel,u=e("vendor"),a=u.Mustache,f=n.$,l=r.BaseView,c=n.Backbone,h,p=e("text!usercontrols/detection/templates/browser.html");return c.View.extend({template:p,events:{"click .close":"closePopup"},cssArr:["usercontrols/detection/browser.css"],initialize:function(e){o("load:css").publish(this.cssArr),h=this,h.data={},h.selectedOptions=[],h.setOptions(e),h.populateData()},populateData:function(){var e=this,t=setInterval(function(){try{f.browser.android,clearInterval(t);if(f.browser.ipad||f.browser.iphone||f.browser.android)e.data.mobile=!0;f.browser.msie&&(e.data.old_ie=!0),f.browser.mozilla&&(e.data.old_ff=!0),e.data.current_version=f.browser.version,e.render()}catch(n){}},500)},render:function(){var e=this,t=a.to_html(e.template,e.data),n={};return n.width="90%",n.height="500px",n.title="Your Browser Might be an Issue",n.html=t,n.id="Browser-detect",console.error(n),routing.trigger("common-popup-open",n),this},setOptions:function(e){for(var t in e)this[t]=e[t]},closePopup:function(){}})}),define("text!usercontrols/landing/templates/landing.html",[],function(){return'<div style="margin: auto; text-align: center; height: 30px;"> </div><div id="landing-info">\r\n	<div id="landing-header"><!--<img src="http://cdn.athletez.com/resources/img/a_logo_smaller.png" style="width:50px; float: left;" />-->\r\n		{{#firstname}}\r\n		Hey {{firstname}}\r\n		{{/firstname}}\r\n		{{^firstname}}		\r\n		Athletez Live Here.\r\n		{{/firstname}}\r\n		<hr />\r\n	</div>\r\n	<div id="site-info">\r\n		{{#firstname}}\r\n			{{#label}}You\'ve been invited to {{#invite_type}}{{invite_type}}{{/invite_type}}{{^invite_type}}join{{/invite_type}} {{label}}.{{/label}}\r\n			{{^label}}Thanks for accepting your invitation!{{/label}}\r\n			Since you\'re already on facebook, we recommend using the "Connect With Facebook" option below.\r\n		{{/firstname}}\r\n		{{^firstname}}		\r\n		And we mean all athletes.  It\'s simple: create a profile, connect with your team, share your games, post your highlights, get discovered.\r\n		{{/firstname}}\r\n	\r\n\r\n		<hr />\r\n	</div>\r\n</div>\r\n<div id="reg-landing"></div>\r\n\r\n<div id="alternative-actions" style="height:100px;">\r\n	<a href="javascript:void(0);" id="browse">Browse Athletez.com</a>\r\n</div>'}),define("text!usercontrols/landing/landing.css",[],function(){return".curr-browser{\r\n    float:left;\r\n    width: 15%;\r\n}\r\n.curr-browser img{\r\n    width:100%;\r\n}\r\n.notify-text{\r\n    float: right;\r\n    width: 75%;\r\n    height: 120px;\r\n    padding: 10px;\r\n}\r\n#recommendations{\r\n    text-align: center;\r\n    display: block;\r\n    width: 100%;\r\n    float: left;\r\n    margin-top: 35px;\r\n}\r\n#recommendations span{\r\n    display: block;\r\n    font-size: 1.2em;\r\n    font-weight: bold;\r\n}\r\n#recommendations div{\r\n    display: inline-block;\r\n    width: 100px;\r\n    margin:9px;\r\n}\r\n#recommendations div img{\r\n}\r\n#landing-info{\r\n    margin-top:50px;\r\n    width: 90%;\r\n    max-width: 800px;\r\n    margin: auto;\r\n    padding:10px 40px;\r\n    text-align: center;\r\n}\r\n#alternative-actions{\r\n    text-align: center;\r\n    margin: auto;\r\n    margin-top: 40px;\r\n    width: 700px;\r\n}\r\na#browse{\r\n    color: white;\r\n    width: 350px;\r\n}\r\n#landing-info li, #landing-info div{\r\n    color: #EFEFEF;\r\n    text-shadow: 4px 1px 1px rgba(0, 0, 0, 0.70);\r\n}\r\n#landing-info #landing-header{\r\n    line-height: 60px;\r\n    width: 100%;\r\n    font-size: 5em;\r\n    font-weight: bold;\r\n    float: left;\r\n    text-align: center;\r\n    text-shadow: 4px 3px 3px rgba(0, 0, 0, 0.70);\r\n    padding: 20px 0px 0px 0px;\r\n}\r\n#landing-info #site-summary{\r\n    list-style-type: circle;\r\n    font-size: 1.6em;\r\n}\r\n#landing-info #site-summary li{\r\n   line-height: 30px;\r\n    margin-top:10px;\r\n}\r\n#site-info{\r\n    font-size: 2.0em;\r\n    font-weight: bold;\r\n    line-height: 38px;\r\n    position: relative;\r\n    width: 90%;\r\n    margin: auto;\r\n    text-shadow: 2px 2px 2px rgba(255, 255, 255, 0.80);\r\n}\r\n#landing-info hr{\r\n    border:0;\r\n    height: 1px;\r\n    margin: 20px auto;\r\n    background-color: white;\r\n    width: 75%;\r\n    opacity: .5;\r\n}\r\n#reg-landing{\r\n    width: 280px;\r\n    margin:15px auto;\r\n}\r\n#reg-landing #mainreg{\r\n    background: none;\r\n}\r\n#reg-landing #regcontainer{\r\n    width: 100%;\r\n}\r\n#reg-landing #mainreg{\r\n    width:100%;\r\n}\r\n#reg-landing .regor {\r\n    color: white;\r\n    margin: 15px 0 0 0;\r\n    font-size: 1.2em;\r\n    font-weight: bolder;\r\n}\r\n#reg-landing #fbpane {\r\n    width: 100%;\r\n    margin: 0;\r\n    padding: 0;\r\n    cursor: pointer;\r\n    border-style: none;\r\n    height: 45px;\r\n    position: relative;\r\n    background: #68659c url(http://cdn.athletez.com/resources/img/facebook-f.png) 94% no-repeat;\r\n}\r\n#reg-landing #fbpane #label{\r\n    margin: 0;\r\n    position: absolute;\r\n    background-color: #6b74b7;\r\n    font-size: 1em;\r\n    padding: 12px;\r\n    width: 75%;\r\n    float: left;\r\n    height: 20px;\r\n}\r\n#reg-landing #regpanemain {\r\n    width: 100%;\r\n}\r\n#reg-landing #firstregbase {\r\n    padding:0;\r\n    float: none;\r\n    width: 100%;\r\n}\r\n#reg-landing #firstregbase input{\r\n    width: 90%;\r\n    margin: 20px 0 0 0;\r\n    padding: 8px 5%;\r\n    position: relative;\r\n}\r\n#reg-landing .signupsubmit{\r\n    margin-top:0;\r\n    padding-top: 10px;\r\n}\r\n#reg-landing .signupsubmit input{\r\n    width: 48% !important;\r\n    color: white;\r\n    font-size: 20px;\r\n    border-style: none;\r\n    height: 40px;\r\n}\r\n#reg-landing .signupsubmit input:first-child{\r\n    float: left;\r\n    background-color: #9DCA3C;\r\n}\r\n#reg-landing .signupsubmit input:last-child{\r\n    float: right;\r\n    background-color: #1AA0AE;\r\n}"}),define("usercontrols/landing/models/fb-user",["models","facade"],function(e,t){var n=e.BaseModel,r=t.$,i=t._;return n.extend({fbUserId:undefined,url:function(){return base_url+"api/fbinvite/basics?fbid="+this.fbUserId}})}),define("usercontrols/landing/views/landing",["require","text!usercontrols/landing/templates/landing.html","text!usercontrols/landing/landing.css","signup/models/registerbasic","signup/views/registerbasic","facade","views","utils","usercontrols/landing/models/fb-user","common/models/entparse","vendor"],function(e){var t=e("facade"),n=e("views"),r=n.SectionView,i=e("utils"),s=e("signup/models/registerbasic"),o=e("signup/views/registerbasic"),u=e("usercontrols/landing/models/fb-user"),a=e("common/models/entparse");Channel=i.lib.Channel,vendor=e("vendor"),Mustache=vendor.Mustache,$=t.$;var f=n.BaseView,l=t.Backbone,c,h=e("text!usercontrols/landing/templates/landing.html");return f.extend({template:h,events:{"click #browse":"closePopup","click #sign-in":"signIn","click #browse":"scrollToContent"},cssArr:["usercontrols/landing/landing.css"],initialize:function(e){console.log(e),Channel("load:css").publish(this.cssArr);var t=this;t.data={},t.selectedOptions=[],t.setOptions(e);try{typeof e=="object"&&e.userId?(t.userId=e.userId,t.getUserData()):t.render()}catch(n){console.error(n)}},getUserData:function(){var e=this,t=new u;t.fbUserId=this.userId,console.log(t),t.fetch(),$.when(t.request).done(function(){var n=t.get("payload");console.log(n);var r=new a({mpay:n.invite_to_obj,display_width:1920,display_height:1024}),i=r.parsedData;e.data={firstname:n.fb_user_data.first_name,lastname:n.fb_user_data.last_name,invite_type:n.invite_type,label:i._label};var s={};typeof (i.imgData=="object")&&(s.background_image=i.imgData.url),console.log(i),e.render(s)})},render:function(e){var t=this,n=Mustache.to_html(t.template,t.data);this.$el=$(".register-wrapper-h");var e=e||{};return e.width="100%",e.height="100%",e.title="&nbsp;",e.html=n,e.id="landing",e.fullPage=!0,e.addClass=["noBorder"],e.background_image==undefined&&(e.background_image="http://athletez.s3.amazonaws.com/resources/img/landing/7.jpg"),this.$el.css({background:"url("+e.background_image+") no-repeat","background-size":"cover"}),this.$el.html(n),t.showReg(),this},scrollToContent:function(e){$("html, body").animate({scrollTop:$("#main").offset().top},700)},setOptions:function(e){for(var t in e)this[t]=e[t]},showReg:function(){this.regModel=new s,this.regView=new o({model:this.regModel,name:"Select Registration Type",destination:"#reg-landing",openAsaPage:!0,data:this.data,showOnLanding:!0,fb_invite:this.userId!==undefined?this.userId:!1})},signIn:function(e){this.regView.showLogin(e)},closePopup:function(){console.log("close popup"),routing.trigger("common-popup-close")}})}),define("text!fbinvite/templates/layout.html",[],function(){return'\r\n		<div id="image-wrap-h" class="search-result-outer">\r\n		</div>\r\n'}),define("text!packages/fbinvite/templates/image-item.html",[],function(){return'<a href="javascript: void(0);" data-index="{{index}}" data-id="{{id}}" class="image-outer-h">\r\n	<div class="image-item-container">\r\n		<img itemprop="image" class="list-thumbnail" src="{{large}}" alt="{{name}}"/>\r\n\r\n		{{#invited}}\r\n		<div class="action-section">\r\n			<div class="action-block left-block vote link-disabled"><span>Already Invited</span></div>\r\n		</div>\r\n		{{/invited}}\r\n		{{^invited}}\r\n		<div class="action-section">\r\n			<div class="action-block left-block follow invite-h" data-id="{{id}}" ><span>Invite</span></div>\r\n		</div>\r\n		{{/invited}}\r\n\r\n		<div class="detail-view {{#_detailclass}}{{_detailclass}}{{/_detailclass}}">\r\n			<h6>{{name}}</h6>\r\n		</div>\r\n	</div>\r\n</a>'}),define("packages/fbinvite/models/invite",["models","facade"],function(e,t){var n=e.BaseModel,r=t.$,i=t._;return n.extend({idAttribute:"id",url:function(){return base_url+"api/fbinvite/invite/"}})}),define("packages/fbinvite/views/image-item",["vendor","views","utils","text!packages/fbinvite/templates/image-item.html","packages/fbinvite/models/invite","utils/storage","chrome/views/header","component/fb"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=require("votes/models/vote"),f=require("utils/storage"),l=require("packages/fbinvite/models/invite"),c=require("chrome/views/header"),h=require("component/fb"),p=require("common/models/entparse");return i=o.extend({tagName:"li",className:"image",events:{},initialize:function(e){console.log(e),this.template=r,this.FBoptions=e.FBoptions||{};if(e.length)for(var t in e)this[t]=e[t];if(this.FBoptions.invite_type===undefined||this.FBoptions.invite_type===null)this.FBoptions.invite_type="join";this.FBComponent=new h},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},render:function(){var e=this,t=this.model.get("payload"),n=u.to_html(this.template,t);this.$el.html(n);var r="120px",i="92px";return this.$el.find(".image-item-container").mouseout(function(){s(this).find(".action-block").css({opacity:0}),s(this).find(".detail-view").css({bottom:"-"+i}),s(this).find(".detail-view.game").css({bottom:"-"+r})}),$nopic_words_div=this.$el.find(".game-tile"),$nopic_words_div.length&&($num_words=$nopic_words_div.text().length,console.log($num_words),$num_words<3?$nopic_words_div.css({"font-size":"5em",top:"90px",left:"60px"}):$num_words<5?$nopic_words_div.css({"font-size":"4em",top:"90px",left:"40px"}):$num_words<25?$nopic_words_div.css("font-size","2em"):$num_words<30?$nopic_words_div.css({"font-size":"1.7em",top:"65px"}):$num_words<40?$nopic_words_div.css({"font-size":"1.5em",top:"50px"}):$nopic_words_div.css("font-size","1em")),this.$el.find(".image-item-container").mouseover(function(){s(this).find(".detail-view").css({bottom:"0px"}),s(this).find(".action-block").css({opacity:90})}),this.$el.find(".circle").mouseover(function(){s(this).parent().find(".detail-view").css({bottom:"0px"}),s(this).parent().find(".action-block").css({opacity:90})}),this.$el.find(".invite-h").click(function(t){e.invite(t)}),this},postMessage:function(e){var t=this,n={};n.link="#acceptfbinvite/"+this.model.get("payload").id,n.name="Come join Me on Atheletez",n.picture="http://cdn.athletez.com/resources/img/athletez_logo_small.png",n.description="You have been invited to sign up for http://athletez.com",n.success=function(){t.callModel(e)},n.error=function(){alert("Some Error Occured. Please try again.")},n.to=this.model.get("payload").id,this.FBComponent.sendInvite(n)},callModel:function(e){var t=new l;t.set({fbid:this.model.get("payload").id}),console.log(this.FBoptions),this.FBoptions&&t.set({invite_type:this.FBoptions.invite_type,invite_to:{subject_id:this.FBoptions.subject_id,enttype_id:this.FBoptions.enttypes_id}}),t.save(),s.when(t.request).done(function(){s(e.target).addClass("link-disabled")})},invite:function(e){e.preventDefault(),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}this.postMessage(e)}}),i}),define("text!packages/fbinvite/templates/image-list.html",[],function(){return'<ul class="image-list">\r\n</ul>\r\n<div class="clear"><a href="javascript: void(0);" class="see-more-h">More</a></div>\r\n'}),define("packages/fbinvite/views/image-list",["facade","views","utils","packages/fbinvite/views/image-item","text!packages/fbinvite/templates/image-list.html","votes/models/follow"],function(e,t,n,r,i){var s,o,u=e.$,a=e._,f=require("vendor"),l=require("votes/models/follow"),c=n.lib.Channel,h=t.CollectionView,p=t.SectionView,d=f.Mustache;return o=h.extend(p.prototype),s=o.extend({__super__:h.prototype,template:i,_tagName:"li",_className:"image",page:0,FBoptions:{},page_limit:20,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=d.to_html(this.template,{target:this.target_id});return this.$el.html(e),this},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){e.name?this.name=e.name:this.name="image list",this.renderTemplate(),this.FBoptions=e.FBOptions,this.pageName=e.pageName?e.pageName:"profile",e.collecton&&(this.collection=e.collection),this.data=e.data,this.controllerObject=e.controllerObject;var t=this;t.allData=this.collection.toArray();var n=t.allData.length;t.start=0,t.end=t.page_limit,t.page_limit=8,t.seeMore(),h.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");a.bindAll(this),this.addSubscribers()},seeMore:function(e){var t=this.allData.length;e&&(this.start=this.end,this.end=this.end+this.page_limit),t<=this.end&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(this.start,this.end)):this.collection.reset(this.allData.slice(this.start,this.end)),this.page++,e&&this.addSubscribers&&this.addSubscribers()},childViews:{}}),s}),define("fbinvite/views/image-list",["facade","utils","packages/fbinvite/views/image-list"],function(e,t,n){var r;return r=n.extend({imagetype:"large_thumb",name:"Image List",setupAddView:function(){}}),r}),define("fbinvite/collections/fbinvite",["facade","media/collections/images","utils","signup/views/facebooksignup"],function(e,t,n,r){return t.extend({url:function(){return testpath?testpath+"user/fbfriends":"/api/user/fbfriends"},fetchError:function(e,t){console.log(e,t),ga("send","event","popup","open","FB Auth Token Renew");if(!confirm("Your Facebook Authentication has timed out.  Want to try and renew it?"))return;var n=new r;n.signupFacebook("linkWithFB")}})}),define("pages/fbinvite",["require","text!fbinvite/templates/layout.html","facade","controller","models","views","utils","fbinvite/views/image-list","fbinvite/collections/fbinvite","media/models/image","signup/views/facebooksignup"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=o.LayoutView,f=r.$,l=r._,c=u.debug,h=u.lib.Channel,p=["/pages/registration/registration.css","/pages/signup/css/signupstyle.css","/css/style.jrac.css","pages/fbinvite/fbinvite.css"],d=e("fbinvite/views/image-list"),v=e("media/models/image"),m=e("fbinvite/collections/fbinvite"),g=e("signup/views/facebooksignup");return i.extend({initialize:function(e){return this.popup=e.popup?!0:!1,this.options=e.options,h("load:css").publish(p),l.bindAll(this),this.ajaxCalls=[],this.handleOptions(e),this.init(),this},init:function(){ga("send","event","FB Invite","Header","Loading reg header"),this.modelHTML='<div id="fbInvite" class="modal hide fade model-popup-h"><div class="closer"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">	&times;</button></div><div id="search-area" class=""><input type="search" class="search-friends-h" placeholder="Search your friends" /></div><div id="modalBody" class="modal-body page-content-h"></div></div>',this.setupLayout().render(),this.execRender()},execRender:function(){this.refreshPage(),this.createData(),this.handleDeferreds()},createData:function(){var e=this;this.images=new m,this.images.targetElement="#image-wrap-h",this.ajaxCalls.push(this.images.fetch({error:function(t,n){ga("send","event","popup","open","FB Auth Token Renew");if(confirm("Your Facebook Authentication has timed out.  Want to try and renew it?")){var r=new g;r.signupFacebook("linkWithFB",e.execRender)}else f("#fbInvite .close").trigger("click")}}))},handleDeferreds:function(){var e=this;f.when(this.images.request).done(function(){e.images.allRecords=e.images.toJSON(),e.setupFriendsList(),f(".search-friends-h").keyup(function(){var t=f(this).val(),n,r=new RegExp(t,"i"),i=e.images.allRecords.length,s=[];for(var n=0;n<i;n++)r.test(e.images.allRecords[n].payload.name)&&s.push(e.images.allRecords[n]),e.images.models[n]&&e.images.models[n].destroy();s.length&&(e.images.reset(s),e.setupFriendsList())})})},refreshPage:function(){var e;this.selectOrgView&&(f(this.selectOrgView.destination).html(""),e=f.inArray(this.selectOrgView,this.scheme),~e&&this.scheme.splice(e,1))},setupFriendsList:function(){var e=this,t;this.imageListView&&(f(this.imageListView.destination).html(""),t=f.inArray(this.imageListView,this.scheme),~t&&this.scheme.splice(t,1)),this.imageListView=new d({collection:this.images,destination:"#image-wrap-h",target_id:this.id,user_id:this.id,FBOptions:this.options,name:"images View 2"}),this.scheme.push(this.imageListView),this.layout.render()},setupLayout:function(){this.scheme=[],f("#fbInvite").modal("hide"),f(".model-popup-h").remove(),f("body").append(this.modelHTML);var e=new a({scheme:this.scheme,destination:"#modalBody",template:t,displayWhen:"ready"});return this.layout=e,f("#fbInvite").modal("show"),this.layout}})}),define("text!packages/common/templates/popup.html",[],function(){return'<div id="<%= popup.id %>" class="modal common-modal hide fade model-popup-h in">\r\n	<div class="modal-header">\r\n		<a href="javascript: void(0);" title="close" data-id="<%= popup.id %>" class="close">\r\n			&times;\r\n		</a>\r\n		<h3 class="modal-header-h">Header</h3>\r\n	</div>\r\n	<div class="modal-body page-content-h" id="modalBody"><%= popup.popup_content %></div>\r\n</div>'}),define("packages/common/views/popup",["require","text!packages/common/templates/popup.html","facade","views","utils","vendor"],function(e){var t=e("facade"),n=e("views"),r=n.SectionView,i=e("utils"),s=i.lib.Channel,o=e("vendor"),u=t._,a=t.$,f=n.BaseView,l=t.Backbone,c,h=e("text!packages/common/templates/popup.html");return f.extend({options:{},forceFullScreen:!1,initialize:function(e){this.processOptions(e)},processOptions:function(e){e.id?this.options.id=e.id:this.options.id="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50),this.options.addClass=e.addClass||[],e.fullPage&&this.options.addClass.push("full-page-modal"),this.options.title=e.title||"",this.options.width=e.width||"50%",this.options.height=e.height||"50%",console.log("Options HTML:",e.html),e.html&&e.html instanceof a?this.options.popup_content=e.html.html():e.html?this.options.popup_content=e.html:this.options.popup_content="<div></div>",this.forceFullScreen=document.documentElement.clientWidth<parseInt(this.options.width)?!0:!1,this.forceFullScreen&&(this.options.addClass.push("noBorder"),this.options.width="100%",this.options.height="100%"),this.render();var t=this,n=0,r=setTimeout(function(){n++,a("#"+t.options.id).length?(clearInterval(r),routing.popups===undefined&&(routing.popups=[]),routing.popups.push(a("#"+t.options.id)),t.processDimensions(),t.processStyle(),t.bindClose()):n>=20&&clearInterval(r)},200);s("popup-finished-launch-"+this.options.id).publish()},bindClose:function(){var e=this;routing.off("common-popup-close"),routing.on("common-popup-close",function(e){if(routing.popups.length){var t=routing.popups.shift();t.modal("hide").remove()}a(".common-modal").length||a(".modal-backdrop").fadeOut().remove()}),a("#"+this.options.id).find(".close").on("click",function(e){routing.trigger("common-popup-close")}),a(".modal-backdrop").off("click"),a(".modal-backdrop").on("click",function(e){routing.trigger("common-popup-close")})},processDimensions:function(){var e=this.options;if(e.width){a("#"+e.id).css({width:this.forceFullScreen?"100%":e.width});var t=parseInt(a("#"+e.id).css("borderLeftWidth"),10)+parseInt(a("#"+e.id).css("borderRightWidth"),10)+parseInt(a("#"+e.id).css("padding-left"),10)+parseInt(a("#"+e.id).css("padding-right"),10);console.log(t);var n;if(e.width.indexOf("%")>0){var r=parseInt(e.width,10);n=window.innerWidth*(r/100)+t}else n=parseInt(e.width,10)+t;if(e.width!="100%"){console.log(a(window).width(),n);var i=a(window).width()/2-n/2+"px"}else var i="0%";a("#"+e.id).css({left:i})}if(e.height){a("#"+e.id).css({height:this.forceFullScreen?"100%":e.height});var s=parseInt(a("#"+e.id).css("borderTopWidth"),10)+parseInt(a("#"+e.id).css("borderBottomWidth"),10)+parseInt(a("#"+e.id).css("padding-top"),10)+parseInt(a("#"+e.id).css("padding-bottom"),10),o;if(e.height.indexOf("%")>0){var r=parseInt(e.height,10);o=window.innerHeight*(r/100)+s}else o=parseInt(e.height,10)+s;if(e.height!="100%")var u=(a(window).height()-e.height.replace("px",""))/2-30+"px";else var u="0%";var f=a(window).height();a("#"+e.id).css({top:u,"margin-top":"0%"})}},render:function(){var e=u.template(h,{popup:this.options});a("body").append(e)},processStyle:function(){var e=this;this.options.addClass!=undefined&&this.options.addClass.length&&u.each(this.options.addClass,function(t){console.log(t),a("#"+e.options.id).addClass(t)}),this.options.background_image&&(console.log(this.options.background_image),a("#"+this.options.id).css({background:"url("+this.options.background_image+") no-repeat center center fixed #FFF","-webkit-background-size":"cover","-moz-background-size":"cover","-o-background-size":"cover","background-size":"cover"})),a("#"+this.options.id).css({margin:"0px"}),a("#"+this.options.id+" .close").attr("data-id",this.options.id),a("#"+this.options.id).find(".modal-header-h").html(this.options.title),a("#"+this.options.id).find(".modal-header").show(),a("#"+this.options.id).modal("show")}})}),define("application",["facade","utils","collections","chrome","controller","profile","imageup","home","videopreview","game","team","registration","profilesetting","userresume","packages/site/collections/phrases","usercontrols/tag/tag","usercontrols/addgame/addgame","signup","login","usercontrols/photo-player/photo-player","usercontrols/add-club/add-club","utils/storage","usercontrols/location/views/view-location","signup/views/facebooksignup","usercontrols/addevent/addevent","chrome/views/header","browserpop/views/browser","usercontrols/landing/views/landing","pages/fbinvite","packages/common/views/popup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){var C,k=n.ApplicationStates,L=e.$,A=e._,O=e.Backbone,M=t.lib.Channel,_=require("pages/fbinvite"),D=require("browserpop/views/browser"),P=require("browserpop/views/browser"),H=require("usercontrols/landing/views/landing");return debug=t.debug,C=O.Router.extend({routes:{"":"defaultRoute",fbinvite:"fbinvite","!fbinvite":"fbinvite","fbinvite/":"fbinvite","!fbinvite/":"fbinvite","acceptfbinvite/:id":"aceptInvite","!acceptfbinvite/:id":"aceptInvite","acceptfbinvite/:id/":"aceptInvite","!acceptfbinvite/:id":"aceptInvite",profile:"showProfile","profile/":"showProfile",team:"showTeam","team/":"showTeam","team/:id":"showTeam","!team/:id":"showTeam",game:"showGame","game/":"showGame","game/:id":"showGame","!game/:id":"showGame",home:"showHome","home/":"showHome","!home/":"showHome","!home":"showHome","!home/search":"showHomePage","!home/search/":"showHomePage","!home/search/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","home/search":"showHomePage","home/search/":"showHomePage","home/search/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/":"showHomePage","home/search/:key/:value/:key/:value/:key/:value":"showHomePage","home/search/:key/:value":"showHomePage","home/search/:key/:value/:key/:value":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage","!home/search/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value/:key/:value":"showHomePage",":page/:id/:param/:id/":"showPage",":page/:id/:param/:id/:param/:id/":"showPage",":page/:id/:param/:id":"showPage",":page/:id/:param/:id/:param/:id":"showPage",":page/:param/:id/":"showOwnPage",":page/:param/:id/:param/:id/":"showOwnPage",":page/:param/:id":"showOwnPage",":page/:param/:id/:param/:id":"showOwnPage","profile/:userid":"showProfile","!profile/:userid":"showProfile","!profile/":"showProfile","!profile":"showProfile",usersettings:"showProfileSetting","usersettings/":"showProfileSetting","!usersettings":"showProfileSetting","!usersettings/":"showProfileSetting",resume:"ShowUserResume","resume/":"ShowUserResume","!registration":"showRegistration","registration/":"showRegistration","!registration/:action":"showRegistration","registration/:action":"showRegistration","user/login":"showLogin",addgame:"showAddGame",logout:"callLogout","*splat":"routeNotFound"},showHomePage:function(){var e=[],t=arguments.length;if(arguments&&t)for(var n=0;n<t;n++)n%2==0&&e.push({key:arguments[n],value:arguments[n+1]});this.showHome&&A.isFunction(this.showHome)&&this.showHome(undefined,e)},routeNotFound:function(){routing.navigate("home",{trigger:!0})},showPage:function(e,t,n,r,i,s){if(n=="media"||i=="media")this.mediaPopup=!0;e.indexOf("!")!="-1"&&(e=e.replace("!",""));var o="show"+e.charAt(0).toUpperCase()+e.slice(1),u=[];n&&u.push({key:n+"_id",value:r}),i&&u.push({key:i+"_id",value:s}),this[o]&&A.isFunction(this[o])&&this[o](t,u)},showOwnPage:function(e,t,n,r,i){if(t=="media"||r=="media")this.mediaPopup=!0;e.indexOf("!")!="-1"&&(e=e.replace("!",""));var s="show"+e.charAt(0).toUpperCase()+e.slice(1),o=[];t&&o.push({key:t+"_id",value:n}),r&&o.push({key:r+"_id",value:i}),this[s]&&A.isFunction(this[s])&&this[s](undefined,o)},initialize:function(e){A.bindAll(this),this.addSubscribers(),i.prototype.appStates=new k,this.getPhrases()},detectBrowser:function(){var e=this,t=setInterval(function(){try{L.browser.android,clearInterval(t);var n=showMobileWindow=!1;if(L.browser.ipad||L.browser.iphone||L.browser.android)showMobileWindow=!0;!A.isUndefined(L.browser.msie)&&L.browser.msie&&parseInt(L.browser.version)<10&&(n=!0),!A.isUndefined(L.browser.version)&&L.browser.mozilla&&parseInt(L.browser.version)<25&&(n=!0),(n||showMobileWindow)&&e.showBrowserWindow()}catch(r){}},1e3)},showBrowserWindow:function(){var e=new D},showLandingInfo:function(){if(!routing.showLandingPage)return;var e=this;setTimeout(function(){if(!e.checkForUser())var t=new H},500)},aceptInvite:function(e){function n(n){L("body").addClass("fbaccept");var r="Athletez - We Are Athletes";setTimeout(function(){var t=new H({userId:e})},500),routing.showLandingPage=!1,!e&&L("div.register-wrapper-h").length==0&&L("body header").after('<div class="register-wrapper-h"></div>'),t.gaPageView("FB Accept - "+e,r),t.showHomePage(n)}var t=this;this.cancelAjaxRequests(),this.loadStyles(),r(),this.initialiRoutesInit(n)},getUserName:function(e){var t=new E("user","localStorage"),n;if(t.data)for(var r in t.data)if(r==e){n=t.data[r].user_name;break}return n?n:!1},intializeImageAndVideo:function(){this.imageUpListeners(),this.videoPreview(),this.showUsercreate(),this.showHomeRefresh(),this.showLogin(),this.triggerSignup()},cancelAjaxRequests:function(){if(typeof routing!="undefined"&&typeof routing.ajaxRequests!="undefined"&&routing.ajaxRequests.length)for(var e in routing.ajaxRequests)routing.ajaxRequests[e].abort()},initTriggers:function(){routing.off("photo-player-init"),routing.on("photo-player-init",function(e,t,n,r,i,s,o){var u=new b({index:e,userId:n,pageName:i,_collection:t,array:r,pageId:s,mediaId:o})}),routing.off("add-school-init"),routing.on("add-school-init",function(e,t,n,r,i,s){var o=new w({type:n,viewObj:r,callback:i,orgNameSoFar:s})});var e=undefined;routing.off("show_location"),routing.on("show_location",function(t,n,r,i){e=i;var s={latitude:t,longitude:n},o=new S(s);L(r).html(o.$el)}),routing.off("popup-close"),routing.on("popup-close",function(){L("#modalPopup").modal("hide"),L(".model-popup-h").remove(),e&&e()})},initialiRoutesInit:function(e,t){var n=this,r=function(){L(".modal:not(#Browser-detect)").remove(),routing.trigger("common-popup-close")};this.hideSignup(),L("body").removeClass("homePage"),routing.off("app-inited"),routing.on("app-inited",function(t){r(),e(t),n.mediaPopup||(n.showLandingInfo(),n.mediaPopup=!1)}),routing.off("fbInvite"),routing.on("fbInvite",function(e,t){console.log(t),n.showFBInviteOnPopup(e,t)}),routing.off("popup-close"),routing.on("popup-close",function(e){console.log(e),e?(L(e.currentTarget).modal("hide"),L(e.currentTarget).unbind().remove(),L(".modal-backdrop").unbind().fadeOut()):(L("#modalPopup").modal("hide"),L("#modalPopup").unbind().remove(),L(".modal-backdrop").unbind().fadeOut())}),routing.off("common-popup-open"),routing.on("common-popup-open",function(e){var t=require("packages/common/views/popup"),n=new t(e)}),L(document).off("hidden.bs.modal","#modalPopup, #photoPlayerModal"),L(document).on("hidden.bs.modal","#modalPopup, #photoPlayerModal",function(e){routing.trigger("popup-close",e)}),routing.off("add-game"),routing.on("add-game",function(e,t,n,r,i){var s=new m({teams_id:t,sports_id:n,user_id:r,id:e,popup:!0,callback:i})}),routing.off("add-event"),routing.on("add-event",function(e,t,n,r){var i=new T({sports_id:t,users_id:n,popup:!0,callback:r})}),routing.off("check-fb-login"),routing.on("check-fb-login",function(){fbregistration=new x,fbregistration.checkFbLogin("linkWithFB")}),routing.off("link-to-facebook"),routing.on("link-to-facebook",function(){ga("send","event","popup","open","FB Reg"),fbregistration=new x,fbregistration.signupFacebook("linkWithFB")}),this.detectBrowser()},checkForUser:function(){return!A.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},defaultRoute:function(){this.initApp()},initApp:function(e){ga("send","event","app","initialized","Browser Reload"),this.showHome(null)},getPhrases:function(){var e=new d;e.fetch()},showFbreg:function(){ga("send","event","popup","open","FB Reg"),fbregistration=new x,fbregistration.signupFacebook("linkWithFB")},gaPageView:function(e,t){ga("send","pageview",{page:e,title:t})},showHome:function(e,t){function i(e){L("body").addClass("homePage");var r="Athletez - We Are Athletes";n.currentController=new u({route:"",title:r,userId:e,params:t}),!e&&L("div.register-wrapper-h").length==0&&L("body header").after('</div><div class="register-wrapper-h"></div>'),n.gaPageView("Home Page",r)}var n=this;this.cancelAjaxRequests(),this.loadStyles(),r(),this.initialiRoutesInit(i)},showFBInviteOnPopup:function(e,t){var n="Athletez - We Are Athletes";self.currentController=new _({route:"",title:n,userId:e,options:t})},fbinvite:function(){function t(t){L("body").addClass("fbinvite");var n="Athletez - We Are Athletes";e.currentController=new _({route:"",title:n,userId:t}),!t&&L("div.register-wrapper-h").length==0&&L("body header").after('<div class="register-wrapper-h"></div>'),e.gaPageView("FB Invite",n)}var e=this;this.cancelAjaxRequests(),this.loadStyles(),r(),this.initialiRoutesInit(t)},removeCurrent:function(){this.currentController&&console.log(this.currentController.layout)},showProfileOurSport:function(e,t){this.showProfile(undefined,e,t)},showProfileOurSportAndPlayer:function(e,t,n,r){this.showProfile(undefined,e,t,n,r)},showUserProfileSport:function(e,t,n){this.showProfile(e,t,n)},showUserProfileSportAndMedia:function(e,t,n,r,i){this.showProfile(e,t,n,r,i)},showProfile:function(e,t){function i(r){M("refresh-profilepage").empty();var i=n.getUserName(r);n.currentController=new s({userId:typeof e!="undefined"?e:r,title:i,params:t}),n.gaPageView("Profile Page",i)}var n=this;this.cancelAjaxRequests(),n.loadStyles(),r(),this.initialiRoutesInit(i)},hideSignup:function(){L("div.register-wrapper-h").remove()},notFound:function(e){alert("Page not found")},showTeam:function(e,t){function i(r){n.currentController=new l({teamId:e,title:"Team Page",userId:r,params:t}),n.gaPageView("Team Page","NA")}var n=this;this.cancelAjaxRequests(),this.loadStyles(),r();if(!e){this.notFound("team");return}n.removeCurrent(),this.initialiRoutesInit(i)},imageUpListeners:function(){function e(e,t,n){var r=new o({route:"",url:e,attr:t,data:n})}this.addImageTrigger(e)},addImageTrigger:function(e){routing.off("add-image"),routing.on("add-image",function(t,n,r){this.checkForUser()?e(t,n,r):routing.trigger("showSignup",function(){e(t,n,r)})})},showProfileSetting:function(e){function n(n){self.currentController=new h({id:e==undefined?n:e,title:"Profile Settings"}),t.gaPageView("Profile Settings","NA")}this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent();var t=this;this.initialiRoutesInit(n)},ShowUserResume:function(e){function n(n){t.currentController=new p({id:e==undefined?n:e}),t.gaPageView("User Resume Page","NA")}var t=this;this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(n)},imageUp:function(){function e(e){var t=new o({route:"",url:this.posturl,attr:this.attribute})}this.cancelAjaxRequests(),this.loadStyles(),this.initialiRoutesInit(e)},triggerSignup:function(){this.signup=new N,routing.off("showSignup"),routing.on("showSignup",function(e){this.signup.signupUser&&this.signup.signupUser(e)})},videoPreview:function(){function t(t,n){e.checkForUser()?new a({url:t,attr:n}):routing.trigger("showSignup",function(){new a({url:t,attr:n})})}this.cancelAjaxRequests(),this.loadStyles();var e=this;M("add-video").subscribe(t)},showGame:function(e,t){function i(r){self.currentController=new f({route:"",gameId:e,title:"Game Page",userId:r,params:t}),n.gaPageView("Game Page","NA")}this.cancelAjaxRequests(),this.loadStyles(),r();if(!e){this.notFound("team");return}this.removeCurrent();var n=this;this.initialiRoutesInit(i)},showRegistration:function(){ga("send","event","popup","Registration")},showTag:function(e){function t(t){self.currentController=new v({id:e==undefined?t:e})}this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(t)},showAddGame:function(e){function t(t){self.currentController=new m({id:e==undefined?t:e})}ga("send","event","popup","Add Game","",e),this.cancelAjaxRequests(),this.loadStyles(),r(),this.removeCurrent(),this.initialiRoutesInit(t)},RefreshHome:function(){r()},showHomeRefresh:function(){this.addHomeTrigger(this.initApp)},addHomeTrigger:function(e){routing.off("reload-home"),routing.on("reload-home",function(){e()})},showLogin:function(){},showUsercreate:function(){function e(){}this.addUserTrigger(e)},addUserTrigger:function(e){routing.off("add-user"),routing.on("add-user",function(){e()})},loadStyles:function(){M("load:css").publish([base_url+"css/bootstrap.css",base_url+"css/bootstrap-responsive.css",base_url+"css/app.css",base_url+"css/common.css",base_url+"css/jquery-ui-1.10.2.custom.css",base_url+"css/form-fields.css"])},addSubscribers:function(){M("load:css").subscribe(this.loadCss)},removeSubscribers:function(){M("load:css").unsubscribe(this.loadCss)},callLogout:function(){ga("send","event","menu","Log Out","Action-Triggered",routing.userLoggedIn),this.logout=new y,routing.trigger("Logout")},getStoredState:function(e,t){var n,r;return n=this.states.findByNameInStorage(e),A.isString(t)&&n&&n.data&&(r=n.data[t]),r||n},show:function(e){e=e||"body",L(e).removeClass("hide")},hide:function(e){e=e||"body",L(e).addClass("hide")},cssLoaded:[],loadCss:function(e){var n,r;if(!A.isArray(e))throw new Error("App method addCss expects an array");for(n=0;n<e.length;n++)r=e[n],A.isString(r)&&L.inArray(r,this.cssLoaded)<0&&(t.lib.loadCss(r),this.cssLoaded.push(r))}}),C}),define("login/models/Loginmodel",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"api/user/login?time="+(new Date).getTime(),payload:{}}),t}),define("text!login/templates/logintemplate.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n<div id="regcontainer">\r\n	<div id="loginmain">\r\n		<div id="mainreg">\r\n			<div id="fbpane">\r\n				<div id="label">\r\n					Connect with Facebook\r\n				</div>\r\n				<div id="fblogo"><span></span></div>\r\n			</div>\r\n			<div class ="regor">\r\n				or\r\n			</div>\r\n			<div id="regpanemain">	\r\n				<form action="/user/login" method="post" accept-charset="utf-8">\r\n					<div id="firstregbase">\r\n						<!--<div class="loginbase">\r\n							<!--<label for="username">Email</label>-->\r\n							<input type="text" name="username" placeholder="Email Address" />\r\n							<!--<label for="password">Password</label>-->\r\n							<input type="password" name="password" placeholder="Password" />\r\n							<div class="loguser">\r\n								<input type="checkbox" name="remember" />\r\n								<label for="remember">Remember Me</label>\r\n								\r\n								<p>(Remember Me keeps you logged in for 2 weeks)</p>\r\n							</div>	\r\n						<!--</div>-->	\r\n						<div class="errormsg"></div>\r\n						\r\n						<button type="button" class=" loginUser btn btn-primary">Login</button>\r\n						<div class="addsub">\r\n							<button type="button"  class="forgot-password-h btn btn-info btn-sm btn-custom" >Forgot My Password</button>\r\n							\r\n							<button type="button"  id= "signup" class=" btn btn-info btn-sm btn-custom" >create a new account</button>\r\n							\r\n						</div>				\r\n					</div>\r\n					\r\n					\r\n				</form>\r\n				\r\n			</div>\r\n			\r\n	\r\n		</div>\r\n\r\n	</div>\r\n	\r\n</div>\r\n\r\n<div class="forgot-password-container hide">\r\n	<div class="success-message hide">Password Reset link has been sent to your email address. Please check.</div>\r\n	<div class="error-message errormsg hide">Sorry we couldn\'t find the match record. Please try again with valid Email.</div>	\r\n	<form action="" method="POST" class="forgot-password-form-h">\r\n		<!--<label for="">Email</label>-->\r\n		<div id="firstregbase">\r\n			<input type="email" name="forgot_password_email" class="forgot-password-email-h" placeholder="Email Address" />\r\n			<button type="submit" name="forgot-password-btn" class="forgot-pasword-btn-h btn btn-default addsub" > Request Password </button>\r\n			<button type="button" class="log-in-link-h btn btn-default btn-sm addsub" >&nbsp;Log In &nbsp;</button>\r\n		</div>\r\n		<!--<br/>\r\n		<input type="submit" name="forgot-password-btn" class="forgot-pasword-btn-h btn btn-default" value="Request Password" />\r\n		<br/><br/>!-->\r\n		<!--<p><a class="log-in-link-h" href="javascript: void(0);"> Log In</a></p>-->\r\n	</form>\r\n</div>'}),define("login/models/Forgotmodel",["models/base"],function(e){return e.extend({defaults:{},email:undefined,url:function(){return"api/user/pw_reset?email="+encodeURIComponent(this.email)},payload:{}})}),define("login/views/Loginview",["require","text!login/templates/logintemplate.html","backbone","underscore","signup","views","facade","utils","login/models/Forgotmodel","signup/views/facebooksignup"],function(e,t,n,r,i){var s,o=e("facade"),u=e("views"),a=e("utils"),f=a.lib.Channel,l=e("login/models/Forgotmodel"),c=e("signup/views/facebooksignup"),h=n.View;return SigninBasicView=h.extend({initialize:function(e){this.callback=e.callback,this.signcontroller=new i,this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),$("#errormsg, #preview").html(""),debug.log("Image upload basic view"),$("#Loginview").modal("show"),$("#Loginview").on("hide",function(){$("div#LoginPopup").empty()})},events:{"click button#signup":"signupUser","click .loginUser":"userLogin","click .forgot-password-h":"forgotPassword","submit .forgot-password-form-h":"forgotPasswordForm","click .log-in-link-h":"loginPageView","click #fbpane":"signupFacebook"},forgotPasswordForm:function(e){e.preventDefault();var t=this,n=new l;n.email=$(e.target).find(".forgot-password-email-h").val(),n.save({email:n.email}),$.when(n.request).done(function(){t.$el.find(".success-message").removeClass("hide"),t.$el.find(".error-message").addClass("hide"),setTimeout(function(){t.loginPageView()},3e3)}),$.when(n.request).fail(function(){t.$el.find(".error-message").removeClass("hide"),t.$el.find(".success-message").addClass("hide")})},signupFacebook:function(e){e.preventDefault(),$("#RegModal").modal("hide"),headView=new c({callback:this.callback}),headView.signupFacebook()},userLogin:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=[],i=this;$.each(t,function(e,t){n[t.name]=t.value});var s=$.extend({},n);this.model.save(s,{success:function(e){$("#Loginview").modal("hide"),i.callback&&r.isFunction(i.callback)?(routing.trigger("common-popup-close"),App.header&&App.header.render(!0),i.callback(function(){})):window.location.href="#profile"},error:function(e){$(".errormsg").empty();var t=jQuery.parseJSON(e.request.responseText);$(".errormsg").html(t.exec_data.error_array[0].error)}})},forgotPassword:function(e){e.preventDefault(),this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Forgot Password"),$("#loginmain").addClass("hide"),$(".forgot-password-container").removeClass("hide")},loginPageView:function(){this.$el.find(".success-message").addClass("hide"),this.$el.find(".error-message").addClass("hide"),$("#Loginview h3#label").html("Login"),$("#loginmain").removeClass("hide"),$(".forgot-password-container").addClass("hide")},signupUser:function(e){e.preventDefault(),routing.trigger("common-popup-close"),routing.trigger("register-basic",this.callback)}}),SigninBasicView}),define("login/models/Logoutmodel",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"/api/user/logout?time="+(new Date).getTime(),payload:{}}),t}),define("login",["require","text!login/templates/layout.html","application","facade","controller","models","views","utils","login/models/Loginmodel","login/views/Loginview","login/models/Logoutmodel"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("login/models/Loginmodel"),l=e("login/views/Loginview"),c=e("login/models/Logoutmodel"),h=u.LayoutView,p=i.$,d=i._,v=a.debug,m=a.lib.Channel,g=["/pages/imageup/imageup.css"];return LoginController=s.extend({initialize:function(e){return m("load:css").publish(g),this.callback=e.callback,d.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.refreshPage(),this.setupLayout(),this.createData(),this.refreshPage(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],pageLayout=new h({scheme:this.scheme,destination:"#LoginPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.login_type=new f},refreshPage:function(){this.loginView&&(p(this.loginView.destination).html(""),position=p.inArray(this.loginView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){p("#imgUploadModal").modal("show"),p("#imgUploadModal").on("hidden",function(){}),p("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){var e=this;routing.off("Login"),routing.on("Login",function(){e.setupLoginView()}),routing.off("Logout"),routing.on("Logout",function(t){e.setupLogout(t)})},setupLogout:function(e){var t=this;this.logoutcheck=new c,this.logoutcheck.fetch(),p.when(this.logoutcheck.request).done(function(){e!=undefined&&e.clear(),window.localStorage.clear(),location.href="/"})},setupLoginView:function(){var e="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50),t="#"+e+" #modalBody",n={};n.height="500px",n.width="600px",n.title="Log Into Athletez",n.id=e,routing.trigger("common-popup-open",n),this.loginView=new l({model:this.login_type,name:"Login View",destination:t,callback:this.callback})}}),LoginController});