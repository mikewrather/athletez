define(["require","text!login/templates/layout.html","application","facade","controller","models","views","utils","login/models/Loginmodel","login/views/Loginview","login/models/Logoutmodel"],function(e,t,n){var r,i=e("facade"),s=e("controller"),o=e("models"),u=e("views"),a=e("utils"),f=e("login/models/Loginmodel"),l=e("login/views/Loginview"),c=e("login/models/Logoutmodel"),h=u.LayoutView,p=i.$,d=i._,v=a.debug,m=a.lib.Channel,g=["/pages/imageup/imageup.css"];return LoginController=s.extend({initialize:function(e){return m("load:css").publish(g),d.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.refreshPage(),this.setupLayout(),this.createData(),this.refreshPage(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],p("div#LoginPopup").remove(),p("body").append('<div id="LoginPopup"></div>'),pageLayout=new h({scheme:this.scheme,destination:"#LoginPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.login_type=new f},refreshPage:function(){this.loginView&&(p(this.loginView.destination).html(""),position=p.inArray(this.loginView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){p("#imgUploadModal").modal("show"),p("#imgUploadModal").on("hidden",function(){}),p("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){var e=this;routing.off("Login"),routing.on("Login",function(){e.setupLoginView()}),routing.off("Logout"),routing.on("Logout",function(t){e.setupLogout(t)})},setupLogout:function(e){var t=this;this.logoutcheck=new c,this.logoutcheck.fetch(),p.when(this.logoutcheck.request).done(function(){e.clear(),location.href="/"})},setupLoginView:function(){this.loginView=new l({model:this.login_type,name:"Login View",destination:"#main-content-reg"}),this.scheme.push(this.selectTypeView),this.layout.render()}}),LoginController});