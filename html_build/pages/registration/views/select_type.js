define(["require","registration/models/select_type","text!registration/templates/select_type.html","facade","views","utils"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView;return r=a.extend({id:"main-content",events:{"click .register_facebook":"registerWithFacebook","click .register_email":"registerWithEmail","click .go_club":"selectOrg"},template:n,initialize:function(e){a.prototype.initialize.call(this,e),this.initModel()},registerWithFacebook:function(e){function t(){FB.login(function(e){e.authResponse?u("registration-with-facebook").publish():alert("Cancelled")},{scope:"email, user_birthday, user_photos"})}function n(){var e,n="facebook-jssdk",r=document.getElementsByTagName("script")[0];if(document.getElementById(n)){t();return}e=document.createElement("script"),e.id=n,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(e,r)}e.preventDefault(),window.fbAsyncInit=function(){FB.init({appId:"239430712864961",status:!0,cookie:!0,xfbml:!0,oauth:!0}),FB.getLoginStatus(function(e){e.status==="connected"?FB.api("/me",function(e){u("registration-with-facebook").publish()}):e.status==="not_authorized"?t():t()},{scope:"email, user_birthday, user_photos"})},n()},registerWithEmail:function(e){e.preventDefault(),u("registration-with-email").publish()},initModel:function(){function n(n){e.select_type=new t,e.select_type.id=n,e.select_type.fetch(),$.when(e.select_type.request).done(function(){e.model=e.select_type})}var e=this;u("app-inited").subscribe(n)},selectOrg:function(e){e.preventDefault();var t=this,n=t.model.get("payload");u("registration-select-org").publish(n)}}),r});