define(["facade","utils","registration/views/fbimage-item","media/views/image-list","registration/views/fbimage-board","registration/views/picture_buttons","models/base"],function(e,t,n,r,i,s,o){var u,a=e._;return u=r.extend({id:"fbimage-list",name:"Facebook Image List",tagName:"div",_tagName:"div",_className:"fbimage",_view:n,setupAddView:function(){console.log("setup Addview");var e=this,t=new s,n=this.addChildView(t);this.childViews.buttons=t,this.callbacks.add(function(){n(),t.render(),e.$el.append(t.el)})},setupBoardView:function(){function r(){var t=e.childViews.board;t.getImageInfo();var n=t.model.get("payload"),r=new o(n);r.url=function(){return testpath?testpath+"/user/savecrop":"/api/user/savecrop"},r.saveSuccess=function(t,n){o.prototype.saveSuccess.call(this,t,n);var r=t.get("exec_data"),i=t.get("payload");!r.exec_error&&i&&Channel("registration-change-picture").publish(i.image_path),$("#"+e.id).dialog("close")},r.saveError=function(t,n){o.prototype.saveError.call(this,t,n),$("#"+e.id).dialog("close")},r.save()}function s(){$("#"+e.id).dialog("close")}console.log("setup Board View"),console.log(this.collection),console.log(this.collection.at(0));var e=this,t=new i({collection:this.collection,model:this.collection.at(0)}),n=this.addChildView(t);this.childViews.board=t,this.callbacks.add(function(){t.render(),e.$el.prepend(t.el),a.delay(t.initCropView,400)}),Channel("changeimage"+this.collection.id).subscribe(this.changeBoard),Channel("registration-use-image").subscribe(r),Channel("registration-upload-image").subscribe(s)},changeBoard:function(e){console.log("changeBoard"),console.log(e),this.removeCropView(),this.childViews.board.model=e,this.childViews.board.render(),this.childViews.board.initCropView()},initCropView:function(){this.childViews.board.initCropView()},removeCropView:function(){this.childViews.board.removeCropView()}}),u});