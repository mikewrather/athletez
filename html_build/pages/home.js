/**
 * @license RequireJS text 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.1.0
 *
 */

/* jQuery Resize And Crop (jrac)
 * A jQuery 1.4+ and jQueryUi 1.8+ plugin under GNU GENERAL PUBLIC LICENSE version 2 lisense.
 * Copyright (c) 2011 Cedric Gampert - cgampert@gmail.com
 */

define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.4",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!pages/home/templates/layout.html",[],function(){return'<div class="template-container">\r\n	<div id="main-header"></div>\r\n	<div id="main-content" class="row-fluid">\r\n		<div class="green-left-heading">\r\n			Top Rated\r\n		</div>\r\n		<div id="top-rated" class="p-l-20 clearfix clear"></div>\r\n\r\n		<div id="menu" class="p-l-20 clear"></div>\r\n		<div class="search-result-outer">\r\n			<div id="search-result" class="p-l-20 clear"></div>\r\n			<a href="javascript: void(0);" class="left-arrow-page home-page-arrow left-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/left_arrow.png">\r\n			</a>\r\n			<a href="javascript: void(0);" class="right-arrow-page home-page-arrow right-arrow-page-h">\r\n				<img src="http://cdn.athletez.com/resources/img/right_arrow.png">\r\n			</a>\r\n		</div>\r\n	</div>\r\n	<div id="main-footer"></div>\r\n</div>'}),define("controller",["facade","collections","models","utils"],function(e,t,n,r){var i,s=t.ApplicationStates,o=n.EventModel,u=e._,a=e.$,f=r.lib.Channel,l=e.Backbone.Model.extend;return i=function(e){e=e||{},e.title?document.title=e.title:document.title="Athletez",this.route=e.route,i.prototype.appStates?e.appStates&&(i.prototype.appStates=e.appStates):i.prototype.appStates=new s,this.route&&i.prototype.appStates&&this.getStoredState(),this.initialize(e)},i.extend=l,i.prototype={initialize:function(e){return this.triggerPublishers(),u.bindAll(this),this.handleOptions(e),this.addSubscribers(),this.handleDeferreds(),this},generateRandomNumber:function(){var e=(new Date).getTime();return e+=Math.floor(Math.random()*200+1),e},setupSections:function(){},setupScheme:function(){},setupLayout:function(){var e;return this.layout=e,this.layout},handleDeferreds:function(){var e=this;a.when(null).then(function(){})},addSubscribers:function(){},removeSubscribers:function(){},triggerPublishers:function(){},meta:{activeViews:[],viewNames:[]},handleOptions:function(e){i.prototype.handleOptions(e)},routeChange:function(e){i.prototype.routeChange(options)},addStateChangeSubscriber:null},i.prototype.data=null,i.prototype.layout=null,i.prototype.scheme=[],i.prototype.sections={},i.prototype.route=null,i.prototype.handleOptions=function(e){e&&e.useFixtures&&this.useFixturesForWebServices()},i.prototype.transitionActiveViews=function(e){var t,n=this.layout,r=this.meta.sectionName,i=this.meta.activeViews=[];e=e||this.meta.presentation,t=function(t,s){s===e&&(t.state()==="not-rendered"&&t.render(),n.transition(r,t),i.push(s))},this.iterateOverLayoutViews(t)},i.prototype.renderInActiveViews=function(){var e;e=function(e){e.state()==="not-rendered"&&(e.callbacks.add(function(){e.state("not-displayed")}),e.render())},this.iterateOverLayoutViews(e)},i.prototype.iterateOverLayoutViews=function(e){var t=this.meta.activeViews,n=this.sections,r=this.meta.viewNames,i,s,o;for(o=0;o<r.length;o++)i=r[o],u.contains(t,i)||(s=n[i],e&&u.isFunction(e)&&e(s,i))},i.prototype.routeChange=function(e,t,n){var r={data:{}},s;if(e&&!u.isString(e))throw s="Controller routeChange expects string as 1st argument.",new Error(s);this.route=e,this.layout&&(this.layout.state({route:e}),r.data=this.layout.state(),u.extend(r,t||{}),i.prototype.appStates.add(r),this.data=r.data,debug.log(r),i.prototype.appStates.save(e)),n&&u.isFunction(n)&&n(this.data),debug.log("Controller routeChange method called with: "+e)},i.prototype.getStoredState=function(){var e;if(!this.route)throw new Error("Controller does not have route property.");return e=i.prototype.appStates.findInCollectionOrStorage(this.route),this.data=e&&e.data?e.data:e,this.data},i.prototype.addStateChangeSubscriber=function(e,t){function s(r,s){var o=e,a=t,f=n,l;f.layout&&(l=f.layout.state(),l&&i.prototype.appStates.add({name:f.route,data:l,expires:new Date(Date.now()+4032e4),storage:"localStorage"})),a&&u.isFunction(a)&&a(r,s)}var n=this,r;if(!e||!u.isString(e))throw r="controller method addStateChangeSubscriber expected string as 1st argument.",new Error(r);f(e+":stateChanged").subscribe(s)},i.prototype.remove=function(){var e;this.layout&&this.layout.remove();for(e in this)delete this[e]},i.prototype.webServices={},i.prototype.useFixturesForWebServices=function(){},i}),define("pages/home/models/menu",["models"],function(e){var t,n=e.BaseModel;return t=n.extend({defaults:{name:null,views:{browse:[{name:"VOTES",value:"votes"},{name:"RECENT",value:"newest"},{name:"FANS",value:"followers"}],time:[{name:"TODAY",value:"DAY"},{name:"THIS WEEK",value:"WEEK"},{name:"THIS MONTH",value:"MONTH"},{name:"ALL TIME",value:"YEAR"}]}}}),t}),define("packages/location/models/city",["models","facade"],function(e,t){var n,r=e.BaseModel,s=t.$,o=t._;return n=r.extend({defaults:{name:null},initialize:function(e,t){this.id=this.id||o.uniqueId("m"),this.addSubscribers(),o.bindAll(this)},search:function(e){this.request&&this.request.abort(),this.request=s.ajax({url:"/api/location/search/?search_text="+e}).done(function(t,n,r){var s=[],u=t.payload;if(u!=null)for(i=0;i<(u.length>10?10:u.length);i++){var a={};a.label=u[i].str,a.id=u[i].id;var f=o.isUndefined(u[i].obj.states_obj)?!o.isUndefined(u[i].obj.city)&&!o.isUndefined(u[i].obj.city.states_obj)?u[i].obj.city.states_obj:{}:u[i].obj.states_obj;a.state_id=f.id,a.country_id=o.isUndefined(f.country)?"":f.country.id,s.push(a)}Channel("response :"+e).publish(s)})},addSubscribers:function(){var e=this;Channel("changeInput"+this.id).subscribe(e.search)}}),n}),define("signup/models/registerbasic",["models/base"],function(e){var t;return t=e.extend({defaults:{},validate:function(e,t){if(e.priority<0)return"Priority cannot be negative."},validation:{email:{required:!0,pattern:"email",msg:"Please enter a valid email"}}}),t}),define("sport/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{sport_id:0,sport_name:null,sport_type:null},desc:"Sport Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("packages/sport/collections/sports",["require","sport/models/sport","facade","collections","utils"],function(e,t){var n,r=e("utils"),s=e("facade"),o=e("collections"),u=r.debug,a=o.BaseCollection,f=s._;return n=a.extend({model:t,url:function(){var e="/api/sport/listall?",t=this.name||"boys",n="";switch(t){case"boys":n="male=1";break;case"both":n="male=1&";case"girls":n+="female=1"}return e+n},initialize:function(e,t){this.url=t.url||this.url,this.name=t.name,a.prototype.initialize.call(this,e,t)},fetchSuccess:function(e,n){e.reset();var r=n.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new t;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",n.desc),s.set("exec_data",n.exec_data),e.push(s)}e.deferred.resolve(n)}}),n}),define("pages/home/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("pages/home/collections/image",["facade","collections","pages/home/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,initialize:function(e,t){debug.log("HomeImageList initialize..."),this.cid=this.cid||o.uniqueId("c"),this.deferred=new $.Deferred,this.num=t.num},fetchSuccess:function(e,t){var r=o.first(t.payload,e.num);e.reset();for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("location/models/state",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{location_id:0,location_name:null,location_country:null},desc:"State Information",exec_data:{exec_time:0,exec_error:!1}})}),n}),define("location/collections/states",["facade","collections","location/models/state","utils"],function(e,t,n,r){var s,o=t.BaseCollection,u=e._,a=r.lib.Channel;return s=o.extend({model:n,url:function(){return testpath?testpath+"/state_search":this.state_name==undefined?"/api/state/search":"/api/state/search/?state_name="+this.state_name},fetchSuccess:function(e,t){e.reset();var r=t.payload;if(r!=null)for(i=0;i<r.length;i++){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t)},isError:function(){return!1}}),s}),define("text!pages/home/templates/menu.html",[],function(){return'<div class="demo-select">\r\n\r\n</div>\r\n<div class="menu-outer-h">\r\n\r\n	<div id="resulttype" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h restype-link-h"><span class="option-heading-h">Athletes</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h restype-options-h">\r\n\r\n			<div class="clearfix"></div>\r\n			<ul class="dropdown-menu" style="display: block; position: relative;">\r\n				<li><a id="user" class="restype" data-number="2" href="javascript:void(0)">Athletes</a></li>\r\n				<li><a id="image" class="restype" data-number="1" href="javascript:void(0)">Images</a></li>\r\n				<li><a id="video" class="restype"  data-number="0" href="javascript:void(0)">Videos</a></li>\r\n				<li><a id="game" class="restype" data-number="3" href="javascript:void(0)">Games</a></li>\r\n			</ul>\r\n		</div>\r\n	</div>\r\n	<div id="sport" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h sport-link-h">\r\n			<span class="option-heading-h">ALL SPORTS</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-sport-area-h sports-option-h">\r\n			<a href="javascript: void(0);" class="btn sport-reset-btn-h">Reset</a>\r\n\r\n			<div class="left text-center">\r\n				<strong>Guys</strong>\r\n\r\n				<div id=\'boys\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Girls</strong>\r\n\r\n				<div id=\'girls\' class="text-left sport-list"></div>\r\n			</div>\r\n			<div class="left text-center">\r\n				<strong>Both</strong>\r\n\r\n				<div id=\'both\' class="text-left sport-list"></div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div id="location" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h location-link-h"> <span class="option-heading-h">ANYWHERE</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-location-area-h">\r\n			<a href="javascript: void(0);" class="btn location-reset-btn-h">Reset</a>\r\n			<!--div class="state"></div-->\r\n			<div class="city"></div>\r\n		</div>\r\n	</div>\r\n\r\n	<div id="views" class="menu span3">\r\n		<a href="javascript:void(0)" class="menu-link-h view-link-h"><span class="option-heading-h">ORDER</span>\r\n\r\n			<div class="caret-large-container">\r\n				<span class="caret-large"></span>\r\n			</div>\r\n		</a>\r\n\r\n		<div class="dd menu-detail-h reset-view-area-h view-options-h">\r\n			<a href="javascript: void(0);" class="btn views-reset-btn-h">Reset</a>\r\n\r\n			<div class="dropdown">\r\n				<span> SORT BY</span>\r\n\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative; margin-bottom:15px;">\r\n					{{#views.browse}}\r\n					<li><a class="browse" data-id="{{value}}" href="javascript:void(0);">{{name}}</a></li>\r\n					{{/views.browse}}\r\n				</ul>\r\n			</div>\r\n			<br/>\r\n\r\n			<div class="clearfix">\r\n				<span>TIME FRAME</span>\r\n\r\n				<div class="clearfix"></div>\r\n				<ul class="dropdown-menu dropdown-menu-alias" style="display: block; position: relative;">\r\n					{{#views.time}}\r\n					<li><a class="time" data-id="{{value}}" href="javascript: void(0)">{{name}}</a></li>\r\n					{{/views.time}}\r\n				</ul>\r\n			</div>\r\n		</div>\r\n	</div>\r\n\r\n\r\n\r\n\r\n\r\n	<div class="pull-right search-box">\r\n		<input type="text" id="search" placeholder="SEARCH"/><a>Search</a>\r\n	</div>\r\n\r\n\r\n\r\n</div>\r\n<!--<div class="pull-left type-icons">\r\n	<a id="video" class="searchBtn" data-number="0" href="javascript:void(0)"><i class="icon-facetime-video"></i>Videos</a>\r\n	<a id="image" class="searchBtn" data-number="1" href="javascript:void(0)"><i class="icon-picture"></i>Images</a>\r\n	<a id="user" class="searchBtn" data-number="2" href="javascript:void(0)"><i class="icon-user"></i>Athletes</a>\r\n	<a id="game" class="searchBtn" data-number="3" href="javascript:void(0)"><i class="icon-user"></i>Games</a>\r\n</div>-->'}),define("pages/home/views/menu",["require","text!pages/home/templates/menu.html","facade","views"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView;return n=s.extend({id:"menu",events:{"blur #search":"updateSearch","focus #search":"hideDropdown","click .restype":"changeBaseUrl","click .dropdown-menu-alias > li > a":"select","click .dd":"doNothing","click .menu-link-h":"showMenuDropdown","click .views-reset-btn-h":"resetView","click .sport-reset-btn-h":"resetSport","click .location-reset-btn-h":"resetLocation"},demoSelect:function(){},resetView:function(){var e="view";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-view-area-h ul li a.select, .reset-view-area-h ul li.select").removeClass("select")},resetSport:function(){var e="sports";Channel("resetFilter").publish(e),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-sport-area-h ul li a.select, .reset-sport-area-h ul li.select").removeClass("select")},resetLocation:function(){var e="location";Channel("resetFilter").publish(e),this.$el.find("#city").val(""),this.$el.find(".menu-detail-h").hide(),this.$el.find(".reset-location-area-h ul li a.select, .reset-location-area-h ul li.select").removeClass("select")},template:t,intialize:function(e){s.prototype.initialize.call(this,e),console.log("intializwe menu view ----------->>>")},updateSearch:function(e){Channel("textChanged").publish($(e.target).val())},changeBaseUrl:function(e){var t=$(e.currentTarget);t.parents("ul").find(".restype").removeClass("select"),t.addClass("select");var n=t.data("number");Channel("baseUrlChanged").publish(n)},stateListChange:function(e){var t=$(e.currentTarget).val();console.log(t);var n=t.data("id");routing.trigger("stateChanged",n)},doNothing:function(e){e.preventDefault(),e.stopPropagation()},hideDropdown:function(){this.$el.find(".menu-detail-h").hide()},hideAllDropdowns:function(){var e=this;$("html, #search").click(function(t){try{console.log($(t.target).parents("#views").length)}catch(t){console={},console.log=function(e){}}$(t.target).parents(".menu").length||e.hideDropdown()})},showMenuDropdown:function(e){var t=$(e.currentTarget).next();t.css("display")=="none"?(this.$el.find(".menu-detail-h").hide(),t.show()):t.hide()},select:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),n=t.attr("class");$(".dropdown-menu > li > a."+n).removeClass("select"),n=t.attr("class").split(" ")[0],$(t).addClass("select");var r={submenu:n,value:$(t).data("id")||$(t).text()};Channel("viewFilterChanged").publish(r),debug.log(r)},toggle:function(e){e.preventDefault();var t=$(e.currentTarget),n=$(t).offset(),r=n.top+40,i=n.left+10,s=t.attr("id");s="#"+s+" .dd",$(s).attr("class")==="dd open"?$(s).hide().removeClass("open"):($(".open").hide().removeClass("open"),$(s).css("top",r).css("left",i),$(s).show(),$(s).addClass("open"))},afterRender:function(){this.hideAllDropdowns();var e=this.model.toJSON();try{console.error(e.views)}catch(t){console={},console.log=function(e){}}}}),n}),define("text!media/templates/image-item.html",[],function(){return'<a href="{{_link}}" data-index="{{index}}" class="image-outer-h {{^_has_link}}open-photo-player-h{{/_has_link}}">\r\n	<div class="image-item-container">\r\n	<img class="list-thumbnail" src="{{_thumbnail}}" alt=""/>\r\n		<div class="action-section">\r\n			{{#show_edit}}\r\n				<div class="action-block left-block edit edit-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>edit</span></div>\r\n				<div class="action-block right-block delete delete-h" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>delete</span></div>\r\n			{{/show_edit}}\r\n			{{^show_edit}}\r\n				<div class="action-block left-block vote vote-h {{#_has_voted}} link-disabled {{/_has_voted}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}">\r\n					<span>vote</span>\r\n				</div>\r\n				{{#_can_follow}}\r\n				<div class="action-block right-block follow follow-h {{#_is_following}} link-disabled {{/_is_following}}" subject-type-id="{{_enttypes_id}}" subject-id="{{_id}}"><span>follow</span></div>\r\n				{{/_can_follow}}\r\n			{{/show_edit}}\r\n		</div>\r\n		<div class="detail-view {{#_detailclass}}{{_detailclass}}{{/_detailclass}}">\r\n			<h6>{{_label}}</h6>\r\n			<span>{{& _sublabel}}</span>\r\n		</div>\r\n	</div>\r\n</a>'}),define("votes/models/vote",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/vote/add?subject_type_id="+this.entity_id+"&subject_id="+this.userId},setData:function(){this.set({subject_type_id:this.entity_id,subject_id:this.userId})}}),n}),define("votes/models/follow",["models","facade"],function(e,t){var n,r=e.BaseModel,i=t.$,s=t._;return n=r.extend({url:function(){return base_url+"api/ent/follow/"+this.entity_id+"/"+this.userId}}),n}),define("media/views/image-item",["vendor","views","utils","text!media/templates/image-item.html","votes/models/vote","votes/models/follow","utils/storage"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache,a=require("votes/models/vote"),f=require("utils/storage"),l=require("votes/models/follow"),i=o.extend({tagName:"li",className:"image",events:{"click .vote-h":"vote","click .follow-h":"follow","click .edit-h":"edit","click .delete-h":"delete"},initialize:function(e){this.template=r},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},render:function(){function b(e){console.log(s(this),e)}var e=this,t=this.model.attributes.payload,n={_enttypes_id:t.enttypes_id,_id:t.id,_has_voted:t.has_voted,_is_following:t.is_following,_can_follow:t.can_follow},r=!1,i=null,o=function(e){return e=e.toLowerCase(),e.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},a=!1;switch(t.enttypes_id){case"23":typeof t.standard_thumb=="object"?(i=t.standard_thumb,n._thumbnail=i.url):n._thumbnail=t.thumbs,a=!0,n._label=t.media.name,n._link="javascript: void(0);",n._has_link=!1,t.media.hasOwnProperty("is_owner")&&(r=t.media.is_owner);break;case"21":typeof t.types=="object"&&(typeof t.types.standard_thumb=="object"?(i=t.types.standard_thumb,n._thumbnail=i.url):typeof t.types.large_thumb=="object"?(i=t.types.large_thumb,n._thumbnail=i.url):typeof t.types.original=="object"&&(i=t.types.original,n._thumbnail=i.url)),n._label=_.isUndefined(t.media_obj.users_obj.label)?"":t.media_obj.users_obj.label,typeof t.media_obj.sports_obj=="object"&&(n._sublabel=o(t.media_obj.sports_obj.sport_name)),n._link="javascript: void(0);",n._has_link=!1,t.media_obj.hasOwnProperty("is_owner")&&(r=t.media_obj.is_owner);break;case"1":typeof t.user_picture_obj=="object"&&typeof t.user_picture_obj.types=="object"&&(typeof t.user_picture_obj.types.standard_thumb=="object"?(i=t.user_picture_obj.types.standard_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.large_thumb=="object"?(i=t.user_picture_obj.types.large_thumb,n._thumbnail=i.url):typeof t.user_picture_obj.types.original=="object"&&(i=t.user_picture_obj.types.original,n._thumbnail=i.url)),n._label=t.label,n._sublabel="Votes: "+t.num_votes+", Followers: "+t.num_followers,n._link="/#profile/"+t.id,n._has_link=!0,t.hasOwnProperty("is_owner")&&(r=t.is_owner);break;case"8":n._detailclass="game",i=t.game_picture!==null?t.game_picture.types.standard_thumb:{height:440,width:440,url:"http://cdn.athletez.com/resources/icons/game/square_game.png"},n._thumbnail=i.url,n._label=t.game_day,n._link="/#game/"+t.id,n._has_link=!0;var f="",l=t.teams;if(l!=null)var c=l.length;for(var h=0;h<c;h++)f+="<span>",f+=o(t.teams[h].team_name),f+="</span>",h+1<t.teams.length&&(f+=" VS. ");t.hasOwnProperty("is_owner")&&(r=t.is_owner),n._sublabel=f}n.show_edit=r==1?!0:undefined;var p=u.to_html(this.template,n);this.$el.html(p);var d="120px",v="92px";this.$el.find(".image-outer-h").mouseout(function(){s(this).find(".action-block").css({opacity:0}),s(this).find(".detail-view").css({bottom:"-"+v}),s(this).find(".detail-view.game").css({bottom:"-"+d})});if(i!="undefined"&&i!=null){var m=i.width/220,g=i.height/220;i.width=parseInt(i.width),i.height=parseInt(i.height);var y=i.width>i.height?-(i.width/g-220)/2:-(i.height/m-220)/2;y>0&&(y=0),i.width>i.height?this.$el.find("img.list-thumbnail").css({"max-width":i.width/g,left:y}):this.$el.find("img.list-thumbnail").css({"max-height":i.height/m,top:y})}return a&&this.$el.append('<div class="circle open-photo-player-h"><div class="play"></div></div>'),this.$el.find(".image-outer-h").mouseover(function(){s(this).find(".detail-view").css({bottom:"0px"}),s(this).find(".action-block").css({opacity:90})}),this.$el.find(".circle").mouseover(function(){s(this).parent().find(".detail-view").css({bottom:"0px"}),s(this).parent().find(".action-block").css({opacity:90})}),this.$el.find(".vote-h").click(function(t){e.vote(t)}),this.$el.find(".follow-h").click(function(t){e.follow(t)}),this.$el.find(".edit-h").click(function(t){e.edit(t)}),this.$el.find(".delete-h").click(function(t){e["delete"](t)}),this},vote:function(e){e.preventDefault(),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}var t=new a;t.userId=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,t.setData(),t.save(),s.when(t.request).done(function(){s(e.currentTarget).addClass("link-disabled")})},follow:function(e){e.preventDefault(),console.log(e.target),e.stopPropagation();if(!this.checkForUser()){routing.trigger("showSignup");return}var t=new l;t.userId=this.model.get("payload").id,t.entity_id=this.model.get("payload").enttypes_id,t.save(),s.when(t.request).done(function(){typeof t.get("payload").follower=="object"&&typeof t.get("payload").subject=="object"&&t.get("payload").id>0?s(e.currentTarget).addClass("link-disabled"):console.log("FAIL")})},edit:function(e){e.stopPropagation(),e.preventDefault();var t=this,n=this.model.get("payload");switch(n.enttypes_id){case"23":break;case"21":break;case"1":window.location.hash="profile/"+n.id;break;case"8":window.location.hash="game/"+n.id}console.log(this.model)},"delete":function(e){e.stopPropagation(),e.preventDefault(),console.log("delete")}});return i}),define("pages/home/views/image-list",["facade","views","utils","media/views/image-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"image-list",name:"Image List",tagName:"ul",_tagName:"li",_className:"image",events:{"click .open-photo-player-h":"initPhotoPlayer"},_view:r,initialize:function(e){var t=this;this.name=e.name||this.name,f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");u.bindAll(this),this.addSubscribers()},initPhotoPlayer:function(e){e.preventDefault(),console.log(this.collection);var t=o(e.target).parents("li").index();routing.trigger("photo-player-init",t,this.collection,this.collection.id)},childViews:{}}),i}),define("text!packages/location/templates/state-item.html",[],function(){return'{{#payload}}\r\n<div data-id="{{id}}" class="state-{{id}}">{{name}}</div>\r\n{{/payload}}\r\n\r\n'}),define("packages/location/views/state-item",["vendor","views","utils","text!packages/location/templates/state-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"state",initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeState:function(){console.log(this.model),Channel("stateChanged:"+this.model.collection.cid).publish(this.model)}}),i}),define("packages/location/views/state-list",["facade","views","utils","packages/location/views/state-item"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=t.CollectionView,l=t.SectionView;return s=f.extend(l.prototype),i=s.extend({__super__:f.prototype,id:"state-list",name:"State List",tagName:"ul",_tagName:"li",_className:"state",_view:r,initialize:function(e){f.prototype.initialize.call(this,e);if(!this.collection)throw new Error("StateListView expected options.collection.");u.bindAll(this),this.addSubscribers()},childViews:{}}),i}),define("pages/home/views/state-list",["facade","views","utils","packages/location/views/state-list"],function(e,t,n,r){var i,s=e.$,o=e._,u=n.lib.Channel,a=t.SectionView;return i=r.extend({tagName:"select",_tagName:"option",events:{change:"changeState"},initialize:function(e){r.prototype.initialize.call(this,e),this.id=e.id||this.id||o.uniqueId("v")},changeState:function(e){console.log(this.collection);var t=s(e.target).val(),n="";this.collection.each(function(e){e.get("payload").name==t&&(n=e.get("payload").id)}),n!=""&&(console.log("sdsd"),routing.trigger("stateChanged",n))}}),i}),define("text!sport/templates/sport-item.html",[],function(){return'{{#payload}}\r\n<a href="javascript: void(0);">\r\n<img src="{{small_icon}}" class="tiny-sport-icon"/>{{sport_name}}</a>\r\n{{/payload}}'}),define("sport/views/sport-item",["vendor","views","utils","text!sport/templates/sport-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"sport",events:{},initialize:function(e){this.template=r},render:function(){var e=this,t=u.to_html(this.template,this.model.toJSON());return this.$el.html(t),this.$el.find("a").click(function(){e.selectSport()}),this},selectSport:function(){debug.log(this.model),s("li.sport").removeClass("select"),this.$el.addClass("select"),Channel("sportChanged:"+this.model.collection.cid).publish(this.model)}}),i}),function(e){jQuery.fn.extend({slimScroll:function(t){var n=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200},t);return this.each(function(){function r(t){if(h){t=t||window.event;var r=0;t.wheelDelta&&(r=-t.wheelDelta/120),t.detail&&(r=t.detail/3),e(t.target||t.srcTarget).closest("."+n.wrapperClass).is(S.parent())&&i(r,!0),t.preventDefault&&!E&&t.preventDefault(),E||(t.returnValue=!1)}}function i(e,t,r){var i=e,s=S.outerHeight()-T.outerHeight();t&&(i=parseInt(T.css("top"))+e*parseInt(n.wheelStep)/100*T.outerHeight(),i=Math.min(Math.max(i,0),s),i=0<e?Math.ceil(i):Math.floor(i),T.css({top:i+"px"})),y=parseInt(T.css("top"))/(S.outerHeight()-T.outerHeight()),i=y*(S[0].scrollHeight-S.outerHeight()),r&&(i=e,e=i/S[0].scrollHeight*S.outerHeight(),e=Math.min(Math.max(e,0),s),T.css({top:e+"px"})),S.scrollTop(i),S.trigger("slimscrolling",~~i),u(),c()}function s(){window.addEventListener?(this.addEventListener("DOMMouseScroll",r,!1),this.addEventListener("mousewheel",r,!1)):document.attachEvent("onmousewheel",r)}function o(){g=Math.max(S.outerHeight()/S[0].scrollHeight*S.outerHeight(),w),T.css({height:g+"px"});var e=g==S.outerHeight()?"none":"block";T.css({display:e})}function u(){o(),clearTimeout(v),y==~~y&&(E=n.allowPageScroll,b!=y&&S.trigger("slimscroll",0==~~y?"top":"bottom")),b=y,g>=S.outerHeight()?E=!0:(T.stop(!0,!0).fadeIn("fast"),n.railVisible&&N.stop(!0,!0).fadeIn("fast"))}function c(){n.alwaysVisible||(v=setTimeout(function(){(!n.disableFadeOut||!h)&&!p&&!d&&(T.fadeOut("slow"),N.fadeOut("slow"))},1e3))}var h,p,d,v,m,g,y,b,w=30,E=!1,S=e(this);if(S.parent().hasClass(n.wrapperClass)){var x=S.scrollTop(),T=S.parent().find("."+n.barClass),N=S.parent().find("."+n.railClass);o();if(e.isPlainObject(t)){if("scrollTo"in t)x=parseInt(n.scrollTo);else if("scrollBy"in t)x+=parseInt(n.scrollBy);else if("destroy"in t){T.remove(),N.remove(),S.unwrap();return}i(x,!1,!0)}}else{n.height="auto"==n.height?S.parent().innerHeight():n.height,x=e("<div></div>").addClass(n.wrapperClass).css({position:"relative",overflow:"hidden",width:n.width,height:n.height}),S.css({overflow:"hidden",width:n.width,height:n.height});var N=e("<div></div>").addClass(n.railClass).css({width:n.size,height:"100%",position:"absolute",top:0,display:n.alwaysVisible&&n.railVisible?"block":"none","border-radius":n.size,background:n.railColor,opacity:n.railOpacity,zIndex:90}),T=e("<div></div>").addClass(n.barClass).css({background:n.color,width:n.size,position:"absolute",top:0,opacity:n.opacity,display:n.alwaysVisible?"block":"none","border-radius":n.size,BorderRadius:n.size,MozBorderRadius:n.size,WebkitBorderRadius:n.size,zIndex:99}),C="right"==n.position?{right:n.distance}:{left:n.distance};N.css(C),T.css(C),S.wrap(x),S.parent().append(T),S.parent().append(N),n.railDraggable&&T.draggable({axis:"y",containment:"parent",start:function(){d=!0},stop:function(){d=!1,c()},drag:function(){i(0,e(this).position().top,!1)}}),N.hover(function(){u()},function(){c()}),T.hover(function(){p=!0},function(){p=!1}),S.hover(function(){h=!0,u(),c()},function(){h=!1,c()}),S.bind("touchstart",function(e){e.originalEvent.touches.length&&(m=e.originalEvent.touches[0].pageY)}),S.bind("touchmove",function(e){e.originalEvent.preventDefault(),e.originalEvent.touches.length&&i((m-e.originalEvent.touches[0].pageY)/n.touchScrollStep,!0)}),"bottom"===n.start?(T.css({top:S.outerHeight()-T.outerHeight()}),i(0,!0)):"top"!==n.start&&(i(e(n.start).position().top,null,!0),n.alwaysVisible||T.hide()),s(),o()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery),define("jquery.slimscroll",function(){}),define("packages/sport/views/sport-list",["facade","views","utils","sport/views/sport-item","jqueryui","jquery.slimscroll"],function(e,t,n,r){var i,s,o=e.$,u=e._,a=n.lib.Channel,f=n.debug;return CollectionView=t.CollectionView,SectionView=t.SectionView,s=CollectionView.extend(SectionView.prototype),i=s.extend({__super__:CollectionView.prototype,className:"sport-list",name:"Sport List",tagName:"ul",_tagName:"li",_className:"sport",_view:r,initialize:function(e){s.prototype.initialize.call(this,e);if(!this.collection)throw new Error("SportListView expected options.collection.");u.bindAll(this),this.name=e.name||this.name,this._tagName=e._tagName||this._tagName,this.tagName=e.tagName||this.tagName,this._className=e._className||this._className,this._view=e._view||this._view,this.addSubscribers()},initScroll:function(){o("."+this.className).slimScroll({height:"200px"})},addSubscribers:function(){var e=this;a("layout:ready").subscribe(e.initScroll)},childViews:{}}),i}),define("text!signup/templates/registration.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n<div id="regcontainer">\r\n	<div id="mainreg">\r\n		<div id="header">\r\n			<span class="regheader"> Show us what you got</span>\r\n		</div>\r\n\r\n		<div id="fbpane">\r\n			<div id="label">\r\n				Register with facebook\r\n			</div>\r\n			<div id="fblogo"><span></span></div>\r\n		</div>\r\n		<div id="regor">\r\n			or\r\n		</div>\r\n		<div id="regpane">\r\n			<form action="#/user/create" method="post" accept-charset="utf-8">\r\n				<div id="firstreg">\r\n				<input type="text" name="firstname" placeholder="First name" />\r\n				<div class="error">\r\n				</div>\r\n				<input type="text" name="lastname" placeholder="Last name" />\r\n				<input type="text" name="email" placeholder="Email" />\r\n				<div class="error">\r\n				</div>\r\n				</div>\r\n				<input type="submit" name="create" value="Sign Up" class="regsubmit" />\r\n			</form>\r\n			<%  if(!onlyRegister) { %>\r\n			\r\n				<div id="reglogin">\r\n				<span>Been here before <a href="#">sign in</a></span>\r\n				</div>\r\n				\r\n			<% } %>	\r\n			\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("text!signup/templates/layout.html",[],function(){return'\r\n<!--<div id="main-header">\r\n\r\n</div>\r\n\r\n<div id="main-content">\r\n    \r\n    \r\n    \r\n</div>\r\n\r\n<div id="main-footer">\r\n\r\n</div>-->\r\n<div id="RegModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n\r\n	<div class="modal-header">\r\n		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>\r\n	</div>\r\n\r\n	<div id="main-contentreg"></div>\r\n\r\n	<div class="modal-body">\r\n		<div id="errormsg"></div>\r\n		<div id="preview"></div>\r\n	</div>\r\n\r\n</div>\r\n'}),define("text!registration/templates/layout.html",[],function(){return'\r\n<div id="main-header">\r\n\r\n</div>\r\n\r\n<div id="main-content">\r\n    \r\n    \r\n    \r\n</div>\r\n\r\n<div id="main-footer">\r\n\r\n</div>\r\n'}),define("user/models/basics",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({url:function(){return"undefined"==typeof this.id?testpath?testpath+"/user/basics/":"/api/user/basics/":testpath?testpath+"/user/basics/"+this.id:"/api/user/basics/"+this.id},initialize:function(){n.__super__.initialize.apply(this,arguments)},user_pic_small:function(){return this.payload.user_picture.types.small_thumb.url}}),n}),define("registration/models/select_type",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return"/api/user/basics/"+this.id},fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n)}}),t}),define("user/models/fbreg",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{name:null,birth_day:null,high_school:null,email:null,user_picture:null},desc:"Facebook Registration Information",exec_data:{exec_time:0,exec_error:!1},id:1})}),n}),define("registration/models/register_facebook",["facade","user/models/fbreg","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbreg":"/api/user/fbreg"}}),r}),define("registration/models/register_email",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+this.id}}),t}),define("registration/models/upload_image",["user/models/basics"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/uploadimage":"/api/user/uploadimage"}}),t}),define("registration/models/select_org",["user/models/basics"],function(e){var t;return t=e.extend({fetchSuccess:function(t,n){e.prototype.fetchSuccess.call(this,t,n);var r=new Date(t.get("payload").dob),i=new Date,s=i.getFullYear()-r.getFullYear();s>18?t.set("show_highschool",!1):t.set("show_highschool",!0)}}),t}),define("text!registration/templates/select_type.html",[],function(){return'\r\n<h1>Register with AthletesUp</h1>\r\n<a href="#" class="register_facebook">Sign up through Facebook</a>\r\n<br/><br/> OR <br/><br/>\r\n<a href="#" class="register_email">Register With Email Address</a>\r\n\r\n<a href="#" class="go_club">go club directly</a>\r\n<div id="fb-root"></div>'}),define("registration/views/select_type",["require","registration/models/select_type","text!registration/templates/select_type.html","facade","views","utils"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView;return r=a.extend({id:"main-content",events:{"click .register_facebook":"registerWithFacebook","click .register_email":"registerWithEmail","click .go_club":"selectOrg"},template:n,initialize:function(e){a.prototype.initialize.call(this,e),this.initModel()},registerWithFacebook:function(e){function t(){FB.login(function(e){e.authResponse?u("registration-with-facebook").publish():alert("Cancelled")},{scope:"email, user_birthday, user_photos"})}function n(){var e,n="facebook-jssdk",r=document.getElementsByTagName("script")[0];if(document.getElementById(n)){t();return}e=document.createElement("script"),e.id=n,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(e,r)}e.preventDefault(),window.fbAsyncInit=function(){FB.init({appId:"219148511595084",status:!0,cookie:!0,xfbml:!0,oauth:!0}),FB.getLoginStatus(function(e){e.status==="connected"?FB.api("/me",function(e){u("registration-with-facebook").publish()}):e.status==="not_authorized"?t():t()},{scope:"email, user_birthday, user_photos"})},n()},registerWithEmail:function(e){e.preventDefault(),u("registration-with-email").publish()},initModel:function(){function n(n){e.select_type=new t,e.select_type.id=n,e.select_type.fetch(),$.when(e.select_type.request).done(function(){e.model=e.select_type})}var e=this;u("app-inited").subscribe(n)},selectOrg:function(e){e.preventDefault();var t=this,n=t.model.get("payload");u("registration-select-org").publish(n)}}),r}),define("text!registration/templates/register_facebook.html",[],function(){return'{{#errorDisplay}}\r\n<div class="span8" style="color:red;"> Error:  {{errorValue}} </div>\r\n{{/errorDisplay}}\r\n\r\n{{^errorDisplay}}\r\n \r\n\r\n\r\n{{#payload}}\r\n\r\n\r\n<h1>Register with Facebook</h1>\r\n<div class="row-fluid">\r\n	<div class="span4">\r\n		<img class="picture" src="{{profile_picture}}" alt="{{name}}"/><br/>\r\n	</div>\r\n	<div class="span8">\r\n		<h3>{{name}}</h3>\r\n\r\n		<div class="field">\r\n			DOB:\r\n			<span class="value" data-name="birthday" data-value="{{birthday}}">\r\n				<input type="hidden" name="birthday" value="{{birthday}}"/>\r\n				{{birthday}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n\r\n		<div class="field">\r\n			Email:\r\n			<span class="value" data-name="email" data-value="{{email}}">\r\n				<input type="hidden" name="email" value="{{email}}"/>\r\n				{{email}} <a href="#" class="change-field">change</a>\r\n			</span>\r\n		</div>\r\n		<div class="field">\r\n			Password: <input type="password" class="password" name="password"/>\r\n		</div>\r\n		<div class="field">\r\n			Again: <input type="password" name="password-again"/>\r\n		</div>\r\n		<div class="password-error"></div>\r\n	</div>\r\n</div>\r\n<div class="row-fluid">\r\n	<label for="agree"><input type="checkbox" id="agree" name="agree"/>I have read and agree to the <a href="#">Terms of Service</a></label>\r\n	<a href="javascript:void(0);" class="next btn-common btn-green">What\'s Next</a>\r\n</div>\r\n{{/payload}}\r\n\r\n{{/errorDisplay}}'}),function(e){e.extend(e.fn,{pstrength:function(t){var t=e.extend({verdects:["Very weak","Weak","Medium","Strong","Very strong"],colors:["#f00","#c06","#f60","#3c0","#3f0"],scores:[10,15,30,40],common:["password","sex","god","123456","123","liverpool","letmein","qwerty","monkey"],minchar:6},t);return this.each(function(){var n=e(this).attr("id");e(this).after('<div class="pstrength-minchar" id="'+n+'_minchar">Minimum number of characters is '+t.minchar+"</div>"),e(this).after('<div class="pstrength-info" id="'+n+'_text"></div>'),e(this).after('<div class="pstrength-bar" id="'+n+'_bar" style="border: 1px solid white; font-size: 1px; height: 5px; width: 0px;"></div>'),e(this).keyup(function(){e.fn.runPassword(e(this).val(),n,t)})})},runPassword:function(t,n,r){nPerc=e.fn.checkPassword(t,r);var i="#"+n+"_bar",s="#"+n+"_text";nPerc==-200?(strColor="#f00",strText="Unsafe password word!",e(i).css({width:"0%"})):nPerc<0&&nPerc>-199?(strColor="#ccc",strText="Too short",e(i).css({width:"5%"})):nPerc<=r.scores[0]?(strColor=r.colors[0],strText=r.verdects[0],e(i).css({width:"10%"})):nPerc>r.scores[0]&&nPerc<=r.scores[1]?(strColor=r.colors[1],strText=r.verdects[1],e(i).css({width:"25%"})):nPerc>r.scores[1]&&nPerc<=r.scores[2]?(strColor=r.colors[2],strText=r.verdects[2],e(i).css({width:"50%"})):nPerc>r.scores[2]&&nPerc<=r.scores[3]?(strColor=r.colors[3],strText=r.verdects[3],e(i).css({width:"75%"})):(strColor=r.colors[4],strText=r.verdects[4],e(i).css({width:"92%"})),e(i).css({backgroundColor:strColor}),e(s).html("<span style='color: "+strColor+";'>"+strText+"</span>")},checkPassword:function(e,t){var n=0,r=t.verdects[0];e.length<t.minchar?n-=100:e.length>=t.minchar&&e.length<=t.minchar+2?n+=6:e.length>=t.minchar+3&&e.length<=t.minchar+4?n+=12:e.length>=t.minchar+5&&(n+=18),e.match(/[a-z]/)&&(n+=1),e.match(/[A-Z]/)&&(n+=5),e.match(/\d+/)&&(n+=5),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(n+=7),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(n+=5),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(n+=7),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(n+=2),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(n+=3),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(n+=3);for(var i=0;i<t.common.length;i++)e.toLowerCase()==t.common[i]&&(n=-200);return n}})}(jQuery),define("jquery.pstrength",function(){}),define("media/models/image",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({defaults:r.extend({},(new t).attributes,{payload:{image_id:0,image_path:null,image_title:null,num_votes:0},desc:"Image information",exec_data:{exec_time:0,exec_error:!1}}),processItemFromPayload:function(e,t){var n=this,r=e.payload;return n.id=Math.ceil(Math.random()*1e5),t!=undefined?n.set("payload",r[t]):n.set("payload",r),n.set("desc",e.desc),n.set("exec_data",e.exec_data),this},selectImageType:function(e){return r.each(this.get("payload").types,function(t,n){n==e&&(this.get("payload").image_path=t.url)},this),this}}),n}),define("media/collections/images",["facade","collections","media/models/image","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.processItemFromPayload(t,i),s.selected_image!=undefined&&(r[i].image_path=s.selected_image),e.push(s)}e.deferred.resolve(t)}}),i}),define("registration/collections/fbimages",["facade","media/collections/images","utils"],function(e,t,n){var r,i=e._,s=n.lib.Channel;return r=t.extend({url:function(){return testpath?testpath+"/user/fbpics":"/api/user/fbpics"}}),r}),define("text!registration/templates/fbimage-item.html",[],function(){return'\r\n{{#payload}}\r\n<img src="{{thumbnail}}" alt="Thumb"/>\r\n{{#num_votes}}{{num_votes}} Votes{{/num_votes}}\r\n{{/payload}}\r\n\r\n'}),define("registration/views/fbimage-item",["vendor","views","utils","text!registration/templates/fbimage-item.html"],function(e,t,n,r){var i,s=e.$,o=t.BaseView,u=e.Mustache;return i=o.extend({tagName:"li",className:"image",events:{click:"changeImage"},initialize:function(e){this.template=r},render:function(){var e=u.to_html(this.template,this.model.toJSON());return this.$el.html(e),this},changeImage:function(){Channel("changeimage"+this.model.collection.id).publish(this.model)}}),i}),define("text!registration/templates/fbimage-board.html",[],function(){return'\r\n{{#payload}}\r\n    <div class="textcenter fbimagecontainer pane">\r\n        <img id="image-select" src="{{original}}" alt="{{image_title}}"/>\r\n        <div class="coords" style="display:none;">\r\n            <div>crop x <input name="crop-x" type="hidden" /></div>\r\n            <div>crop y <input name="crop-y" type="hidden" /></div>\r\n            <div>crop width <input name="crop-width" type="hidden" /></div>\r\n            <div>crop height <input name="crop-height" type="hidden" /></div>\r\n            <div>image width <input name="image-width" type="hidden" /></div>\r\n            <div>image height <input name="image-height" type="hidden" /></div>            \r\n        </div>\r\n    </div>\r\n{{/payload}}\r\n'}),function(e){e.fn.jrac=function(t){var n={crop_width:200,crop_height:100,crop_x:0,crop_y:0,crop_resize:!0,crop_aspect_ratio:null,image_width:null,image_height:null,zoom_min:100,zoom_max:3e3,viewport_image_surrounding:!1,viewport_width:null,viewport_height:null,viewport_resize:!0,viewport_content_left:0,viewport_content_top:0,viewport_onload:null};return this.each(function(){if(!e(this).is("img"))return;var r=!1;typeof t=="object"?e.extend(n,t):t=="destroy"&&(r=!0);var i=e(this),s=!1;i.parent().hasClass("jrac_viewport")&&(s=!0),s&&r?(i.draggable("destroy"),i.parent().find(".jrac_crop").remove(),i.parent().parent().find(".jrac_zoom_slider").remove(),i.parent().append(i.data("original")),i.parent().unwrap(),i.unwrap(),i.remove()):i.data("original",i.clone());if(r)return;s||i.hide().css("position","absolute").wrap('<div class="jrac_container"><div class="jrac_viewport"></div></div>');var o=i.parent(),u=o.parent(),a=e('<div class="jrac_loading" />');o.append(a);var f=function(){e.extend(i,{scale_proportion_locked:!0,originalWidth:i.width(),originalHeight:i.height()}),i.width(n.image_width).height(n.image_height),n.viewport_image_surrounding?o.width(i.width()).height(i.height()):o.width(n.viewport_width).height(n.viewport_height),i.css({left:n.viewport_content_left,top:n.viewport_content_top});if(!s){var t=e('<div class="jrac_zoom_slider"><div class="ui-slider-handle"></div></div>').width(o.width()).slider({value:i.width(),min:n.zoom_min,max:n.zoom_max,start:function(n,r){e.extend(t,{on_start_width_value:r.value,on_start_height_value:i.height()})},slide:function(e,n){var r=Math.round(t.on_start_height_value*n.value/t.on_start_width_value);i.height(r),i.width(n.value),o.observator.notify("jrac_image_height",r),o.observator.notify("jrac_image_width",n.value)}});u.append(t),n.viewport_resize&&o.resizable({resize:function(e,n){t.width(n.size.width)}}),i.draggable({drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});var r=e('<div class="jrac_crop"><div class="jrac_crop_drag_handler"></div></div>').css({width:n.crop_width,height:n.crop_height,left:n.crop_x+n.viewport_content_left,top:n.crop_y+n.viewport_content_top}).draggable({containment:o,handle:"div.jrac_crop_drag_handler",drag:function(e,t){t.position.left!=t.originalPosition.left&&o.observator.notify("jrac_crop_x",o.observator.crop_position_x()),t.position.top!=t.originalPosition.top&&o.observator.notify("jrac_crop_y",o.observator.crop_position_y())}});n.crop_resize&&r.resizable({containment:o,aspectRatio:n.crop_aspect_ratio,resize:function(e,t){t.size.width!=t.originalSize.width&&o.observator.notify("jrac_crop_width",r.width()),t.size.height!=t.originalSize.height&&o.observator.notify("jrac_crop_height",r.height())}}),o.append(r)}e.extend(o,{$container:u,$image:i,$crop:r,$zoom_widget:t,observator:{items:{},register:function(e,t,n){e&&t&&(this.items[e]={element:t,callback:n})},unregister:function(e){delete this.items[e]},notify:function(t,n){if(this.items[t]){var r=this.items[t].element,s=this.items[t].callback;r.trigger(t,[o,n]),e.isFunction(s)&&s.call(o,t,r,n)}i.trigger("jrac_events",[o])},notify_all:function(){this.notify("jrac_crop_x",this.crop_position_x()),this.notify("jrac_crop_y",this.crop_position_y()),this.notify("jrac_crop_width",r.width()),this.notify("jrac_crop_height",r.height()),this.notify("jrac_image_width",i.width()),this.notify("jrac_image_height",i.height())},crop_position_x:function(){return r.position().left-i.position().left},crop_position_y:function(){return r.position().top-i.position().top},crop_consistent:function(){return this.crop_position_x()>=0&&this.crop_position_y()>=0&&this.crop_position_x()+r.width()<=i.width()&&this.crop_position_y()+r.height()<=i.height()},set_property:function(e,n){n=parseInt(n);if(isNaN(n))return;switch(e){case"jrac_crop_x":r.css("left",n+i.position().left);break;case"jrac_crop_y":r.css("top",n+i.position().top);break;case"jrac_crop_width":r.width(n);break;case"jrac_crop_height":r.height(n);break;case"jrac_image_width":if(i.scale_proportion_locked){var s=Math.round(i.height()*n/i.width());i.height(s),this.notify("jrac_image_height",s)}i.width(n),t.slider("value",n);break;case"jrac_image_height":if(i.scale_proportion_locked){var o=Math.round(i.width()*n/i.height());i.width(o),this.notify("jrac_image_width",o),t.slider("value",o)}i.height(n)}this.notify(e,n)}}}),a.hide(),a.remove(),i.show(),e.isFunction(n.viewport_onload)&&(n.viewport_onload.call(o),o.observator.notify_all())},l=i.attr("src");/^data:image/.test(l)?f():(l=l+(l.search(/\?/)<0?"?":"&")+"jracrandom="+(new Date).getTime(),e("<img>").attr("src",l).load(f()))})}}(jQuery),define("jquery.jrac",function(){}),define("registration/views/fbimage-board",["require","text!registration/templates/fbimage-board.html","facade","views","utils","jquery.jrac"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=r._,a=r.$,f=s.lib.Channel;return n=o.extend({tagName:"div",className:"image-board",template:t,setOptions:function(e){if(!this.model)throw new Error("ImageBoardView expected options.model.")},render:function(){console.log("fb image board render"),console.log("fb image board collection"),console.log(this.collection);var e=this;o.prototype.render.call(this)},selectArea:function(e,t){a("#x1").val(t.x1),a("#y1").val(t.y1),a("#x2").val(t.x2),a("#y2").val(t.y2),a("#w").val(t.width),a("#h").val(t.height)},initCropView:function(){a("#image-select").jrac({crop_width:150,crop_height:150,crop_aspect_ratio:"1:1",crop_x:100,crop_y:100,image_width:400,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){a(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,a(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=a(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},removeCropView:function(){a("#image-select").jrac("destroy"),a("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=this.$(".coords :input").serializeArray(),t=this.model.get("payload");a.each(e,function(e,n){t[n.name]=n.value}),this.model.set("payload",t)}}),n}),define("text!registration/templates/picture_buttons.html",[],function(){return'\r\n<div id="picture-buttons">\r\n    <a href="#" class="use_image">Use This Image</a>\r\n    <a href="#" class="upload_image">Upload a New Image</a>\r\n</div>\r\n'}),define("registration/views/picture_buttons",["require","text!registration/templates/picture_buttons.html","vendor","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=i.BaseView,u=s.lib.Channel,a=e("vendor"),f=a.Mustache;return n=o.extend({tagName:"div",className:"picture-buttons clearfix",template:t,events:{"click .use_image":"clickUseImage","click .upload_image":"clickUploadImage"},render:function(){var e=f.to_html(this.template);return this.$el.html(e),this},clickUseImage:function(e){e.preventDefault(),u("registration-use-image").publish()},clickUploadImage:function(e){e.preventDefault(),u("registration-upload-image").publish()}}),n}),define("registration/views/fbimage-list",["facade","utils","views","registration/views/fbimage-item","registration/views/fbimage-board","registration/views/picture_buttons","models/base"],function(e,t,n,r,i,s,o){var u,a=n.BaseView;return _=e._,u=a.extend({initialize:function(e){console.log(this.options,"options.collection"),_.map(this.collection,function(e,t){console.log(e.payload,"value.attributes")})},createElement:function(){}}),u}),define("registration/views/register_facebook",["require","text!registration/templates/register_facebook.html","backbone","facade","views","utils","jquery.pstrength","registration/collections/fbimages","registration/views/fbimage-list"],function(e,t,n){var r,i=e("facade"),s=e("views"),o=e("utils"),u=o.lib.Channel,a=s.SectionView,f=e("registration/collections/fbimages"),l=e("registration/views/fbimage-list");return r=a.extend({id:"main-content",events:{keypress:"stopSubmit","click .change-field":"changeField","click .diff_fb_pic":"diffFBPicture","click .upload_new_image":"uploadNewImage","click .next":"nextStep"},template:t,initialize:function(e){function s(e){i.$(".picture").attr("src",e)}function o(){i.initFBPictures()}function f(){i.initUploadImage()}var t=jQuery.parseJSON(this.model.request.responseText);if(t.exec_data.exec_error){var n=!0,r=t.exec_data.error_array[0].error;this.model.set("errorDisplay",!0),this.model.set("errorValue",r)}var i=this;if(!this.model)throw new Error("RegistrationFacebookView expected options.model.");i.parseFBData(this.model.get("payload")),a.prototype.initialize.call(this,e),u("registration-change-picture").subscribe(s),u("registration-diff-fbpicture").subscribe(o),u("registration-upload-image").subscribe(f)},childViews:{},render:function(e,t,n){a.prototype.render.call(this,e,t,n),this.$(".password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},diffFBPicture:function(e){e.preventDefault(),this.initFBPictures()},uploadNewImage:function(e){e.preventDefault(),this.initUploadImage()},parseFBData:function(e){e.hs_exists=e.high_school?!0:!1,e.dob_exists=e.birthday?!0:!1,e.email_exists=e.email?!0:!1,this.model.set("payload",e)},initFBPictures:function(){var e=this;this.fbimages?(debug.log(e.fbimages.toJSON(),"else"),this.fbImageListView=new l({collection:e.fbimages.toJSON()})):(this.fbimages=new f,this.fbimages.fetch(),$.when(this.fbimages.request).done(function(){debug.log("this.fbimages are as follows"),debug.log(e.fbimages.toJSON()),this.fbImageListView=new l({collection:e.fbimages.toJSON()})}))},setupFBPictures:function(){var e=this;this.fbImageListView=new l({collection:this.fbimages});var t=this.addChildView(this.fbImageListView);this.childViews.fbImageListView=this.fbImageListView,this.callbacks.add(function(){t()}),this.fbImageListView.render(),this.$el.append(e.fbImageListView.el),$("#"+this.fbImageListView.id).dialog({width:"80%",close:e.removeListView})},removeListView:function(){this.childViews.fbImageListView.removeCropView()},initUploadImage:function(){alert("Upload Image")},changeField:function(e){e.preventDefault(),$parent=this.$(e.target).parent(),id=$parent.attr("data-name"),value=$parent.attr("data-value"),$parent.html('<input type="text" id="'+id+'" name="'+id+'" value="'+value+'"/>')},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=this.model.get("payload");$.each(t,function(e,t){n[t.name]=t.value});if(n["password"]==""||n["password-again"]==""){alert("Please input a password");return}if(n["password"]!=n["password-again"]){alert("Please input a password correctly");return}if(n["agree"]==null){alert("Please agree to the Terms of Service");return}this.model.attributes.id=!1,this.model.set({payload:n,id:1}),this.model.url=function(){return testpath?testpath+"/user/basics":"/api/user/basics/"+n.users_id},this.model.save({callback:"true"},{success:function(e){location.href="#usersettings",$("#RegModal").modal("hide")}})}}),r}),define("text!registration/templates/register_email.html",[],function(){return'\r\n<h1>The Basics</h1>\r\n<div class="row-fluid">\r\n    <form class="form-horizontal">\r\n        <div class="control-group">\r\n            <label class="control-label" for="first_name">First Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="firstname" id="first_name" placeholder="First Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="last_name">Last Name: </label>\r\n            <div class="controls">\r\n                <input type="text" name="lastname" id="last_name" placeholder="Last Name">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="dob">DOB: </label>\r\n            <div class="controls">\r\n                <input type="text" name="dob" id="dob" placeholder="Birthday">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="email">Email: </label>\r\n            <div class="controls">\r\n                <input type="text" name="email" id="email" placeholder="Email">\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label">Gender: </label>\r\n            <div class="controls" id="gender">\r\n                <label for="male"><input type="radio" id="male" name="gender" value="M"> Male</label>\r\n                <label for="female"><input type="radio" id="female" name="gender" value="F"> Female</label>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="password">Password: </label>\r\n            <div class="controls">\r\n                <input type="password" id="password" name="password" placeholder="Password"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div class="control-group">\r\n            <label class="control-label" for="re_password">Again: </label>\r\n            <div class="controls">\r\n                <input type="password" id="re_password" name="re_password" placeholder="Password Again"/>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <p class="agree-error text-error"></p>\r\n            <label for="accept_terms">\r\n                <input type="checkbox" id="accept_terms" name="accept_terms"/>I have read and agree to the <a href="#">Terms of Service</a>\r\n                <p class="field-error"></p>\r\n                <p class="field-message"></p>\r\n            </label>            \r\n            <a href="#" class="next">What\'s Next</a>\r\n        </div>\r\n    </form>\r\n</div>'}),define("registration/views/register_email",["require","text!registration/templates/register_email.html","facade","views","utils","jquery.pstrength","models/base"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView,a=e("models/base");return n=u.extend({id:"main-content",events:{keypress:"stopSubmit","click .next":"nextStep"},template:t,initialize:function(e){if(!this.model)throw new Error("RegistrationEmailView expected options.model.");u.prototype.initialize.call(this,e)},render:function(e,t,n){u.prototype.render.call(this,e,t,n),this.$("#password").pstrength()},stopSubmit:function(e){var t=e.keyCode?e.keyCode:e.which;t==13&&e.preventDefault()},nextStep:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n={};$.each(t,function(e,t){n[t.name]=t.value});var r=new a(n);r.url=function(){return"/api/user/register"},r.saveSuccess=function(e,t){a.prototype.saveSuccess.call(this,e,t);var n=t.exec_data,r=t.payload;n.exec_error||o("registration-select-org").publish(r)},r.save()}}),n}),define("text!registration/templates/upload_image.html",[],function(){return'\r\nUpload Image\r\n\r\n<a href="#" class="next">What\'s Next</a>'}),define("registration/views/upload_image",["require","text!registration/templates/upload_image.html","facade","views","utils"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=s.lib.Channel,u=i.SectionView;return n=u.extend({id:"main-content",events:{"click .next":"nextStep"},template:t,initialize:function(e){u.prototype.initialize.call(this,e)},nextStep:function(e){e.preventDefault(),o("registration-select-org").publish()}}),n}),define("text!registration/templates/select_org.html",[],function(){return'\r\n<h1>Athletic Organizations</h1>\r\n<div class="step-club">\r\n<div>Link Up With Your Teams</div>\r\n<a href="#" class="find_club">\r\n    <h3>Find My Club</h3>\r\n    <p>Use our club locator to find your sports club and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{#show_highschool}}\r\n<div class="step-highschool" style="display:none;">\r\n<div class="text-error">Only display high school chooser if age <= 18</div>\r\n<a href="#" class="high_school">\r\n    <h3>High School Locator</h3>\r\n    <p>If you play for your high school, click here to find your school and link up with your team.</p>\r\n</a>\r\n</div>\r\n{{/show_highschool}}\r\n<div class="step-sport" style="display:none;">\r\n<a href="#" class="indiv_sports">\r\n    <h3>Individual Sports</h3>\r\n    <p>If you are an athlete who competes without a team, this is where you\'ll find your sport.</p>\r\n</a>\r\n</div>\r\n<div class="step-next" style="display:none;">\r\n<a href="#" class="next">What\'s Next</a>\r\n</div>\r\n'}),define("registration/models/my_club",["models/base"],function(e){var t;return t=e.extend({url:function(){return testpath?testpath+"/user/myclub":"/api/user/basics/"+this.id}}),t}),define("text!registration/templates/find_my_club.html",[],function(){return'\r\n<h2>Find My Sports Club</h2>\r\n<form id="findClubFrm" class="form-horizontal">\r\n    <div class="control-group">\r\n        <label class="control-label" for="states_id">What State?</label>\r\n        <div class="controls">\r\n            <input id="states_id" name="state_name" placeholder="Just Start Typing" value="{{state}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="sports_id">What Sport?</label>\r\n        <div class="controls">\r\n            <input id="sports_id" name="sport_name" placeholder="Just Start Typing" value="{{sport}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="control-group">\r\n        <label class="control-label" for="orgs_id">Club Name</label>\r\n        <div class="controls">\r\n            <input id="orgs_id" name="org_name" placeholder="Just Start Typing" value="{{club}}" />\r\n            <p class="field-error"></p>\r\n            <p class="field-message"></p>\r\n        </div>\r\n    </div>\r\n    <div class="complevels"></div>\r\n    <div class="seasons"></div>\r\n    <a href="#" class="back">Go Back</a>    \r\n    <a href="#" class="not_find">Can\'t Find Your Club?</a>\r\n    <a href="#" class="continue">Continue</a>\r\n</form>\r\n'}),define("registration/collections/states",["facade","collections","location/collections/states","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/sport",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/sports",["facade","collections","sportorg/models/sport","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){return testpath?testpath+"/sport_search":(this.state_name==undefined,"/api/sport/search/?sport_name="+this.sport_name+"&gender="+this.gender)},fetchSuccess:function(e,t){e.reset();var r=t.payload;for(var i in r){var s=new n;s.id=Math.ceil(Math.random()*1e5),s.set("payload",r[i]),s.set("desc",t.desc),s.set("exec_data",t.exec_data),e.push(s)}e.deferred.resolve(t),e.processResult(e)},processResult:function(e){},returnProcessedData:function(e){}}),i}),define("registration/collections/sports",["facade","collections","sportorg/collections/sports","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("sportorg/models/club",["facade","models/base"],function(e,t){var n,r=e._;return n=t.extend({}),n}),define("sportorg/collections/clubs",["facade","collections","sportorg/models/club","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=s.extend({model:n,url:function(){var e=this;return testpath?testpath+"/club_search":(e.states_id==undefined||e.sports_id==undefined||e.club_name==undefined,"/api/org/search/?sports_club=1&states_id="+e.states_id+"&sports_id="+e.sports_id+"&org_name="+e.club_name)},fetchSuccess:function(e,t){e.reset();var n=t.payload;for(var r in n){var i=new SportorgSportModel;i.id=Math.ceil(Math.random()*1e5),i.set("payload",n[r]),i.set("desc",t.desc),i.set("exec_data",t.exec_data),e.push(i)}e.deferred.resolve(t)}}),i}),define("registration/collections/clubs",["facade","collections","sportorg/collections/clubs","utils"],function(e,t,n,r){var i,s=t.BaseCollection,o=e._,u=r.lib.Channel;return i=n.extend({}),i}),define("registration/views/find_my_club",["require","text!registration/templates/find_my_club.html","facade","views","utils","models/base","jqueryui","registration/collections/states","registration/collections/sports","registration/collections/clubs"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=e("models/base");return BaseView=i.BaseView,_=r._,$=r.$,Channel=s.lib.Channel,RegistrationStatesCollection=e("registration/collections/states"),RegistrationSportsCollection=e("registration/collections/sports"),RegistrationClubsCollection=e("registration/collections/clubs"),n=BaseView.extend({id:"find-my-club",tagName:"div",className:"find-my-club",template:t,events:{"click .back":"closeView","click .not-find":"notFind","click .continue":"highSchoolView","keyup #states_id":"keyupState","keyup #sports_id":"keyupSport","keyup #orgs_id":"keyupClub","blur #states_id":"changeState","blur #sports_id":"changeSport","change #orgs_id":"changeClub"},states:[],states_id:"",sports:[],sports_id:"",clubs:[],clubs_id:"",setOptions:function(e){if(!this.model)throw new Error("RegistrationFindMyClubView expected options.model.")},initialize:function(e){BaseView.prototype.initialize.call(this,e)},render:function(){var e=this;BaseView.prototype.render.call(this)},closeView:function(e){e.preventDefault(),Channel("registration-close-clubview").publish()},notFind:function(e){e.preventDefault()},highSchoolView:function(e){e.preventDefault()},keyUp:function(e){switch(this.$(e.target).attr("id")){case"state":this.keyupState(e);break;case"sport":this.keyupSport(e);break;case"club":this.keyupClub(e)}},keyupState:function(e){var t=this,n=this.$("#states_id").val(),r=[];if(n!=""){var i=new RegistrationStatesCollection;i.state_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();(e==null||e.length<1)&&t.$("#states_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.states=[];for(var n in e)t.states.push(e[n].payload);debug.log("self.states",t.states),t.states.forEach(function(e,t){r.push(e.name)}),debug.log("stateArr",r),t.$("#states_id").autocomplete({source:r})})}},changeState:function(e){var t=this.$("#states_id").val(),n=this;n.states_id="",n.states.forEach(function(e,r){e["name"]==t&&(n.states_id=e.id)}),this.keyupClub()},keyupSport:function(e){var t=this,n=t.model,r="all";n.get("payload").gender&&(r=n.get("payload").gender);var i=this.$("#sports_id").val(),s=[];if(i!=""){var o=new RegistrationSportsCollection;o.sport_name=i,o.gender=r,$(e.target).addClass("ui-autocomplete-loading"),o.fetch(),$.when(o.request).done(function(){if(o.isError())return;var e=o.toJSON();console.log("Sports Model",e),(e==null||e.length<1)&&t.$("#sports_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.sports=[];for(var n in e)t.sports.push(e[n].payload);console.log("sports",t.sports),t.sports.forEach(function(e,t){s.push(e.sport_name)}),console.log("sportArr",s),t.$("#sports_id").autocomplete({source:s})})}},changeSport:function(e){var t=this.$("#sports_id").val(),n=this;n.sports_id="",n.sports.forEach(function(e,r){e["sport_name"]==t&&(n.sports_id=e.sport_id)}),this.keyupClub()},keyupClub:function(e){var t=this,n=this.$("#orgs_id").val(),r=[];if(n!=""){var i=new RegistrationClubsCollection;console.log(t.states_id,t.sports_id,n),i.states_id=t.states_id,i.sports_id=t.sports_id,i.club_name=n,$(e.target).addClass("ui-autocomplete-loading"),i.fetch(),$.when(i.request).done(function(){if(i.isError())return;var e=i.toJSON();console.log("models",e),(e==null||e.length<1)&&t.$("#orgs_id").parent().find(".field-message").html("Couldn't find any matches").stop().fadeIn(),t.clubs=[];for(var n in e)t.clubs.push(e[n].payload);t.clubs.forEach(function(e,t){r.push(e.org_name)}),console.log("clubArr",r),t.$("#orgs_id").autocomplete({source:r})})}},changeClub:function(e){var t=this.$("#orgs_id").val(),n=this;n.clubs_id=0,n.clubs.forEach(function(e,r){e["name"]==t&&(n.clubs_id=e.id)})}}),n}),define("registration/views/select_org",["require","text!registration/templates/select_org.html","facade","views","utils","registration/models/my_club","registration/views/find_my_club"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("utils"),o=r.$,u=s.lib.Channel,a=i.SectionView,f=e("registration/models/my_club"),l=e("registration/views/find_my_club");return n=a.extend({id:"main-content",step:1,events:{"click .find_club":"findMyClub","click .high_school":"highSchoolLocator","click .indiv_sports":"individualSports","click .next":"nextStep"},template:t,initialize:function(e){a.prototype.initialize.call(this,e)},childViews:[],findMyClub:function(e){e.preventDefault();if(this.step!=1)return;var t=this;this.myclub?(this.myclub.fetch(),this.findMyClubView.render(),o("#"+this.findMyClubView.id).dialog({width:"80%",close:t.removeMyClubView})):(this.myclub=new f,this.myclub.id=t.model.get("payload").id,this.myclub.fetch(),o.when(this.myclub.request).done(function(){t.setupFindMyClub()}))},setupFindMyClub:function(){function n(){o("#"+e.findMyClubView.id).dialog("close")}var e=this;this.findMyClubView=new l({model:this.myclub});var t=this.addChildView(this.findMyClubView);this.childViews.findMyClubView=this.findMyClubView,this.callbacks.add(function(){t()}),this.findMyClubView.render(),this.$el.append(e.findMyClubView.el),o("#"+e.findMyClubView.id).dialog({width:"80%",close:e.removeMyClubView}),u("registration-close-clubview").subscribe(n)},removeMyClubView:function(){},highSchoolLocator:function(e){e.preventDefault();if(this.step!=2)return},individualSports:function(e){e.preventDefault();if(this.step!=3)return},nextStep:function(e){e.preventDefault();if(this.step!=4)return}}),n}),define("signup/views/shopopup",["require","backbone","underscore","registration","views","facade","utils"],function(e,t,n,r){var i,s=t.View;return i=s.extend({initialize:function(e){$("#errormsg, #preview").html(""),debug.log("Image upload basic view"),$("#RegModal").modal("show"),$("#RegModal").on("hide",function(){$("div#modalPopup").remove()})}}),i}),define("registration",["require","text!signup/templates/layout.html","text!registration/templates/layout.html","facade","controller","models","views","utils","registration/models/select_type","registration/models/register_facebook","registration/models/register_email","registration/models/upload_image","registration/models/select_org","registration/views/select_type","registration/views/register_facebook","registration/views/register_email","registration/views/upload_image","registration/views/select_org","signup/views/shopopup"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("registration/models/select_type"),f=e("registration/models/register_facebook"),l=e("registration/models/register_email"),c=e("registration/models/upload_image"),h=e("registration/models/select_org"),p=e("registration/views/select_type"),d=e("registration/views/register_facebook"),v=e("registration/views/register_email"),m=e("registration/views/upload_image"),g=e("registration/views/select_org"),y=e("signup/views/shopopup"),b=o.LayoutView,w=r.$,E=r._,S=u.debug,x=u.lib.Channel,T=["/pages/registration/registration.css","/pages/signup/css/signupstyle.css","/css/style.jrac.css"];return n=i.extend({initialize:function(e){return x("load:css").publish(T),E.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.setupLayout().render(),this.refreshPage(),this.createData(),this.handleDeferreds()},createData:function(){this.select_type=new a},handleDeferreds:function(){function t(){e.initRegisterFacebook()}function n(){e.initRegisterEmail()}function r(){e.uploadImage()}function i(t){e.selectOrg(t)}var e=this;routing.off("registration-with-facebook"),routing.on("registration-with-facebook",function(){e.initRegisterFacebook()}),x("registration-select-org").subscribe(i)},refreshPage:function(){var e;this.selectTypeView&&(w(this.selectTypeView.destination).html(""),e=w.inArray(this.selectTypeView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerFacebookView&&(w(this.registerFacebookView.destination).html(""),e=w.inArray(this.registerFacebookView,this.scheme),~e&&this.scheme.splice(e,1)),this.registerEmailView&&(w(this.registerEmailView.destination).html(""),e=w.inArray(this.registerEmailView,this.scheme),~e&&this.scheme.splice(e,1)),this.selectOrgView&&(w(this.selectOrgView.destination).html(""),e=w.inArray(this.selectOrgView,this.scheme),~e&&this.scheme.splice(e,1))},setupSelectTypeView:function(){this.selectTypeView=new p({model:this.select_type,name:"Select Registration Type",destination:"#main-content"}),this.scheme.push(this.selectTypeView),this.layout.render()},initRegisterFacebook:function(){var e=this;this.refreshPage(),this.register_facebook=new f,this.register_facebook.bind("request",e.handleProgress,this),this.register_facebook.fetch(),w.when(this.register_facebook.request).done(function(t){console.log(t.payload.identity_exists,"payload"),t.payload.identity_exists==1?routing.trigger("reload-home"):(this.pop=new y,e.setupRegisterFacebookView())}).fail(function(t){this.pop=new y,e.setupRegisterFacebookView()})},handleProgress:function(e){},setupRegisterFacebookView:function(){this.registerFacebookView=new d({model:this.register_facebook,name:"Registration with Facebook",destination:"#main-contentreg"}),this.scheme.push(this.registerFacebookView),this.layout.render()},initRegisterEmail:function(){var e=this;this.refreshPage(),this.register_email=new l,e.setupRegisterEmailView()},setupRegisterEmailView:function(){this.registerEmailView=new v({model:this.register_email,name:"Registration with Email Address",destination:"#main-content"}),this.scheme.push(this.registerEmailView),this.layout.render()},uploadImage:function(){var e=this;this.refreshPage(),this.upload_image=new c,this.setupUploadImageView()},setupUploadImageView:function(){this.uploadImageView=new m({model:this.upload_image,name:"Registration Upload Image",destination:"#main-content"}),this.scheme.push(this.uploadImageView),this.layout.render()},selectOrg:function(e){var t=this;this.refreshPage(),this.select_org=new h,this.select_org.id=e.id,this.select_org.fetch(),w.when(this.select_org.request).done(function(){t.setupSelectOrgView()})},setupSelectOrgView:function(){this.selectOrgView=new g({model:this.select_org,name:"Registration Select Org",destination:"#main-content"}),this.scheme.push(this.selectOrgView),this.layout.render()},setupLayout:function(){return this.scheme=[],w("div#modalPopup").remove(),w("body").append('<div id="modalPopup"></div>'),pageLayout=new b({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout}}),n}),define("signup/models/registration-basics-final",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"api/user/register"}),t}),define("text!signup/templates/basciFinal.html",[],function(){return'<!--<h1>Auth module using the ORM driver for Kohana 3.1</h1>-->\r\n\r\n\r\n\r\n<div id="regcontainer">\r\n	<div id="mainregfinal">\r\n		<div id="header">\r\n			<span class="regheader"> The Basics </span>\r\n		</div>\r\n\r\n		\r\n		<div id="regpanefinal">\r\n			\r\n			<form action="#/user/create" method="post" accept-charset="utf-8">\r\n				<div id="finalreg">\r\n					<div class="firstdiv" id="firstname">\r\n						<div class="label">\r\n							<label for="Name">Name</label>\r\n						</div>\r\n						<input type="text" id="first_name" name="Name" placeholder="Name" />\r\n						<a id="editname">edit</a>\r\n					</div>\r\n					<div class="seconddiv" id="dob">\r\n						<div class="label">\r\n							<label for="born">Born</label>\r\n						</div>	\r\n						\r\n					</div>\r\n					<div class="thirddiv" id="email">\r\n						<div class="label">\r\n							<label for="Email">Email</label>\r\n						</div>	\r\n						<input type="text" name="email" id="emailInput" placeholder="Email" />\r\n					</div>\r\n					<div class="fourthdiv">\r\n						<div class="label">\r\n							<label for="Name">Gender</label>\r\n						</div>	\r\n						<div class="radioinput" id="radioinput">\r\n							<input type="radio" id="male" name="gender" value="M">\r\n						</div>\r\n						<div class="radio">\r\n							<label for="male">male</label>\r\n						</div>\r\n						<div class="radioinput" id="radioinput">\r\n							<input type="radio" id="Female" name="gender" value="F">\r\n						</div>\r\n						<div class="radio">\r\n							<label for="female">female</label>\r\n						</div>\r\n						\r\n					</div>\r\n					<div class="fifthdiv">\r\n						<div class="label">\r\n							<label for="Name">I am</label>\r\n						</div>\r\n						<div class="Role" id="Role">\r\n							<div class="radioinput"><input type="radio" id="athlet" name="athlet" value="A"></div>\r\n							<div class="radio"><label for="athlet">an athlet</label></div>\r\n							<div class="radioinput"><input type="radio" id="Fan" name="athlet" value="F"></div>\r\n							<div class="radio"><label for="fan">a fan</label></div>\r\n						</div>\r\n					\r\n					</div>\r\n					<div class="sixthdiv">\r\n						<div class="label">\r\n							<label for="Password">Password</label>\r\n						</div>	\r\n						<input type="password" name="password" id="password" placeholder="Password" />\r\n					</div>\r\n					<div class="seventhdiv">\r\n						<div class="label">\r\n							<label for="CPassword">Confirm</label>\r\n						</div>	\r\n						<input type="password" name="re_password" id="re_password" placeholder="Password" />\r\n					</div>\r\n					</div>\r\n					<div id="submitbutton">\r\n						<input type="submit" name="create" value="Sign Up" class="regsubmitfinal" />\r\n					</div>	\r\n				</form>\r\n				\r\n			<%  if(!page) { %>	\r\n				<div id="reglogin">\r\n					<span>Been here before <a href="#">sign in</a></span>\r\n				</div>\r\n			<% } %>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n'}),define("signup/views/registration-basics-final",["require","text!signup/templates/basciFinal.html","backbone","underscore","views","facade","utils"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.template=r.template(t,{page:e.openAsPopUp?!0:!1}),e.destination&&(this.$el=$(e.destination)),e.openAsPopUp&&(this.openAsPopUp=e.openAsPopUp),this.render()},render:function(){this.$el.html(this.template),this.registrationElements(),this.payload=this.finalRegistrationPayload(this.options.attr),this.fetchpayload(this.payload)},events:{"click .regsubmitfinal":"next","click #editname":"editName"},editName:function(e){e.preventDefault(),$(".firstdiv").empty();var t=this.getnameElement("first_name","First Name","firstname"),n=this.getnameElement("last_name","Last Name","lastname"),r=this.getLabel("First Name"),i=this.getLabel("Second Name");$(".firstdiv").append(r),$(".firstdiv").append(t),$(".firstdiv").append(i),$(".firstdiv").append(n)},getLabel:function(e){var t=$("<div/>").attr({"class":"label"}),n=$("<lable/>").attr({For:e}).html(e);return t.append(n),t},getnameElement:function(e,t,n){var r=$("<input/>").attr({name:n,type:"text",id:e,placeholder:t});return r},finalRegistrationPayload:function(e){payload={};var t=e.attr;return $.each(t,function(e,t){payload[t.name]=t.value}),payload},registrationElements:function(){var e={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31"},n={1920:"1920",1921:"1921",1922:"1922",1923:"1923",1924:"1924",1925:"1925",1926:"1926",1927:"1927",1928:"1928",1929:"1929",1930:"1930",1931:"1931",1932:"1932",1933:"1933",1934:"1934",1935:"1935",1936:"1936",1937:"1937",1938:"1938",1939:"1939",1940:"1940",1941:"1941",1942:"1942",1943:"1943",1944:"1944",1945:"1945",1946:"1946",1947:"1947",1948:"1948",1949:"1949",1950:"1950",1951:"1951",1952:"1952",1953:"1953",1954:"1954",1955:"1955",1956:"1956",1957:"1957",1958:"1958",1959:"1959",1960:"1960",1961:"1961",1962:"1962",1963:"1963",1964:"1964",1965:"1965",1966:"1966",1967:"1967",1968:"1968",1969:"1969",1970:"1970",1971:"1971",1972:"1972",1973:"1973",1974:"1974",1975:"1975",1976:"1976",1977:"1977",1978:"1978",1979:"1979",1980:"1980",1981:"1981",1982:"1982",1983:"1983",1984:"1984",1985:"1985",1986:"1986",1987:"1987",1988:"1988",1989:"1989",1990:"1990",1991:"1991",1992:"1992",1993:"1993",1994:"1994",1995:"1995",1996:"1996",1997:"1997",1998:"1998",1999:"1999",2e3:"2000",2001:"2001",2002:"2002",2003:"2003",2004:"2004",2005:"2005",2006:"2006",2007:"2007",2008:"2008",2009:"2009",2010:"2010",2011:"2011",2012:"2012",2013:"2013",2014:"2014",2015:"2015",2016:"2016",2017:"2017",2018:"2018"},r=this.option(e,"born");this.$el.find(".seconddiv").append(r);var i=this.option(t,"borndate");this.$el.find(".seconddiv").append(i);var s=this.option(n,"borndyear");this.$el.find(".seconddiv").append(s)},option:function(e,t){var n=$("<select/>").attr({"class":t});return $.each(e,function(e,t){var r=$("<option/>").attr({value:e}).html(t).appendTo(n)}),n},fetchpayload:function(e){this.$el.find("#first_name").val(e.firstname+" "+e.lastname),this.$el.find("#emailInput").val(e.email)},next:function(e){var t=this;e.preventDefault(),console.log(this.payload);var n=this.$(":input").serializeArray();$.each(n,function(e,t){payload[t.name]=t.value}),console.log(payload,"new payload"),this.payload.gender=$("input:radio[name=gender]").val(),this.payload.password=$("#password").val(),this.payload.re_password=$("#re_password").val(),this.payload.dob=$(".borndate").val()+"-"+$(".born").val()+"-"+$(".borndyear").val(),this.payload.accept_terms=!0,this.model.save(this.payload,{success:function(e){location.href="#usersettings",$("#RegModal").modal("hide")},error:function(e){$(".errormsg").remove();var n=jQuery.parseJSON(e.request.responseText);errorArray=n.exec_data.error_array,$.each(errorArray,function(e,n){t.displayErrors(n)})}})},displayErrors:function(e){var t=$("#"+e.field),n=t.width();if(n){console.log(t.position(),"fieldName",n,"elemet width");var r=this.displayMesage(t.position(),e.error,n);$("#finalreg").append(r)}},displayMesage:function(e,t,n){console.log(n,"widthele");var r=e.left+15;r+=n,console.log(r,"posleft");var i=$("<div/>").attr({name:"error message","class":"errormsg"}).css({width:"200px",height:"50px",position:"absolute",top:e.top,left:r,color:"#CE0009"}).html(t);return i}}),i}),define("signup/models/image-upload",["models/base"],function(e){var t;return t=e.extend({defaults:{},url:"/api/user/savecrop/425983",payload:{}}),t}),define("text!signup/templates/imageupload.html",[],function(){return' <style type="text/css">\r\n\r\n </style>\r\n <div id="regcontainer">\r\n    <div id="mainregimg">\r\n      <div id="header">\r\n      <span class="regheader"> Upload a user pic</span>\r\n    </div>\r\n      <div id="imgcontainer" class="imgcontainer">\r\n       \r\n        <div class="textcenter pane" id="imgpreview" >\r\n          <img id="image-select" style="max-height: 245px; max-width: 320px;" />\r\n            <div class="coords" style="display:none;">\r\n                <div>crop x <input name="crop-x" type="hidden" /></div>\r\n                <div>crop y <input name="crop-y" type="hidden" /></div>\r\n                <div>crop width <input name="crop-width" type="hidden" /></div>\r\n                <div>crop height <input name="crop-height" type="hidden" /></div>\r\n                <div>image width <input name="image-width" type="hidden" /></div>\r\n                <div>image height <input name="image-height" type="hidden" /></div>            \r\n            </div>\r\n        </div>\r\n        <div id="imguploader" class="imguploader">\r\n          <input type="file" name= "preview" id="preview">\r\n        </div>\r\n        <div class="inputmask">\r\n          <div class="selectlabel">Select File</div>\r\n          <div class="showselected"></div>\r\n        </div>  \r\n         \r\n        <div id="imgupload"  class="imgupload">\r\n          <input type="submit" name="imgup" id="crpimgup" value="Crop and save" class="imgup" /> \r\n           <input type="submit" name="skip" id="skip" value="Skip" class="imgup" />   \r\n        </div>\r\n        \r\n      </div>\r\n    </div>  \r\n  </div>   '}),define("signup/views/image-upload",["require","text!signup/templates/imageupload.html","backbone","underscore","views","facade","utils","jquery.jrac"],function(e,t,n,r){var i,s=e("facade"),o=e("views"),u=e("utils"),a=u.lib.Channel,f=n.View;return i=f.extend({initialize:function(e){this.template=r.template(t),this.$el=$(e.destination),this.render()},render:function(){this.$el.html(this.template),this.userinfo(this.options.attr)},events:{"change input":"preview","click #crpimgup":"imageupload","click #skip":"skip"},skip:function(e){e.preventDefault(),window.location.href="#usersettings"},userinfo:function(e){},preview:function(e){this.removeCropView();var t=window.URL||window.webkitURL;window.fileURL=t.createObjectURL(e.target.files[0]),this.srcimg=window.fileURL,$("#image-select").attr({src:window.fileURL}),this.initCropView()},initCropView:function(){$("#image-select").jrac({crop_width:200,crop_height:240,crop_aspect_ratio:"1:1",crop_x:0,crop_y:0,crop_resize:!1,viewport_resize:!1,viewport_onload:function(){var e=this,t=e.$container.parent(".pane").find(".coords input:hidden"),n=["jrac_crop_x","jrac_crop_y","jrac_crop_width","jrac_crop_height","jrac_image_width","jrac_image_height"];for(var r=0;r<n.length;r++){var i=n[r];e.observator.register(i,t.eq(r)),t.eq(r).bind(i,function(e,t,n){$(this).val(n)}).change(i,function(t){var n=t.data;e.$image.scale_proportion_locked=e.$container.parent(".pane").find(".coords input:checkbox").is(":checked"),e.observator.set_property(n,$(this).val())})}e.$container.append('<div class="natual-size">Image natual size: '+e.$image.originalWidth+" x "+e.$image.originalHeight+"</div>")}}).bind("jrac_events",function(e,t){var n=$(this).parents(".pane").find(".coords input");n.css("background-color",t.observator.crop_consistent()?"chartreuse":"salmon")})},imageupload:function(e){e.preventDefault(),this.getImageInfo()},removeCropView:function(){$("#image-select").jrac("destroy"),$("#image-select").parent().find(".natual-size").remove()},getImageInfo:function(){var e=[],t=this.$(".coords :input").serializeArray();e.image_url=this.srcimg,$.each(t,function(t,n){e[n.name]=n.value}),console.log(e,"finalRegistrationPayload"),this.model.save(e,{success:function(e){a("upload-user-image").publish(e)},error:function(){}})}}),i}),define("signup",["require","text!signup/templates/layout.html","facade","controller","models","views","utils","signup/models/registerbasic","signup/models/registration-basics-final","signup/views/registerbasic","signup/views/registration-basics-final","signup/models/image-upload","signup/views/image-upload"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("signup/models/registerbasic"),f=e("signup/models/registration-basics-final"),l=e("signup/models/image-upload"),c=e("signup/views/registerbasic"),h=e("signup/views/registration-basics-final"),p=e("signup/views/image-upload"),d=o.LayoutView,v=r.$,m=r._,g=u.debug,y=u.lib.Channel,b=["/pages/signup/css/signupstyle.css","/css/style.jrac.css","/pages/imageup/imageup.css"];return n=i.extend({initialize:function(e){return y("load:css").publish(b),m.bindAll(this),this.handleOptions(e),this.init(),this},init:function(){this.refreshPage(),this.setupLayout(),this.createData(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],v("div#modalPopup").remove(),v("body").append('<div id="modalPopup"></div>'),pageLayout=new d({scheme:this.scheme,destination:"#modalPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.select_type=new a},refreshPage:function(){this.selectTypeView&&(v(this.selectTypeView.destination).html(""),position=v.inArray(this.selectTypeView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){v("#imgUploadModal").modal("show"),v("#imgUploadModal").on("hidden",function(){}),v("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){function t(t){e.initRegisterFinal({attr:t})}function n(t){e.uploadUserImage({attr:t})}var e=this;routing.off("register-basic"),routing.on("register-basic",function(){e.setupSelectTypeView()}),routing.off("register-basic-final"),routing.on("register-basic-final",function(e){t(e)}),routing.off("upload-user-image"),routing.on("upload-user-image",function(e){n(e)})},initRegisterFinal:function(e){this.basic_type=new f,this.selectRegisterBasicFinalView=new h({model:this.basic_type,name:"Final registration",destination:"#main-contentreg",attr:e}),this.layout.render()},uploadUserImage:function(e){this.basic_type=new l,this.selectRegisterBasicFinalView=new p({model:this.basic_type,name:"Final registration",destination:"#main-contentreg",attr:e}),this.layout.render()},setupSelectTypeView:function(){this.selectTypeView=new c({model:this.select_type,name:"Select Registration Type",destination:"#main-contentreg"}),this.scheme.push(this.selectTypeView),this.layout.render()}}),n}),define("signup/views/facebooksignup",["vendor","views","registration","signup","signup/views/shopopup","utils/storage"],function(e,t,n,r,i,s){var o,u=t.BaseView,a=e.$,f=e._,l=e.Mustache;return o=u.extend({signupFacebook:function(){var e=this;this.registrationController||(this.registrationController=new n);var t=f.bind(e.getFBlogin,this);this.Fbinit(t),this.loadFBLogin()},Fbinit:function(e){var t=this;window.fbAsyncInit=function(){console.log("facebook"),FB.init({appId:"219148511595084",status:!0,cookie:!0,xfbml:!0,oauth:!0}),e()}},loadFBLogin:function(){this.registrationController.refreshPage();var e,t="facebook-jssdk",n=document.getElementsByTagName("script")[0];document.getElementById(t)&&(this.loginInfo=this.loginfb(),this.return),e=document.createElement("script"),e.id=t,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(e,n)},getFBlogin:function(){var e=this;FB.getLoginStatus(function(t){t.status==="connected"?FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")}):t.status==="not_authorized"?(console.log("not_authorized"),e.loginInfo||(e.loginInfo=e.loginfb())):e.loginInfo||(e.loginInfo=e.loginfb())},{scope:"email, user_birthday, user_photos"})},loginfb:function(){FB.login(function(e){e.authResponse?routing.trigger("registration-with-facebook"):alert("Cancelled ")},{scope:"email, user_birthday, user_photos"})},checkFBlogin:function(){FB.getLoginStatus(function(e){e.status==="connected"&&FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")})},{scope:"email, user_birthday, user_photos"})}}),o}),define("signup/views/registerbasic",["require","text!signup/templates/registration.html","backbone","underscore","registration","views","signup/views/facebooksignup","facade","utils","signup/views/registration-basics-final","signup/models/registration-basics-final"],function(e,t,n,r,i){var s,o=e("facade"),u=e("views"),a=e("signup/views/facebooksignup"),f=e("utils"),l=f.lib.Channel,c=e("signup/views/registration-basics-final"),h=e("signup/models/registration-basics-final"),p=n.View;return s=p.extend({initialize:function(e){e.openAsaPage&&(this.openAsaPage=e.openAsaPage),this.registrationController=new i({route:""}),this.template=r.template(t,{onlyRegister:this.openAsaPage?!0:!1}),this.$el=$(e.destination),console.log("REG BLOCK:",this.$el),$("#errormsg, #preview").html(""),p.prototype.initialize.call(this,e),debug.log("Image upload basic view"),this.openAsaPage||($("#RegModal").modal("show"),$("#RegModal").on("hidden",function(){}),$("#RegModal").on("hide",function(){$("div#modalPopup").remove()})),this.render()},render:function(){this.$el.html(this.template)},events:{"click .regsubmit":"next","click #fbpane":"signupFacebook"},next:function(e){e.preventDefault();var t=this.$(":input").serializeArray(),n=!0;$.each(t,function(e,t){if(!t.value)return alert(t.name+" is blank"),n=!1,!1});if(this.openAsaPage&&n){this.basic_type=new h;var r={model:this.basic_type,name:"Final registration",attr:{attr:t},openAsPopUp:!0};this.selectRegisterBasicFinalView=new c(r),$("#RegModal .modal-body").append(this.selectRegisterBasicFinalView.$el),$("#RegModal").modal("show")}else n&&routing.trigger("register-basic-final",t,page)},signupFacebook:function(e){e.preventDefault(),$("#RegModal").modal("hide"),headView=new a,headView.signupFacebook()}}),s}),define("text!location/templates/city.html",[],function(){return'<input id="city" type="text" placeholder="Enter a City"/>'}),define("packages/location/views/city",["require","text!location/templates/city.html","views","facade","utils","jqueryui","controller"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("controller");return n=o.extend({template:t,className:"ui-front",initialize:function(e){o.prototype.initialize.call(this,e),this.id=e.id||this.id||a.unique("v"),this.addSubscribers()},initPlugin:function(){var e=this,t=this.model.id;u("#city").autocomplete({minLength:2,source:function(e,n){var r=e.term,i=l.prototype.appStates;if(i){var s=i.findByNameInStorage(r);if(s){n(s.data);return}}var o=function(e){var t=l.prototype.appStates;t&&(t.add({name:r,data:e,storage:"localStorage",expires:new Date(Date.now()+3154e5)}),t.save(r)),n(e)};Channel("response :"+r).subscribe(o),Channel("changeInput"+t).publish(r)},select:function(t,n){Channel("cityChanged:"+e.id).publish(n.item),f.log(n.item)}})},addSubscribers:function(){var e=this;Channel("layout:ready").subscribe(e.initPlugin)}}),n}),define("home",["require","text!pages/home/templates/layout.html","facade","controller","models","views","utils","pages/home/models/menu","packages/location/models/city","signup/models/registerbasic","packages/sport/collections/sports","pages/home/collections/image","location/collections/states","pages/home/views/menu","pages/home/views/image-list","pages/home/views/state-list","packages/sport/views/sport-list","signup/views/registerbasic","packages/location/views/city"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("packages/sport/collections/sports"),f=e("location/collections/states"),l=e("pages/home/collections/image"),c=e("pages/home/models/menu"),h=e("packages/location/models/city"),p=e("signup/models/registerbasic"),d=e("pages/home/views/menu"),v=e("signup/views/registerbasic"),m=e("pages/home/views/image-list"),g=e("pages/home/views/state-list"),y=e("packages/sport/views/sport-list"),b=e("packages/location/views/city"),w=o.LayoutView,E=r.$,S=r._,x=u.lib.Channel,T=[base_url+"pages/home/home.css"];return n=i.extend({searchPage:0,initialize:function(e){return x("load:css").publish(T),S.bindAll(this),this.handleOptions(e),e.userId&&(this.userId=e.userId),this.scheme=[],this.genderTypes=["boys","girls","both"],this.init(),this},init:function(){this.initUrlOptions(),this.createData(),this.handleDeferreds()},initUrlOptions:function(){this.searchUrls=["/api/video/search","/api/image/search","/api/user/search","/api/game/search"],this.baseUrl=this.searchUrls[2],this.urlOptions={sports_id:"0",cities_id:"0",orderby:"random",time:"DAY",states_id:"0",searchtext:"",country_id:"0"},this.menuValues=[{src:".view-options-h .browse.select",target:".view-link-h .option-heading-h",input:!1,defaultValue:"ORDER"},{src:".sports-option-h .sport.select",target:".sport-link-h .option-heading-h",input:!1,defaultValue:"ALL SPORTS"},{src:"#city",target:".location-link-h .option-heading-h",input:!0,defaultValue:"ANYWHERE"},{src:"#resulttype a.restype.select",target:".restype-link-h .option-heading-h",input:!1,defaultValue:"ATHLETES"}],this.viewOptions=["orderby","time"],this.sportsOptions=["sports_id"],this.locationOptions=["cities_id","states_id","country_id"]},addSubscribers:function(){var e=this;S.each(this.genderTypes,function(e){x("sportChanged:"+this.collections[e].cid).subscribe(this.changeSportFilter)},this),x("cityChanged:"+this.sections.city.id).subscribe(this.changeCityFilter),routing.on("stateChanged",function(t){e.changeStateFilter(t)}),x("textChanged").subscribe(this.updateText),x("viewFilterChanged").subscribe(this.changeViewFilter),x("baseUrlChanged").subscribe(this.updateBaseUrl),x("resetFilter").subscribe(this.resetFilter)},setupScheme:function(){var e,t=this.params;for(e=0;e<this.meta.activeViews.length;e++)this.scheme.push(this.sections[this.meta.activeViews[e]])},initSections:function(){this.setupMenuView(),S.each(this.genderTypes,this.setupSportListView),S.each(["top-rated","search-result"],this.setupImageListView),this.setupLocationDDView(),this.setupScheme(),this.setupLayout().render(),this.setUpRegistrationView(),this.cityView&&this.cityView.initPlugin(),this.userId&&E(".register-wrapper, .register-wrapper-h").hide().html("")},updateBaseUrl:function(e){this.baseUrl=this.searchUrls[e],this.transitionView()},updateText:function(e){this.urlOptions.searchtext=e,this.transitionView()},changeViewFilter:function(e){e.submenu==="browse"?options={orderby:e.value}:options={time:e.value},this.transitionView(options)},changeSportFilter:function(e){console.log(e);var t={sports_id:e.attributes.payload.sport_id};this.transitionView(t)},changeStateFilter:function(e){var t={states_id:e};this.transitionView(t)},changeCityFilter:function(e){e.label&&E("#city").val(e.label);var t={cities_id:e.id,states_id:e.state_id,country_id:e.country_id};this.transitionView(t)},resetFilter:function(e){for(var t in this.menuValues)this.menuValues[t].input?E(this.menuValues[t].src).val(""):E(this.menuValues[t].src).removeClass("select");switch(e){case"view":for(var t in this.viewOptions)this.viewOptions[t]=="orderby"?(E(".dropdown-menu .browse").removeClass("select"),this.urlOptions[this.viewOptions[t]]="random"):t=="time"&&(this.urlOptions[this.viewOptions[t]]="today");break;case"sports":for(var t in this.sportsOptions)this.urlOptions[this.sportsOptions[t]]="0";break;case"location":for(var t in this.locationOptions)this.urlOptions[this.locationOptions[t]]="0"}this.transitionView()},transitionView:function(e){this.searchPage=0,this.searchView(e)},searchView:function(e){var t=this,n="search-result",r=this.collections[n];controller=this,r.url=this.url(e),r.fetch(),E.when(r.request).done(function(){r.length<12?E(".right-arrow-page-h").addClass("disable-arrow-link"):E(".right-arrow-page-h").removeClass("disable-arrow-link"),t.searchPage==0?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link");var e=new m({collection:r,name:n,destination:"#"+n});controller.layout.transition(n,e)});for(var i in this.menuValues){if(this.menuValues[i].input)var s=E(this.menuValues[i].src).val();else var s=E(this.menuValues[i].src).text();s!=""?E(this.menuValues[i].target).html(s):E(this.menuValues[i].target).html(this.menuValues[i].defaultValue)}},bindCickEvents:function(){var e=this;E(document).on("click",".left-arrow-page-h",function(){e.searchPage--,e.searchView()}),E(document).on("click",".right-arrow-page-h",function(){e.searchPage++,e.searchView()}),e.searchPage==0?E(".left-arrow-page-h").addClass("disable-arrow-link"):E(".left-arrow-page-h").removeClass("disable-arrow-link")},url:function(e){var t=this.baseUrl+"?offset="+this.searchPage+"&";S.extend(this.urlOptions,e);var n=[];return E.each(this.urlOptions,function(e,t){n.push(e+"="+encodeURIComponent(t))}),t+n.join("&")},createData:function(){var e=this.collections={};e["search-result"]=new l([],{url:this.url(),num:"12"}),e.state=new f,e["top-rated"]=new l([],{url:"/api/user/search",num:"4"}),S.each(this.genderTypes,function(t){e[t]=new a([],{name:t})})},handleDeferreds:function(){var e=this,t=[];S.each(this.collections,function(e,n,r){t.push(e.fetch())}),E.when.apply(E,t).done(e.initSections,e.addSubscribers)},setupImageListView:function(e){var t;t=new m({collection:this.collections[e],name:e,destination:"#"+e}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setupSportListView:function(e){var t;t=new y({collection:this.collections[e],name:e,id:e,destination:"#sport #"+e}),t.render(),this.sections[e]=t,this.meta.activeViews.push(e)},setUpRegistrationView:function(){var e;this.select_type=new p,this.selectTypeView=new v({model:this.select_type,name:"Select Registration Type",destination:".register-wrapper-h",openAsaPage:!0})},setupMenuView:function(){var e=new c,t,n="menu";t=new d({model:e,name:n,destination:"#"+n}),t.render(),this.sections[n]=t,this.meta.activeViews.push(n)},setupLocationDDView:function(){var e,t="state",n=new h,r="city";this.cityView=new b({model:n,name:r,destination:"#location .city"}),this.cityView.render(),this.sections[r]=this.cityView,this.meta.activeViews.push(r)},setupLayout:function(){var e;return e=new w({scheme:this.scheme,destination:"#main",template:t,displayWhen:"ready"}),this.layout=e,this.bindCickEvents(),this.layout}}),n});