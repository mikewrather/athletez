define(["vendor","views","registration","signup","signup/views/shopopup","utils/storage"],function(e,t,n,r,i,s){var o,u=t.BaseView,a=e.$,f=e._,l=e.Mustache;return o=u.extend({signupFacebook:function(){var e=this;this.registrationController||(this.registrationController=new n);var t=f.bind(e.getFBlogin,this);this.Fbinit(t),this.loadFBLogin()},Fbinit:function(e){var t=this;window.fbAsyncInit=function(){FB.init({appId:"239430712864961",status:!0,cookie:!0,xfbml:!0,oauth:!0}),e()}},loadFBLogin:function(){this.registrationController.refreshPage();var e,t="facebook-jssdk",n=document.getElementsByTagName("script")[0];document.getElementById(t)&&(this.loginInfo=this.loginfb(),this.return),e=document.createElement("script"),e.id=t,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(e,n)},getFBlogin:function(){var e=this;FB.getLoginStatus(function(t){t.status==="connected"?FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")}):t.status==="not_authorized"?(console.log("not_authorized"),e.loginInfo||(e.loginInfo=e.loginfb())):e.loginInfo||(e.loginInfo=e.loginfb())},{scope:"email, user_birthday, user_photos"})},loginfb:function(){FB.login(function(e){e.authResponse?routing.trigger("registration-with-facebook"):alert("Cancelled ")},{scope:"email, user_birthday, user_photos"})},checkFBlogin:function(){FB.getLoginStatus(function(e){e.status==="connected"&&FB.api("/me",function(e){console.log(e),routing.trigger("registration-with-facebook")})},{scope:"email, user_birthday, user_photos"})}}),o});