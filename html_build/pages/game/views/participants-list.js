define(["facade","views","utils","media/views/image-item","text!game/templates/participats-list.html","game/models/addparticipate"],function(e,t,n,r,i,s){var o,u,a=e.$,f=e._,l=require("vendor"),c=n.lib.Channel,h=t.CollectionView,p=t.SectionView,d=l.Mustache;return ParticipantsView=h.extend(p.prototype),ParticipantsView.extend({__super__:h.prototype,template:i,_tagName:"li",_className:"image",page:0,page_limit:8,listView:".image-list",_view:r,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=d.to_html(this.template,{target:this.target_id});return this.$el.html(e),this},addParticipant:function(){var e=new s,t=this;e.set({games_id:this.game_id,sports_id:this.sports_id}),e.save(),a.when(e.request).done(function(){t.controller.reloadParticipateView()})},initialize:function(e){var t=this;a(document).off("click",".add-to-event"),a(document).on("click",".add-to-event",function(){t.addParticipant()}),a(".participants-heading-h").removeClass("hide"),e.name?this.name=e.name:this.name="image list",e.collecton&&(this.collection=e.collection),this.sports_id=e.sports_id,this.game_id=this.collection.id,this.renderTemplate();var n=this.collection.toArray(),r=n[0].get("payload"),i=[];for(var s in r)console.error(routing.loggedInUserId==r[s].id),routing.loggedInUserId==r[s].id&&this.$el.find(".add-to-event").hide(),i.push({payload:r[s]});this.collection.reset(i),this.target_id=e.target_id,this.target_url=e.target_url,this.sport_id=e.sport_id;var t=this;t.allData=this.collection.toArray(),t.seeMore(),h.prototype.initialize.call(this,e);if(!this.collection)throw new Error("ImageListView expected options.collection.");f.bindAll(this),this.addSubscribers(),this.setupAddView()},seeMore:function(e){var t=this.allData.length,n=this.page*this.page_limit,r=n+this.page_limit;t<=r&&this.$el.find(".see-more-h").hide(),e?this.collection.add(this.allData.slice(n,r)):this.collection.reset(this.allData.slice(n,r)),this.page++,e&&(this.addSubscribers&&this.addSubscribers(),this.setupAddView&&this.setupAddView())},childViews:{},setupAddView:function(){function r(e){t.model=e,t.render(),a(this.listView).append(t.el)}var e,t=new AddImageView({collection:this.collection}),n=this.addChildView(t);this.childViews.form=t,this.callbacks.add(function(){n()}),c("addimage:fetch").subscribe(r)},filterWithImageType:function(e){var t=this.collection;return a.each(t.models,function(t,n){n.selectImageType&&n.selectImageType(e)}),t}})});