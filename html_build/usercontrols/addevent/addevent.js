define(["require","text!usercontrols/addevent/templates/layout.html","facade","controller","models","views","user/models/basic_info","usercontrols/addevent/views/main"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=r.$,f=r._,l=u.debug,c=u.lib.Channel,h=o.LayoutView,p=e("user/models/basic_info"),d=e("usercontrols/addevent/views/main"),v=i.extend({cssArr:["/usercontrols/addevent/addevent.css"],events:{},initialize:function(e){return c("load:css").publish(this.cssArr),f.bindAll(this),e.id&&(this.id=e.id),e.sports_id&&(this.sports_id=e.sports_id),e.users_id&&(this.users_id=e.users_id),this.callback=e.callback,e.popup&&(this.popup=!0),this.init(),this},init:function(){this.popup?this.setupPopupLayout().render():this.setupLayout().render(),this.setUpMainView(),this.handleDeferreds()},setupLayout:function(){if(this.layout)return this.layout;var e=new h({scheme:this.scheme,destination:"#main",template:"",displayWhen:"ready"});return this.layout=e,this.layout},setupPopupLayout:function(){var e;this.scheme=[];var e=new h({scheme:this.scheme,destination:"#modalBody",template:"",displayWhen:"ready"});this.layout=e,this.modelBoxId="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50);var t={};return t.height="500px",t.width="500px",t.title="Add Event",t.id=this.modelBoxId,routing.trigger("common-popup-open",t),this.layout},setUpMainView:function(){var e=this;routing.off("add-event-success"),routing.on("add-event-success",function(t){e.addTeamFunction(t)});var n=this;this.addGameView=new d({model:new p,template:t,name:"add-event-main",destination:this.popup?"#"+this.modelBoxId+" #modalBody":"#main",user_id:n.users_id,channel:"add-event-success",sports_id:this.sports_id,teams_id:this.teams_id}),this.scheme.push(this.addGameView),this.layout.render(),a("#modalPopup .modal-body").slimScroll({height:"430px",railVisible:!0,allowPageScroll:!0,disableFadeOut:!0})},addTeamFunction:function(e){this.callback&&this.callback(e)}});return v});