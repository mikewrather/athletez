define(["require","text!usercontrols/imagecropper/templates/layout.html","facade","controller","views"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("views"),o=e("utils"),u=r.$,a=r._,f=o.lib.Channel,l=s.LayoutView;return n=i.extend({cssArr:["/usercontrols/imagecropper/imagecropper.css"],events:{"click button.close":"alertsomething"},initialize:function(e){console.log("init");var t=this;f("load:css").publish(this.cssArr),a.bindAll(this),console.log(e),this.image_o=e.image_o?e.image_o:"",this.image_e=e.image_e?e.image_e:"",this.modelHTML='<div id="modalPopup" class="modal imagecropper hide fade model-popup-h"><div class="modal-header"><span>Athletez Profile Pic Editor</span><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></div><div class="modal-body page-content-h"></div></div>',this.setupLayout().render(),this.handleDeferreds()},handleDeferreds:function(){},setupLayout:function(){var e=this;this.scheme=[];var t="/vendor/plugins/iedit2/index.html?vh=500&vw=500&sx=0&sy=0&sz=100&t=Profile%20Picture&edit=";this.image_e!=""&&(t+="&edit="+this.image_e),this.image_o!=""&&(t+="&o="+this.image_o);var n={};return n.width="100%",n.height="100%",n.title="Change your Athletez Photo",n.html='<iframe src="'+t+'" id="cropper_iframe" style="width:100%;height:100%;margin:0;"></iframe>',n.id="change-userpic-modal",n.addClass=["noBorder"],routing.trigger("common-popup-open",n),u("#"+n.id+" .close").bind("click",function(){e.notifyUpdate()}),this.layout},notifyUpdate:function(){f("userpic-changed").publish()}}),n});