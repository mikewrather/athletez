define(["require","text!usercontrols/location/templates/get-view-location.html","facade","views","utils","vendor","usercontrols/location/models/verify-adress"],function(e,t){var n,r=e("facade"),i=e("views"),s=i.SectionView,o=e("utils"),u=o.lib.Channel,a=e("vendor"),f=e("usercontrols/location/models/verify-adress"),l=a.Mustache,c=r.$,h=i.BaseView,p=r.Backbone,d;return p.View.extend({template:t,events:{"click .verify-address-h":"verifyAddress","blur .address-h":"verifyAddress"},initialize:function(e){d=this,d.location={},e.callback&&(this.callback=e.callback),d.location.latitude=!_.isUndefined(e)&&!_.isUndefined(e.latitude)?e.latitude:undefined,d.location.longitude=!_.isUndefined(e)&&!_.isUndefined(e.longitude)?e.longitude:undefined,d.setOptions(e),d.render()},intializeMap:function(){},verifyAddress:function(){var e=this,t=e.$el.find(".address-h").val();e.adressModel=new f,e.adressModel.address=t,e.adressModel.url(),e.adressModel.set({address:t}),e.adressModel.showError=function(t,n){try{e.$el.find(".set-address-h").addClass("link-disabled"),e.$el.find(".address-error-status-h").removeClass("hide").html(n.responseJSON.exec_data.error_array[0].error)}catch(r){}e.$el.find(".address-h").addClass("address-field-error").removeClass("address-verified")},e.adressModel.save({dataType:"json"}),e.$el.find(".address-h").removeClass("address-verified"),e.callback(""),c.when(e.adressModel.request).done(function(){console.log(e.adressModel.toJSON()),e.locationId=e.adressModel.get("payload").id;if(e.locationId){e.$el.find(".address-error-status-h").addClass("hide"),e.$el.find(".address-h").removeClass("address-field-error").addClass("address-verified"),e.location.latitude=e.adressModel.get("payload").lat,e.location.latitude=e.adressModel.get("payload").lon,e.$el.find(".set-address-h").removeClass("link-disabled"),e.callback(e.locationId);if(e.map){var t=new google.maps.LatLng(e.adressModel.get("payload").lat,e.adressModel.get("payload").lon);e.marker.setPosition(t),e.map.panTo(t)}else e.createMap()}})},createMap:function(){var e=this,t=new google.maps.LatLng(e.location.latitude,e.location.latitude),n={zoom:8,center:t,scaleControl:!0,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};this.$el.find("#map-canvas-h").show(),this.map=new google.maps.Map(document.getElementById("map-canvas-h"),n),this.marker=new google.maps.Marker({position:t,map:this.map}),this.marker.setMap(this.map)},render:function(){var e=this,t=l.to_html(e.template,{location:e.locaion});return c(e.el).html(t),setTimeout(function(){e.intializeMap()},1e3),this},setOptions:function(e){for(var t in e)this[t]=e[t]}})});