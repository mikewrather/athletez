define(["require","text!common/templates/heading.html","facade","views","votes/models/follow","roster/models/roster","vendor","vendor/plugins/qtip/qtip","text!vendor/plugins/qtip/qtip.css"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("votes/models/follow"),o=e("roster/models/roster"),u=i.BaseView,a=e("vendor"),f=a.Mustache;return n=u.extend({events:{"click .add-image-h":"addImage","click .add-video-h":"addVideo","click .question":"addQuestion","click .add-to-list-h":"addToList","click .invite-fans-from-fb-h":"InviteFromFB","click .invite-participant-from-fb-h":"InviteFromFB","click .add-to-roster-list-h":"addToRoster","click .add-to-participants-list-h":"addParticipant","click .invite-roster-from-fb-h":"InviteFromFB"},addImage:function(e){var t=$(e.currentTarget).data("page-base")||"user",n=$(e.currentTarget).data("ent-id"),r=$(e.currentTarget).data("sports-id");ga("send","event","Open-Add-Popup","Image","User opened "+t+" image uploader",n);var i=$(".selected-sport-h").data("id")||$(".sports-h").val()||$(".sports-h").attr("data-id"),s="/api/"+t+"/addimage/"+n,o={sports_id:r};routing.trigger("add-image",s,o)},addVideo:function(e){ga("send","event","Open-Add-Popup","Video","User opened video uploader",this.model.userid);var t="/api/user/addvideo/"+this.model.userid;Channel("add-video").publish(t)},addQuestion:function(e){},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},addParticipant:function(e){routing.trigger("add-to-event")},addToList:function(e){e.preventDefault();var t=this,n=function(n){var r=new s;r.subject_id=t.collection.id,r.entity_id=t.controllerObject.basics.get("payload").enttypes_id,r.save(),$.when(r.request).done(function(){typeof r.get("payload").follower=="object"&&typeof r.get("payload").subject=="object"&&r.get("payload").id>0&&($(e.target).addClass("link-disabled"),t.controllerObject&&t.controllerObject.reloadFans&&t.controllerObject.reloadFans()),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},InviteFromFB:function(e){var t=this,n={};console.log(t.controllerObject),t.data.inviteData==undefined||!typeof t.data.inviteData==="object"?(n.invite_type="follow",n.subject_id=t.target_id?t.target_id:t.controllerObject.basics.get("payload").id,n.enttype_id=t.controllerObject.basics.get("payload").enttypes_id):n=t.data.inviteData,console.log(n);var r=function(){routing.trigger("fbInvite",undefined,n)};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},addToRoster:function(e){this.addToRoster&&this.addToRoster()},className:"pull-left",initialize:function(e){console.error(e);for(var t in e)this[t]=e[t];this.data=e,this.render()},render:function(){var e=this,n=f.to_html(t,{heading:this.heading});this.$el.html(n),$(this.target).html(this.$el);var r=f.to_html(this.template,{data:this.data});this.$el.find(".buttons-h").html(r),this.$el.find("a").each(function(){$(this).qtip({content:$(this).data("content"),position:{my:"bottom center",at:"top center"},style:{classes:$(this).data("tip-style")}})})}}),n});