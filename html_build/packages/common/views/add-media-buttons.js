define(["require","text!common/templates/heading.html","facade","views","votes/models/follow","roster/models/roster","vendor/plugins/qtip/qtip","text!vendor/plugins/qtip/qtip.css"],function(e,t){var n,r=e("facade"),i=e("views"),s=e("votes/models/follow"),o=e("roster/models/roster"),u=i.BaseView;return n=u.extend({events:{"click .add-image-h":"addImage","click .add-video-h":"addVideo","click .question":"addQuestion","click .add-to-list-h":"addToList","click .invite-fans-from-fb-h":"InviteFansFromFB","click .add-to-roster-list-h":"addToRoster","click .invite-roster-from-fb-h":"inviteRosterFromFB"},addImage:function(e){ga("send","event","Open-Add-Popup","Image","User opened image uploader",this.model.userid);var t=$(".selected-sport-h").data("id")||$(".sports-h").val()||$(".sports-h").attr("data-id"),n="/api/user/addimage/"+this.model.userid,n="/api/user/addimage/"+this.model.userid,r={sports_id:t};routing.trigger("add-image",n,r)},addVideo:function(e){ga("send","event","Open-Add-Popup","Video","User opened video uploader",this.model.userid);var t="/api/user/addvideo/"+this.model.userid;Channel("add-video").publish(t)},addQuestion:function(e){},checkForUser:function(){return!_.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},addToList:function(e){e.preventDefault();var t=this,n=function(n){var r=new s;r.subject_id=t.collection.id,r.entity_id=t.controllerObject.basics.get("payload").enttypes_id,r.save(),$.when(r.request).done(function(){typeof r.get("payload").follower=="object"&&typeof r.get("payload").subject=="object"&&r.get("payload").id>0&&($(e.target).addClass("link-disabled"),t.controllerObject&&t.controllerObject.reloadFans&&t.controllerObject.reloadFans()),n&&n()})};t.checkForUser()?n():routing.trigger("showSignup",function(e){n(function(){e&&e()})})},InviteFansFromFB:function(e){var t=this,n={},r=function(){n.invite_type="follow",n.subject_id=t.target_id,n.enttype_id=t.controllerObject.basics.get("payload").enttypes_id,routing.trigger("fbInvite",undefined,n)};t.checkForUser()?r():routing.trigger("showSignup",function(e){r(function(){e&&e()})})},addToRoster:function(e){this.addToRoster&&this.addToRoster()},inviteRosterFromFB:function(e){var t=this,n={};n.subject_id=this.team_id,n.enttype_id=this.entityId,routing.trigger("fbInvite",undefined,n)},className:"pull-left",initialize:function(e){for(var t in e)this[t]=e[t];this.data=e,this.render()},render:function(){var e=this,n=Mustache.to_html(t,{heading:this.heading});this.$el.html(n),$(this.target).html(this.$el);var r=Mustache.to_html(this.template,{data:this.data});this.$el.find(".buttons-h").html(r),this.$el.find("a").each(function(){$(this).qtip({content:$(this).data("content"),position:{my:"bottom center",at:"top center"},style:{classes:$(this).data("tip-style")}})})}}),n});