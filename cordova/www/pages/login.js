define(["require","text!login/templates/layout.html","application","facade","controller","models","views","utils","login/models/Loginmodel","login/views/Loginview","login/models/Logoutmodel"],function(e,t){var n,r=e("facade"),i=e("controller"),s=e("models"),o=e("views"),u=e("utils"),a=e("login/models/Loginmodel"),f=e("login/views/Loginview"),l=e("login/models/Logoutmodel"),c=o.LayoutView,h=r.$,p=r._,d=u.debug,v=u.lib.Channel,m=[base_url+"pages/imageup/imageup.css"],g=i.extend({initialize:function(e){return v("load:css").publish(m),this.callback=e.callback,p.bindAll(this),this.handleOptions(e),!p.isUndefined(e.attr)&&p.isObject(e.attr)&&(this.attr=e.attr),this.init(),this},init:function(){this.refreshPage(),this.setupLayout(),this.createData(),this.refreshPage(),this.handleDeferreds()},setupLayout:function(){return this.scheme=[],pageLayout=new c({scheme:this.scheme,destination:"#LoginPopup",template:t,displayWhen:"ready"}),this.layout=pageLayout,this.layout},createData:function(){this.login_type=new a},refreshPage:function(){this.loginView&&(h(this.loginView.destination).html(""),position=h.inArray(this.loginView,this.scheme),~position&&this.scheme.splice(position,1))},showPopup:function(){h("#imgUploadModal").modal("show"),h("#imgUploadModal").on("hidden",function(){}),h("#imgUploadModal").on("hide",function(){})},handleDeferreds:function(){var e=this;routing.off("Login"),routing.on("Login",function(){e.setupLoginView()}),routing.off("Logout"),routing.on("Logout",function(t){e.setupLogout(t)})},setupLogout:function(e){var t=this;this.logoutcheck=new l,this.logoutcheck.fetch(),h.when(this.logoutcheck.request).done(function(){e!=undefined&&e.clear(),window.localStorage.clear(),location.href="/"})},setupLoginView:function(){var e="modal-popup-"+Math.floor(Math.random()*Math.random()*50*Math.random()*50),t="#"+e+" #modalBody",n={};n.height="500px",n.width="600px",n.title="Log Into Athletez",n.id=e,routing.trigger("common-popup-open",n),this.loginView=new f({model:this.login_type,name:"Login View",destination:t,callback:this.callback,attr:this.attr})}});return g});