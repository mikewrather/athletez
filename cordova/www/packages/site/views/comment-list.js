define(["facade","views","utils","site/views/comment-item","site/views/comment-form","text!site/templates/comment-list.html"],function(e,t,n,r,i,s){var o,u,a=n.lib.Channel,f=require("vendor"),l=t.CollectionView,c=t.SectionView,h=f.Mustache;return u=l.extend(c.prototype),o=u.extend({__super__:l.prototype,listView:"#comment-list",_tagName:"li",_className:"comment",page:1,page_limit:5,prepend:!1,_view:r,template:s,events:{"click .see-more-h":"seeMore"},renderTemplate:function(){var e=h.to_html(this.template);return this.$el.html(e),this},initialize:function(e){this.renderTemplate();var t=this;this.collection=e.collection,console.log(this.collection.toJSON()),t.allData=this.collection.toArray(),t.seeMore(),l.prototype.initialize.call(this,e);if(!this.collection)throw new Error("CommentListView expected options.collection.");_.bindAll(this),this.addSubscribers(),this.setupFormView(),console.log(this.collection.toJSON())},seeMore:function(e){var t=this.allData.length,n=t<this.page_limit?t:this.page_limit,r=t-this.page*n,i=r+this.page_limit;r<=0&&this.$el.find(".see-more-h").hide(),this.prepend=!0,e?this.collection.add(this.allData.slice(r,i)):this.collection.reset(this.allData.slice(r,i)),this.page++,this.prepend=!1,e&&(this.addSubscribers&&this.addSubscribers(),this.setupBoardView&&this.setupBoardView(),this.setupAddView&&this.setupAddView())},childViews:{},setupFormView:function(){function r(n){t.model=n,t.render(),$(e.listView).prepend(t.el)}var e=this,t=new i({collection:this.collection}),n=this.addChildView(t);console.log("Form:",t),this.childViews.form=t,this.callbacks.add(function(){n()}),a("commentform:fetch").subscribe(r)}}),o});