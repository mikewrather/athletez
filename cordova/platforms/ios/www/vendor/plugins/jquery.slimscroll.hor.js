/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.6.5
 *
 */

(function(e){jQuery.fn.extend({slimScrollHorizontal:function(t){var n={wheelStep:20,height:"auto",width:"250px",size:"7px",color:"#000",position:"bottom",distance:"1px",start:"left",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200,barZ:99,wrapperPos:"relative",wrapperBottom:"0px"},r=e.extend(n,t);return this.each(function(){function w(e,t,n){var i=e;g.css("left")=="auto"&&g.css("left","0px");if(t){i=parseInt(g.css("left"))+e*parseInt(r.wheelStep)/100*g.outerWidth();var s=d.outerWidth()-g.outerWidth();i=Math.min(Math.max(i,0),s),g.css({left:i+"px"})}f=parseInt(g.css("left"))/(d.outerWidth()-g.outerWidth()),i=f*(d[0].scrollWidth-d.outerWidth());if(n){i=e;var u=i/d[0].scrollWidth*d.outerWidth();g.css({left:u+"px"})}d.scrollLeft(i),x(),T()}function S(){a=Math.max(d.outerWidth()/d[0].scrollWidth*d.outerWidth(),h),g.css({width:a+"px"})}function x(){S(),clearTimeout(s);if(f==~~f){p=r.allowPageScroll;if(l!=f){var e=~~f==0?"left":"right";d.trigger("slimscroll",e)}}l=f;if(a>=d.outerWidth()){p=!0;return}g.stop(!0,!0).fadeIn("fast"),r.railVisible&&m.stop(!0,!0).fadeIn("fast")}function T(){r.alwaysVisible||(s=setTimeout(function(){(!r.disableFadeOut||!t)&&!n&&!i&&(g.fadeOut("slow"),m.fadeOut("slow"))},1e3))}var t,n,i,s,u,a,f,l,c="<div></div>",h=30,p=!1,d=e(this);if(d.parent().hasClass("slimScrollDiv")){scroll&&(g=d.parent().find(".slimScrollBar"),m=d.parent().find(".slimScrollRail"),w(d.scrollLeft()+parseInt(scroll),!1,!0));return}var v=e(c).addClass(r.wrapperClass).css({position:r.wrapperPos,bottom:r.wrapperBottom,overflow:"hidden",width:r.width,height:r.height});d.css({overflow:"hidden",width:r.width,height:r.height});var m=e(c).addClass(r.railClass).css({width:"100%",height:r.size,position:"absolute",bottom:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.size,background:r.railColor,opacity:r.railOpacity,zIndex:90}),g=e(c).addClass(r.barClass).css({background:r.color,height:r.size,position:"absolute",bottom:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.size,BorderRadius:r.size,MozBorderRadius:r.size,WebkitBorderRadius:r.size,zIndex:r.barZ}),y=r.position=="top"?{top:r.distance}:{bottom:r.distance};m.css(y),g.css(y),d.wrap(v),d.parent().append(g),d.parent().append(m),g.draggable({axis:"x",containment:"parent",start:function(){i=!0},stop:function(){i=!1,T()},drag:function(t){w(0,e(this).position().left,!1)}}),m.hover(function(){x()},function(){T()}),g.hover(function(){n=!0},function(){n=!1}),d.hover(function(){t=!0,x(),T()},function(){t=!1,T()}),d.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(u=e.originalEvent.touches[0].pageX)}),d.bind("touchmove",function(e){e.originalEvent.preventDefault();if(e.originalEvent.touches.length){var t=(u-e.originalEvent.touches[0].pageX)/r.touchScrollStep;w(t,!0)}});var b=function(e){if(!t)return;var e=e||window.event,n=0;e.wheelDelta&&(n=-e.wheelDelta/120),e.detail&&(n=e.detail/3),w(n,!0),e.preventDefault&&!p&&e.preventDefault(),p||(e.returnValue=!1)},E=function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",b,!1),this.addEventListener("mousewheel",b,!1)):document.attachEvent("onmousewheel",b)};E(),S(),r.start=="right"?(g.css({left:d.outerWidth()-g.outerWidth()}),w(0,!0)):typeof r.start=="object"&&(w(e(r.start).position().left,null,!0),r.alwaysVisible||g.hide())}),this}}),jQuery.fn.extend({slimscrollHorizontal:jQuery.fn.slimScrollHorizontal})})(jQuery);