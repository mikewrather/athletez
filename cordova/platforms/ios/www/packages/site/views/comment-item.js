define(["vendor","views","utils","text!site/templates/comment-item.html","common/models/delete","vendor/plugins/dateformat"],function(e,t,n,r){var i,s=t.BaseView,o=require("common/models/delete"),u=require("vendor/plugins/dateformat"),a=e.Mustache;return i=s.extend({tagName:"li",className:"comment",events:{"click .delete-comment-h":"deleteComments"},initialize:function(e){e.template?this.template=e.template:this.template=r},dateFormat:function(e){return e=new Date(e),u(e,"mmm d, h:MM TT")},render:function(){var e=this.model.get("payload");e.comment=e.comment.replace(/\n/g,"<br />"),e.comment_date=this.dateFormat(e.timePosted),this.model.set("payload",e);var t=a.to_html(this.template,this.model.toJSON());this.$el.html(t);var n=this;if(e)try{var r=e.user.user_picture_obj.types.small_thumb.url;n.$(".user-photo img").attr("src",r)}catch(i){console.log(i)}return this},deleteComments:function(e){e.stopPropagation(),e.preventDefault();var t=this,n=new o;console.log("payload",this.model.get("payload")),n.subject_id=this.model.get("payload").id,n.enttypes_id=this.model.get("payload").enttypes_id,n.removeNode=$(e.currentTarget).parents("li.comment"),n.destroyAndRemove()}}),i});