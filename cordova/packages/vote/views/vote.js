define(["require","text!votes/templates/vote.html","views","vendor","facade","utils","jqueryui","controller","votes/models/vote","votes/models/follow"],function(e,t){var n,r=e("views"),i=e("facade"),s=e("utils"),o=r.SectionView,u=i.$,a=i._,f=s.debug,l=e("vendor"),c=l.Mustache,h=s.lib.Channel,p=e("votes/models/vote"),d=e("votes/models/follow");return n=o.extend({template:t,events:{"click .team-action-h":"vote","click .follow-action-h":"follow"},vote:function(e){if(!this.checkForUser()){routing.trigger("showSignup");return}this.voteModelOb.save(),u.when(this.voteModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled").html("voted")})},follow:function(e){console.log(e);if(!this.checkForUser()){routing.trigger("showSignup");return}this.followModelOb.save(),u.when(this.followModelOb.request).done(function(){u(e.currentTarget).addClass("link-disabled").html("following")}),h("new-fan").publish()},checkForUser:function(){return!a.isUndefined(routing.userLoggedIn)&&routing.userLoggedIn?!0:!1},initialize:function(e){var t=this;a.bindAll(this),o.prototype.initialize.call(this,e)},render:function(e,t,n){o.prototype.render.call(this,e,t,n);var r=this.model.get("payload");r.has_voted?this.$el.find(".team-action-h").addClass("link-disabled"):(this.voteModelOb=new p,this.voteModelOb.subject_id=r.id,this.voteModelOb.entity_id=r.enttypes_id,this.voteModelOb.setData()),r.is_following?this.$el.find(".follow-action-h").addClass("link-disabled"):(this.followModelOb=new d,this.followModelOb.subject_id=r.id,this.followModelOb.entity_id=r.enttypes_id)}}),n});